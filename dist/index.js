import{getRealm}from"~system/Runtime";var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromNamespaceIfNotNamed(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")&&1===Object.keys(e).length?e.default:e}var lib={};ArrayBuffer.isView||(ArrayBuffer.isView=e=>null!==e&&"object"==typeof e&&e.buffer instanceof ArrayBuffer),"undefined"==typeof globalThis&&"undefined"!=typeof window&&(window.globalThis=window);var Client$1={},ServerError={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.ServerError=e.CloseCode=void 0,(t=e.CloseCode||(e.CloseCode={}))[t.CONSENTED=4e3]="CONSENTED",t[t.DEVMODE_RESTART=4010]="DEVMODE_RESTART";class n extends Error{constructor(e,t){super(t),this.name="ServerError",this.code=e}}e.ServerError=n}(ServerError);var Room$1={},msgpack$1={};function Decoder(e,t){if(this._offset=t,e instanceof ArrayBuffer)this._buffer=e,this._view=new DataView(this._buffer);else{if(!ArrayBuffer.isView(e))throw new Error("Invalid argument");this._buffer=e.buffer,this._view=new DataView(this._buffer,e.byteOffset,e.byteLength)}}function utf8Read(e,t,n){for(var i="",o=0,r=t,a=t+n;r<a;r++){var s=e.getUint8(r);if(128&s)if(192!=(224&s))if(224!=(240&s)){if(240!=(248&s))throw new Error("Invalid byte "+s.toString(16));(o=(7&s)<<18|(63&e.getUint8(++r))<<12|(63&e.getUint8(++r))<<6|63&e.getUint8(++r))>=65536?(o-=65536,i+=String.fromCharCode(55296+(o>>>10),56320+(1023&o))):i+=String.fromCharCode(o)}else i+=String.fromCharCode((15&s)<<12|(63&e.getUint8(++r))<<6|63&e.getUint8(++r));else i+=String.fromCharCode((31&s)<<6|63&e.getUint8(++r));else i+=String.fromCharCode(s)}return i}function decode(e,t=0){var n=new Decoder(e,t),i=n._parse();if(n._offset!==e.byteLength)throw new Error(e.byteLength-n._offset+" trailing bytes");return i}Object.defineProperty(msgpack$1,"__esModule",{value:!0}),msgpack$1.decode=msgpack$1.encode=void 0,Decoder.prototype._array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this._parse();return t},Decoder.prototype._map=function(e){for(var t={},n=0;n<e;n++)t[this._parse()]=this._parse();return t},Decoder.prototype._str=function(e){var t=utf8Read(this._view,this._offset,e);return this._offset+=e,t},Decoder.prototype._bin=function(e){var t=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,t},Decoder.prototype._parse=function(){var e,t=this._view.getUint8(this._offset++),n=0,i=0,o=0,r=0;if(t<192)return t<128?t:t<144?this._map(15&t):t<160?this._array(15&t):this._str(31&t);if(t>223)return-1*(255-t+1);switch(t){case 192:return null;case 194:return!1;case 195:return!0;case 196:return n=this._view.getUint8(this._offset),this._offset+=1,this._bin(n);case 197:return n=this._view.getUint16(this._offset),this._offset+=2,this._bin(n);case 198:return n=this._view.getUint32(this._offset),this._offset+=4,this._bin(n);case 199:if(n=this._view.getUint8(this._offset),i=this._view.getInt8(this._offset+1),this._offset+=2,-1===i){var a=this._view.getUint32(this._offset);return o=this._view.getInt32(this._offset+4),r=this._view.getUint32(this._offset+8),this._offset+=12,new Date(1e3*(4294967296*o+r)+a/1e6)}return[i,this._bin(n)];case 200:return n=this._view.getUint16(this._offset),i=this._view.getInt8(this._offset+2),this._offset+=3,[i,this._bin(n)];case 201:return n=this._view.getUint32(this._offset),i=this._view.getInt8(this._offset+4),this._offset+=5,[i,this._bin(n)];case 202:return e=this._view.getFloat32(this._offset),this._offset+=4,e;case 203:return e=this._view.getFloat64(this._offset),this._offset+=8,e;case 204:return e=this._view.getUint8(this._offset),this._offset+=1,e;case 205:return e=this._view.getUint16(this._offset),this._offset+=2,e;case 206:return e=this._view.getUint32(this._offset),this._offset+=4,e;case 207:return o=this._view.getUint32(this._offset)*Math.pow(2,32),r=this._view.getUint32(this._offset+4),this._offset+=8,o+r;case 208:return e=this._view.getInt8(this._offset),this._offset+=1,e;case 209:return e=this._view.getInt16(this._offset),this._offset+=2,e;case 210:return e=this._view.getInt32(this._offset),this._offset+=4,e;case 211:return o=this._view.getInt32(this._offset)*Math.pow(2,32),r=this._view.getUint32(this._offset+4),this._offset+=8,o+r;case 212:return i=this._view.getInt8(this._offset),this._offset+=1,0===i?void(this._offset+=1):[i,this._bin(1)];case 213:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(2)];case 214:return i=this._view.getInt8(this._offset),this._offset+=1,-1===i?(e=this._view.getUint32(this._offset),this._offset+=4,new Date(1e3*e)):[i,this._bin(4)];case 215:return i=this._view.getInt8(this._offset),this._offset+=1,0===i?(o=this._view.getInt32(this._offset)*Math.pow(2,32),r=this._view.getUint32(this._offset+4),this._offset+=8,new Date(o+r)):-1===i?(o=this._view.getUint32(this._offset),r=this._view.getUint32(this._offset+4),this._offset+=8,new Date(1e3*(4294967296*(3&o)+r)+(o>>>2)/1e6)):[i,this._bin(8)];case 216:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(16)];case 217:return n=this._view.getUint8(this._offset),this._offset+=1,this._str(n);case 218:return n=this._view.getUint16(this._offset),this._offset+=2,this._str(n);case 219:return n=this._view.getUint32(this._offset),this._offset+=4,this._str(n);case 220:return n=this._view.getUint16(this._offset),this._offset+=2,this._array(n);case 221:return n=this._view.getUint32(this._offset),this._offset+=4,this._array(n);case 222:return n=this._view.getUint16(this._offset),this._offset+=2,this._map(n);case 223:return n=this._view.getUint32(this._offset),this._offset+=4,this._map(n)}throw new Error("Could not parse")},msgpack$1.decode=decode;var TIMESTAMP32_MAX_SEC=4294967295,TIMESTAMP64_MAX_SEC=17179869183;function utf8Write(e,t,n){for(var i=0,o=0,r=n.length;o<r;o++)(i=n.charCodeAt(o))<128?e.setUint8(t++,i):i<2048?(e.setUint8(t++,192|i>>6),e.setUint8(t++,128|63&i)):i<55296||i>=57344?(e.setUint8(t++,224|i>>12),e.setUint8(t++,128|i>>6&63),e.setUint8(t++,128|63&i)):(o++,i=65536+((1023&i)<<10|1023&n.charCodeAt(o)),e.setUint8(t++,240|i>>18),e.setUint8(t++,128|i>>12&63),e.setUint8(t++,128|i>>6&63),e.setUint8(t++,128|63&i))}function utf8Length(e){for(var t=0,n=0,i=0,o=e.length;i<o;i++)(t=e.charCodeAt(i))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}function _encode(e,t,n){var i=typeof n,o=0,r=0,a=0,s=0,c=0,u=0;if("string"===i){if((c=utf8Length(n))<32)e.push(160|c),u=1;else if(c<256)e.push(217,c),u=2;else if(c<65536)e.push(218,c>>8,c),u=3;else{if(!(c<4294967296))throw new Error("String too long");e.push(219,c>>24,c>>16,c>>8,c),u=5}return t.push({_str:n,_length:c,_offset:e.length}),u+c}if("number"===i)return Math.floor(n)===n&&isFinite(n)?n>=0?n<128?(e.push(n),1):n<256?(e.push(204,n),2):n<65536?(e.push(205,n>>8,n),3):n<4294967296?(e.push(206,n>>24,n>>16,n>>8,n),5):(a=n/Math.pow(2,32)|0,s=n>>>0,e.push(207,a>>24,a>>16,a>>8,a,s>>24,s>>16,s>>8,s),9):n>=-32?(e.push(n),1):n>=-128?(e.push(208,n),2):n>=-32768?(e.push(209,n>>8,n),3):n>=-2147483648?(e.push(210,n>>24,n>>16,n>>8,n),5):(a=Math.floor(n/Math.pow(2,32)),s=n>>>0,e.push(211,a>>24,a>>16,a>>8,a,s>>24,s>>16,s>>8,s),9):(e.push(203),t.push({_float:n,_length:8,_offset:e.length}),9);if("object"===i){if(null===n)return e.push(192),1;if(Array.isArray(n)){if((c=n.length)<16)e.push(144|c),u=1;else if(c<65536)e.push(220,c>>8,c),u=3;else{if(!(c<4294967296))throw new Error("Array too large");e.push(221,c>>24,c>>16,c>>8,c),u=5}for(o=0;o<c;o++)u+=_encode(e,t,n[o]);return u}if(n instanceof Date){var l=n.getTime(),f=Math.floor(l/1e3),d=1e6*(l-1e3*f);return f>=0&&d>=0&&f<=TIMESTAMP64_MAX_SEC?0===d&&f<=TIMESTAMP32_MAX_SEC?(e.push(214,255,f>>24,f>>16,f>>8,f),6):(a=f/4294967296,s=4294967295&f,e.push(215,255,d>>22,d>>14,d>>6,a,s>>24,s>>16,s>>8,s),10):(a=Math.floor(f/4294967296),s=f>>>0,e.push(199,12,255,d>>24,d>>16,d>>8,d,a>>24,a>>16,a>>8,a,s>>24,s>>16,s>>8,s),15)}if(n instanceof ArrayBuffer){if((c=n.byteLength)<256)e.push(196,c),u=2;else if(c<65536)e.push(197,c>>8,c),u=3;else{if(!(c<4294967296))throw new Error("Buffer too large");e.push(198,c>>24,c>>16,c>>8,c),u=5}return t.push({_bin:n,_length:c,_offset:e.length}),u+c}if("function"==typeof n.toJSON)return _encode(e,t,n.toJSON());var h=[],p="",m=Object.keys(n);for(o=0,r=m.length;o<r;o++)void 0!==n[p=m[o]]&&"function"!=typeof n[p]&&h.push(p);if((c=h.length)<16)e.push(128|c),u=1;else if(c<65536)e.push(222,c>>8,c),u=3;else{if(!(c<4294967296))throw new Error("Object too large");e.push(223,c>>24,c>>16,c>>8,c),u=5}for(o=0;o<c;o++)u+=_encode(e,t,p=h[o]),u+=_encode(e,t,n[p]);return u}if("boolean"===i)return e.push(n?195:194),1;if("undefined"===i)return e.push(192),1;if("function"==typeof n.toJSON)return _encode(e,t,n.toJSON());throw new Error("Could not encode")}function encode(e){var t=[],n=[],i=_encode(t,n,e),o=new ArrayBuffer(i),r=new DataView(o),a=0,s=0,c=-1;n.length>0&&(c=n[0]._offset);for(var u,l=0,f=0,d=0,h=t.length;d<h;d++)if(r.setUint8(s+d,t[d]),d+1===c){if(l=(u=n[a])._length,f=s+c,u._bin)for(var p=new Uint8Array(u._bin),m=0;m<l;m++)r.setUint8(f+m,p[m]);else u._str?utf8Write(r,f,u._str):void 0!==u._float&&r.setFloat64(f,u._float);s+=l,n[++a]&&(c=n[a]._offset)}return o}msgpack$1.encode=encode;var Connection$1={},WebSocketTransport$1={},browser=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")},__importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(WebSocketTransport$1,"__esModule",{value:!0}),WebSocketTransport$1.WebSocketTransport=void 0;const ws_1=__importDefault(browser),WebSocket=globalThis.WebSocket||ws_1.default;class WebSocketTransport{constructor(e){this.events=e}send(e){e instanceof ArrayBuffer?this.ws.send(e):Array.isArray(e)&&this.ws.send(new Uint8Array(e).buffer)}connect(e){this.ws=new WebSocket(e,this.protocols),this.ws.binaryType="arraybuffer",this.ws.onopen=this.events.onopen,this.ws.onmessage=this.events.onmessage,this.ws.onclose=this.events.onclose,this.ws.onerror=this.events.onerror}close(e,t){this.ws.close(e,t)}get isOpen(){return this.ws.readyState===WebSocket.OPEN}}WebSocketTransport$1.WebSocketTransport=WebSocketTransport,Object.defineProperty(Connection$1,"__esModule",{value:!0}),Connection$1.Connection=void 0;const WebSocketTransport_1=WebSocketTransport$1;class Connection{constructor(){this.events={},this.transport=new WebSocketTransport_1.WebSocketTransport(this.events)}send(e){this.transport.send(e)}connect(e){this.transport.connect(e)}close(e,t){this.transport.close(e,t)}get isOpen(){return this.transport.isOpen}}Connection$1.Connection=Connection;var Protocol={},exports,ErrorCode;exports=Protocol,Object.defineProperty(exports,"__esModule",{value:!0}),exports.utf8Length=exports.utf8Read=exports.ErrorCode=exports.Protocol=void 0,function(e){e[e.HANDSHAKE=9]="HANDSHAKE",e[e.JOIN_ROOM=10]="JOIN_ROOM",e[e.ERROR=11]="ERROR",e[e.LEAVE_ROOM=12]="LEAVE_ROOM",e[e.ROOM_DATA=13]="ROOM_DATA",e[e.ROOM_STATE=14]="ROOM_STATE",e[e.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",e[e.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA",e[e.ROOM_DATA_BYTES=17]="ROOM_DATA_BYTES"}(exports.Protocol||(exports.Protocol={})),(ErrorCode=exports.ErrorCode||(exports.ErrorCode={}))[ErrorCode.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",ErrorCode[ErrorCode.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",ErrorCode[ErrorCode.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",ErrorCode[ErrorCode.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",ErrorCode[ErrorCode.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",ErrorCode[ErrorCode.AUTH_FAILED=4215]="AUTH_FAILED",ErrorCode[ErrorCode.APPLICATION_ERROR=4216]="APPLICATION_ERROR",exports.utf8Read=function(e,t){const n=e[t++];for(var i="",o=0,r=t,a=t+n;r<a;r++){var s=e[r];if(128&s)if(192!=(224&s))if(224!=(240&s)){if(240!=(248&s))throw new Error("Invalid byte "+s.toString(16));(o=(7&s)<<18|(63&e[++r])<<12|(63&e[++r])<<6|63&e[++r])>=65536?(o-=65536,i+=String.fromCharCode(55296+(o>>>10),56320+(1023&o))):i+=String.fromCharCode(o)}else i+=String.fromCharCode((15&s)<<12|(63&e[++r])<<6|63&e[++r]);else i+=String.fromCharCode((31&s)<<6|63&e[++r]);else i+=String.fromCharCode(s)}return i},exports.utf8Length=function(e=""){let t=0,n=0;for(let i=0,o=e.length;i<o;i++)t=e.charCodeAt(i),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n+1};var Serializer={};Object.defineProperty(Serializer,"__esModule",{value:!0}),Serializer.getSerializer=Serializer.registerSerializer=void 0;const serializers={};function registerSerializer(e,t){serializers[e]=t}function getSerializer(e){const t=serializers[e];if(!t)throw new Error("missing serializer: "+e);return t}Serializer.registerSerializer=registerSerializer,Serializer.getSerializer=getSerializer;var nanoevents={};Object.defineProperty(nanoevents,"__esModule",{value:!0}),nanoevents.createNanoEvents=void 0;const createNanoEvents=()=>({emit(e,...t){let n=this.events[e]||[];for(let e=0,i=n.length;e<i;e++)n[e](...t)},events:{},on(e,t){var n;return(null===(n=this.events[e])||void 0===n?void 0:n.push(t))||(this.events[e]=[t]),()=>{var n;this.events[e]=null===(n=this.events[e])||void 0===n?void 0:n.filter((e=>t!==e))}}});nanoevents.createNanoEvents=createNanoEvents;var signal={};Object.defineProperty(signal,"__esModule",{value:!0}),signal.createSignal=signal.EventEmitter=void 0;class EventEmitter$1{constructor(){this.handlers=[]}register(e,t=!1){return this.handlers.push(e),this}invoke(...e){this.handlers.forEach((t=>t.apply(this,e)))}invokeAsync(...e){return Promise.all(this.handlers.map((t=>t.apply(this,e))))}remove(e){const t=this.handlers.indexOf(e);this.handlers[t]=this.handlers[this.handlers.length-1],this.handlers.pop()}clear(){this.handlers=[]}}function createSignal(){const e=new EventEmitter$1;function t(t){return e.register(t,null===this)}return t.once=t=>{const n=function(...i){t.apply(this,i),e.remove(n)};e.register(n)},t.remove=t=>e.remove(t),t.invoke=(...t)=>e.invoke(...t),t.invokeAsync=(...t)=>e.invokeAsync(...t),t.clear=()=>e.clear(),t}signal.EventEmitter=EventEmitter$1,signal.createSignal=createSignal;var umd={exports:{}};!function(e){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)};function n(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}function i(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function o(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var r,a=255,s=213;e.OPERATION=void 0,(r=e.OPERATION||(e.OPERATION={}))[r.ADD=128]="ADD",r[r.REPLACE=0]="REPLACE",r[r.DELETE=64]="DELETE",r[r.DELETE_AND_ADD=192]="DELETE_AND_ADD",r[r.TOUCH=1]="TOUCH",r[r.CLEAR=10]="CLEAR";var c=function(){function t(e,t,n){this.changed=!1,this.changes=new Map,this.allChanges=new Set,this.caches={},this.currentCustomOperation=0,this.ref=e,this.setParent(t,n)}return t.prototype.setParent=function(e,t,n){var i=this;if(this.indexes||(this.indexes=this.ref instanceof Ce?this.ref._definition.indexes:{}),this.parent=e,this.parentIndex=n,t)if(this.root=t,this.ref instanceof Ce){var o=this.ref._definition;for(var r in o.schema){var a=this.ref[r];if(a&&a.$changes){var s=o.indexes[r];a.$changes.setParent(this.ref,t,s)}}}else"object"==typeof this.ref&&this.ref.forEach((function(e,t){if(e instanceof Ce){var n=e.$changes,o=i.ref.$changes.indexes[t];n.setParent(i.ref,i.root,o)}}))},t.prototype.operation=function(e){this.changes.set(--this.currentCustomOperation,e)},t.prototype.change=function(t,n){void 0===n&&(n=e.OPERATION.ADD);var i="number"==typeof t?t:this.indexes[t];this.assertValidIndex(i,t);var o=this.changes.get(i);o&&o.op!==e.OPERATION.DELETE&&o.op!==e.OPERATION.TOUCH||this.changes.set(i,{op:o&&o.op===e.OPERATION.DELETE?e.OPERATION.DELETE_AND_ADD:n,index:i}),this.allChanges.add(i),this.changed=!0,this.touchParents()},t.prototype.touch=function(t){var n="number"==typeof t?t:this.indexes[t];this.assertValidIndex(n,t),this.changes.has(n)||this.changes.set(n,{op:e.OPERATION.TOUCH,index:n}),this.allChanges.add(n),this.touchParents()},t.prototype.touchParents=function(){this.parent&&this.parent.$changes.touch(this.parentIndex)},t.prototype.getType=function(e){if(this.ref._definition)return(t=this.ref._definition).schema[t.fieldsByIndex[e]];var t,n=(t=this.parent._definition).schema[t.fieldsByIndex[this.parentIndex]];return Object.values(n)[0]},t.prototype.getChildrenFilter=function(){var e=this.parent._definition.childFilters;return e&&e[this.parentIndex]},t.prototype.getValue=function(e){return this.ref.getByIndex(e)},t.prototype.delete=function(t){var n="number"==typeof t?t:this.indexes[t];if(void 0!==n){var i=this.getValue(n);this.changes.set(n,{op:e.OPERATION.DELETE,index:n}),this.allChanges.delete(n),delete this.caches[n],i&&i.$changes&&(i.$changes.parent=void 0),this.changed=!0,this.touchParents()}else console.warn("@colyseus/schema ".concat(this.ref.constructor.name,": trying to delete non-existing index: ").concat(t," (").concat(n,")"))},t.prototype.discard=function(t,n){var i=this;void 0===t&&(t=!1),void 0===n&&(n=!1),this.ref instanceof Ce||this.changes.forEach((function(t){if(t.op===e.OPERATION.DELETE){var n=i.ref.getIndex(t.index);delete i.indexes[n]}})),this.changes.clear(),this.changed=t,n&&this.allChanges.clear(),this.currentCustomOperation=0},t.prototype.discardAll=function(){var e=this;this.changes.forEach((function(t){var n=e.getValue(t.index);n&&n.$changes&&n.$changes.discardAll()})),this.discard()},t.prototype.cache=function(e,t){this.caches[e]=t},t.prototype.clone=function(){return new t(this.ref,this.parent,this.root)},t.prototype.ensureRefId=function(){void 0===this.refId&&(this.refId=this.root.getNextUniqueId())},t.prototype.assertValidIndex=function(e,t){if(void 0===e)throw new Error('ChangeTree: missing index for field "'.concat(t,'"'))},t}();function u(e,t,n,i){return e[t]||(e[t]=[]),e[t].push(n),null==i||i.forEach((function(e,t){return n(e,t)})),function(){return f(e[t],e[t].indexOf(n))}}function l(t){var n=this,i="string"!=typeof this.$changes.getType();this.$items.forEach((function(o,r){t.push({refId:n.$changes.refId,op:e.OPERATION.DELETE,field:r,value:void 0,previousValue:o}),i&&n.$changes.root.removeRef(o.$changes.refId)}))}function f(e,t){if(-1===t||t>=e.length)return!1;for(var n=e.length-1,i=t;i<n;i++)e[i]=e[i+1];return e.length=n,!0}var d=function(e,t){var n=e.toString(),i=t.toString();return n<i?-1:n>i?1:0};function h(e){return e.$proxy=!0,e=new Proxy(e,{get:function(e,t){return"symbol"==typeof t||isNaN(t)?e[t]:e.at(t)},set:function(e,t,n){if("symbol"==typeof t||isNaN(t))e[t]=n;else{var i=Array.from(e.$items.keys()),o=parseInt(i[t]||t);null==n?e.deleteAt(o):e.setAt(o,n)}return!0},deleteProperty:function(e,t){return"number"==typeof t?e.deleteAt(t):delete e[t],!0},has:function(e,t){return"symbol"==typeof t||isNaN(Number(t))?Reflect.has(e,t):e.$items.has(Number(t))}})}var p=function(){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.$changes=new c(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,this.push.apply(this,e)}return t.prototype.onAdd=function(t,n){return void 0===n&&(n=!0),u(this.$callbacks||(this.$callbacks={}),e.OPERATION.ADD,t,n?this.$items:void 0)},t.prototype.onRemove=function(t){return u(this.$callbacks||(this.$callbacks={}),e.OPERATION.DELETE,t)},t.prototype.onChange=function(t){return u(this.$callbacks||(this.$callbacks={}),e.OPERATION.REPLACE,t)},t.is=function(e){return Array.isArray(e)||void 0!==e.array},Object.defineProperty(t.prototype,"length",{get:function(){return this.$items.size},set:function(e){0===e?this.clear():this.splice(e,this.length-e)},enumerable:!1,configurable:!0}),t.prototype.push=function(){for(var e,t=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.forEach((function(n){e=t.$refId++,t.setAt(e,n)})),e},t.prototype.pop=function(){var e=Array.from(this.$indexes.values()).pop();if(void 0!==e){this.$changes.delete(e),this.$indexes.delete(e);var t=this.$items.get(e);return this.$items.delete(e),t}},t.prototype.at=function(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length)){var t=Array.from(this.$items.keys())[e];return this.$items.get(t)}},t.prototype.setAt=function(t,n){var i,o;if(null!=n){if(this.$items.get(t)!==n){void 0!==n.$changes&&n.$changes.setParent(this,this.$changes.root,t);var r=null!==(o=null===(i=this.$changes.indexes[t])||void 0===i?void 0:i.op)&&void 0!==o?o:e.OPERATION.ADD;this.$changes.indexes[t]=t,this.$indexes.set(t,t),this.$items.set(t,n),this.$changes.change(t,r)}}else console.error("ArraySchema items cannot be null nor undefined; Use `deleteAt(index)` instead.")},t.prototype.deleteAt=function(e){var t=Array.from(this.$items.keys())[e];return void 0!==t&&this.$deleteAt(t)},t.prototype.$deleteAt=function(e){return this.$changes.delete(e),this.$indexes.delete(e),this.$items.delete(e)},t.prototype.clear=function(t){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&l.call(this,t),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},t.prototype.concat=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return new(t.bind.apply(t,o([void 0],(e=Array.from(this.$items.values())).concat.apply(e,n),!1)))},t.prototype.join=function(e){return Array.from(this.$items.values()).join(e)},t.prototype.reverse=function(){var e=this,t=Array.from(this.$items.keys());return Array.from(this.$items.values()).reverse().forEach((function(n,i){e.setAt(t[i],n)})),this},t.prototype.shift=function(){var e=Array.from(this.$items.keys()).shift();if(void 0!==e){var t=this.$items.get(e);return this.$deleteAt(e),t}},t.prototype.slice=function(e,n){var i=new t;return i.push.apply(i,Array.from(this.$items.values()).slice(e,n)),i},t.prototype.sort=function(e){var t=this;void 0===e&&(e=d);var n=Array.from(this.$items.keys());return Array.from(this.$items.values()).sort(e).forEach((function(e,i){t.setAt(n[i],e)})),this},t.prototype.splice=function(e,t){void 0===t&&(t=this.length-e);for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];for(var o=Array.from(this.$items.keys()),r=[],a=e;a<e+t;a++)r.push(this.$items.get(o[a])),this.$deleteAt(o[a]);for(a=0;a<n.length;a++)this.setAt(e+a,n[a]);return r},t.prototype.unshift=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=this.length,o=t.length,r=Array.from(this.$items.values());return t.forEach((function(t,n){e.setAt(n,t)})),r.forEach((function(t,n){e.setAt(o+n,t)})),i+o},t.prototype.indexOf=function(e,t){return Array.from(this.$items.values()).indexOf(e,t)},t.prototype.lastIndexOf=function(e,t){return void 0===t&&(t=this.length-1),Array.from(this.$items.values()).lastIndexOf(e,t)},t.prototype.every=function(e,t){return Array.from(this.$items.values()).every(e,t)},t.prototype.some=function(e,t){return Array.from(this.$items.values()).some(e,t)},t.prototype.forEach=function(e,t){Array.from(this.$items.values()).forEach(e,t)},t.prototype.map=function(e,t){return Array.from(this.$items.values()).map(e,t)},t.prototype.filter=function(e,t){return Array.from(this.$items.values()).filter(e,t)},t.prototype.reduce=function(e,t){return Array.prototype.reduce.apply(Array.from(this.$items.values()),arguments)},t.prototype.reduceRight=function(e,t){return Array.prototype.reduceRight.apply(Array.from(this.$items.values()),arguments)},t.prototype.find=function(e,t){return Array.from(this.$items.values()).find(e,t)},t.prototype.findIndex=function(e,t){return Array.from(this.$items.values()).findIndex(e,t)},t.prototype.fill=function(e,t,n){throw new Error("ArraySchema#fill() not implemented")},t.prototype.copyWithin=function(e,t,n){throw new Error("ArraySchema#copyWithin() not implemented")},t.prototype.toString=function(){return this.$items.toString()},t.prototype.toLocaleString=function(){return this.$items.toLocaleString()},t.prototype[Symbol.iterator]=function(){return Array.from(this.$items.values())[Symbol.iterator]()},Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.entries=function(){return this.$items.entries()},t.prototype.keys=function(){return this.$items.keys()},t.prototype.values=function(){return this.$items.values()},t.prototype.includes=function(e,t){return Array.from(this.$items.values()).includes(e,t)},t.prototype.flatMap=function(e,t){throw new Error("ArraySchema#flatMap() is not supported.")},t.prototype.flat=function(e){throw new Error("ArraySchema#flat() is not supported.")},t.prototype.findLast=function(){var e=Array.from(this.$items.values());return e.findLast.apply(e,arguments)},t.prototype.findLastIndex=function(){var e=Array.from(this.$items.values());return e.findLastIndex.apply(e,arguments)},t.prototype.with=function(e,n){var i=Array.from(this.$items.values());return i[e]=n,new(t.bind.apply(t,o([void 0],i,!1)))},t.prototype.toReversed=function(){return Array.from(this.$items.values()).reverse()},t.prototype.toSorted=function(e){return Array.from(this.$items.values()).sort(e)},t.prototype.toSpliced=function(e,t){var n=Array.from(this.$items.values());return n.toSpliced.apply(n,arguments)},t.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},t.prototype.getIndex=function(e){return this.$indexes.get(e)},t.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},t.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},t.prototype.toArray=function(){return Array.from(this.$items.values())},t.prototype.toJSON=function(){return this.toArray().map((function(e){return"function"==typeof e.toJSON?e.toJSON():e}))},t.prototype.clone=function(e){return e?new(t.bind.apply(t,o([void 0],Array.from(this.$items.values()),!1))):new(t.bind.apply(t,o([void 0],this.map((function(e){return e.$changes?e.clone():e})),!1)))},t}();function m(e){return e.$proxy=!0,e=new Proxy(e,{get:function(e,t){return"symbol"!=typeof t&&void 0===e[t]?e.get(t):e[t]},set:function(e,t,n){return"symbol"!=typeof t&&-1===t.indexOf("$")&&"onAdd"!==t&&"onRemove"!==t&&"onChange"!==t?e.set(t,n):e[t]=n,!0},deleteProperty:function(e,t){return e.delete(t),!0}})}var y=function(){function t(e){var n=this;if(this.$changes=new c(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e)if(e instanceof Map||e instanceof t)e.forEach((function(e,t){return n.set(t,e)}));else for(var i in e)this.set(i,e[i])}return t.prototype.onAdd=function(t,n){return void 0===n&&(n=!0),u(this.$callbacks||(this.$callbacks={}),e.OPERATION.ADD,t,n?this.$items:void 0)},t.prototype.onRemove=function(t){return u(this.$callbacks||(this.$callbacks={}),e.OPERATION.DELETE,t)},t.prototype.onChange=function(t){return u(this.$callbacks||(this.$callbacks={}),e.OPERATION.REPLACE,t)},t.is=function(e){return void 0!==e.map},t.prototype[Symbol.iterator]=function(){return this.$items[Symbol.iterator]()},Object.defineProperty(t.prototype,Symbol.toStringTag,{get:function(){return this.$items[Symbol.toStringTag]},enumerable:!1,configurable:!0}),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.set=function(t,n){if(null==n)throw new Error("MapSchema#set('".concat(t,"', ").concat(n,"): trying to set ").concat(n," value on '").concat(t,"'."));t=t.toString();var i=void 0!==this.$changes.indexes[t],o=i?this.$changes.indexes[t]:this.$refId++,r=i?e.OPERATION.REPLACE:e.OPERATION.ADD,a=void 0!==n.$changes;if(a&&n.$changes.setParent(this,this.$changes.root,o),i){if(!a&&this.$items.get(t)===n)return;a&&this.$items.get(t)!==n&&(r=e.OPERATION.ADD)}else this.$changes.indexes[t]=o,this.$indexes.set(o,t);return this.$items.set(t,n),this.$changes.change(t,r),this},t.prototype.get=function(e){return this.$items.get(e)},t.prototype.delete=function(e){return this.$changes.delete(e.toString()),this.$items.delete(e)},t.prototype.clear=function(t){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&l.call(this,t),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},t.prototype.has=function(e){return this.$items.has(e)},t.prototype.forEach=function(e){this.$items.forEach(e)},t.prototype.entries=function(){return this.$items.entries()},t.prototype.keys=function(){return this.$items.keys()},t.prototype.values=function(){return this.$items.values()},Object.defineProperty(t.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),t.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},t.prototype.getIndex=function(e){return this.$indexes.get(e)},t.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},t.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},t.prototype.toJSON=function(){var e={};return this.forEach((function(t,n){e[n]="function"==typeof t.toJSON?t.toJSON():t})),e},t.prototype.clone=function(e){var n;return e?n=Object.assign(new t,this):(n=new t,this.forEach((function(e,t){e.$changes?n.set(t,e.clone()):n.set(t,e)}))),n},t}(),g={};function E(e,t){g[e]=t}function _(e){return g[e]}var T=function(){function e(){this.indexes={},this.fieldsByIndex={},this.deprecated={},this.descriptors={}}return e.create=function(t){var n=new e;return n.schema=Object.assign({},t&&t.schema||{}),n.indexes=Object.assign({},t&&t.indexes||{}),n.fieldsByIndex=Object.assign({},t&&t.fieldsByIndex||{}),n.descriptors=Object.assign({},t&&t.descriptors||{}),n.deprecated=Object.assign({},t&&t.deprecated||{}),n},e.prototype.addField=function(e,t){var n=this.getNextFieldIndex();this.fieldsByIndex[n]=e,this.indexes[e]=n,this.schema[e]=Array.isArray(t)?{array:t[0]}:t},e.prototype.hasField=function(e){return void 0!==this.indexes[e]},e.prototype.addFilter=function(e,t){return this.filters||(this.filters={},this.indexesWithFilters=[]),this.filters[this.indexes[e]]=t,this.indexesWithFilters.push(this.indexes[e]),!0},e.prototype.addChildrenFilter=function(e,t){var n=this.indexes[e],i=this.schema[e];if(_(Object.keys(i)[0]))return this.childFilters||(this.childFilters={}),this.childFilters[n]=t,!0;console.warn("@filterChildren: field '".concat(e,"' can't have children. Ignoring filter."))},e.prototype.getChildrenFilter=function(e){return this.childFilters&&this.childFilters[this.indexes[e]]},e.prototype.getNextFieldIndex=function(){return Object.keys(this.schema||{}).length},e}();function v(e){return e._context&&e._context.useFilters}var S=function(){function e(){this.types={},this.schemas=new Map,this.useFilters=!1}return e.prototype.has=function(e){return this.schemas.has(e)},e.prototype.get=function(e){return this.types[e]},e.prototype.add=function(e,t){void 0===t&&(t=this.schemas.size),e._definition=T.create(e._definition),e._typeid=t,this.types[t]=e,this.schemas.set(e,t)},e.create=function(t){return void 0===t&&(t={}),function(n){return t.context||(t.context=new e),A(n,t)}},e}(),b=new S;function A(e,t){return void 0===t&&(t={}),function(n,i){var r=t.context||b,a=n.constructor;if(a._context=r,!e)throw new Error("".concat(a.name,': @type() reference provided for "').concat(i,"\" is undefined. Make sure you don't have any circular dependencies."));r.has(a)||r.add(a);var s=a._definition;if(s.addField(i,e),s.descriptors[i]){if(s.deprecated[i])return;try{throw new Error("@colyseus/schema: Duplicate '".concat(i,"' definition on '").concat(a.name,"'.\nCheck @type() annotation"))}catch(e){var c=e.stack.split("\n")[4].trim();throw new Error("".concat(e.message," ").concat(c))}}var u=p.is(e),l=!u&&y.is(e);if("string"!=typeof e&&!Ce.is(e)){var f=Object.values(e)[0];"string"==typeof f||r.has(f)||r.add(f)}if(t.manual)s.descriptors[i]={enumerable:!0,configurable:!0,writable:!0};else{var d="_".concat(i);s.descriptors[d]={enumerable:!1,configurable:!1,writable:!0},s.descriptors[i]={get:function(){return this[d]},set:function(e){e!==this[d]&&(null!=e?(!u||e instanceof p||(e=new(p.bind.apply(p,o([void 0],e,!1)))),!l||e instanceof y||(e=new y(e)),void 0===e.$proxy&&(l?e=m(e):u&&(e=h(e))),this.$changes.change(i),e.$changes&&e.$changes.setParent(this,this.$changes.root,this._definition.indexes[i])):this[d]&&this.$changes.delete(i),this[d]=e)},enumerable:!0,configurable:!0}}}}function w(e){return function(t,n){var i=t.constructor;i._definition.addFilter(n,e)&&(i._context.useFilters=!0)}}function P(e){return function(t,n){var i=t.constructor;i._definition.addChildrenFilter(n,e)&&(i._context.useFilters=!0)}}function B(e){return void 0===e&&(e=!0),function(t,n){var i=t.constructor._definition;i.deprecated[n]=!0,e&&(i.descriptors[n]={get:function(){throw new Error("".concat(n," is deprecated."))},set:function(e){},enumerable:!1,configurable:!0})}}function R(e,t,n){for(var i in void 0===n&&(n={}),n.context||(n.context=e._context||n.context||b),t)A(t[i],n)(e.prototype,i);return e}function C(e){for(var t=0,n=0,i=0,o=e.length;i<o;i++)(t=e.charCodeAt(i))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}function M(e,t,n){for(var i=0,o=0,r=n.length;o<r;o++)(i=n.charCodeAt(o))<128?e[t++]=i:i<2048?(e[t++]=192|i>>6,e[t++]=128|63&i):i<55296||i>=57344?(e[t++]=224|i>>12,e[t++]=128|i>>6&63,e[t++]=128|63&i):(o++,i=65536+((1023&i)<<10|1023&n.charCodeAt(o)),e[t++]=240|i>>18,e[t++]=128|i>>12&63,e[t++]=128|i>>6&63,e[t++]=128|63&i)}function I(e,t){e.push(255&t)}function N(e,t){e.push(255&t)}function O(e,t){e.push(255&t),e.push(t>>8&255)}function k(e,t){e.push(255&t),e.push(t>>8&255)}function x(e,t){e.push(255&t),e.push(t>>8&255),e.push(t>>16&255),e.push(t>>24&255)}function U(e,t){var n=t>>24,i=t>>16,o=t>>8,r=t;e.push(255&r),e.push(255&o),e.push(255&i),e.push(255&n)}function L(e,t){var n=Math.floor(t/Math.pow(2,32));U(e,t>>>0),U(e,n)}function $(e,t){var n=t/Math.pow(2,32)|0;U(e,t>>>0),U(e,n)}function D(e,t){G(e,t)}function z(e,t){j(e,t)}var F=new Int32Array(2),V=new Float32Array(F.buffer),W=new Float64Array(F.buffer);function G(e,t){V[0]=t,x(e,F[0])}function j(e,t){W[0]=t,x(e,F[0]),x(e,F[1])}function H(e,t){return N(e,t?1:0)}function q(e,t){t||(t="");var n=C(t),i=0;if(n<32)e.push(160|n),i=1;else if(n<256)e.push(217),N(e,n),i=2;else if(n<65536)e.push(218),k(e,n),i=3;else{if(!(n<4294967296))throw new Error("String too long");e.push(219),U(e,n),i=5}return M(e,e.length,t),i+n}function Y(e,t){return isNaN(t)?Y(e,0):isFinite(t)?t!==(0|t)?(e.push(203),j(e,t),9):t>=0?t<128?(N(e,t),1):t<256?(e.push(204),N(e,t),2):t<65536?(e.push(205),k(e,t),3):t<4294967296?(e.push(206),U(e,t),5):(e.push(207),$(e,t),9):t>=-32?(e.push(224|t+32),1):t>=-128?(e.push(208),I(e,t),2):t>=-32768?(e.push(209),O(e,t),3):t>=-2147483648?(e.push(210),x(e,t),5):(e.push(211),L(e,t),9):Y(e,t>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER)}var Q=Object.freeze({__proto__:null,boolean:H,float32:D,float64:z,int16:O,int32:x,int64:L,int8:I,number:Y,string:q,uint16:k,uint32:U,uint64:$,uint8:N,utf8Write:M,writeFloat32:G,writeFloat64:j});function J(e,t,n){for(var i="",o=0,r=t,a=t+n;r<a;r++){var s=e[r];128&s?192!=(224&s)?224!=(240&s)?240!=(248&s)?console.error("Invalid byte "+s.toString(16)):(o=(7&s)<<18|(63&e[++r])<<12|(63&e[++r])<<6|63&e[++r])>=65536?(o-=65536,i+=String.fromCharCode(55296+(o>>>10),56320+(1023&o))):i+=String.fromCharCode(o):i+=String.fromCharCode((15&s)<<12|(63&e[++r])<<6|63&e[++r]):i+=String.fromCharCode((31&s)<<6|63&e[++r]):i+=String.fromCharCode(s)}return i}function X(e,t){return K(e,t)<<24>>24}function K(e,t){return e[t.offset++]}function Z(e,t){return ee(e,t)<<16>>16}function ee(e,t){return e[t.offset++]|e[t.offset++]<<8}function te(e,t){return e[t.offset++]|e[t.offset++]<<8|e[t.offset++]<<16|e[t.offset++]<<24}function ne(e,t){return te(e,t)>>>0}function ie(e,t){return le(e,t)}function oe(e,t){return fe(e,t)}function re(e,t){var n=ne(e,t);return te(e,t)*Math.pow(2,32)+n}function ae(e,t){var n=ne(e,t);return ne(e,t)*Math.pow(2,32)+n}var se=new Int32Array(2),ce=new Float32Array(se.buffer),ue=new Float64Array(se.buffer);function le(e,t){return se[0]=te(e,t),ce[0]}function fe(e,t){return se[0]=te(e,t),se[1]=te(e,t),ue[0]}function de(e,t){return K(e,t)>0}function he(e,t){var n,i=e[t.offset++];i<192?n=31&i:217===i?n=K(e,t):218===i?n=ee(e,t):219===i&&(n=ne(e,t));var o=J(e,t.offset,n);return t.offset+=n,o}function pe(e,t){var n=e[t.offset];return n<192&&n>160||217===n||218===n||219===n}function me(e,t){var n=e[t.offset++];return n<128?n:202===n?le(e,t):203===n?fe(e,t):204===n?K(e,t):205===n?ee(e,t):206===n?ne(e,t):207===n?ae(e,t):208===n?X(e,t):209===n?Z(e,t):210===n?te(e,t):211===n?re(e,t):n>223?-1*(255-n+1):void 0}function ye(e,t){var n=e[t.offset];return n<128||n>=202&&n<=211}function ge(e,t){return e[t.offset]<160}function Ee(e,t){return e[t.offset-1]===a&&(e[t.offset]<128||e[t.offset]>=202&&e[t.offset]<=211)}var _e=Object.freeze({__proto__:null,arrayCheck:ge,boolean:de,float32:ie,float64:oe,int16:Z,int32:te,int64:re,int8:X,number:me,numberCheck:ye,readFloat32:le,readFloat64:fe,string:he,stringCheck:pe,switchStructureCheck:Ee,uint16:ee,uint32:ne,uint64:ae,uint8:K}),Te=function(){function t(e){var t=this;this.$changes=new c(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach((function(e){return t.add(e)}))}return t.prototype.onAdd=function(t,n){return void 0===n&&(n=!0),u(this.$callbacks||(this.$callbacks=[]),e.OPERATION.ADD,t,n?this.$items:void 0)},t.prototype.onRemove=function(t){return u(this.$callbacks||(this.$callbacks=[]),e.OPERATION.DELETE,t)},t.prototype.onChange=function(t){return u(this.$callbacks||(this.$callbacks=[]),e.OPERATION.REPLACE,t)},t.is=function(e){return void 0!==e.collection},t.prototype.add=function(e){var t=this.$refId++;return void 0!==e.$changes&&e.$changes.setParent(this,this.$changes.root,t),this.$changes.indexes[t]=t,this.$indexes.set(t,t),this.$items.set(t,e),this.$changes.change(t),t},t.prototype.at=function(e){var t=Array.from(this.$items.keys())[e];return this.$items.get(t)},t.prototype.entries=function(){return this.$items.entries()},t.prototype.delete=function(e){for(var t,n,i=this.$items.entries();(n=i.next())&&!n.done;)if(e===n.value[1]){t=n.value[0];break}return void 0!==t&&(this.$changes.delete(t),this.$indexes.delete(t),this.$items.delete(t))},t.prototype.clear=function(t){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&l.call(this,t),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},t.prototype.has=function(e){return Array.from(this.$items.values()).some((function(t){return t===e}))},t.prototype.forEach=function(e){var t=this;this.$items.forEach((function(n,i,o){return e(n,i,t)}))},t.prototype.values=function(){return this.$items.values()},Object.defineProperty(t.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),t.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},t.prototype.getIndex=function(e){return this.$indexes.get(e)},t.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},t.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},t.prototype.toArray=function(){return Array.from(this.$items.values())},t.prototype.toJSON=function(){var e=[];return this.forEach((function(t,n){e.push("function"==typeof t.toJSON?t.toJSON():t)})),e},t.prototype.clone=function(e){var n;return e?n=Object.assign(new t,this):(n=new t,this.forEach((function(e){e.$changes?n.add(e.clone()):n.add(e)}))),n},t}(),ve=function(){function t(e){var t=this;this.$changes=new c(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach((function(e){return t.add(e)}))}return t.prototype.onAdd=function(t,n){return void 0===n&&(n=!0),u(this.$callbacks||(this.$callbacks=[]),e.OPERATION.ADD,t,n?this.$items:void 0)},t.prototype.onRemove=function(t){return u(this.$callbacks||(this.$callbacks=[]),e.OPERATION.DELETE,t)},t.prototype.onChange=function(t){return u(this.$callbacks||(this.$callbacks=[]),e.OPERATION.REPLACE,t)},t.is=function(e){return void 0!==e.set},t.prototype.add=function(t){var n,i;if(this.has(t))return!1;var o=this.$refId++;void 0!==t.$changes&&t.$changes.setParent(this,this.$changes.root,o);var r=null!==(i=null===(n=this.$changes.indexes[o])||void 0===n?void 0:n.op)&&void 0!==i?i:e.OPERATION.ADD;return this.$changes.indexes[o]=o,this.$indexes.set(o,o),this.$items.set(o,t),this.$changes.change(o,r),o},t.prototype.entries=function(){return this.$items.entries()},t.prototype.delete=function(e){for(var t,n,i=this.$items.entries();(n=i.next())&&!n.done;)if(e===n.value[1]){t=n.value[0];break}return void 0!==t&&(this.$changes.delete(t),this.$indexes.delete(t),this.$items.delete(t))},t.prototype.clear=function(t){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&l.call(this,t),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},t.prototype.has=function(e){for(var t,n=this.$items.values(),i=!1;(t=n.next())&&!t.done;)if(e===t.value){i=!0;break}return i},t.prototype.forEach=function(e){var t=this;this.$items.forEach((function(n,i,o){return e(n,i,t)}))},t.prototype.values=function(){return this.$items.values()},Object.defineProperty(t.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),t.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},t.prototype.getIndex=function(e){return this.$indexes.get(e)},t.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},t.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},t.prototype.toArray=function(){return Array.from(this.$items.values())},t.prototype.toJSON=function(){var e=[];return this.forEach((function(t,n){e.push("function"==typeof t.toJSON?t.toJSON():t)})),e},t.prototype.clone=function(e){var n;return e?n=Object.assign(new t,this):(n=new t,this.forEach((function(e){e.$changes?n.add(e.clone()):n.add(e)}))),n},t}(),Se=function(){function e(){this.refIds=new WeakSet,this.containerIndexes=new WeakMap}return e.prototype.addRefId=function(e){this.refIds.has(e)||(this.refIds.add(e),this.containerIndexes.set(e,new Set))},e.get=function(t){return void 0===t.$filterState&&(t.$filterState=new e),t.$filterState},e}(),be=function(){function e(){this.refs=new Map,this.refCounts={},this.deletedRefs=new Set,this.nextUniqueId=0}return e.prototype.getNextUniqueId=function(){return this.nextUniqueId++},e.prototype.addRef=function(e,t,n){void 0===n&&(n=!0),this.refs.set(e,t),n&&(this.refCounts[e]=(this.refCounts[e]||0)+1)},e.prototype.removeRef=function(e){var t=this.refCounts[e];void 0!==t?0!==t?(this.refCounts[e]=t-1,this.deletedRefs.add(e)):console.warn("trying to remove reference ".concat(e," with 0 refCount")):console.warn("trying to remove reference ".concat(e," that doesn't exist"))},e.prototype.clearRefs=function(){this.refs.clear(),this.deletedRefs.clear(),this.refCounts={}},e.prototype.garbageCollectDeletedRefs=function(){var e=this;this.deletedRefs.forEach((function(t){if(!(e.refCounts[t]>0)){var n=e.refs.get(t);if(n instanceof Ce)for(var i in n._definition.schema)"string"!=typeof n._definition.schema[i]&&n[i]&&n[i].$changes&&e.removeRef(n[i].$changes.refId);else{var o=n.$changes.parent._definition,r=o.schema[o.fieldsByIndex[n.$changes.parentIndex]];"function"==typeof Object.values(r)[0]&&Array.from(n.values()).forEach((function(t){return e.removeRef(t.$changes.refId)}))}e.refs.delete(t),delete e.refCounts[t]}})),this.deletedRefs.clear()},e}(),Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(Error);function we(e,t,n,i){var o,r=!1;switch(t){case"number":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":case"int64":case"uint64":case"float32":case"float64":o="number",isNaN(e)&&console.log('trying to encode "NaN" in '.concat(n.constructor.name,"#").concat(i));break;case"string":o="string",r=!0;break;case"boolean":return}if(typeof e!==o&&(!r||r&&null!==e)){var a="'".concat(JSON.stringify(e),"'").concat(e&&e.constructor&&" (".concat(e.constructor.name,")")||"");throw new Ae("a '".concat(o,"' was expected, but ").concat(a," was provided in ").concat(n.constructor.name,"#").concat(i))}}function Pe(e,t,n,i){if(!(e instanceof t))throw new Ae("a '".concat(t.name,"' was expected, but '").concat(e.constructor.name,"' was provided in ").concat(n.constructor.name,"#").concat(i))}function Be(e,t,n,i,o){we(n,e,i,o);var r=Q[e];if(!r)throw new Ae("a '".concat(e,"' was expected, but ").concat(n," was provided in ").concat(i.constructor.name,"#").concat(o));r(t,n)}function Re(e,t,n){return _e[e](t,n)}var Ce=function(){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Object.defineProperties(this,{$changes:{value:new c(this,void 0,new be),enumerable:!1,writable:!0},$callbacks:{value:void 0,enumerable:!1,writable:!0}});var n=this._definition.descriptors;n&&Object.defineProperties(this,n),e[0]&&this.assign(e[0])}return t.onError=function(e){console.error(e)},t.is=function(e){return e._definition&&void 0!==e._definition.schema},t.prototype.onChange=function(t){return u(this.$callbacks||(this.$callbacks={}),e.OPERATION.REPLACE,t)},t.prototype.onRemove=function(t){return u(this.$callbacks||(this.$callbacks={}),e.OPERATION.DELETE,t)},t.prototype.assign=function(e){return Object.assign(this,e),this},Object.defineProperty(t.prototype,"_definition",{get:function(){return this.constructor._definition},enumerable:!1,configurable:!0}),t.prototype.setDirty=function(e,t){this.$changes.change(e,t)},t.prototype.listen=function(e,t,n){var i=this;return void 0===n&&(n=!0),this.$callbacks||(this.$callbacks={}),this.$callbacks[e]||(this.$callbacks[e]=[]),this.$callbacks[e].push(t),n&&void 0!==this[e]&&t(this[e],void 0),function(){return f(i.$callbacks[e],i.$callbacks[e].indexOf(t))}},t.prototype.decode=function(n,i,o){void 0===i&&(i={offset:0}),void 0===o&&(o=this);var r=[],s=this.$changes.root,c=n.length,u=0;for(s.refs.set(u,this);i.offset<c;){var l=n[i.offset++];if(l!=a){var f=o.$changes,d=void 0!==o._definition,h=d?l>>6<<6:l;if(h!==e.OPERATION.CLEAR){var m=d?l%(h||255):me(n,i),g=d?o._definition.fieldsByIndex[m]:"",E=f.getType(m),T=void 0,v=void 0,S=void 0;if(d?v=o["_".concat(g)]:(v=o.getByIndex(m),(h&e.OPERATION.ADD)===e.OPERATION.ADD?(S=o instanceof y?he(n,i):m,o.setIndex(m,S)):S=o.getIndex(m)),(h&e.OPERATION.DELETE)===e.OPERATION.DELETE&&(h!==e.OPERATION.DELETE_AND_ADD&&o.deleteByIndex(m),v&&v.$changes&&s.removeRef(v.$changes.refId),T=null),void 0!==g){if(h===e.OPERATION.DELETE);else if(t.is(E)){var b=me(n,i);if(T=s.refs.get(b),h!==e.OPERATION.REPLACE){var A=this.getSchemaType(n,i,E);T||((T=this.createTypeInstance(A)).$changes.refId=b,v&&(T.$callbacks=v.$callbacks,v.$changes.refId&&b!==v.$changes.refId&&s.removeRef(v.$changes.refId))),s.addRef(b,T,T!==v)}}else if("string"==typeof E)T=Re(E,n,i);else{var w=_(Object.keys(E)[0]),P=me(n,i),B=s.refs.has(P)?v||s.refs.get(P):new w.constructor;if((T=B.clone(!0)).$changes.refId=P,v&&(T.$callbacks=v.$callbacks,v.$changes.refId&&P!==v.$changes.refId)){s.removeRef(v.$changes.refId);for(var R=v.entries(),C=void 0;(C=R.next())&&!C.done;){var M=C.value,I=M[0],N=M[1];r.push({refId:P,op:e.OPERATION.DELETE,field:I,value:void 0,previousValue:N})}}s.addRef(P,T,B!==v)}if(null!=T)if(T.$changes&&T.$changes.setParent(f.ref,f.root,m),o instanceof t)o[g]=T;else if(o instanceof y)I=S,o.$items.set(I,T),o.$changes.allChanges.add(m);else if(o instanceof p)o.setAt(m,T);else if(o instanceof Te){var O=o.add(T);o.setIndex(m,O)}else o instanceof ve&&!1!==(O=o.add(T))&&o.setIndex(m,O);v!==T&&r.push({refId:u,op:h,field:g,dynamicIndex:S,value:T,previousValue:v})}else{console.warn("@colyseus/schema: definition mismatch");for(var k={offset:i.offset};i.offset<c&&(!Ee(n,i)||(k.offset=i.offset+1,!s.refs.has(me(n,k))));)i.offset++}}else o.clear(r)}else{u=me(n,i);var x=s.refs.get(u);if(!x)throw new Error('"refId" not found: '.concat(u));o=x}}return this._triggerChanges(r),s.garbageCollectDeletedRefs(),r},t.prototype.encode=function(n,i,o){void 0===n&&(n=!1),void 0===i&&(i=[]),void 0===o&&(o=!1);for(var r=this.$changes,s=new WeakSet,c=[r],u=1,l=0;l<u;l++){var f=c[l],d=f.ref,h=d instanceof t;f.ensureRefId(),s.add(f),f!==r&&(f.changed||n)&&(N(i,a),Y(i,f.refId));for(var p=n?Array.from(f.allChanges):Array.from(f.changes.values()),m=0,g=p.length;m<g;m++){var E=n?{op:e.OPERATION.ADD,index:p[m]}:p[m],T=E.index,v=h?d._definition.fieldsByIndex&&d._definition.fieldsByIndex[T]:T,S=i.length;if(E.op!==e.OPERATION.TOUCH)if(h)N(i,T|E.op);else{if(N(i,E.op),E.op===e.OPERATION.CLEAR)continue;Y(i,T)}if(h||(E.op&e.OPERATION.ADD)!=e.OPERATION.ADD||d instanceof y&&q(i,f.ref.$indexes.get(T)),E.op!==e.OPERATION.DELETE){var b=f.getType(T),A=f.getValue(T);if(A&&A.$changes&&!s.has(A.$changes)&&(c.push(A.$changes),A.$changes.ensureRefId(),u++),E.op!==e.OPERATION.TOUCH){if(t.is(b))Pe(A,b,d,v),Y(i,A.$changes.refId),(E.op&e.OPERATION.ADD)===e.OPERATION.ADD&&this.tryEncodeTypeId(i,b,A.constructor);else if("string"==typeof b)Be(b,i,A,d,v);else{var w=_(Object.keys(b)[0]);Pe(d["_".concat(v)],w.constructor,d,v),Y(i,A.$changes.refId)}o&&f.cache(T,i.slice(S))}}}n||o||f.discard()}return i},t.prototype.encodeAll=function(e){return this.encode(!0,[],e)},t.prototype.applyFilters=function(n,i){var o,r;void 0===i&&(i=!1);for(var s=this,c=new Set,u=Se.get(n),l=[this.$changes],f=1,d=[],h=function(h){var p=l[h];if(c.has(p.refId))return"continue";var m=p.ref,g=m instanceof t;N(d,a),Y(d,p.refId);var E=u.refIds.has(p),_=i||!E;u.addRefId(p);var T=u.containerIndexes.get(p),v=_?Array.from(p.allChanges):Array.from(p.changes.values());!i&&g&&m._definition.indexesWithFilters&&m._definition.indexesWithFilters.forEach((function(t){!T.has(t)&&p.allChanges.has(t)&&(_?v.push(t):v.push({op:e.OPERATION.ADD,index:t}))}));for(var S=0,b=v.length;S<b;S++){var A=_?{op:e.OPERATION.ADD,index:v[S]}:v[S];if(A.op!==e.OPERATION.CLEAR){var w=A.index;if(A.op!==e.OPERATION.DELETE){var P=p.getValue(w),B=p.getType(w);if(g){if((R=m._definition.filters&&m._definition.filters[w])&&!R.call(m,n,P,s)){P&&P.$changes&&c.add(P.$changes.refId);continue}}else{var R,C=p.parent;if((R=p.getChildrenFilter())&&!R.call(C,n,m.$indexes.get(w),P,s)){P&&P.$changes&&c.add(P.$changes.refId);continue}}if(P.$changes&&(l.push(P.$changes),f++),A.op!==e.OPERATION.TOUCH)if(A.op===e.OPERATION.ADD||g)d.push.apply(d,null!==(o=p.caches[w])&&void 0!==o?o:[]),T.add(w);else if(T.has(w))d.push.apply(d,null!==(r=p.caches[w])&&void 0!==r?r:[]);else{if(T.add(w),N(d,e.OPERATION.ADD),Y(d,w),m instanceof y){var M=p.ref.$indexes.get(w);q(d,M)}P.$changes?Y(d,P.$changes.refId):Q[B](d,P)}else P.$changes&&!g&&(N(d,e.OPERATION.ADD),Y(d,w),m instanceof y&&(M=p.ref.$indexes.get(w),q(d,M)),Y(d,P.$changes.refId))}else g?N(d,A.op|w):(N(d,A.op),Y(d,w))}else N(d,A.op)}},p=0;p<f;p++)h(p);return d},t.prototype.clone=function(){var e,t=new this.constructor,n=this._definition.schema;for(var i in n)"object"==typeof this[i]&&"function"==typeof(null===(e=this[i])||void 0===e?void 0:e.clone)?t[i]=this[i].clone():t[i]=this[i];return t},t.prototype.toJSON=function(){var e=this._definition.schema,t=this._definition.deprecated,n={};for(var i in e)t[i]||null===this[i]||void 0===this[i]||(n[i]="function"==typeof this[i].toJSON?this[i].toJSON():this["_".concat(i)]);return n},t.prototype.discardAllChanges=function(){this.$changes.discardAll()},t.prototype.getByIndex=function(e){return this[this._definition.fieldsByIndex[e]]},t.prototype.deleteByIndex=function(e){this[this._definition.fieldsByIndex[e]]=void 0},t.prototype.tryEncodeTypeId=function(e,t,n){t._typeid!==n._typeid&&(N(e,s),Y(e,n._typeid))},t.prototype.getSchemaType=function(e,t,n){var i;return e[t.offset]===s&&(t.offset++,i=this.constructor._context.get(me(e,t))),i||n},t.prototype.createTypeInstance=function(e){var t=new e;return t.$changes.root=this.$changes.root,t},t.prototype._triggerChanges=function(n){for(var i,o,r,a,s,c,u,l,f,d=new Set,h=this.$changes.root.refs,p=function(p){var m=n[p],y=m.refId,g=h.get(y),E=g.$callbacks;if((m.op&e.OPERATION.DELETE)===e.OPERATION.DELETE&&m.previousValue instanceof t&&(null===(o=null===(i=m.previousValue.$callbacks)||void 0===i?void 0:i[e.OPERATION.DELETE])||void 0===o||o.forEach((function(e){return e()}))),!E)return"continue";if(g instanceof t){if(!d.has(y))try{null===(r=null==E?void 0:E[e.OPERATION.REPLACE])||void 0===r||r.forEach((function(e){return e()}))}catch(e){t.onError(e)}try{E.hasOwnProperty(m.field)&&(null===(a=E[m.field])||void 0===a||a.forEach((function(e){return e(m.value,m.previousValue)})))}catch(e){t.onError(e)}}else m.op===e.OPERATION.ADD&&void 0===m.previousValue?null===(s=E[e.OPERATION.ADD])||void 0===s||s.forEach((function(e){var t;return e(m.value,null!==(t=m.dynamicIndex)&&void 0!==t?t:m.field)})):m.op===e.OPERATION.DELETE?void 0!==m.previousValue&&(null===(c=E[e.OPERATION.DELETE])||void 0===c||c.forEach((function(e){var t;return e(m.previousValue,null!==(t=m.dynamicIndex)&&void 0!==t?t:m.field)}))):m.op===e.OPERATION.DELETE_AND_ADD&&(void 0!==m.previousValue&&(null===(u=E[e.OPERATION.DELETE])||void 0===u||u.forEach((function(e){var t;return e(m.previousValue,null!==(t=m.dynamicIndex)&&void 0!==t?t:m.field)}))),null===(l=E[e.OPERATION.ADD])||void 0===l||l.forEach((function(e){var t;return e(m.value,null!==(t=m.dynamicIndex)&&void 0!==t?t:m.field)}))),m.value!==m.previousValue&&(null===(f=E[e.OPERATION.REPLACE])||void 0===f||f.forEach((function(e){var t;return e(m.value,null!==(t=m.dynamicIndex)&&void 0!==t?t:m.field)})));d.add(y)},m=0;m<n.length;m++)p(m)},t._definition=T.create(),t}();function Me(e){for(var t=[e.$changes],n=1,i={},o=i,r=function(e){var n=t[e];n.changes.forEach((function(e){var t=n.ref,i=e.index,r=t._definition?t._definition.fieldsByIndex[i]:t.$indexes.get(i);o[r]=n.getValue(i)}))},a=0;a<n;a++)r(a);return i}var Ie={context:new S},Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),i([A("string",Ie)],t.prototype,"name",void 0),i([A("string",Ie)],t.prototype,"type",void 0),i([A("number",Ie)],t.prototype,"referencedType",void 0),t}(Ce),Oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fields=new p,t}return n(t,e),i([A("number",Ie)],t.prototype,"id",void 0),i([A([Ne],Ie)],t.prototype,"fields",void 0),t}(Ce),ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.types=new p,t}return n(t,e),t.encode=function(e){var n,i=e.constructor,o=new t;o.rootType=i._typeid;var r=function(e,t){for(var n in t){var i=new Ne;i.name=n;var r=void 0;if("string"==typeof t[n])r=t[n];else{var a=t[n],s=void 0;Ce.is(a)?(r="ref",s=t[n]):"string"==typeof a[r=Object.keys(a)[0]]?r+=":"+a[r]:s=a[r],i.referencedType=s?s._typeid:-1}i.type=r,e.fields.push(i)}o.types.push(e)},a=null===(n=i._context)||void 0===n?void 0:n.types;for(var s in a){var c=new Oe;c.id=Number(s),r(c,a[s]._definition.schema)}return o.encodeAll()},t.decode=function(e,i){var o=new S,r=new t;r.decode(e,i);var a=r.types.reduce((function(e,t){var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(Ce),r=t.id;return e[r]=i,o.add(i,r),e}),{});r.types.forEach((function(e){var t=a[e.id];e.fields.forEach((function(e){var n;if(void 0!==e.referencedType){var i=e.type,r=a[e.referencedType];if(!r){var s=e.type.split(":");i=s[0],r=s[1]}"ref"===i?A(r,{context:o})(t.prototype,e.name):A(((n={})[i]=r,n),{context:o})(t.prototype,e.name)}else A(e.type,{context:o})(t.prototype,e.name)}))}));var s=a[r.rootType],c=new s;for(var u in s._definition.schema){var l=s._definition.schema[u];"string"!=typeof l&&(c[u]="function"==typeof l?new l:new(_(Object.keys(l)[0]).constructor))}return c},i([A([Oe],Ie)],t.prototype,"types",void 0),i([A("number",Ie)],t.prototype,"rootType",void 0),t}(Ce);E("map",{constructor:y}),E("array",{constructor:p}),E("set",{constructor:ve}),E("collection",{constructor:Te}),e.ArraySchema=p,e.CollectionSchema=Te,e.Context=S,e.MapSchema=y,e.Reflection=ke,e.ReflectionField=Ne,e.ReflectionType=Oe,e.Schema=Ce,e.SchemaDefinition=T,e.SetSchema=ve,e.decode=_e,e.defineTypes=R,e.deprecated=B,e.dumpChanges=Me,e.encode=Q,e.filter=w,e.filterChildren=P,e.hasFilter=v,e.registerType=E,e.type=A}(umd.exports);var __createBinding$1=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),__setModuleDefault$1=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$1=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&__createBinding$1(t,e,n);return __setModuleDefault$1(t,e),t};Object.defineProperty(Room$1,"__esModule",{value:!0}),Room$1.Room=void 0;const msgpack=__importStar$1(msgpack$1),Connection_1=Connection$1,Protocol_1=Protocol,Serializer_1=Serializer,nanoevents_1$1=nanoevents,signal_1=signal,schema_1$1=umd.exports,ServerError_1$2=ServerError;class Room{constructor(e,t){this.onStateChange=(0,signal_1.createSignal)(),this.onError=(0,signal_1.createSignal)(),this.onLeave=(0,signal_1.createSignal)(),this.onJoin=(0,signal_1.createSignal)(),this.hasJoined=!1,this.onMessageHandlers=(0,nanoevents_1$1.createNanoEvents)(),this.roomId=null,this.name=e,t&&(this.serializer=new((0,Serializer_1.getSerializer)("schema")),this.rootSchema=t,this.serializer.state=new t),this.onError(((e,t)=>{var n;return null===(n=console.warn)||void 0===n?void 0:n.call(console,`colyseus.js - onError => (${e}) ${t}`)})),this.onLeave((()=>this.removeAllListeners()))}get id(){return this.roomId}connect(e,t,n=this){const i=new Connection_1.Connection;n.connection=i,i.events.onmessage=Room.prototype.onMessageCallback.bind(n),i.events.onclose=function(e){var i;if(!n.hasJoined)return null===(i=console.warn)||void 0===i||i.call(console,`Room connection was closed unexpectedly (${e.code}): ${e.reason}`),void n.onError.invoke(e.code,e.reason);e.code===ServerError_1$2.CloseCode.DEVMODE_RESTART&&t?t():(n.onLeave.invoke(e.code,e.reason),n.destroy())},i.events.onerror=function(e){var t;null===(t=console.warn)||void 0===t||t.call(console,`Room, onError (${e.code}): ${e.reason}`),n.onError.invoke(e.code,e.reason)},i.connect(e)}leave(e=!0){return new Promise((t=>{this.onLeave((e=>t(e))),this.connection?e?this.connection.send([Protocol_1.Protocol.LEAVE_ROOM]):this.connection.close():this.onLeave.invoke(ServerError_1$2.CloseCode.CONSENTED)}))}onMessage(e,t){return this.onMessageHandlers.on(this.getMessageHandlerKey(e),t)}send(e,t){const n=[Protocol_1.Protocol.ROOM_DATA];let i;if("string"==typeof e?schema_1$1.encode.string(n,e):schema_1$1.encode.number(n,e),void 0!==t){const e=msgpack.encode(t);i=new Uint8Array(n.length+e.byteLength),i.set(new Uint8Array(n),0),i.set(new Uint8Array(e),n.length)}else i=new Uint8Array(n);this.connection.send(i.buffer)}sendBytes(e,t){const n=[Protocol_1.Protocol.ROOM_DATA_BYTES];let i;"string"==typeof e?schema_1$1.encode.string(n,e):schema_1$1.encode.number(n,e),i=new Uint8Array(n.length+(t.byteLength||t.length)),i.set(new Uint8Array(n),0),i.set(new Uint8Array(t),n.length),this.connection.send(i.buffer)}get state(){return this.serializer.getState()}removeAllListeners(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={}}onMessageCallback(e){const t=Array.from(new Uint8Array(e.data)),n=t[0];if(n===Protocol_1.Protocol.JOIN_ROOM){let e=1;const n=(0,Protocol_1.utf8Read)(t,e);if(e+=(0,Protocol_1.utf8Length)(n),this.serializerId=(0,Protocol_1.utf8Read)(t,e),e+=(0,Protocol_1.utf8Length)(this.serializerId),!this.serializer){const e=(0,Serializer_1.getSerializer)(this.serializerId);this.serializer=new e}t.length>e&&this.serializer.handshake&&this.serializer.handshake(t,{offset:e}),this.reconnectionToken=`${this.roomId}:${n}`,this.hasJoined=!0,this.onJoin.invoke(),this.connection.send([Protocol_1.Protocol.JOIN_ROOM])}else if(n===Protocol_1.Protocol.ERROR){const e={offset:1},n=schema_1$1.decode.number(t,e),i=schema_1$1.decode.string(t,e);this.onError.invoke(n,i)}else if(n===Protocol_1.Protocol.LEAVE_ROOM)this.leave();else if(n===Protocol_1.Protocol.ROOM_DATA_SCHEMA){const e={offset:1},n=this.serializer.getState().constructor._context.get(schema_1$1.decode.number(t,e)),i=new n;i.decode(t,e),this.dispatchMessage(n,i)}else if(n===Protocol_1.Protocol.ROOM_STATE)t.shift(),this.setState(t);else if(n===Protocol_1.Protocol.ROOM_STATE_PATCH)t.shift(),this.patch(t);else if(n===Protocol_1.Protocol.ROOM_DATA){const n={offset:1},i=schema_1$1.decode.stringCheck(t,n)?schema_1$1.decode.string(t,n):schema_1$1.decode.number(t,n),o=t.length>n.offset?msgpack.decode(e.data,n.offset):void 0;this.dispatchMessage(i,o)}else if(n===Protocol_1.Protocol.ROOM_DATA_BYTES){const e={offset:1},n=schema_1$1.decode.stringCheck(t,e)?schema_1$1.decode.string(t,e):schema_1$1.decode.number(t,e);this.dispatchMessage(n,new Uint8Array(t.slice(e.offset)))}}setState(e){this.serializer.setState(e),this.onStateChange.invoke(this.serializer.getState())}patch(e){this.serializer.patch(e),this.onStateChange.invoke(this.serializer.getState())}dispatchMessage(e,t){var n;const i=this.getMessageHandlerKey(e);this.onMessageHandlers.events[i]?this.onMessageHandlers.emit(i,t):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",e,t):null===(n=console.warn)||void 0===n||n.call(console,`colyseus.js: onMessage() not registered for type '${e}'.`)}destroy(){this.serializer&&this.serializer.teardown()}getMessageHandlerKey(e){switch(typeof e){case"function":return`$${e._typeid}`;case"string":return e;case"number":return`i${e}`;default:throw new Error("invalid message type.")}}}Room$1.Room=Room;var HTTP$1={};function apply(e,t){t.headers=e.headers||{},t.statusMessage=e.statusText,t.statusCode=e.status,t.data=e.response}function send(e,t,n){return new Promise((function(i,o){n=n||{};var r,a,s,c=new XMLHttpRequest,u=n.body,l=n.headers||{};for(r in n.timeout&&(c.timeout=n.timeout),c.ontimeout=c.onerror=function(e){e.timeout="timeout"==e.type,o(e)},c.open(e,t.href||t),c.onload=function(){for(s=c.getAllResponseHeaders().trim().split(/[\r\n]+/),apply(c,c);a=s.shift();)a=a.split(": "),c.headers[a.shift().toLowerCase()]=a.join(": ");if((a=c.headers["content-type"])&&~a.indexOf("application/json"))try{c.data=JSON.parse(c.data,n.reviver)}catch(e){return apply(c,e),o(e)}(c.status>=400?o:i)(c)},typeof FormData<"u"&&u instanceof FormData||u&&"object"==typeof u&&(l["content-type"]="application/json",u=JSON.stringify(u)),c.withCredentials=!!n.withCredentials,l)c.setRequestHeader(r,l[r]);c.send(u)}))}var get=send.bind(send,"GET"),post=send.bind(send,"POST"),patch=send.bind(send,"PATCH"),del=send.bind(send,"DELETE"),put=send.bind(send,"PUT"),xhr=Object.freeze({__proto__:null,send:send,get:get,post:post,patch:patch,del:del,put:put}),require$$1=getDefaultExportFromNamespaceIfNotNamed(xhr),__createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),__setModuleDefault=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&__createBinding(t,e,n);return __setModuleDefault(t,e),t};Object.defineProperty(HTTP$1,"__esModule",{value:!0}),HTTP$1.HTTP=void 0;const ServerError_1$1=ServerError,httpie=__importStar(require$$1);class HTTP{constructor(e){this.client=e}get(e,t={}){return this.request("get",e,t)}post(e,t={}){return this.request("post",e,t)}del(e,t={}){return this.request("del",e,t)}put(e,t={}){return this.request("put",e,t)}request(e,t,n={}){return httpie[e](this.client.getHttpEndpoint(t),this.getOptions(n)).catch((e=>{var t;const n=e.statusCode,i=(null===(t=e.data)||void 0===t?void 0:t.error)||e.statusMessage||e.message;if(!n&&!i)throw e;throw new ServerError_1$1.ServerError(n,i)}))}getOptions(e){return this.authToken&&(e.headers||(e.headers={}),e.headers.Authorization=`Bearer ${this.authToken}`),"undefined"!=typeof cc&&cc.sys&&cc.sys.isNative||(e.withCredentials=!0),e}}HTTP$1.HTTP=HTTP;var Auth$1={},Storage={};let storage;function getStorage(){if(!storage)try{storage="undefined"!=typeof cc&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:window.localStorage}catch(e){}return storage||(storage={cache:{},setItem:function(e,t){this.cache[e]=t},getItem:function(e){this.cache[e]},removeItem:function(e){delete this.cache[e]}}),storage}function setItem(e,t){getStorage().setItem(e,t)}function removeItem(e){getStorage().removeItem(e)}function getItem(e,t){const n=getStorage().getItem(e);"undefined"!=typeof Promise&&n instanceof Promise?n.then((e=>t(e))):t(n)}Object.defineProperty(Storage,"__esModule",{value:!0}),Storage.getItem=Storage.removeItem=Storage.setItem=void 0,Storage.setItem=setItem,Storage.removeItem=removeItem,Storage.getItem=getItem;var __awaiter$1=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{c(i.next(e))}catch(e){r(e)}}function s(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},__classPrivateFieldGet$1=commonjsGlobal&&commonjsGlobal.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},__classPrivateFieldSet=commonjsGlobal&&commonjsGlobal.__classPrivateFieldSet||function(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n},_Auth__initialized,_Auth__initializationPromise,_Auth__signInWindow,_Auth__events;Object.defineProperty(Auth$1,"__esModule",{value:!0}),Auth$1.Auth=void 0;const Storage_1=Storage,nanoevents_1=nanoevents;class Auth{constructor(e){this.http=e,this.settings={path:"/auth",key:"colyseus-auth-token"},_Auth__initialized.set(this,!1),_Auth__initializationPromise.set(this,void 0),_Auth__signInWindow.set(this,void 0),_Auth__events.set(this,(0,nanoevents_1.createNanoEvents)()),(0,Storage_1.getItem)(this.settings.key,(e=>this.token=e))}set token(e){this.http.authToken=e}get token(){return this.http.authToken}onChange(e){const t=__classPrivateFieldGet$1(this,_Auth__events,"f").on("change",e);return __classPrivateFieldGet$1(this,_Auth__initialized,"f")||__classPrivateFieldSet(this,_Auth__initializationPromise,new Promise(((e,t)=>{this.getUserData().then((e=>{this.emitChange(Object.assign(Object.assign({},e),{token:this.token}))})).catch((e=>{this.emitChange({user:null,token:void 0})})).finally((()=>{e()}))})),"f"),__classPrivateFieldSet(this,_Auth__initialized,!0,"f"),t}getUserData(){return __awaiter$1(this,void 0,void 0,(function*(){if(this.token)return(yield this.http.get(`${this.settings.path}/userdata`)).data;throw new Error("missing auth.token")}))}registerWithEmailAndPassword(e,t,n){return __awaiter$1(this,void 0,void 0,(function*(){const i=(yield this.http.post(`${this.settings.path}/register`,{body:{email:e,password:t,options:n}})).data;return this.emitChange(i),i}))}signInWithEmailAndPassword(e,t){return __awaiter$1(this,void 0,void 0,(function*(){const n=(yield this.http.post(`${this.settings.path}/login`,{body:{email:e,password:t}})).data;return this.emitChange(n),n}))}signInAnonymously(e){return __awaiter$1(this,void 0,void 0,(function*(){const t=(yield this.http.post(`${this.settings.path}/anonymous`,{body:{options:e}})).data;return this.emitChange(t),t}))}sendPasswordResetEmail(e){return __awaiter$1(this,void 0,void 0,(function*(){return(yield this.http.post(`${this.settings.path}/forgot-password`,{body:{email:e}})).data}))}signInWithProvider(e,t={}){return __awaiter$1(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{const o=t.width||480,r=t.height||768,a=this.token?`?token=${this.token}`:"",s=`Login with ${e[0].toUpperCase()+e.substring(1)}`,c=this.http.client.getHttpEndpoint(`${t.prefix||`${this.settings.path}/provider`}/${e}${a}`),u=screen.width/2-o/2,l=screen.height/2-r/2;__classPrivateFieldSet(this,_Auth__signInWindow,window.open(c,s,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+o+", height="+r+", top="+l+", left="+u),"f");const f=e=>{void 0===e.data.user&&void 0===e.data.token||(clearInterval(d),__classPrivateFieldGet$1(this,_Auth__signInWindow,"f").close(),__classPrivateFieldSet(this,_Auth__signInWindow,void 0,"f"),window.removeEventListener("message",f),void 0!==e.data.error?i(e.data.error):(n(e.data),this.emitChange(e.data)))},d=setInterval((()=>{__classPrivateFieldGet$1(this,_Auth__signInWindow,"f")&&!__classPrivateFieldGet$1(this,_Auth__signInWindow,"f").closed||(__classPrivateFieldSet(this,_Auth__signInWindow,void 0,"f"),i("cancelled"),window.removeEventListener("message",f))}),200);window.addEventListener("message",f)}))}))}signOut(){return __awaiter$1(this,void 0,void 0,(function*(){this.emitChange({user:null,token:null})}))}emitChange(e){void 0!==e.token&&(this.token=e.token,null===e.token?(0,Storage_1.removeItem)(this.settings.key):(0,Storage_1.setItem)(this.settings.key,e.token)),__classPrivateFieldGet$1(this,_Auth__events,"f").emit("change",e)}}Auth$1.Auth=Auth,_Auth__initialized=new WeakMap,_Auth__initializationPromise=new WeakMap,_Auth__signInWindow=new WeakMap,_Auth__events=new WeakMap;var discord={};function discordURLBuilder(e){var t;const n=(null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.hostname)||"localhost",i=e.hostname.split("."),o=!e.hostname.includes("trycloudflare.com")&&!e.hostname.includes("discordsays.com")&&i.length>2?`/${i[0]}`:"";return e.pathname.startsWith("/.proxy")?`${e.protocol}//${n}${o}${e.pathname}${e.search}`:`${e.protocol}//${n}/.proxy/colyseus${o}${e.pathname}${e.search}`}Object.defineProperty(discord,"__esModule",{value:!0}),discord.discordURLBuilder=void 0,discord.discordURLBuilder=discordURLBuilder;var __awaiter=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{c(i.next(e))}catch(e){r(e)}}function s(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},_a;Object.defineProperty(Client$1,"__esModule",{value:!0}),Client$1.Client=Client$1.MatchMakeError=void 0;const ServerError_1=ServerError,Room_1=Room$1,HTTP_1=HTTP$1,Auth_1=Auth$1,discord_1=discord;class MatchMakeError extends Error{constructor(e,t){super(e),this.code=t,Object.setPrototypeOf(this,MatchMakeError.prototype)}}Client$1.MatchMakeError=MatchMakeError;const DEFAULT_ENDPOINT="undefined"!=typeof window&&void 0!==(null===(_a=null===window||void 0===window?void 0:window.location)||void 0===_a?void 0:_a.hostname)?`${window.location.protocol.replace("http","ws")}//${window.location.hostname}${window.location.port&&`:${window.location.port}`}`:"ws://127.0.0.1:2567";class Client{constructor(e=DEFAULT_ENDPOINT,t){var n,i;if("string"==typeof e){const t=e.startsWith("/")?new URL(e,DEFAULT_ENDPOINT):new URL(e),n="https:"===t.protocol||"wss:"===t.protocol,i=Number(t.port||(n?443:80));this.settings={hostname:t.hostname,pathname:t.pathname,port:i,secure:n}}else void 0===e.port&&(e.port=e.secure?443:80),void 0===e.pathname&&(e.pathname=""),this.settings=e;this.settings.pathname.endsWith("/")&&(this.settings.pathname=this.settings.pathname.slice(0,-1)),this.http=new HTTP_1.HTTP(this),this.auth=new Auth_1.Auth(this.http),this.urlBuilder=t,!this.urlBuilder&&"undefined"!=typeof window&&(null===(i=null===(n=null===window||void 0===window?void 0:window.location)||void 0===n?void 0:n.hostname)||void 0===i?void 0:i.includes("discordsays.com"))&&(this.urlBuilder=discord_1.discordURLBuilder,console.log("Colyseus SDK: Discord Embedded SDK detected. Using custom URL builder."))}joinOrCreate(e,t={},n){return __awaiter(this,void 0,void 0,(function*(){return yield this.createMatchMakeRequest("joinOrCreate",e,t,n)}))}create(e,t={},n){return __awaiter(this,void 0,void 0,(function*(){return yield this.createMatchMakeRequest("create",e,t,n)}))}join(e,t={},n){return __awaiter(this,void 0,void 0,(function*(){return yield this.createMatchMakeRequest("join",e,t,n)}))}joinById(e,t={},n){return __awaiter(this,void 0,void 0,(function*(){return yield this.createMatchMakeRequest("joinById",e,t,n)}))}reconnect(e,t){return __awaiter(this,void 0,void 0,(function*(){if("string"==typeof e&&"string"==typeof t)throw new Error("DEPRECATED: .reconnect() now only accepts 'reconnectionToken' as argument.\nYou can get this token from previously connected `room.reconnectionToken`");const[n,i]=e.split(":");if(!n||!i)throw new Error("Invalid reconnection token format.\nThe format should be roomId:reconnectionToken");return yield this.createMatchMakeRequest("reconnect",n,{reconnectionToken:i},t)}))}getAvailableRooms(e=""){return __awaiter(this,void 0,void 0,(function*(){return(yield this.http.get(`matchmake/${e}`,{headers:{Accept:"application/json"}})).data}))}consumeSeatReservation(e,t,n){return __awaiter(this,void 0,void 0,(function*(){const i=this.createRoom(e.room.name,t);i.roomId=e.room.roomId,i.sessionId=e.sessionId;const o={sessionId:i.sessionId};e.reconnectionToken&&(o.reconnectionToken=e.reconnectionToken);const r=n||i;return i.connect(this.buildEndpoint(e.room,o),e.devMode&&(()=>__awaiter(this,void 0,void 0,(function*(){console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} Re-establishing connection with room id '${i.roomId}'...`);let n=0;const o=()=>__awaiter(this,void 0,void 0,(function*(){n++;try{yield this.consumeSeatReservation(e,t,r),console.info(`[Colyseus devMode]: ${String.fromCodePoint(9989)} Successfully re-established connection with room '${i.roomId}'`)}catch(e){n<8?(console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} retrying... (${n} out of 8)`),setTimeout(o,2e3)):console.info(`[Colyseus devMode]: ${String.fromCodePoint(10060)} Failed to reconnect. Is your server running? Please check server logs.`)}}));setTimeout(o,2e3)}))),r),new Promise(((e,t)=>{const n=(e,n)=>t(new ServerError_1.ServerError(e,n));r.onError.once(n),r.onJoin.once((()=>{r.onError.remove(n),e(r)}))}))}))}createMatchMakeRequest(e,t,n={},i,o){return __awaiter(this,void 0,void 0,(function*(){const r=(yield this.http.post(`matchmake/${e}/${t}`,{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)})).data;if(r.error)throw new MatchMakeError(r.error,r.code);return"reconnect"===e&&(r.reconnectionToken=n.reconnectionToken),yield this.consumeSeatReservation(r,i,o)}))}createRoom(e,t){return new Room_1.Room(e,t)}buildEndpoint(e,t={}){const n=[];for(const e in t)t.hasOwnProperty(e)&&n.push(`${e}=${t[e]}`);let i=this.settings.secure?"wss://":"ws://";e.publicAddress?i+=`${e.publicAddress}`:i+=`${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}`;const o=`${i}/${e.processId}/${e.roomId}?${n.join("&")}`;return this.urlBuilder?this.urlBuilder(new URL(o)):o}getHttpEndpoint(e=""){const t=e.startsWith("/")?e:`/${e}`,n=`${this.settings.secure?"https":"http"}://${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}${t}`;return this.urlBuilder?this.urlBuilder(new URL(n)):n}getEndpointPort(){return 80!==this.settings.port&&443!==this.settings.port?`:${this.settings.port}`:""}}Client$1.Client=Client;var SchemaSerializer$1={};Object.defineProperty(SchemaSerializer$1,"__esModule",{value:!0}),SchemaSerializer$1.SchemaSerializer=void 0;const schema_1=umd.exports;class SchemaSerializer{setState(e){return this.state.decode(e)}getState(){return this.state}patch(e){return this.state.decode(e)}teardown(){var e,t;null===(t=null===(e=this.state)||void 0===e?void 0:e.$changes)||void 0===t||t.root.clearRefs()}handshake(e,t){if(this.state){(new schema_1.Reflection).decode(e,t)}else this.state=schema_1.Reflection.decode(e,t)}}SchemaSerializer$1.SchemaSerializer=SchemaSerializer;var NoneSerializer$1={};Object.defineProperty(NoneSerializer$1,"__esModule",{value:!0}),NoneSerializer$1.NoneSerializer=void 0;class NoneSerializer{setState(e){}getState(){return null}patch(e){}teardown(){}handshake(e){}}function mitt(e){return{all:e=e||new Map,on:function(t,n){var i=e.get(t);i?i.push(n):e.set(t,[n])},off:function(t,n){var i=e.get(t);i&&(n?i.splice(i.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var i=e.get(t);i&&i.slice().map((function(e){e(n)})),(i=e.get("*"))&&i.slice().map((function(e){e(t,n)}))}}}NoneSerializer$1.NoneSerializer=NoneSerializer,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SchemaSerializer=e.registerSerializer=e.Auth=e.Room=e.ErrorCode=e.Protocol=e.Client=void 0;var t=Client$1;Object.defineProperty(e,"Client",{enumerable:!0,get:function(){return t.Client}});var n=Protocol;Object.defineProperty(e,"Protocol",{enumerable:!0,get:function(){return n.Protocol}}),Object.defineProperty(e,"ErrorCode",{enumerable:!0,get:function(){return n.ErrorCode}});var i=Room$1;Object.defineProperty(e,"Room",{enumerable:!0,get:function(){return i.Room}});var o=Auth$1;Object.defineProperty(e,"Auth",{enumerable:!0,get:function(){return o.Auth}});const r=SchemaSerializer$1;Object.defineProperty(e,"SchemaSerializer",{enumerable:!0,get:function(){return r.SchemaSerializer}});const a=NoneSerializer$1,s=Serializer;Object.defineProperty(e,"registerSerializer",{enumerable:!0,get:function(){return s.registerSerializer}}),(0,s.registerSerializer)("schema",r.SchemaSerializer),(0,s.registerSerializer)("none",a.NoneSerializer)}(lib);var indexMinimal={},minimal$1={},aspromise=asPromise;function asPromise(e,t){for(var n=new Array(arguments.length-1),i=0,o=2,r=!0;o<arguments.length;)n[i++]=arguments[o++];return new Promise((function(o,a){n[i]=function(e){if(r)if(r=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];o.apply(null,t)}};try{e.apply(t||null,n)}catch(e){r&&(r=!1,a(e))}}))}var base64$1={};!function(e){var t=base64$1;t.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var n=new Array(64),i=new Array(123),o=0;o<64;)i[n[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;t.encode=function(e,t,i){for(var o,r=null,a=[],s=0,c=0;t<i;){var u=e[t++];switch(c){case 0:a[s++]=n[u>>2],o=(3&u)<<4,c=1;break;case 1:a[s++]=n[o|u>>4],o=(15&u)<<2,c=2;break;case 2:a[s++]=n[o|u>>6],a[s++]=n[63&u],c=0}s>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=n[o],a[s++]=61,1===c&&(a[s++]=61)),r?(s&&r.push(String.fromCharCode.apply(String,a.slice(0,s))),r.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var r="invalid encoding";t.decode=function(e,t,n){for(var o,a=n,s=0,c=0;c<e.length;){var u=e.charCodeAt(c++);if(61===u&&s>1)break;if(void 0===(u=i[u]))throw Error(r);switch(s){case 0:o=u,s=1;break;case 1:t[n++]=o<<2|(48&u)>>4,o=u,s=2;break;case 2:t[n++]=(15&o)<<4|(60&u)>>2,o=u,s=3;break;case 3:t[n++]=(3&o)<<6|u,s=0}}if(1===s)throw Error(r);return n-a},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}();var eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},EventEmitter.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this},EventEmitter.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this};var float=factory(factory);function factory(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),i=128===n[3];function o(e,i,o){t[0]=e,i[o]=n[0],i[o+1]=n[1],i[o+2]=n[2],i[o+3]=n[3]}function r(e,i,o){t[0]=e,i[o]=n[3],i[o+1]=n[2],i[o+2]=n[1],i[o+3]=n[0]}function a(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],t[0]}function s(e,i){return n[3]=e[i],n[2]=e[i+1],n[1]=e[i+2],n[0]=e[i+3],t[0]}e.writeFloatLE=i?o:r,e.writeFloatBE=i?r:o,e.readFloatLE=i?a:s,e.readFloatBE=i?s:a}():function(){function t(e,t,n,i){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,n,i);else if(isNaN(t))e(2143289344,n,i);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,n,i);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,n,i);else{var r=Math.floor(Math.log(t)/Math.LN2);e((o<<31|r+127<<23|8388607&Math.round(t*Math.pow(2,-r)*8388608))>>>0,n,i)}}function n(e,t,n){var i=e(t,n),o=2*(i>>31)+1,r=i>>>23&255,a=8388607&i;return 255===r?a?NaN:o*(1/0):0===r?1401298464324817e-60*o*a:o*Math.pow(2,r-150)*(a+8388608)}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE),e.readFloatLE=n.bind(null,readUintLE),e.readFloatBE=n.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),i=128===n[7];function o(e,i,o){t[0]=e,i[o]=n[0],i[o+1]=n[1],i[o+2]=n[2],i[o+3]=n[3],i[o+4]=n[4],i[o+5]=n[5],i[o+6]=n[6],i[o+7]=n[7]}function r(e,i,o){t[0]=e,i[o]=n[7],i[o+1]=n[6],i[o+2]=n[5],i[o+3]=n[4],i[o+4]=n[3],i[o+5]=n[2],i[o+6]=n[1],i[o+7]=n[0]}function a(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],n[4]=e[i+4],n[5]=e[i+5],n[6]=e[i+6],n[7]=e[i+7],t[0]}function s(e,i){return n[7]=e[i],n[6]=e[i+1],n[5]=e[i+2],n[4]=e[i+3],n[3]=e[i+4],n[2]=e[i+5],n[1]=e[i+6],n[0]=e[i+7],t[0]}e.writeDoubleLE=i?o:r,e.writeDoubleBE=i?r:o,e.readDoubleLE=i?a:s,e.readDoubleBE=i?s:a}():function(){function t(e,t,n,i,o,r){var a=i<0?1:0;if(a&&(i=-i),0===i)e(0,o,r+t),e(1/i>0?0:2147483648,o,r+n);else if(isNaN(i))e(0,o,r+t),e(2146959360,o,r+n);else if(i>17976931348623157e292)e(0,o,r+t),e((a<<31|2146435072)>>>0,o,r+n);else{var s;if(i<22250738585072014e-324)e((s=i/5e-324)>>>0,o,r+t),e((a<<31|s/4294967296)>>>0,o,r+n);else{var c=Math.floor(Math.log(i)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=i*Math.pow(2,-c))>>>0,o,r+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,o,r+n)}}}function n(e,t,n,i,o){var r=e(i,o+t),a=e(i,o+n),s=2*(a>>31)+1,c=a>>>20&2047,u=4294967296*(1048575&a)+r;return 2047===c?u?NaN:s*(1/0):0===c?5e-324*s*u:s*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0),e.readDoubleLE=n.bind(null,readUintLE,0,4),e.readDoubleBE=n.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function writeUintBE(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8$2={};!function(e){var t=utf8$2;t.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)(n=e.charCodeAt(i))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},t.read=function(e,t,n){if(n-t<1)return"";for(var i,o=null,r=[],a=0;t<n;)(i=e[t++])<128?r[a++]=i:i>191&&i<224?r[a++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,r[a++]=55296+(i>>10),r[a++]=56320+(1023&i)):r[a++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,r)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,r.slice(0,a))),o.join("")):String.fromCharCode.apply(String,r.slice(0,a))},t.write=function(e,t,n){for(var i,o,r=n,a=0;a<e.length;++a)(i=e.charCodeAt(a))<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&56320==(64512&(o=e.charCodeAt(a+1)))?(i=65536+((1023&i)<<10)+(1023&o),++a,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128);return n-r}}();var pool_1=pool;function pool(e,t,n){var i=n||8192,o=i>>>1,r=null,a=i;return function(n){if(n<1||n>o)return e(n);a+n>i&&(r=e(i),a=0);var s=t.call(r,a,a+=n);return 7&a&&(a=1+(7|a)),s}}var longbits=LongBits$2,util$5=minimal$1;function LongBits$2(e,t){this.lo=e>>>0,this.hi=t>>>0}var zero=LongBits$2.zero=new LongBits$2(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits$2.zeroHash="\0\0\0\0\0\0\0\0";LongBits$2.fromNumber=function(e){if(0===e)return zero;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new LongBits$2(n,i)},LongBits$2.from=function(e){if("number"==typeof e)return LongBits$2.fromNumber(e);if(util$5.isString(e)){if(!util$5.Long)return LongBits$2.fromNumber(parseInt(e,10));e=util$5.Long.fromString(e)}return e.low||e.high?new LongBits$2(e.low>>>0,e.high>>>0):zero},LongBits$2.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},LongBits$2.prototype.toLong=function(e){return util$5.Long?new util$5.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var charCodeAt=String.prototype.charCodeAt;LongBits$2.fromHash=function(e){return e===zeroHash?zero:new LongBits$2((charCodeAt.call(e,0)|charCodeAt.call(e,1)<<8|charCodeAt.call(e,2)<<16|charCodeAt.call(e,3)<<24)>>>0,(charCodeAt.call(e,4)|charCodeAt.call(e,5)<<8|charCodeAt.call(e,6)<<16|charCodeAt.call(e,7)<<24)>>>0)},LongBits$2.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits$2.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits$2.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits$2.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10},function(e){var t=minimal$1;function n(e,t,n){for(var i=Object.keys(t),o=0;o<i.length;++o)void 0!==e[i[o]]&&n||(e[i[o]]=t[i[o]]);return e}function i(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),i&&n(this,i)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}t.asPromise=aspromise,t.base64=base64$1,t.EventEmitter=eventemitter,t.float=float,t.inquire=inquire_1,t.utf8=utf8$2,t.pool=pool_1,t.LongBits=longbits,t.isNode=Boolean(void 0!==commonjsGlobal&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),t.global=t.isNode&&commonjsGlobal||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||commonjsGlobal,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"==typeof e},t.isset=t.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},t.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,n){var i=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(i.lo,i.hi,n):i.toNumber(Boolean(n))},t.merge=n,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=i,t.ProtocolError=i("ProtocolError"),t.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},t.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):t._Buffer_from=t._Buffer_allocUnsafe=null}}();var writer=Writer$1,util$4=minimal$1,BufferWriter$1,LongBits$1=util$4.LongBits,base64=util$4.base64,utf8$1=util$4.utf8;function Op(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function noop(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer$1(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create$1=function(){return util$4.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};function writeByte(e,t,n){t[n]=255&e}function writeVarint32(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function writeFixed32(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}Writer$1.create=create$1(),Writer$1.alloc=function(e){return new util$4.Array(e)},util$4.Array!==Array&&(Writer$1.alloc=util$4.pool(Writer$1.alloc,util$4.Array.prototype.subarray)),Writer$1.prototype._push=function(e,t,n){return this.tail=this.tail.next=new Op(e,t,n),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer$1.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer$1.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer$1.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer$1.prototype.uint64=function(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)},Writer$1.prototype.int64=Writer$1.prototype.uint64,Writer$1.prototype.sint64=function(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer$1.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer$1.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32,Writer$1.prototype.fixed64=function(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64,Writer$1.prototype.float=function(e){return this._push(util$4.float.writeFloatLE,4,e)},Writer$1.prototype.double=function(e){return this._push(util$4.float.writeDoubleLE,8,e)};var writeBytes=util$4.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};Writer$1.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(util$4.isString(e)){var n=Writer$1.alloc(t=base64.length(e));base64.decode(e,n,0),e=n}return this.uint32(t)._push(writeBytes,t,e)},Writer$1.prototype.string=function(e){var t=utf8$1.length(e);return t?this.uint32(t)._push(utf8$1.write,t,e):this._push(writeByte,1,0)},Writer$1.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer$1.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer$1.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},Writer$1.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},Writer$1._configure=function(e){BufferWriter$1=e,Writer$1.create=create$1(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$3=minimal$1;function BufferWriter(){Writer.call(this)}function writeStringBuffer(e,t,n){e.length<40?util$3.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}BufferWriter._configure=function(){BufferWriter.alloc=util$3._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$3.Buffer&&util$3.Buffer.prototype instanceof Uint8Array&&"set"===util$3.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}},BufferWriter.prototype.bytes=function(e){util$3.isString(e)&&(e=util$3._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(BufferWriter.writeBytesBuffer,t,e),this},BufferWriter.prototype.string=function(e){var t=util$3.Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this},BufferWriter._configure();var reader=Reader$1,util$2=minimal$1,BufferReader$1,LongBits=util$2.LongBits,utf8=util$2.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader$1(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")},create=function(){return util$2.Buffer?function(e){return(Reader$1.create=function(e){return util$2.Buffer.isBuffer(e)?new BufferReader$1(e):create_array(e)})(e)}:create_array},value;function readLongVarint(){var e=new LongBits(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.create=create(),Reader$1.prototype._slice=util$2.Array.prototype.subarray||util$2.Array.prototype.slice,Reader$1.prototype.uint32=(value=4294967295,function(){if(value=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return value;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return value}),Reader$1.prototype.int32=function(){return 0|this.uint32()},Reader$1.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},Reader$1.prototype.bool=function(){return 0!==this.uint32()},Reader$1.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=util$2.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader$1.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=util$2.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader$1.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw indexOutOfRange(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var i=util$2.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)},Reader$1.prototype.string=function(){var e=this.bytes();return utf8.read(e,0,e.length)},Reader$1.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader$1.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader$1._configure=function(e){BufferReader$1=e,Reader$1.create=create(),BufferReader$1._configure();var t=util$2.Long?"toLong":"toNumber";util$2.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$1=minimal$1;function BufferReader(e){Reader.call(this,e)}BufferReader._configure=function(){util$1.Buffer&&(BufferReader.prototype._slice=util$1.Buffer.prototype.slice)},BufferReader.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},BufferReader._configure();var rpc={},service=Service,util=minimal$1;function Service(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(t,n,i,o,r){if(!o)throw TypeError("request must be specified");var a=this;if(!r)return util.asPromise(e,a,t,n,i,o);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return a.emit("error",e,t),r(e);if(null!==n){if(!(n instanceof i))try{n=i[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),r(e)}return a.emit("data",n,t),r(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){r(e)}),0)}else setTimeout((function(){r(Error("already ended"))}),0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},function(e){e.Service=service}(rpc);var roots={};!function(e){var t=indexMinimal;function n(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}t.build="minimal",t.Writer=writer,t.BufferWriter=writer_buffer,t.Reader=reader,t.BufferReader=reader_buffer,t.util=minimal$1,t.rpc=rpc,t.roots=roots,t.configure=n,n()}();var minimal=indexMinimal,PBAnimator,PBAnimationState;function createBasePBAnimator(){return{states:[]}}function createBasePBAnimationState(){return{clip:"",playing:void 0,weight:void 0,speed:void 0,loop:void 0,shouldReset:void 0}}!function(e){e.encode=function(e,t=minimal.Writer.create()){for(const n of e.states)PBAnimationState.encode(n,t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBAnimator();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.states.push(PBAnimationState.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBAnimator||(PBAnimator={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.clip&&t.uint32(18).string(e.clip),void 0!==e.playing&&t.uint32(24).bool(e.playing),void 0!==e.weight&&t.uint32(37).float(e.weight),void 0!==e.speed&&t.uint32(45).float(e.speed),void 0!==e.loop&&t.uint32(48).bool(e.loop),void 0!==e.shouldReset&&t.uint32(56).bool(e.shouldReset),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBAnimationState();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 2:if(18!==e)break;o.clip=n.string();continue;case 3:if(24!==e)break;o.playing=n.bool();continue;case 4:if(37!==e)break;o.weight=n.float();continue;case 5:if(45!==e)break;o.speed=n.float();continue;case 6:if(48!==e)break;o.loop=n.bool();continue;case 7:if(56!==e)break;o.shouldReset=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBAnimationState||(PBAnimationState={}));const AnimatorSchema={COMPONENT_ID:1042,serialize(e,t){const n=PBAnimator.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBAnimator.decode(e.buffer(),e.remainingBytes()),create:()=>PBAnimator.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAnimator"}};function createBasePBAudioEvent(){return{state:0,timestamp:0}}var PBAudioEvent;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.state&&t.uint32(8).int32(e.state),0!==e.timestamp&&t.uint32(16).uint32(e.timestamp),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBAudioEvent();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.state=n.int32();continue;case 2:if(16!==e)break;o.timestamp=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBAudioEvent||(PBAudioEvent={}));const AudioEventSchema={COMPONENT_ID:1105,serialize(e,t){const n=PBAudioEvent.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBAudioEvent.decode(e.buffer(),e.remainingBytes()),create:()=>PBAudioEvent.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAudioEvent"}};function createBasePBAudioSource(){return{playing:void 0,volume:void 0,loop:void 0,pitch:void 0,audioClipUrl:"",currentTime:void 0,global:void 0}}var PBAudioSource;!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.playing&&t.uint32(8).bool(e.playing),void 0!==e.volume&&t.uint32(21).float(e.volume),void 0!==e.loop&&t.uint32(24).bool(e.loop),void 0!==e.pitch&&t.uint32(37).float(e.pitch),""!==e.audioClipUrl&&t.uint32(42).string(e.audioClipUrl),void 0!==e.currentTime&&t.uint32(53).float(e.currentTime),void 0!==e.global&&t.uint32(56).bool(e.global),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBAudioSource();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.playing=n.bool();continue;case 2:if(21!==e)break;o.volume=n.float();continue;case 3:if(24!==e)break;o.loop=n.bool();continue;case 4:if(37!==e)break;o.pitch=n.float();continue;case 5:if(42!==e)break;o.audioClipUrl=n.string();continue;case 6:if(53!==e)break;o.currentTime=n.float();continue;case 7:if(56!==e)break;o.global=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBAudioSource||(PBAudioSource={}));const AudioSourceSchema={COMPONENT_ID:1020,serialize(e,t){const n=PBAudioSource.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBAudioSource.decode(e.buffer(),e.remainingBytes()),create:()=>PBAudioSource.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAudioSource"}};function createBasePBAudioStream(){return{playing:void 0,volume:void 0,url:""}}var PBAudioStream;!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.playing&&t.uint32(8).bool(e.playing),void 0!==e.volume&&t.uint32(21).float(e.volume),""!==e.url&&t.uint32(26).string(e.url),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBAudioStream();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.playing=n.bool();continue;case 2:if(21!==e)break;o.volume=n.float();continue;case 3:if(26!==e)break;o.url=n.string();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBAudioStream||(PBAudioStream={}));const AudioStreamSchema={COMPONENT_ID:1021,serialize(e,t){const n=PBAudioStream.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBAudioStream.decode(e.buffer(),e.remainingBytes()),create:()=>PBAudioStream.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAudioStream"}};var AvatarAnchorPointType,PBAvatarAttach;function createBasePBAvatarAttach(){return{avatarId:void 0,anchorPointId:0}}!function(e){e[e.AAPT_POSITION=0]="AAPT_POSITION",e[e.AAPT_NAME_TAG=1]="AAPT_NAME_TAG",e[e.AAPT_HEAD=4]="AAPT_HEAD",e[e.AAPT_NECK=5]="AAPT_NECK",e[e.AAPT_SPINE=6]="AAPT_SPINE",e[e.AAPT_SPINE1=7]="AAPT_SPINE1",e[e.AAPT_SPINE2=8]="AAPT_SPINE2",e[e.AAPT_HIP=9]="AAPT_HIP",e[e.AAPT_LEFT_SHOULDER=10]="AAPT_LEFT_SHOULDER",e[e.AAPT_LEFT_ARM=11]="AAPT_LEFT_ARM",e[e.AAPT_LEFT_FOREARM=12]="AAPT_LEFT_FOREARM",e[e.AAPT_LEFT_HAND=2]="AAPT_LEFT_HAND",e[e.AAPT_LEFT_HAND_INDEX=13]="AAPT_LEFT_HAND_INDEX",e[e.AAPT_RIGHT_SHOULDER=14]="AAPT_RIGHT_SHOULDER",e[e.AAPT_RIGHT_ARM=15]="AAPT_RIGHT_ARM",e[e.AAPT_RIGHT_FOREARM=16]="AAPT_RIGHT_FOREARM",e[e.AAPT_RIGHT_HAND=3]="AAPT_RIGHT_HAND",e[e.AAPT_RIGHT_HAND_INDEX=17]="AAPT_RIGHT_HAND_INDEX",e[e.AAPT_LEFT_UP_LEG=18]="AAPT_LEFT_UP_LEG",e[e.AAPT_LEFT_LEG=19]="AAPT_LEFT_LEG",e[e.AAPT_LEFT_FOOT=20]="AAPT_LEFT_FOOT",e[e.AAPT_LEFT_TOE_BASE=21]="AAPT_LEFT_TOE_BASE",e[e.AAPT_RIGHT_UP_LEG=22]="AAPT_RIGHT_UP_LEG",e[e.AAPT_RIGHT_LEG=23]="AAPT_RIGHT_LEG",e[e.AAPT_RIGHT_FOOT=24]="AAPT_RIGHT_FOOT",e[e.AAPT_RIGHT_TOE_BASE=25]="AAPT_RIGHT_TOE_BASE"}(AvatarAnchorPointType||(AvatarAnchorPointType={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.avatarId&&t.uint32(10).string(e.avatarId),0!==e.anchorPointId&&t.uint32(16).int32(e.anchorPointId),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBAvatarAttach();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.avatarId=n.string();continue;case 2:if(16!==e)break;o.anchorPointId=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBAvatarAttach||(PBAvatarAttach={}));const AvatarAttachSchema={COMPONENT_ID:1073,serialize(e,t){const n=PBAvatarAttach.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBAvatarAttach.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarAttach.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarAttach"}};function createBaseColor3(){return{r:0,g:0,b:0}}var Color3$1,Color4$1,PBAvatarBase;function createBaseColor4(){return{r:0,g:0,b:0,a:0}}function createBasePBAvatarBase(){return{skinColor:void 0,eyesColor:void 0,hairColor:void 0,bodyShapeUrn:"",name:""}}!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.r&&t.uint32(13).float(e.r),0!==e.g&&t.uint32(21).float(e.g),0!==e.b&&t.uint32(29).float(e.b),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseColor3();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.r=n.float();continue;case 2:if(21!==e)break;o.g=n.float();continue;case 3:if(29!==e)break;o.b=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(Color3$1||(Color3$1={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.r&&t.uint32(13).float(e.r),0!==e.g&&t.uint32(21).float(e.g),0!==e.b&&t.uint32(29).float(e.b),0!==e.a&&t.uint32(37).float(e.a),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseColor4();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.r=n.float();continue;case 2:if(21!==e)break;o.g=n.float();continue;case 3:if(29!==e)break;o.b=n.float();continue;case 4:if(37!==e)break;o.a=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(Color4$1||(Color4$1={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.skinColor&&Color3$1.encode(e.skinColor,t.uint32(10).fork()).ldelim(),void 0!==e.eyesColor&&Color3$1.encode(e.eyesColor,t.uint32(18).fork()).ldelim(),void 0!==e.hairColor&&Color3$1.encode(e.hairColor,t.uint32(26).fork()).ldelim(),""!==e.bodyShapeUrn&&t.uint32(34).string(e.bodyShapeUrn),""!==e.name&&t.uint32(42).string(e.name),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBAvatarBase();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.skinColor=Color3$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.eyesColor=Color3$1.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.hairColor=Color3$1.decode(n,n.uint32());continue;case 4:if(34!==e)break;o.bodyShapeUrn=n.string();continue;case 5:if(42!==e)break;o.name=n.string();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBAvatarBase||(PBAvatarBase={}));const AvatarBaseSchema={COMPONENT_ID:1087,serialize(e,t){const n=PBAvatarBase.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBAvatarBase.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarBase.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarBase"}};function createBasePBAvatarEmoteCommand(){return{emoteUrn:"",loop:!1,timestamp:0}}var PBAvatarEmoteCommand;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.emoteUrn&&t.uint32(10).string(e.emoteUrn),!0===e.loop&&t.uint32(16).bool(e.loop),0!==e.timestamp&&t.uint32(24).uint32(e.timestamp),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBAvatarEmoteCommand();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.emoteUrn=n.string();continue;case 2:if(16!==e)break;o.loop=n.bool();continue;case 3:if(24!==e)break;o.timestamp=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBAvatarEmoteCommand||(PBAvatarEmoteCommand={}));const AvatarEmoteCommandSchema={COMPONENT_ID:1088,serialize(e,t){const n=PBAvatarEmoteCommand.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBAvatarEmoteCommand.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarEmoteCommand.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarEmoteCommand"}};function createBasePBAvatarEquippedData(){return{wearableUrns:[],emoteUrns:[]}}var PBAvatarEquippedData;!function(e){e.encode=function(e,t=minimal.Writer.create()){for(const n of e.wearableUrns)t.uint32(10).string(n);for(const n of e.emoteUrns)t.uint32(18).string(n);return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBAvatarEquippedData();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.wearableUrns.push(n.string());continue;case 2:if(18!==e)break;o.emoteUrns.push(n.string());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBAvatarEquippedData||(PBAvatarEquippedData={}));const AvatarEquippedDataSchema={COMPONENT_ID:1091,serialize(e,t){const n=PBAvatarEquippedData.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBAvatarEquippedData.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarEquippedData.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarEquippedData"}};function createBasePosition(){return{x:0,y:0,z:0}}var Position,Vector3$1,Vector2$1,Quaternion$1,AvatarModifierType,PBAvatarModifierArea;function createBaseVector3(){return{x:0,y:0,z:0}}function createBaseVector2(){return{x:0,y:0}}function createBaseQuaternion(){return{x:0,y:0,z:0,w:0}}function createBasePBAvatarModifierArea(){return{area:void 0,excludeIds:[],modifiers:[]}}!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.x&&t.uint32(13).float(e.x),0!==e.y&&t.uint32(21).float(e.y),0!==e.z&&t.uint32(29).float(e.z),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePosition();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.x=n.float();continue;case 2:if(21!==e)break;o.y=n.float();continue;case 3:if(29!==e)break;o.z=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(Position||(Position={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.x&&t.uint32(13).float(e.x),0!==e.y&&t.uint32(21).float(e.y),0!==e.z&&t.uint32(29).float(e.z),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseVector3();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.x=n.float();continue;case 2:if(21!==e)break;o.y=n.float();continue;case 3:if(29!==e)break;o.z=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(Vector3$1||(Vector3$1={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.x&&t.uint32(13).float(e.x),0!==e.y&&t.uint32(21).float(e.y),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseVector2();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.x=n.float();continue;case 2:if(21!==e)break;o.y=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(Vector2$1||(Vector2$1={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.x&&t.uint32(13).float(e.x),0!==e.y&&t.uint32(21).float(e.y),0!==e.z&&t.uint32(29).float(e.z),0!==e.w&&t.uint32(37).float(e.w),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseQuaternion();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.x=n.float();continue;case 2:if(21!==e)break;o.y=n.float();continue;case 3:if(29!==e)break;o.z=n.float();continue;case 4:if(37!==e)break;o.w=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(Quaternion$1||(Quaternion$1={})),function(e){e[e.AMT_HIDE_AVATARS=0]="AMT_HIDE_AVATARS",e[e.AMT_DISABLE_PASSPORTS=1]="AMT_DISABLE_PASSPORTS"}(AvatarModifierType||(AvatarModifierType={})),function(e){e.encode=function(e,t=minimal.Writer.create()){void 0!==e.area&&Vector3$1.encode(e.area,t.uint32(10).fork()).ldelim();for(const n of e.excludeIds)t.uint32(18).string(n);t.uint32(26).fork();for(const n of e.modifiers)t.int32(n);return t.ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBAvatarModifierArea();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.area=Vector3$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.excludeIds.push(n.string());continue;case 3:if(24===e){o.modifiers.push(n.int32());continue}if(26===e){const e=n.uint32()+n.pos;for(;n.pos<e;)o.modifiers.push(n.int32());continue}}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBAvatarModifierArea||(PBAvatarModifierArea={}));const AvatarModifierAreaSchema={COMPONENT_ID:1070,serialize(e,t){const n=PBAvatarModifierArea.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBAvatarModifierArea.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarModifierArea.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarModifierArea"}};
/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var wasm=null;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Long(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function isLong(e){return!0===(e&&e.__isLong__)}function ctz32(e){var t=Math.clz32(e&-e);return e?31-t:t}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(e,t){var n,i,o;return t?(o=0<=(e>>>=0)&&e<256)&&(i=UINT_CACHE[e])?i:(n=fromBits(e,0,!0),o&&(UINT_CACHE[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(i=INT_CACHE[e])?i:(n=fromBits(e,e<0?-1:0,!1),o&&(INT_CACHE[e]=n),n)}function fromNumber(e,t){if(isNaN(e))return t?UZERO:ZERO;if(t){if(e<0)return UZERO;if(e>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(e<=-TWO_PWR_63_DBL)return MIN_VALUE;if(e+1>=TWO_PWR_63_DBL)return MAX_VALUE}return e<0?fromNumber(-e,t).neg():fromBits(e%TWO_PWR_32_DBL|0,e/TWO_PWR_32_DBL|0,t)}function fromBits(e,t,n){return new Long(e,t,n)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var pow_dbl=Math.pow;function fromString(e,t,n){if(0===e.length)throw Error("empty string");if("number"==typeof t?(n=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?UZERO:ZERO;if((n=n||10)<2||36<n)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return fromString(e.substring(1),t,n).neg();for(var o=fromNumber(pow_dbl(n,8)),r=ZERO,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+s),n);if(s<8){var u=fromNumber(pow_dbl(n,s));r=r.mul(u).add(fromNumber(c))}else r=(r=r.mul(o)).add(fromNumber(c))}return r.unsigned=t,r}function fromValue(e,t){return"number"==typeof e?fromNumber(e,t):"string"==typeof e?fromString(e,t):fromBits(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}Long.fromString=fromString,Long.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype,PBAvatarShape;function createBasePBAvatarShape(){return{id:"",name:void 0,bodyShape:void 0,skinColor:void 0,hairColor:void 0,eyeColor:void 0,expressionTriggerId:void 0,expressionTriggerTimestamp:void 0,talking:void 0,wearables:[],emotes:[]}}LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(MIN_VALUE)){var t=fromNumber(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=fromNumber(pow_dbl(e,6),this.unsigned),r=this,a="";;){var s=r.div(o),c=(r.sub(s.mul(o)).toInt()>>>0).toString(e);if((r=s).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},LongPrototype.getHighBits=function(){return this.high},LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0},LongPrototype.getLowBits=function(){return this.low},LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0},LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},LongPrototype.isSafeInteger=function(){var e=this.high>>21;return!e||!this.unsigned&&(-1===e&&!(0===this.low&&-2097152===this.high))},LongPrototype.isZero=function(){return 0===this.high&&0===this.low},LongPrototype.eqz=LongPrototype.isZero,LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function(){return this.unsigned||this.high>=0},LongPrototype.isOdd=function(){return!(1&~this.low)},LongPrototype.isEven=function(){return!(1&this.low)},LongPrototype.equals=function(e){return isLong(e)||(e=fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function(e){return!this.eq(e)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.ne=LongPrototype.notEquals,LongPrototype.lessThan=function(e){return this.comp(e)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function(e){return this.comp(e)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.le=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function(e){return this.comp(e)>0},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function(e){return this.comp(e)>=0},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.ge=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function(e){isLong(e)||(e=fromValue(e));var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,r=e.high>>>16,a=65535&e.high,s=e.low>>>16,c=0,u=0,l=0,f=0;return l+=(f+=o+(65535&e.low))>>>16,u+=(l+=i+s)>>>16,c+=(u+=n+a)>>>16,c+=t+r,fromBits((l&=65535)<<16|(f&=65535),(c&=65535)<<16|(u&=65535),this.unsigned)},LongPrototype.subtract=function(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function(e){if(this.isZero())return this;if(isLong(e)||(e=fromValue(e)),wasm)return fromBits(wasm.mul(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned);if(e.isZero())return this.unsigned?UZERO:ZERO;if(this.eq(MIN_VALUE))return e.isOdd()?MIN_VALUE:ZERO;if(e.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TWO_PWR_24)&&e.lt(TWO_PWR_24))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,r=e.high>>>16,a=65535&e.high,s=e.low>>>16,c=65535&e.low,u=0,l=0,f=0,d=0;return f+=(d+=o*c)>>>16,l+=(f+=i*c)>>>16,f&=65535,l+=(f+=o*s)>>>16,u+=(l+=n*c)>>>16,l&=65535,u+=(l+=i*s)>>>16,l&=65535,u+=(l+=o*a)>>>16,u+=t*c+n*s+i*a+o*r,fromBits((f&=65535)<<16|(d&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");var t,n,i;if(wasm)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?fromBits((this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?UZERO:ZERO;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return UZERO;if(e.gt(this.shru(1)))return UONE;i=UZERO}else{if(this.eq(MIN_VALUE))return e.eq(ONE)||e.eq(NEG_ONE)?MIN_VALUE:e.eq(MIN_VALUE)?ONE:(t=this.shr(1).div(e).shl(1)).eq(ZERO)?e.isNegative()?ONE:NEG_ONE:(n=this.sub(e.mul(t)),i=t.add(n.div(e)));if(e.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=ZERO}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(t)/Math.LN2),r=o<=48?1:pow_dbl(2,o-48),a=fromNumber(t),s=a.mul(e);s.isNegative()||s.gt(n);)s=(a=fromNumber(t-=r,this.unsigned)).mul(e);a.isZero()&&(a=ONE),i=i.add(a),n=n.sub(s)}return i},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function(e){return isLong(e)||(e=fromValue(e)),wasm?fromBits((this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.rem=LongPrototype.modulo,LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},LongPrototype.clz=LongPrototype.countLeadingZeros,LongPrototype.countTrailingZeros=function(){return this.low?ctz32(this.low):ctz32(this.high)+32},LongPrototype.ctz=LongPrototype.countTrailingZeros,LongPrototype.and=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)},LongPrototype.or=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)},LongPrototype.xor=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)},LongPrototype.shiftLeft=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):fromBits(32===e?this.high:this.high>>>e-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.shr_u=LongPrototype.shiftRightUnsigned,LongPrototype.rotateLeft=function(e){var t;return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?fromBits(this.high,this.low,this.unsigned):e<32?(t=32-e,fromBits(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),fromBits(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},LongPrototype.rotl=LongPrototype.rotateLeft,LongPrototype.rotateRight=function(e){var t;return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?fromBits(this.high,this.low,this.unsigned):e<32?(t=32-e,fromBits(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),fromBits(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},LongPrototype.rotr=LongPrototype.rotateRight,LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},LongPrototype.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Long.fromBytes=function(e,t,n){return n?Long.fromBytesLE(e,t):Long.fromBytesBE(e,t)},Long.fromBytesLE=function(e,t){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Long.fromBytesBE=function(e,t){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},"function"==typeof BigInt&&(Long.fromBigInt=function(e,t){return fromBits(Number(BigInt.asIntN(32,e)),Number(BigInt.asIntN(32,e>>BigInt(32))),t)},Long.fromValue=function(e,t){return"bigint"==typeof e?fromBigInt(e,t):fromValue(e,t)},LongPrototype.toBigInt=function(){var e=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|e}),function(e){e.encode=function(e,t=minimal.Writer.create()){""!==e.id&&t.uint32(10).string(e.id),void 0!==e.name&&t.uint32(18).string(e.name),void 0!==e.bodyShape&&t.uint32(26).string(e.bodyShape),void 0!==e.skinColor&&Color3$1.encode(e.skinColor,t.uint32(34).fork()).ldelim(),void 0!==e.hairColor&&Color3$1.encode(e.hairColor,t.uint32(42).fork()).ldelim(),void 0!==e.eyeColor&&Color3$1.encode(e.eyeColor,t.uint32(50).fork()).ldelim(),void 0!==e.expressionTriggerId&&t.uint32(58).string(e.expressionTriggerId),void 0!==e.expressionTriggerTimestamp&&t.uint32(64).int64(e.expressionTriggerTimestamp),void 0!==e.talking&&t.uint32(72).bool(e.talking);for(const n of e.wearables)t.uint32(82).string(n);for(const n of e.emotes)t.uint32(90).string(n);return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBAvatarShape();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.id=n.string();continue;case 2:if(18!==e)break;o.name=n.string();continue;case 3:if(26!==e)break;o.bodyShape=n.string();continue;case 4:if(34!==e)break;o.skinColor=Color3$1.decode(n,n.uint32());continue;case 5:if(42!==e)break;o.hairColor=Color3$1.decode(n,n.uint32());continue;case 6:if(50!==e)break;o.eyeColor=Color3$1.decode(n,n.uint32());continue;case 7:if(58!==e)break;o.expressionTriggerId=n.string();continue;case 8:if(64!==e)break;o.expressionTriggerTimestamp=longToNumber(n.int64());continue;case 9:if(72!==e)break;o.talking=n.bool();continue;case 10:if(82!==e)break;o.wearables.push(n.string());continue;case 11:if(90!==e)break;o.emotes.push(n.string());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBAvatarShape||(PBAvatarShape={}));const tsProtoGlobalThis$2=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw"Unable to locate global object"})();function longToNumber(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new tsProtoGlobalThis$2.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}minimal.util.Long!==Long&&(minimal.util.Long=Long,minimal.configure());const AvatarShapeSchema={COMPONENT_ID:1080,serialize(e,t){const n=PBAvatarShape.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBAvatarShape.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarShape.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarShape"}};var BillboardMode,PBBillboard;function createBasePBBillboard(){return{billboardMode:void 0}}!function(e){e[e.BM_NONE=0]="BM_NONE",e[e.BM_X=1]="BM_X",e[e.BM_Y=2]="BM_Y",e[e.BM_Z=4]="BM_Z",e[e.BM_ALL=7]="BM_ALL"}(BillboardMode||(BillboardMode={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.billboardMode&&t.uint32(8).int32(e.billboardMode),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBBillboard();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.billboardMode=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBBillboard||(PBBillboard={}));const BillboardSchema={COMPONENT_ID:1090,serialize(e,t){const n=PBBillboard.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBBillboard.decode(e.buffer(),e.remainingBytes()),create:()=>PBBillboard.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBBillboard"}};function createBasePBCameraMode(){return{mode:0}}var PBCameraMode;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.mode&&t.uint32(8).int32(e.mode),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBCameraMode();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.mode=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBCameraMode||(PBCameraMode={}));const CameraModeSchema={COMPONENT_ID:1072,serialize(e,t){const n=PBCameraMode.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBCameraMode.decode(e.buffer(),e.remainingBytes()),create:()=>PBCameraMode.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBCameraMode"}};function createBasePBCameraModeArea(){return{area:void 0,mode:0}}var PBCameraModeArea;!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.area&&Vector3$1.encode(e.area,t.uint32(10).fork()).ldelim(),0!==e.mode&&t.uint32(16).int32(e.mode),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBCameraModeArea();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.area=Vector3$1.decode(n,n.uint32());continue;case 2:if(16!==e)break;o.mode=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBCameraModeArea||(PBCameraModeArea={}));const CameraModeAreaSchema={COMPONENT_ID:1071,serialize(e,t){const n=PBCameraModeArea.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBCameraModeArea.decode(e.buffer(),e.remainingBytes()),create:()=>PBCameraModeArea.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBCameraModeArea"}};function createBasePBEngineInfo(){return{frameNumber:0,totalRuntime:0,tickNumber:0}}var PBEngineInfo;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.frameNumber&&t.uint32(8).uint32(e.frameNumber),0!==e.totalRuntime&&t.uint32(21).float(e.totalRuntime),0!==e.tickNumber&&t.uint32(24).uint32(e.tickNumber),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBEngineInfo();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.frameNumber=n.uint32();continue;case 2:if(21!==e)break;o.totalRuntime=n.float();continue;case 3:if(24!==e)break;o.tickNumber=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBEngineInfo||(PBEngineInfo={}));const EngineInfoSchema={COMPONENT_ID:1048,serialize(e,t){const n=PBEngineInfo.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBEngineInfo.decode(e.buffer(),e.remainingBytes()),create:()=>PBEngineInfo.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBEngineInfo"}};function createBasePBGltfContainer(){return{src:"",visibleMeshesCollisionMask:void 0,invisibleMeshesCollisionMask:void 0}}var PBGltfContainer;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.src&&t.uint32(10).string(e.src),void 0!==e.visibleMeshesCollisionMask&&t.uint32(32).uint32(e.visibleMeshesCollisionMask),void 0!==e.invisibleMeshesCollisionMask&&t.uint32(40).uint32(e.invisibleMeshesCollisionMask),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBGltfContainer();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.src=n.string();continue;case 4:if(32!==e)break;o.visibleMeshesCollisionMask=n.uint32();continue;case 5:if(40!==e)break;o.invisibleMeshesCollisionMask=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBGltfContainer||(PBGltfContainer={}));const GltfContainerSchema={COMPONENT_ID:1041,serialize(e,t){const n=PBGltfContainer.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBGltfContainer.decode(e.buffer(),e.remainingBytes()),create:()=>PBGltfContainer.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBGltfContainer"}};function createBasePBGltfContainerLoadingState(){return{currentState:0}}var PBGltfContainerLoadingState;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.currentState&&t.uint32(8).int32(e.currentState),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBGltfContainerLoadingState();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.currentState=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBGltfContainerLoadingState||(PBGltfContainerLoadingState={}));const GltfContainerLoadingStateSchema={COMPONENT_ID:1049,serialize(e,t){const n=PBGltfContainerLoadingState.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBGltfContainerLoadingState.decode(e.buffer(),e.remainingBytes()),create:()=>PBGltfContainerLoadingState.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBGltfContainerLoadingState"}};function createBasePBInputModifier(){return{mode:void 0}}var PBInputModifier,PBInputModifier_StandardInput;function createBasePBInputModifier_StandardInput(){return{disableAll:void 0,disableWalk:void 0,disableJog:void 0,disableRun:void 0,disableJump:void 0,disableEmote:void 0}}!function(e){e.encode=function(e,t=minimal.Writer.create()){if("standard"===e.mode?.$case)PBInputModifier_StandardInput.encode(e.mode.standard,t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBInputModifier();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.mode={$case:"standard",standard:PBInputModifier_StandardInput.decode(n,n.uint32())};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBInputModifier||(PBInputModifier={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.disableAll&&t.uint32(8).bool(e.disableAll),void 0!==e.disableWalk&&t.uint32(16).bool(e.disableWalk),void 0!==e.disableJog&&t.uint32(24).bool(e.disableJog),void 0!==e.disableRun&&t.uint32(32).bool(e.disableRun),void 0!==e.disableJump&&t.uint32(40).bool(e.disableJump),void 0!==e.disableEmote&&t.uint32(48).bool(e.disableEmote),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBInputModifier_StandardInput();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.disableAll=n.bool();continue;case 2:if(16!==e)break;o.disableWalk=n.bool();continue;case 3:if(24!==e)break;o.disableJog=n.bool();continue;case 4:if(32!==e)break;o.disableRun=n.bool();continue;case 5:if(40!==e)break;o.disableJump=n.bool();continue;case 6:if(48!==e)break;o.disableEmote=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBInputModifier_StandardInput||(PBInputModifier_StandardInput={}));const InputModifierSchema={COMPONENT_ID:1078,serialize(e,t){const n=PBInputModifier.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBInputModifier.decode(e.buffer(),e.remainingBytes()),create:()=>PBInputModifier.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBInputModifier"}};function createBasePBMainCamera(){return{virtualCameraEntity:void 0}}var PBMainCamera;!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.virtualCameraEntity&&t.uint32(8).uint32(e.virtualCameraEntity),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMainCamera();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.virtualCameraEntity=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMainCamera||(PBMainCamera={}));const MainCameraSchema={COMPONENT_ID:1075,serialize(e,t){const n=PBMainCamera.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBMainCamera.decode(e.buffer(),e.remainingBytes()),create:()=>PBMainCamera.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBMainCamera"}};var TextureWrapMode,TextureFilterMode,Texture,AvatarTexture,VideoTexture,TextureUnion,MaterialTransparencyMode,PBMaterial,PBMaterial_UnlitMaterial,PBMaterial_PbrMaterial;function createBaseTexture(){return{src:"",wrapMode:void 0,filterMode:void 0,offset:void 0,tiling:void 0}}function createBaseAvatarTexture(){return{userId:"",wrapMode:void 0,filterMode:void 0}}function createBaseVideoTexture(){return{videoPlayerEntity:0,wrapMode:void 0,filterMode:void 0}}function createBaseTextureUnion(){return{tex:void 0}}function createBasePBMaterial(){return{material:void 0}}function createBasePBMaterial_UnlitMaterial(){return{texture:void 0,alphaTest:void 0,castShadows:void 0,diffuseColor:void 0,alphaTexture:void 0}}function createBasePBMaterial_PbrMaterial(){return{texture:void 0,alphaTest:void 0,castShadows:void 0,alphaTexture:void 0,emissiveTexture:void 0,bumpTexture:void 0,albedoColor:void 0,emissiveColor:void 0,reflectivityColor:void 0,transparencyMode:void 0,metallic:void 0,roughness:void 0,specularIntensity:void 0,emissiveIntensity:void 0,directIntensity:void 0}}!function(e){e[e.TWM_REPEAT=0]="TWM_REPEAT",e[e.TWM_CLAMP=1]="TWM_CLAMP",e[e.TWM_MIRROR=2]="TWM_MIRROR"}(TextureWrapMode||(TextureWrapMode={})),function(e){e[e.TFM_POINT=0]="TFM_POINT",e[e.TFM_BILINEAR=1]="TFM_BILINEAR",e[e.TFM_TRILINEAR=2]="TFM_TRILINEAR"}(TextureFilterMode||(TextureFilterMode={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.src&&t.uint32(10).string(e.src),void 0!==e.wrapMode&&t.uint32(16).int32(e.wrapMode),void 0!==e.filterMode&&t.uint32(24).int32(e.filterMode),void 0!==e.offset&&Vector2$1.encode(e.offset,t.uint32(34).fork()).ldelim(),void 0!==e.tiling&&Vector2$1.encode(e.tiling,t.uint32(42).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseTexture();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.src=n.string();continue;case 2:if(16!==e)break;o.wrapMode=n.int32();continue;case 3:if(24!==e)break;o.filterMode=n.int32();continue;case 4:if(34!==e)break;o.offset=Vector2$1.decode(n,n.uint32());continue;case 5:if(42!==e)break;o.tiling=Vector2$1.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(Texture||(Texture={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.userId&&t.uint32(10).string(e.userId),void 0!==e.wrapMode&&t.uint32(16).int32(e.wrapMode),void 0!==e.filterMode&&t.uint32(24).int32(e.filterMode),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseAvatarTexture();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.userId=n.string();continue;case 2:if(16!==e)break;o.wrapMode=n.int32();continue;case 3:if(24!==e)break;o.filterMode=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(AvatarTexture||(AvatarTexture={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.videoPlayerEntity&&t.uint32(8).uint32(e.videoPlayerEntity),void 0!==e.wrapMode&&t.uint32(16).int32(e.wrapMode),void 0!==e.filterMode&&t.uint32(24).int32(e.filterMode),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseVideoTexture();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.videoPlayerEntity=n.uint32();continue;case 2:if(16!==e)break;o.wrapMode=n.int32();continue;case 3:if(24!==e)break;o.filterMode=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(VideoTexture||(VideoTexture={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.tex?.$case){case"texture":Texture.encode(e.tex.texture,t.uint32(10).fork()).ldelim();break;case"avatarTexture":AvatarTexture.encode(e.tex.avatarTexture,t.uint32(18).fork()).ldelim();break;case"videoTexture":VideoTexture.encode(e.tex.videoTexture,t.uint32(26).fork()).ldelim()}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseTextureUnion();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.tex={$case:"texture",texture:Texture.decode(n,n.uint32())};continue;case 2:if(18!==e)break;o.tex={$case:"avatarTexture",avatarTexture:AvatarTexture.decode(n,n.uint32())};continue;case 3:if(26!==e)break;o.tex={$case:"videoTexture",videoTexture:VideoTexture.decode(n,n.uint32())};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(TextureUnion||(TextureUnion={})),function(e){e[e.MTM_OPAQUE=0]="MTM_OPAQUE",e[e.MTM_ALPHA_TEST=1]="MTM_ALPHA_TEST",e[e.MTM_ALPHA_BLEND=2]="MTM_ALPHA_BLEND",e[e.MTM_ALPHA_TEST_AND_ALPHA_BLEND=3]="MTM_ALPHA_TEST_AND_ALPHA_BLEND",e[e.MTM_AUTO=4]="MTM_AUTO"}(MaterialTransparencyMode||(MaterialTransparencyMode={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.material?.$case){case"unlit":PBMaterial_UnlitMaterial.encode(e.material.unlit,t.uint32(10).fork()).ldelim();break;case"pbr":PBMaterial_PbrMaterial.encode(e.material.pbr,t.uint32(18).fork()).ldelim()}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMaterial();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.material={$case:"unlit",unlit:PBMaterial_UnlitMaterial.decode(n,n.uint32())};continue;case 2:if(18!==e)break;o.material={$case:"pbr",pbr:PBMaterial_PbrMaterial.decode(n,n.uint32())};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMaterial||(PBMaterial={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.texture&&TextureUnion.encode(e.texture,t.uint32(10).fork()).ldelim(),void 0!==e.alphaTest&&t.uint32(21).float(e.alphaTest),void 0!==e.castShadows&&t.uint32(24).bool(e.castShadows),void 0!==e.diffuseColor&&Color4$1.encode(e.diffuseColor,t.uint32(34).fork()).ldelim(),void 0!==e.alphaTexture&&TextureUnion.encode(e.alphaTexture,t.uint32(42).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMaterial_UnlitMaterial();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.texture=TextureUnion.decode(n,n.uint32());continue;case 2:if(21!==e)break;o.alphaTest=n.float();continue;case 3:if(24!==e)break;o.castShadows=n.bool();continue;case 4:if(34!==e)break;o.diffuseColor=Color4$1.decode(n,n.uint32());continue;case 5:if(42!==e)break;o.alphaTexture=TextureUnion.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMaterial_UnlitMaterial||(PBMaterial_UnlitMaterial={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.texture&&TextureUnion.encode(e.texture,t.uint32(10).fork()).ldelim(),void 0!==e.alphaTest&&t.uint32(21).float(e.alphaTest),void 0!==e.castShadows&&t.uint32(24).bool(e.castShadows),void 0!==e.alphaTexture&&TextureUnion.encode(e.alphaTexture,t.uint32(34).fork()).ldelim(),void 0!==e.emissiveTexture&&TextureUnion.encode(e.emissiveTexture,t.uint32(42).fork()).ldelim(),void 0!==e.bumpTexture&&TextureUnion.encode(e.bumpTexture,t.uint32(50).fork()).ldelim(),void 0!==e.albedoColor&&Color4$1.encode(e.albedoColor,t.uint32(58).fork()).ldelim(),void 0!==e.emissiveColor&&Color3$1.encode(e.emissiveColor,t.uint32(66).fork()).ldelim(),void 0!==e.reflectivityColor&&Color3$1.encode(e.reflectivityColor,t.uint32(74).fork()).ldelim(),void 0!==e.transparencyMode&&t.uint32(80).int32(e.transparencyMode),void 0!==e.metallic&&t.uint32(93).float(e.metallic),void 0!==e.roughness&&t.uint32(101).float(e.roughness),void 0!==e.specularIntensity&&t.uint32(117).float(e.specularIntensity),void 0!==e.emissiveIntensity&&t.uint32(125).float(e.emissiveIntensity),void 0!==e.directIntensity&&t.uint32(133).float(e.directIntensity),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMaterial_PbrMaterial();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.texture=TextureUnion.decode(n,n.uint32());continue;case 2:if(21!==e)break;o.alphaTest=n.float();continue;case 3:if(24!==e)break;o.castShadows=n.bool();continue;case 4:if(34!==e)break;o.alphaTexture=TextureUnion.decode(n,n.uint32());continue;case 5:if(42!==e)break;o.emissiveTexture=TextureUnion.decode(n,n.uint32());continue;case 6:if(50!==e)break;o.bumpTexture=TextureUnion.decode(n,n.uint32());continue;case 7:if(58!==e)break;o.albedoColor=Color4$1.decode(n,n.uint32());continue;case 8:if(66!==e)break;o.emissiveColor=Color3$1.decode(n,n.uint32());continue;case 9:if(74!==e)break;o.reflectivityColor=Color3$1.decode(n,n.uint32());continue;case 10:if(80!==e)break;o.transparencyMode=n.int32();continue;case 11:if(93!==e)break;o.metallic=n.float();continue;case 12:if(101!==e)break;o.roughness=n.float();continue;case 14:if(117!==e)break;o.specularIntensity=n.float();continue;case 15:if(125!==e)break;o.emissiveIntensity=n.float();continue;case 16:if(133!==e)break;o.directIntensity=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMaterial_PbrMaterial||(PBMaterial_PbrMaterial={}));const MaterialSchema={COMPONENT_ID:1017,serialize(e,t){const n=PBMaterial.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBMaterial.decode(e.buffer(),e.remainingBytes()),create:()=>PBMaterial.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBMaterial"}};var ColliderLayer,PBMeshCollider,PBMeshCollider_BoxMesh,PBMeshCollider_CylinderMesh,PBMeshCollider_PlaneMesh,PBMeshCollider_SphereMesh;function createBasePBMeshCollider(){return{collisionMask:void 0,mesh:void 0}}function createBasePBMeshCollider_BoxMesh(){return{}}function createBasePBMeshCollider_CylinderMesh(){return{radiusTop:void 0,radiusBottom:void 0}}function createBasePBMeshCollider_PlaneMesh(){return{}}function createBasePBMeshCollider_SphereMesh(){return{}}!function(e){e[e.CL_NONE=0]="CL_NONE",e[e.CL_POINTER=1]="CL_POINTER",e[e.CL_PHYSICS=2]="CL_PHYSICS",e[e.CL_RESERVED1=4]="CL_RESERVED1",e[e.CL_RESERVED2=8]="CL_RESERVED2",e[e.CL_RESERVED3=16]="CL_RESERVED3",e[e.CL_RESERVED4=32]="CL_RESERVED4",e[e.CL_RESERVED5=64]="CL_RESERVED5",e[e.CL_RESERVED6=128]="CL_RESERVED6",e[e.CL_CUSTOM1=256]="CL_CUSTOM1",e[e.CL_CUSTOM2=512]="CL_CUSTOM2",e[e.CL_CUSTOM3=1024]="CL_CUSTOM3",e[e.CL_CUSTOM4=2048]="CL_CUSTOM4",e[e.CL_CUSTOM5=4096]="CL_CUSTOM5",e[e.CL_CUSTOM6=8192]="CL_CUSTOM6",e[e.CL_CUSTOM7=16384]="CL_CUSTOM7",e[e.CL_CUSTOM8=32768]="CL_CUSTOM8"}(ColliderLayer||(ColliderLayer={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(void 0!==e.collisionMask&&t.uint32(8).uint32(e.collisionMask),e.mesh?.$case){case"box":PBMeshCollider_BoxMesh.encode(e.mesh.box,t.uint32(18).fork()).ldelim();break;case"sphere":PBMeshCollider_SphereMesh.encode(e.mesh.sphere,t.uint32(26).fork()).ldelim();break;case"cylinder":PBMeshCollider_CylinderMesh.encode(e.mesh.cylinder,t.uint32(34).fork()).ldelim();break;case"plane":PBMeshCollider_PlaneMesh.encode(e.mesh.plane,t.uint32(42).fork()).ldelim()}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMeshCollider();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.collisionMask=n.uint32();continue;case 2:if(18!==e)break;o.mesh={$case:"box",box:PBMeshCollider_BoxMesh.decode(n,n.uint32())};continue;case 3:if(26!==e)break;o.mesh={$case:"sphere",sphere:PBMeshCollider_SphereMesh.decode(n,n.uint32())};continue;case 4:if(34!==e)break;o.mesh={$case:"cylinder",cylinder:PBMeshCollider_CylinderMesh.decode(n,n.uint32())};continue;case 5:if(42!==e)break;o.mesh={$case:"plane",plane:PBMeshCollider_PlaneMesh.decode(n,n.uint32())};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMeshCollider||(PBMeshCollider={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMeshCollider_BoxMesh();for(;n.pos<i;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMeshCollider_BoxMesh||(PBMeshCollider_BoxMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.radiusTop&&t.uint32(13).float(e.radiusTop),void 0!==e.radiusBottom&&t.uint32(21).float(e.radiusBottom),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMeshCollider_CylinderMesh();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.radiusTop=n.float();continue;case 2:if(21!==e)break;o.radiusBottom=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMeshCollider_CylinderMesh||(PBMeshCollider_CylinderMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMeshCollider_PlaneMesh();for(;n.pos<i;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMeshCollider_PlaneMesh||(PBMeshCollider_PlaneMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMeshCollider_SphereMesh();for(;n.pos<i;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMeshCollider_SphereMesh||(PBMeshCollider_SphereMesh={}));const MeshColliderSchema={COMPONENT_ID:1019,serialize(e,t){const n=PBMeshCollider.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBMeshCollider.decode(e.buffer(),e.remainingBytes()),create:()=>PBMeshCollider.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBMeshCollider"}};function createBasePBMeshRenderer(){return{mesh:void 0}}var PBMeshRenderer,PBMeshRenderer_BoxMesh,PBMeshRenderer_CylinderMesh,PBMeshRenderer_PlaneMesh,PBMeshRenderer_SphereMesh;function createBasePBMeshRenderer_BoxMesh(){return{uvs:[]}}function createBasePBMeshRenderer_CylinderMesh(){return{radiusTop:void 0,radiusBottom:void 0}}function createBasePBMeshRenderer_PlaneMesh(){return{uvs:[]}}function createBasePBMeshRenderer_SphereMesh(){return{}}!function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.mesh?.$case){case"box":PBMeshRenderer_BoxMesh.encode(e.mesh.box,t.uint32(10).fork()).ldelim();break;case"sphere":PBMeshRenderer_SphereMesh.encode(e.mesh.sphere,t.uint32(18).fork()).ldelim();break;case"cylinder":PBMeshRenderer_CylinderMesh.encode(e.mesh.cylinder,t.uint32(26).fork()).ldelim();break;case"plane":PBMeshRenderer_PlaneMesh.encode(e.mesh.plane,t.uint32(34).fork()).ldelim()}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMeshRenderer();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.mesh={$case:"box",box:PBMeshRenderer_BoxMesh.decode(n,n.uint32())};continue;case 2:if(18!==e)break;o.mesh={$case:"sphere",sphere:PBMeshRenderer_SphereMesh.decode(n,n.uint32())};continue;case 3:if(26!==e)break;o.mesh={$case:"cylinder",cylinder:PBMeshRenderer_CylinderMesh.decode(n,n.uint32())};continue;case 4:if(34!==e)break;o.mesh={$case:"plane",plane:PBMeshRenderer_PlaneMesh.decode(n,n.uint32())};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMeshRenderer||(PBMeshRenderer={})),function(e){e.encode=function(e,t=minimal.Writer.create()){t.uint32(10).fork();for(const n of e.uvs)t.float(n);return t.ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMeshRenderer_BoxMesh();for(;n.pos<i;){const e=n.uint32();if(e>>>3==1){if(13===e){o.uvs.push(n.float());continue}if(10===e){const e=n.uint32()+n.pos;for(;n.pos<e;)o.uvs.push(n.float());continue}}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMeshRenderer_BoxMesh||(PBMeshRenderer_BoxMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.radiusTop&&t.uint32(13).float(e.radiusTop),void 0!==e.radiusBottom&&t.uint32(21).float(e.radiusBottom),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMeshRenderer_CylinderMesh();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.radiusTop=n.float();continue;case 2:if(21!==e)break;o.radiusBottom=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMeshRenderer_CylinderMesh||(PBMeshRenderer_CylinderMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){t.uint32(10).fork();for(const n of e.uvs)t.float(n);return t.ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMeshRenderer_PlaneMesh();for(;n.pos<i;){const e=n.uint32();if(e>>>3==1){if(13===e){o.uvs.push(n.float());continue}if(10===e){const e=n.uint32()+n.pos;for(;n.pos<e;)o.uvs.push(n.float());continue}}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMeshRenderer_PlaneMesh||(PBMeshRenderer_PlaneMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBMeshRenderer_SphereMesh();for(;n.pos<i;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBMeshRenderer_SphereMesh||(PBMeshRenderer_SphereMesh={}));const MeshRendererSchema={COMPONENT_ID:1018,serialize(e,t){const n=PBMeshRenderer.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBMeshRenderer.decode(e.buffer(),e.remainingBytes()),create:()=>PBMeshRenderer.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBMeshRenderer"}};var NftFrameType,PBNftShape;function createBasePBNftShape(){return{urn:"",style:void 0,color:void 0}}!function(e){e[e.NFT_CLASSIC=0]="NFT_CLASSIC",e[e.NFT_BAROQUE_ORNAMENT=1]="NFT_BAROQUE_ORNAMENT",e[e.NFT_DIAMOND_ORNAMENT=2]="NFT_DIAMOND_ORNAMENT",e[e.NFT_MINIMAL_WIDE=3]="NFT_MINIMAL_WIDE",e[e.NFT_MINIMAL_GREY=4]="NFT_MINIMAL_GREY",e[e.NFT_BLOCKY=5]="NFT_BLOCKY",e[e.NFT_GOLD_EDGES=6]="NFT_GOLD_EDGES",e[e.NFT_GOLD_CARVED=7]="NFT_GOLD_CARVED",e[e.NFT_GOLD_WIDE=8]="NFT_GOLD_WIDE",e[e.NFT_GOLD_ROUNDED=9]="NFT_GOLD_ROUNDED",e[e.NFT_METAL_MEDIUM=10]="NFT_METAL_MEDIUM",e[e.NFT_METAL_WIDE=11]="NFT_METAL_WIDE",e[e.NFT_METAL_SLIM=12]="NFT_METAL_SLIM",e[e.NFT_METAL_ROUNDED=13]="NFT_METAL_ROUNDED",e[e.NFT_PINS=14]="NFT_PINS",e[e.NFT_MINIMAL_BLACK=15]="NFT_MINIMAL_BLACK",e[e.NFT_MINIMAL_WHITE=16]="NFT_MINIMAL_WHITE",e[e.NFT_TAPE=17]="NFT_TAPE",e[e.NFT_WOOD_SLIM=18]="NFT_WOOD_SLIM",e[e.NFT_WOOD_WIDE=19]="NFT_WOOD_WIDE",e[e.NFT_WOOD_TWIGS=20]="NFT_WOOD_TWIGS",e[e.NFT_CANVAS=21]="NFT_CANVAS",e[e.NFT_NONE=22]="NFT_NONE"}(NftFrameType||(NftFrameType={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.urn&&t.uint32(10).string(e.urn),void 0!==e.style&&t.uint32(16).int32(e.style),void 0!==e.color&&Color3$1.encode(e.color,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBNftShape();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.urn=n.string();continue;case 2:if(16!==e)break;o.style=n.int32();continue;case 3:if(26!==e)break;o.color=Color3$1.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBNftShape||(PBNftShape={}));const NftShapeSchema={COMPONENT_ID:1040,serialize(e,t){const n=PBNftShape.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBNftShape.decode(e.buffer(),e.remainingBytes()),create:()=>PBNftShape.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBNftShape"}};function createBasePBPlayerIdentityData(){return{address:"",isGuest:!1}}var PBPlayerIdentityData;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.address&&t.uint32(10).string(e.address),!0===e.isGuest&&t.uint32(24).bool(e.isGuest),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBPlayerIdentityData();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.address=n.string();continue;case 3:if(24!==e)break;o.isGuest=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBPlayerIdentityData||(PBPlayerIdentityData={}));const PlayerIdentityDataSchema={COMPONENT_ID:1089,serialize(e,t){const n=PBPlayerIdentityData.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBPlayerIdentityData.decode(e.buffer(),e.remainingBytes()),create:()=>PBPlayerIdentityData.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBPlayerIdentityData"}};function createBasePBPointerEvents(){return{pointerEvents:[]}}var PBPointerEvents,PBPointerEvents_Info,PBPointerEvents_Entry;function createBasePBPointerEvents_Info(){return{button:void 0,hoverText:void 0,maxDistance:void 0,showFeedback:void 0,showHighlight:void 0}}function createBasePBPointerEvents_Entry(){return{eventType:0,eventInfo:void 0}}!function(e){e.encode=function(e,t=minimal.Writer.create()){for(const n of e.pointerEvents)PBPointerEvents_Entry.encode(n,t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBPointerEvents();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.pointerEvents.push(PBPointerEvents_Entry.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBPointerEvents||(PBPointerEvents={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.button&&t.uint32(8).int32(e.button),void 0!==e.hoverText&&t.uint32(18).string(e.hoverText),void 0!==e.maxDistance&&t.uint32(29).float(e.maxDistance),void 0!==e.showFeedback&&t.uint32(32).bool(e.showFeedback),void 0!==e.showHighlight&&t.uint32(40).bool(e.showHighlight),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBPointerEvents_Info();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.button=n.int32();continue;case 2:if(18!==e)break;o.hoverText=n.string();continue;case 3:if(29!==e)break;o.maxDistance=n.float();continue;case 4:if(32!==e)break;o.showFeedback=n.bool();continue;case 5:if(40!==e)break;o.showHighlight=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBPointerEvents_Info||(PBPointerEvents_Info={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.eventType&&t.uint32(8).int32(e.eventType),void 0!==e.eventInfo&&PBPointerEvents_Info.encode(e.eventInfo,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBPointerEvents_Entry();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.eventType=n.int32();continue;case 2:if(18!==e)break;o.eventInfo=PBPointerEvents_Info.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBPointerEvents_Entry||(PBPointerEvents_Entry={}));const PointerEventsSchema={COMPONENT_ID:1062,serialize(e,t){const n=PBPointerEvents.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBPointerEvents.decode(e.buffer(),e.remainingBytes()),create:()=>PBPointerEvents.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBPointerEvents"}};function createBaseRaycastHit(){return{position:void 0,globalOrigin:void 0,direction:void 0,normalHit:void 0,length:0,meshName:void 0,entityId:void 0}}var RaycastHit,PBPointerEventsResult;function createBasePBPointerEventsResult(){return{button:0,hit:void 0,state:0,timestamp:0,analog:void 0,tickNumber:0}}!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.position&&Vector3$1.encode(e.position,t.uint32(10).fork()).ldelim(),void 0!==e.globalOrigin&&Vector3$1.encode(e.globalOrigin,t.uint32(18).fork()).ldelim(),void 0!==e.direction&&Vector3$1.encode(e.direction,t.uint32(26).fork()).ldelim(),void 0!==e.normalHit&&Vector3$1.encode(e.normalHit,t.uint32(34).fork()).ldelim(),0!==e.length&&t.uint32(45).float(e.length),void 0!==e.meshName&&t.uint32(50).string(e.meshName),void 0!==e.entityId&&t.uint32(56).uint32(e.entityId),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseRaycastHit();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.position=Vector3$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.globalOrigin=Vector3$1.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.direction=Vector3$1.decode(n,n.uint32());continue;case 4:if(34!==e)break;o.normalHit=Vector3$1.decode(n,n.uint32());continue;case 5:if(45!==e)break;o.length=n.float();continue;case 6:if(50!==e)break;o.meshName=n.string();continue;case 7:if(56!==e)break;o.entityId=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(RaycastHit||(RaycastHit={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.button&&t.uint32(8).int32(e.button),void 0!==e.hit&&RaycastHit.encode(e.hit,t.uint32(18).fork()).ldelim(),0!==e.state&&t.uint32(32).int32(e.state),0!==e.timestamp&&t.uint32(40).uint32(e.timestamp),void 0!==e.analog&&t.uint32(53).float(e.analog),0!==e.tickNumber&&t.uint32(56).uint32(e.tickNumber),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBPointerEventsResult();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.button=n.int32();continue;case 2:if(18!==e)break;o.hit=RaycastHit.decode(n,n.uint32());continue;case 4:if(32!==e)break;o.state=n.int32();continue;case 5:if(40!==e)break;o.timestamp=n.uint32();continue;case 6:if(53!==e)break;o.analog=n.float();continue;case 7:if(56!==e)break;o.tickNumber=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBPointerEventsResult||(PBPointerEventsResult={}));const PointerEventsResultSchema={COMPONENT_ID:1063,serialize(e,t){const n=PBPointerEventsResult.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBPointerEventsResult.decode(e.buffer(),e.remainingBytes()),create:()=>PBPointerEventsResult.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBPointerEventsResult"}};function createBasePBPointerLock(){return{isPointerLocked:!1}}var PBPointerLock;!function(e){e.encode=function(e,t=minimal.Writer.create()){return!0===e.isPointerLocked&&t.uint32(8).bool(e.isPointerLocked),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBPointerLock();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.isPointerLocked=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBPointerLock||(PBPointerLock={}));const PointerLockSchema={COMPONENT_ID:1074,serialize(e,t){const n=PBPointerLock.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBPointerLock.decode(e.buffer(),e.remainingBytes()),create:()=>PBPointerLock.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBPointerLock"}};var RaycastQueryType,PBRaycast;function createBasePBRaycast(){return{timestamp:void 0,originOffset:void 0,direction:void 0,maxDistance:0,queryType:0,continuous:void 0,collisionMask:void 0}}!function(e){e[e.RQT_HIT_FIRST=0]="RQT_HIT_FIRST",e[e.RQT_QUERY_ALL=1]="RQT_QUERY_ALL",e[e.RQT_NONE=2]="RQT_NONE"}(RaycastQueryType||(RaycastQueryType={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(void 0!==e.timestamp&&t.uint32(8).uint32(e.timestamp),void 0!==e.originOffset&&Vector3$1.encode(e.originOffset,t.uint32(18).fork()).ldelim(),e.direction?.$case){case"localDirection":Vector3$1.encode(e.direction.localDirection,t.uint32(50).fork()).ldelim();break;case"globalDirection":Vector3$1.encode(e.direction.globalDirection,t.uint32(26).fork()).ldelim();break;case"globalTarget":Vector3$1.encode(e.direction.globalTarget,t.uint32(58).fork()).ldelim();break;case"targetEntity":t.uint32(80).uint32(e.direction.targetEntity)}return 0!==e.maxDistance&&t.uint32(37).float(e.maxDistance),0!==e.queryType&&t.uint32(40).int32(e.queryType),void 0!==e.continuous&&t.uint32(64).bool(e.continuous),void 0!==e.collisionMask&&t.uint32(72).uint32(e.collisionMask),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBRaycast();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.timestamp=n.uint32();continue;case 2:if(18!==e)break;o.originOffset=Vector3$1.decode(n,n.uint32());continue;case 6:if(50!==e)break;o.direction={$case:"localDirection",localDirection:Vector3$1.decode(n,n.uint32())};continue;case 3:if(26!==e)break;o.direction={$case:"globalDirection",globalDirection:Vector3$1.decode(n,n.uint32())};continue;case 7:if(58!==e)break;o.direction={$case:"globalTarget",globalTarget:Vector3$1.decode(n,n.uint32())};continue;case 10:if(80!==e)break;o.direction={$case:"targetEntity",targetEntity:n.uint32()};continue;case 4:if(37!==e)break;o.maxDistance=n.float();continue;case 5:if(40!==e)break;o.queryType=n.int32();continue;case 8:if(64!==e)break;o.continuous=n.bool();continue;case 9:if(72!==e)break;o.collisionMask=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBRaycast||(PBRaycast={}));const RaycastSchema={COMPONENT_ID:1067,serialize(e,t){const n=PBRaycast.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBRaycast.decode(e.buffer(),e.remainingBytes()),create:()=>PBRaycast.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBRaycast"}};function createBasePBRaycastResult(){return{timestamp:void 0,globalOrigin:void 0,direction:void 0,hits:[],tickNumber:0}}var PBRaycastResult;!function(e){e.encode=function(e,t=minimal.Writer.create()){void 0!==e.timestamp&&t.uint32(8).uint32(e.timestamp),void 0!==e.globalOrigin&&Vector3$1.encode(e.globalOrigin,t.uint32(18).fork()).ldelim(),void 0!==e.direction&&Vector3$1.encode(e.direction,t.uint32(26).fork()).ldelim();for(const n of e.hits)RaycastHit.encode(n,t.uint32(34).fork()).ldelim();return 0!==e.tickNumber&&t.uint32(40).uint32(e.tickNumber),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBRaycastResult();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.timestamp=n.uint32();continue;case 2:if(18!==e)break;o.globalOrigin=Vector3$1.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.direction=Vector3$1.decode(n,n.uint32());continue;case 4:if(34!==e)break;o.hits.push(RaycastHit.decode(n,n.uint32()));continue;case 5:if(40!==e)break;o.tickNumber=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBRaycastResult||(PBRaycastResult={}));const RaycastResultSchema={COMPONENT_ID:1068,serialize(e,t){const n=PBRaycastResult.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBRaycastResult.decode(e.buffer(),e.remainingBytes()),create:()=>PBRaycastResult.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBRaycastResult"}};function createBasePBRealmInfo(){return{baseUrl:"",realmName:"",networkId:0,commsAdapter:"",isPreview:!1,room:void 0,isConnectedSceneRoom:void 0}}var PBRealmInfo;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.baseUrl&&t.uint32(10).string(e.baseUrl),""!==e.realmName&&t.uint32(18).string(e.realmName),0!==e.networkId&&t.uint32(24).int32(e.networkId),""!==e.commsAdapter&&t.uint32(34).string(e.commsAdapter),!0===e.isPreview&&t.uint32(40).bool(e.isPreview),void 0!==e.room&&t.uint32(50).string(e.room),void 0!==e.isConnectedSceneRoom&&t.uint32(56).bool(e.isConnectedSceneRoom),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBRealmInfo();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.baseUrl=n.string();continue;case 2:if(18!==e)break;o.realmName=n.string();continue;case 3:if(24!==e)break;o.networkId=n.int32();continue;case 4:if(34!==e)break;o.commsAdapter=n.string();continue;case 5:if(40!==e)break;o.isPreview=n.bool();continue;case 6:if(50!==e)break;o.room=n.string();continue;case 7:if(56!==e)break;o.isConnectedSceneRoom=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBRealmInfo||(PBRealmInfo={}));const RealmInfoSchema={COMPONENT_ID:1106,serialize(e,t){const n=PBRealmInfo.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBRealmInfo.decode(e.buffer(),e.remainingBytes()),create:()=>PBRealmInfo.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBRealmInfo"}};function createBasePBTextShape(){return{text:"",font:void 0,fontSize:void 0,fontAutoSize:void 0,textAlign:void 0,width:void 0,height:void 0,paddingTop:void 0,paddingRight:void 0,paddingBottom:void 0,paddingLeft:void 0,lineSpacing:void 0,lineCount:void 0,textWrapping:void 0,shadowBlur:void 0,shadowOffsetX:void 0,shadowOffsetY:void 0,outlineWidth:void 0,shadowColor:void 0,outlineColor:void 0,textColor:void 0}}var PBTextShape;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.text&&t.uint32(10).string(e.text),void 0!==e.font&&t.uint32(16).int32(e.font),void 0!==e.fontSize&&t.uint32(29).float(e.fontSize),void 0!==e.fontAutoSize&&t.uint32(32).bool(e.fontAutoSize),void 0!==e.textAlign&&t.uint32(40).int32(e.textAlign),void 0!==e.width&&t.uint32(53).float(e.width),void 0!==e.height&&t.uint32(61).float(e.height),void 0!==e.paddingTop&&t.uint32(69).float(e.paddingTop),void 0!==e.paddingRight&&t.uint32(77).float(e.paddingRight),void 0!==e.paddingBottom&&t.uint32(85).float(e.paddingBottom),void 0!==e.paddingLeft&&t.uint32(93).float(e.paddingLeft),void 0!==e.lineSpacing&&t.uint32(101).float(e.lineSpacing),void 0!==e.lineCount&&t.uint32(104).int32(e.lineCount),void 0!==e.textWrapping&&t.uint32(112).bool(e.textWrapping),void 0!==e.shadowBlur&&t.uint32(125).float(e.shadowBlur),void 0!==e.shadowOffsetX&&t.uint32(133).float(e.shadowOffsetX),void 0!==e.shadowOffsetY&&t.uint32(141).float(e.shadowOffsetY),void 0!==e.outlineWidth&&t.uint32(149).float(e.outlineWidth),void 0!==e.shadowColor&&Color3$1.encode(e.shadowColor,t.uint32(154).fork()).ldelim(),void 0!==e.outlineColor&&Color3$1.encode(e.outlineColor,t.uint32(162).fork()).ldelim(),void 0!==e.textColor&&Color4$1.encode(e.textColor,t.uint32(170).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBTextShape();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.text=n.string();continue;case 2:if(16!==e)break;o.font=n.int32();continue;case 3:if(29!==e)break;o.fontSize=n.float();continue;case 4:if(32!==e)break;o.fontAutoSize=n.bool();continue;case 5:if(40!==e)break;o.textAlign=n.int32();continue;case 6:if(53!==e)break;o.width=n.float();continue;case 7:if(61!==e)break;o.height=n.float();continue;case 8:if(69!==e)break;o.paddingTop=n.float();continue;case 9:if(77!==e)break;o.paddingRight=n.float();continue;case 10:if(85!==e)break;o.paddingBottom=n.float();continue;case 11:if(93!==e)break;o.paddingLeft=n.float();continue;case 12:if(101!==e)break;o.lineSpacing=n.float();continue;case 13:if(104!==e)break;o.lineCount=n.int32();continue;case 14:if(112!==e)break;o.textWrapping=n.bool();continue;case 15:if(125!==e)break;o.shadowBlur=n.float();continue;case 16:if(133!==e)break;o.shadowOffsetX=n.float();continue;case 17:if(141!==e)break;o.shadowOffsetY=n.float();continue;case 18:if(149!==e)break;o.outlineWidth=n.float();continue;case 19:if(154!==e)break;o.shadowColor=Color3$1.decode(n,n.uint32());continue;case 20:if(162!==e)break;o.outlineColor=Color3$1.decode(n,n.uint32());continue;case 21:if(170!==e)break;o.textColor=Color4$1.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBTextShape||(PBTextShape={}));const TextShapeSchema={COMPONENT_ID:1030,serialize(e,t){const n=PBTextShape.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBTextShape.decode(e.buffer(),e.remainingBytes()),create:()=>PBTextShape.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBTextShape"}};var TextureMovementType,EasingFunction,PBTween,Move,Rotate,Scale,TextureMove;function createBasePBTween(){return{duration:0,easingFunction:0,mode:void 0,playing:void 0,currentTime:void 0}}function createBaseMove(){return{start:void 0,end:void 0,faceDirection:void 0}}function createBaseRotate(){return{start:void 0,end:void 0}}function createBaseScale(){return{start:void 0,end:void 0}}function createBaseTextureMove(){return{start:void 0,end:void 0,movementType:void 0}}!function(e){e[e.TMT_OFFSET=0]="TMT_OFFSET",e[e.TMT_TILING=1]="TMT_TILING"}(TextureMovementType||(TextureMovementType={})),function(e){e[e.EF_LINEAR=0]="EF_LINEAR",e[e.EF_EASEINQUAD=1]="EF_EASEINQUAD",e[e.EF_EASEOUTQUAD=2]="EF_EASEOUTQUAD",e[e.EF_EASEQUAD=3]="EF_EASEQUAD",e[e.EF_EASEINSINE=4]="EF_EASEINSINE",e[e.EF_EASEOUTSINE=5]="EF_EASEOUTSINE",e[e.EF_EASESINE=6]="EF_EASESINE",e[e.EF_EASEINEXPO=7]="EF_EASEINEXPO",e[e.EF_EASEOUTEXPO=8]="EF_EASEOUTEXPO",e[e.EF_EASEEXPO=9]="EF_EASEEXPO",e[e.EF_EASEINELASTIC=10]="EF_EASEINELASTIC",e[e.EF_EASEOUTELASTIC=11]="EF_EASEOUTELASTIC",e[e.EF_EASEELASTIC=12]="EF_EASEELASTIC",e[e.EF_EASEINBOUNCE=13]="EF_EASEINBOUNCE",e[e.EF_EASEOUTBOUNCE=14]="EF_EASEOUTBOUNCE",e[e.EF_EASEBOUNCE=15]="EF_EASEBOUNCE",e[e.EF_EASEINCUBIC=16]="EF_EASEINCUBIC",e[e.EF_EASEOUTCUBIC=17]="EF_EASEOUTCUBIC",e[e.EF_EASECUBIC=18]="EF_EASECUBIC",e[e.EF_EASEINQUART=19]="EF_EASEINQUART",e[e.EF_EASEOUTQUART=20]="EF_EASEOUTQUART",e[e.EF_EASEQUART=21]="EF_EASEQUART",e[e.EF_EASEINQUINT=22]="EF_EASEINQUINT",e[e.EF_EASEOUTQUINT=23]="EF_EASEOUTQUINT",e[e.EF_EASEQUINT=24]="EF_EASEQUINT",e[e.EF_EASEINCIRC=25]="EF_EASEINCIRC",e[e.EF_EASEOUTCIRC=26]="EF_EASEOUTCIRC",e[e.EF_EASECIRC=27]="EF_EASECIRC",e[e.EF_EASEINBACK=28]="EF_EASEINBACK",e[e.EF_EASEOUTBACK=29]="EF_EASEOUTBACK",e[e.EF_EASEBACK=30]="EF_EASEBACK"}(EasingFunction||(EasingFunction={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(0!==e.duration&&t.uint32(13).float(e.duration),0!==e.easingFunction&&t.uint32(16).int32(e.easingFunction),e.mode?.$case){case"move":Move.encode(e.mode.move,t.uint32(26).fork()).ldelim();break;case"rotate":Rotate.encode(e.mode.rotate,t.uint32(34).fork()).ldelim();break;case"scale":Scale.encode(e.mode.scale,t.uint32(42).fork()).ldelim();break;case"textureMove":TextureMove.encode(e.mode.textureMove,t.uint32(66).fork()).ldelim()}return void 0!==e.playing&&t.uint32(48).bool(e.playing),void 0!==e.currentTime&&t.uint32(61).float(e.currentTime),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBTween();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.duration=n.float();continue;case 2:if(16!==e)break;o.easingFunction=n.int32();continue;case 3:if(26!==e)break;o.mode={$case:"move",move:Move.decode(n,n.uint32())};continue;case 4:if(34!==e)break;o.mode={$case:"rotate",rotate:Rotate.decode(n,n.uint32())};continue;case 5:if(42!==e)break;o.mode={$case:"scale",scale:Scale.decode(n,n.uint32())};continue;case 8:if(66!==e)break;o.mode={$case:"textureMove",textureMove:TextureMove.decode(n,n.uint32())};continue;case 6:if(48!==e)break;o.playing=n.bool();continue;case 7:if(61!==e)break;o.currentTime=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBTween||(PBTween={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.start&&Vector3$1.encode(e.start,t.uint32(10).fork()).ldelim(),void 0!==e.end&&Vector3$1.encode(e.end,t.uint32(18).fork()).ldelim(),void 0!==e.faceDirection&&t.uint32(24).bool(e.faceDirection),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseMove();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.start=Vector3$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.end=Vector3$1.decode(n,n.uint32());continue;case 3:if(24!==e)break;o.faceDirection=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(Move||(Move={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.start&&Quaternion$1.encode(e.start,t.uint32(10).fork()).ldelim(),void 0!==e.end&&Quaternion$1.encode(e.end,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseRotate();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.start=Quaternion$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.end=Quaternion$1.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(Rotate||(Rotate={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.start&&Vector3$1.encode(e.start,t.uint32(10).fork()).ldelim(),void 0!==e.end&&Vector3$1.encode(e.end,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseScale();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.start=Vector3$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.end=Vector3$1.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(Scale||(Scale={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.start&&Vector2$1.encode(e.start,t.uint32(10).fork()).ldelim(),void 0!==e.end&&Vector2$1.encode(e.end,t.uint32(18).fork()).ldelim(),void 0!==e.movementType&&t.uint32(24).int32(e.movementType),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseTextureMove();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.start=Vector2$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.end=Vector2$1.decode(n,n.uint32());continue;case 3:if(24!==e)break;o.movementType=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(TextureMove||(TextureMove={}));const TweenSchema={COMPONENT_ID:1102,serialize(e,t){const n=PBTween.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBTween.decode(e.buffer(),e.remainingBytes()),create:()=>PBTween.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBTween"}};var TweenLoop,PBTweenSequence;function createBasePBTweenSequence(){return{sequence:[],loop:void 0}}!function(e){e[e.TL_RESTART=0]="TL_RESTART",e[e.TL_YOYO=1]="TL_YOYO"}(TweenLoop||(TweenLoop={})),function(e){e.encode=function(e,t=minimal.Writer.create()){for(const n of e.sequence)PBTween.encode(n,t.uint32(10).fork()).ldelim();return void 0!==e.loop&&t.uint32(16).int32(e.loop),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBTweenSequence();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.sequence.push(PBTween.decode(n,n.uint32()));continue;case 2:if(16!==e)break;o.loop=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBTweenSequence||(PBTweenSequence={}));const TweenSequenceSchema={COMPONENT_ID:1104,serialize(e,t){const n=PBTweenSequence.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBTweenSequence.decode(e.buffer(),e.remainingBytes()),create:()=>PBTweenSequence.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBTweenSequence"}};var TweenStateStatus,PBTweenState;function createBasePBTweenState(){return{state:0,currentTime:0}}!function(e){e[e.TS_ACTIVE=0]="TS_ACTIVE",e[e.TS_COMPLETED=1]="TS_COMPLETED",e[e.TS_PAUSED=2]="TS_PAUSED"}(TweenStateStatus||(TweenStateStatus={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.state&&t.uint32(8).int32(e.state),0!==e.currentTime&&t.uint32(21).float(e.currentTime),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBTweenState();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.state=n.int32();continue;case 2:if(21!==e)break;o.currentTime=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBTweenState||(PBTweenState={}));const TweenStateSchema={COMPONENT_ID:1103,serialize(e,t){const n=PBTweenState.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBTweenState.decode(e.buffer(),e.remainingBytes()),create:()=>PBTweenState.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBTweenState"}};function createBaseBorderRect(){return{top:0,left:0,right:0,bottom:0}}var BorderRect,Rect,BackgroundTextureMode,PBUiBackground;function createBaseRect(){return{x:0,y:0,width:0,height:0}}function createBasePBUiBackground(){return{color:void 0,texture:void 0,textureMode:0,textureSlices:void 0,uvs:[]}}!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.top&&t.uint32(13).float(e.top),0!==e.left&&t.uint32(21).float(e.left),0!==e.right&&t.uint32(29).float(e.right),0!==e.bottom&&t.uint32(37).float(e.bottom),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseBorderRect();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.top=n.float();continue;case 2:if(21!==e)break;o.left=n.float();continue;case 3:if(29!==e)break;o.right=n.float();continue;case 4:if(37!==e)break;o.bottom=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(BorderRect||(BorderRect={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.x&&t.uint32(13).float(e.x),0!==e.y&&t.uint32(21).float(e.y),0!==e.width&&t.uint32(29).float(e.width),0!==e.height&&t.uint32(37).float(e.height),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseRect();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.x=n.float();continue;case 2:if(21!==e)break;o.y=n.float();continue;case 3:if(29!==e)break;o.width=n.float();continue;case 4:if(37!==e)break;o.height=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(Rect||(Rect={})),function(e){e[e.NINE_SLICES=0]="NINE_SLICES",e[e.CENTER=1]="CENTER",e[e.STRETCH=2]="STRETCH"}(BackgroundTextureMode||(BackgroundTextureMode={})),function(e){e.encode=function(e,t=minimal.Writer.create()){void 0!==e.color&&Color4$1.encode(e.color,t.uint32(10).fork()).ldelim(),void 0!==e.texture&&TextureUnion.encode(e.texture,t.uint32(18).fork()).ldelim(),0!==e.textureMode&&t.uint32(24).int32(e.textureMode),void 0!==e.textureSlices&&BorderRect.encode(e.textureSlices,t.uint32(34).fork()).ldelim(),t.uint32(42).fork();for(const n of e.uvs)t.float(n);return t.ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBUiBackground();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.color=Color4$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.texture=TextureUnion.decode(n,n.uint32());continue;case 3:if(24!==e)break;o.textureMode=n.int32();continue;case 4:if(34!==e)break;o.textureSlices=BorderRect.decode(n,n.uint32());continue;case 5:if(45===e){o.uvs.push(n.float());continue}if(42===e){const e=n.uint32()+n.pos;for(;n.pos<e;)o.uvs.push(n.float());continue}}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBUiBackground||(PBUiBackground={}));const UiBackgroundSchema={COMPONENT_ID:1053,serialize(e,t){const n=PBUiBackground.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBUiBackground.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiBackground.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiBackground"}};function createBasePBUiCanvasInformation(){return{devicePixelRatio:0,width:0,height:0,interactableArea:void 0}}var PBUiCanvasInformation;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.devicePixelRatio&&t.uint32(13).float(e.devicePixelRatio),0!==e.width&&t.uint32(16).int32(e.width),0!==e.height&&t.uint32(24).int32(e.height),void 0!==e.interactableArea&&BorderRect.encode(e.interactableArea,t.uint32(34).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBUiCanvasInformation();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.devicePixelRatio=n.float();continue;case 2:if(16!==e)break;o.width=n.int32();continue;case 3:if(24!==e)break;o.height=n.int32();continue;case 4:if(34!==e)break;o.interactableArea=BorderRect.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBUiCanvasInformation||(PBUiCanvasInformation={}));const UiCanvasInformationSchema={COMPONENT_ID:1054,serialize(e,t){const n=PBUiCanvasInformation.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBUiCanvasInformation.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiCanvasInformation.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiCanvasInformation"}};function createBasePBUiDropdown(){return{acceptEmpty:!1,emptyLabel:void 0,options:[],selectedIndex:void 0,disabled:!1,color:void 0,textAlign:void 0,font:void 0,fontSize:void 0}}var PBUiDropdown;!function(e){e.encode=function(e,t=minimal.Writer.create()){!0===e.acceptEmpty&&t.uint32(8).bool(e.acceptEmpty),void 0!==e.emptyLabel&&t.uint32(18).string(e.emptyLabel);for(const n of e.options)t.uint32(26).string(n);return void 0!==e.selectedIndex&&t.uint32(32).int32(e.selectedIndex),!0===e.disabled&&t.uint32(40).bool(e.disabled),void 0!==e.color&&Color4$1.encode(e.color,t.uint32(50).fork()).ldelim(),void 0!==e.textAlign&&t.uint32(80).int32(e.textAlign),void 0!==e.font&&t.uint32(88).int32(e.font),void 0!==e.fontSize&&t.uint32(96).int32(e.fontSize),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBUiDropdown();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.acceptEmpty=n.bool();continue;case 2:if(18!==e)break;o.emptyLabel=n.string();continue;case 3:if(26!==e)break;o.options.push(n.string());continue;case 4:if(32!==e)break;o.selectedIndex=n.int32();continue;case 5:if(40!==e)break;o.disabled=n.bool();continue;case 6:if(50!==e)break;o.color=Color4$1.decode(n,n.uint32());continue;case 10:if(80!==e)break;o.textAlign=n.int32();continue;case 11:if(88!==e)break;o.font=n.int32();continue;case 12:if(96!==e)break;o.fontSize=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBUiDropdown||(PBUiDropdown={}));const UiDropdownSchema={COMPONENT_ID:1094,serialize(e,t){const n=PBUiDropdown.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBUiDropdown.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiDropdown.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiDropdown"}};function createBasePBUiDropdownResult(){return{value:0}}var PBUiDropdownResult;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.value&&t.uint32(8).int32(e.value),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBUiDropdownResult();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.value=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBUiDropdownResult||(PBUiDropdownResult={}));const UiDropdownResultSchema={COMPONENT_ID:1096,serialize(e,t){const n=PBUiDropdownResult.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBUiDropdownResult.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiDropdownResult.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiDropdownResult"}};function createBasePBUiInput(){return{placeholder:"",color:void 0,placeholderColor:void 0,disabled:!1,textAlign:void 0,font:void 0,fontSize:void 0,value:void 0}}var PBUiInput;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.placeholder&&t.uint32(10).string(e.placeholder),void 0!==e.color&&Color4$1.encode(e.color,t.uint32(18).fork()).ldelim(),void 0!==e.placeholderColor&&Color4$1.encode(e.placeholderColor,t.uint32(26).fork()).ldelim(),!0===e.disabled&&t.uint32(32).bool(e.disabled),void 0!==e.textAlign&&t.uint32(80).int32(e.textAlign),void 0!==e.font&&t.uint32(88).int32(e.font),void 0!==e.fontSize&&t.uint32(96).int32(e.fontSize),void 0!==e.value&&t.uint32(106).string(e.value),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBUiInput();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.placeholder=n.string();continue;case 2:if(18!==e)break;o.color=Color4$1.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.placeholderColor=Color4$1.decode(n,n.uint32());continue;case 4:if(32!==e)break;o.disabled=n.bool();continue;case 10:if(80!==e)break;o.textAlign=n.int32();continue;case 11:if(88!==e)break;o.font=n.int32();continue;case 12:if(96!==e)break;o.fontSize=n.int32();continue;case 13:if(106!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBUiInput||(PBUiInput={}));const UiInputSchema={COMPONENT_ID:1093,serialize(e,t){const n=PBUiInput.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBUiInput.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiInput.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiInput"}};function createBasePBUiInputResult(){return{value:"",isSubmit:void 0}}var PBUiInputResult;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.value&&t.uint32(10).string(e.value),void 0!==e.isSubmit&&t.uint32(16).bool(e.isSubmit),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBUiInputResult();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue;case 2:if(16!==e)break;o.isSubmit=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBUiInputResult||(PBUiInputResult={}));const UiInputResultSchema={COMPONENT_ID:1095,serialize(e,t){const n=PBUiInputResult.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBUiInputResult.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiInputResult.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiInputResult"}};var TextWrap,PBUiText;function createBasePBUiText(){return{value:"",color:void 0,textAlign:void 0,font:void 0,fontSize:void 0,textWrap:void 0}}!function(e){e[e.TW_WRAP=0]="TW_WRAP",e[e.TW_NO_WRAP=1]="TW_NO_WRAP"}(TextWrap||(TextWrap={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.value&&t.uint32(10).string(e.value),void 0!==e.color&&Color4$1.encode(e.color,t.uint32(18).fork()).ldelim(),void 0!==e.textAlign&&t.uint32(24).int32(e.textAlign),void 0!==e.font&&t.uint32(32).int32(e.font),void 0!==e.fontSize&&t.uint32(40).int32(e.fontSize),void 0!==e.textWrap&&t.uint32(48).int32(e.textWrap),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBUiText();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue;case 2:if(18!==e)break;o.color=Color4$1.decode(n,n.uint32());continue;case 3:if(24!==e)break;o.textAlign=n.int32();continue;case 4:if(32!==e)break;o.font=n.int32();continue;case 5:if(40!==e)break;o.fontSize=n.int32();continue;case 6:if(48!==e)break;o.textWrap=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBUiText||(PBUiText={}));const UiTextSchema={COMPONENT_ID:1052,serialize(e,t){const n=PBUiText.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBUiText.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiText.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiText"}};var YGPositionType,YGAlign,YGUnit,YGFlexDirection,YGWrap,YGJustify,YGOverflow,YGDisplay,YGEdge,PointerFilterMode,PBUiTransform;function createBasePBUiTransform(){return{parent:0,rightOf:0,alignContent:void 0,alignItems:void 0,flexWrap:void 0,flexShrink:void 0,positionType:0,alignSelf:0,flexDirection:0,justifyContent:0,overflow:0,display:0,flexBasisUnit:0,flexBasis:0,flexGrow:0,widthUnit:0,width:0,heightUnit:0,height:0,minWidthUnit:0,minWidth:0,minHeightUnit:0,minHeight:0,maxWidthUnit:0,maxWidth:0,maxHeightUnit:0,maxHeight:0,positionLeftUnit:0,positionLeft:0,positionTopUnit:0,positionTop:0,positionRightUnit:0,positionRight:0,positionBottomUnit:0,positionBottom:0,marginLeftUnit:0,marginLeft:0,marginTopUnit:0,marginTop:0,marginRightUnit:0,marginRight:0,marginBottomUnit:0,marginBottom:0,paddingLeftUnit:0,paddingLeft:0,paddingTopUnit:0,paddingTop:0,paddingRightUnit:0,paddingRight:0,paddingBottomUnit:0,paddingBottom:0,pointerFilter:void 0}}!function(e){e[e.YGPT_RELATIVE=0]="YGPT_RELATIVE",e[e.YGPT_ABSOLUTE=1]="YGPT_ABSOLUTE"}(YGPositionType||(YGPositionType={})),function(e){e[e.YGA_AUTO=0]="YGA_AUTO",e[e.YGA_FLEX_START=1]="YGA_FLEX_START",e[e.YGA_CENTER=2]="YGA_CENTER",e[e.YGA_FLEX_END=3]="YGA_FLEX_END",e[e.YGA_STRETCH=4]="YGA_STRETCH",e[e.YGA_BASELINE=5]="YGA_BASELINE",e[e.YGA_SPACE_BETWEEN=6]="YGA_SPACE_BETWEEN",e[e.YGA_SPACE_AROUND=7]="YGA_SPACE_AROUND"}(YGAlign||(YGAlign={})),function(e){e[e.YGU_UNDEFINED=0]="YGU_UNDEFINED",e[e.YGU_POINT=1]="YGU_POINT",e[e.YGU_PERCENT=2]="YGU_PERCENT",e[e.YGU_AUTO=3]="YGU_AUTO"}(YGUnit||(YGUnit={})),function(e){e[e.YGFD_ROW=0]="YGFD_ROW",e[e.YGFD_COLUMN=1]="YGFD_COLUMN",e[e.YGFD_COLUMN_REVERSE=2]="YGFD_COLUMN_REVERSE",e[e.YGFD_ROW_REVERSE=3]="YGFD_ROW_REVERSE"}(YGFlexDirection||(YGFlexDirection={})),function(e){e[e.YGW_NO_WRAP=0]="YGW_NO_WRAP",e[e.YGW_WRAP=1]="YGW_WRAP",e[e.YGW_WRAP_REVERSE=2]="YGW_WRAP_REVERSE"}(YGWrap||(YGWrap={})),function(e){e[e.YGJ_FLEX_START=0]="YGJ_FLEX_START",e[e.YGJ_CENTER=1]="YGJ_CENTER",e[e.YGJ_FLEX_END=2]="YGJ_FLEX_END",e[e.YGJ_SPACE_BETWEEN=3]="YGJ_SPACE_BETWEEN",e[e.YGJ_SPACE_AROUND=4]="YGJ_SPACE_AROUND",e[e.YGJ_SPACE_EVENLY=5]="YGJ_SPACE_EVENLY"}(YGJustify||(YGJustify={})),function(e){e[e.YGO_VISIBLE=0]="YGO_VISIBLE",e[e.YGO_HIDDEN=1]="YGO_HIDDEN",e[e.YGO_SCROLL=2]="YGO_SCROLL"}(YGOverflow||(YGOverflow={})),function(e){e[e.YGD_FLEX=0]="YGD_FLEX",e[e.YGD_NONE=1]="YGD_NONE"}(YGDisplay||(YGDisplay={})),function(e){e[e.YGE_LEFT=0]="YGE_LEFT",e[e.YGE_TOP=1]="YGE_TOP",e[e.YGE_RIGHT=2]="YGE_RIGHT",e[e.YGE_BOTTOM=3]="YGE_BOTTOM",e[e.YGE_START=4]="YGE_START",e[e.YGE_END=5]="YGE_END",e[e.YGE_HORIZONTAL=6]="YGE_HORIZONTAL",e[e.YGE_VERTICAL=7]="YGE_VERTICAL",e[e.YGE_ALL=8]="YGE_ALL"}(YGEdge||(YGEdge={})),function(e){e[e.PFM_NONE=0]="PFM_NONE",e[e.PFM_BLOCK=1]="PFM_BLOCK"}(PointerFilterMode||(PointerFilterMode={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.parent&&t.uint32(8).int32(e.parent),0!==e.rightOf&&t.uint32(16).int32(e.rightOf),void 0!==e.alignContent&&t.uint32(24).int32(e.alignContent),void 0!==e.alignItems&&t.uint32(32).int32(e.alignItems),void 0!==e.flexWrap&&t.uint32(40).int32(e.flexWrap),void 0!==e.flexShrink&&t.uint32(53).float(e.flexShrink),0!==e.positionType&&t.uint32(56).int32(e.positionType),0!==e.alignSelf&&t.uint32(64).int32(e.alignSelf),0!==e.flexDirection&&t.uint32(72).int32(e.flexDirection),0!==e.justifyContent&&t.uint32(80).int32(e.justifyContent),0!==e.overflow&&t.uint32(88).int32(e.overflow),0!==e.display&&t.uint32(96).int32(e.display),0!==e.flexBasisUnit&&t.uint32(104).int32(e.flexBasisUnit),0!==e.flexBasis&&t.uint32(117).float(e.flexBasis),0!==e.flexGrow&&t.uint32(125).float(e.flexGrow),0!==e.widthUnit&&t.uint32(128).int32(e.widthUnit),0!==e.width&&t.uint32(141).float(e.width),0!==e.heightUnit&&t.uint32(144).int32(e.heightUnit),0!==e.height&&t.uint32(157).float(e.height),0!==e.minWidthUnit&&t.uint32(160).int32(e.minWidthUnit),0!==e.minWidth&&t.uint32(173).float(e.minWidth),0!==e.minHeightUnit&&t.uint32(176).int32(e.minHeightUnit),0!==e.minHeight&&t.uint32(189).float(e.minHeight),0!==e.maxWidthUnit&&t.uint32(192).int32(e.maxWidthUnit),0!==e.maxWidth&&t.uint32(205).float(e.maxWidth),0!==e.maxHeightUnit&&t.uint32(208).int32(e.maxHeightUnit),0!==e.maxHeight&&t.uint32(221).float(e.maxHeight),0!==e.positionLeftUnit&&t.uint32(224).int32(e.positionLeftUnit),0!==e.positionLeft&&t.uint32(237).float(e.positionLeft),0!==e.positionTopUnit&&t.uint32(240).int32(e.positionTopUnit),0!==e.positionTop&&t.uint32(253).float(e.positionTop),0!==e.positionRightUnit&&t.uint32(256).int32(e.positionRightUnit),0!==e.positionRight&&t.uint32(269).float(e.positionRight),0!==e.positionBottomUnit&&t.uint32(272).int32(e.positionBottomUnit),0!==e.positionBottom&&t.uint32(285).float(e.positionBottom),0!==e.marginLeftUnit&&t.uint32(288).int32(e.marginLeftUnit),0!==e.marginLeft&&t.uint32(301).float(e.marginLeft),0!==e.marginTopUnit&&t.uint32(304).int32(e.marginTopUnit),0!==e.marginTop&&t.uint32(317).float(e.marginTop),0!==e.marginRightUnit&&t.uint32(320).int32(e.marginRightUnit),0!==e.marginRight&&t.uint32(333).float(e.marginRight),0!==e.marginBottomUnit&&t.uint32(336).int32(e.marginBottomUnit),0!==e.marginBottom&&t.uint32(349).float(e.marginBottom),0!==e.paddingLeftUnit&&t.uint32(352).int32(e.paddingLeftUnit),0!==e.paddingLeft&&t.uint32(365).float(e.paddingLeft),0!==e.paddingTopUnit&&t.uint32(368).int32(e.paddingTopUnit),0!==e.paddingTop&&t.uint32(381).float(e.paddingTop),0!==e.paddingRightUnit&&t.uint32(384).int32(e.paddingRightUnit),0!==e.paddingRight&&t.uint32(397).float(e.paddingRight),0!==e.paddingBottomUnit&&t.uint32(400).int32(e.paddingBottomUnit),0!==e.paddingBottom&&t.uint32(413).float(e.paddingBottom),void 0!==e.pointerFilter&&t.uint32(416).int32(e.pointerFilter),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBUiTransform();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.parent=n.int32();continue;case 2:if(16!==e)break;o.rightOf=n.int32();continue;case 3:if(24!==e)break;o.alignContent=n.int32();continue;case 4:if(32!==e)break;o.alignItems=n.int32();continue;case 5:if(40!==e)break;o.flexWrap=n.int32();continue;case 6:if(53!==e)break;o.flexShrink=n.float();continue;case 7:if(56!==e)break;o.positionType=n.int32();continue;case 8:if(64!==e)break;o.alignSelf=n.int32();continue;case 9:if(72!==e)break;o.flexDirection=n.int32();continue;case 10:if(80!==e)break;o.justifyContent=n.int32();continue;case 11:if(88!==e)break;o.overflow=n.int32();continue;case 12:if(96!==e)break;o.display=n.int32();continue;case 13:if(104!==e)break;o.flexBasisUnit=n.int32();continue;case 14:if(117!==e)break;o.flexBasis=n.float();continue;case 15:if(125!==e)break;o.flexGrow=n.float();continue;case 16:if(128!==e)break;o.widthUnit=n.int32();continue;case 17:if(141!==e)break;o.width=n.float();continue;case 18:if(144!==e)break;o.heightUnit=n.int32();continue;case 19:if(157!==e)break;o.height=n.float();continue;case 20:if(160!==e)break;o.minWidthUnit=n.int32();continue;case 21:if(173!==e)break;o.minWidth=n.float();continue;case 22:if(176!==e)break;o.minHeightUnit=n.int32();continue;case 23:if(189!==e)break;o.minHeight=n.float();continue;case 24:if(192!==e)break;o.maxWidthUnit=n.int32();continue;case 25:if(205!==e)break;o.maxWidth=n.float();continue;case 26:if(208!==e)break;o.maxHeightUnit=n.int32();continue;case 27:if(221!==e)break;o.maxHeight=n.float();continue;case 28:if(224!==e)break;o.positionLeftUnit=n.int32();continue;case 29:if(237!==e)break;o.positionLeft=n.float();continue;case 30:if(240!==e)break;o.positionTopUnit=n.int32();continue;case 31:if(253!==e)break;o.positionTop=n.float();continue;case 32:if(256!==e)break;o.positionRightUnit=n.int32();continue;case 33:if(269!==e)break;o.positionRight=n.float();continue;case 34:if(272!==e)break;o.positionBottomUnit=n.int32();continue;case 35:if(285!==e)break;o.positionBottom=n.float();continue;case 36:if(288!==e)break;o.marginLeftUnit=n.int32();continue;case 37:if(301!==e)break;o.marginLeft=n.float();continue;case 38:if(304!==e)break;o.marginTopUnit=n.int32();continue;case 39:if(317!==e)break;o.marginTop=n.float();continue;case 40:if(320!==e)break;o.marginRightUnit=n.int32();continue;case 41:if(333!==e)break;o.marginRight=n.float();continue;case 42:if(336!==e)break;o.marginBottomUnit=n.int32();continue;case 43:if(349!==e)break;o.marginBottom=n.float();continue;case 44:if(352!==e)break;o.paddingLeftUnit=n.int32();continue;case 45:if(365!==e)break;o.paddingLeft=n.float();continue;case 46:if(368!==e)break;o.paddingTopUnit=n.int32();continue;case 47:if(381!==e)break;o.paddingTop=n.float();continue;case 48:if(384!==e)break;o.paddingRightUnit=n.int32();continue;case 49:if(397!==e)break;o.paddingRight=n.float();continue;case 50:if(400!==e)break;o.paddingBottomUnit=n.int32();continue;case 51:if(413!==e)break;o.paddingBottom=n.float();continue;case 52:if(416!==e)break;o.pointerFilter=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBUiTransform||(PBUiTransform={}));const UiTransformSchema={COMPONENT_ID:1050,serialize(e,t){const n=PBUiTransform.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBUiTransform.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiTransform.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiTransform"}};var VideoState,PBVideoEvent;function createBasePBVideoEvent(){return{timestamp:0,tickNumber:0,currentOffset:0,videoLength:0,state:0}}!function(e){e[e.VS_NONE=0]="VS_NONE",e[e.VS_ERROR=1]="VS_ERROR",e[e.VS_LOADING=2]="VS_LOADING",e[e.VS_READY=3]="VS_READY",e[e.VS_PLAYING=4]="VS_PLAYING",e[e.VS_BUFFERING=5]="VS_BUFFERING",e[e.VS_SEEKING=6]="VS_SEEKING",e[e.VS_PAUSED=7]="VS_PAUSED"}(VideoState||(VideoState={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.timestamp&&t.uint32(8).uint32(e.timestamp),0!==e.tickNumber&&t.uint32(16).uint32(e.tickNumber),0!==e.currentOffset&&t.uint32(29).float(e.currentOffset),0!==e.videoLength&&t.uint32(37).float(e.videoLength),0!==e.state&&t.uint32(40).int32(e.state),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBVideoEvent();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.timestamp=n.uint32();continue;case 2:if(16!==e)break;o.tickNumber=n.uint32();continue;case 3:if(29!==e)break;o.currentOffset=n.float();continue;case 4:if(37!==e)break;o.videoLength=n.float();continue;case 5:if(40!==e)break;o.state=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBVideoEvent||(PBVideoEvent={}));const VideoEventSchema={COMPONENT_ID:1044,serialize(e,t){const n=PBVideoEvent.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBVideoEvent.decode(e.buffer(),e.remainingBytes()),create:()=>PBVideoEvent.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBVideoEvent"}};function createBasePBVideoPlayer(){return{src:"",playing:void 0,position:void 0,volume:void 0,playbackRate:void 0,loop:void 0}}var PBVideoPlayer;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.src&&t.uint32(10).string(e.src),void 0!==e.playing&&t.uint32(16).bool(e.playing),void 0!==e.position&&t.uint32(29).float(e.position),void 0!==e.volume&&t.uint32(37).float(e.volume),void 0!==e.playbackRate&&t.uint32(45).float(e.playbackRate),void 0!==e.loop&&t.uint32(48).bool(e.loop),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBVideoPlayer();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.src=n.string();continue;case 2:if(16!==e)break;o.playing=n.bool();continue;case 3:if(29!==e)break;o.position=n.float();continue;case 4:if(37!==e)break;o.volume=n.float();continue;case 5:if(45!==e)break;o.playbackRate=n.float();continue;case 6:if(48!==e)break;o.loop=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBVideoPlayer||(PBVideoPlayer={}));const VideoPlayerSchema={COMPONENT_ID:1043,serialize(e,t){const n=PBVideoPlayer.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBVideoPlayer.decode(e.buffer(),e.remainingBytes()),create:()=>PBVideoPlayer.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBVideoPlayer"}};function createBaseCameraTransition(){return{transitionMode:void 0}}var CameraTransition,PBVirtualCamera;function createBasePBVirtualCamera(){return{defaultTransition:void 0,lookAtEntity:void 0}}!function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.transitionMode?.$case){case"time":t.uint32(13).float(e.transitionMode.time);break;case"speed":t.uint32(21).float(e.transitionMode.speed)}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseCameraTransition();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;o.transitionMode={$case:"time",time:n.float()};continue;case 2:if(21!==e)break;o.transitionMode={$case:"speed",speed:n.float()};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(CameraTransition||(CameraTransition={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.defaultTransition&&CameraTransition.encode(e.defaultTransition,t.uint32(10).fork()).ldelim(),void 0!==e.lookAtEntity&&t.uint32(16).uint32(e.lookAtEntity),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBVirtualCamera();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.defaultTransition=CameraTransition.decode(n,n.uint32());continue;case 2:if(16!==e)break;o.lookAtEntity=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBVirtualCamera||(PBVirtualCamera={}));const VirtualCameraSchema={COMPONENT_ID:1076,serialize(e,t){const n=PBVirtualCamera.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBVirtualCamera.decode(e.buffer(),e.remainingBytes()),create:()=>PBVirtualCamera.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBVirtualCamera"}};function createBasePBVisibilityComponent(){return{visible:void 0}}var PBVisibilityComponent;!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.visible&&t.uint32(8).bool(e.visible),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBasePBVisibilityComponent();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.visible=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o}}(PBVisibilityComponent||(PBVisibilityComponent={}));const VisibilityComponentSchema={COMPONENT_ID:1081,serialize(e,t){const n=PBVisibilityComponent.encode(e),i=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(i,!1)},deserialize:e=>PBVisibilityComponent.decode(e.buffer(),e.remainingBytes()),create:()=>PBVisibilityComponent.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBVisibilityComponent"}},Animator=e=>e.defineComponentFromSchema("core::Animator",AnimatorSchema),AudioEvent=e=>e.defineValueSetComponentFromSchema("core::AudioEvent",AudioEventSchema,{timestampFunction:e=>e.timestamp,maxElements:100}),AudioSource=e=>e.defineComponentFromSchema("core::AudioSource",AudioSourceSchema),AudioStream=e=>e.defineComponentFromSchema("core::AudioStream",AudioStreamSchema),AvatarAttach=e=>e.defineComponentFromSchema("core::AvatarAttach",AvatarAttachSchema),AvatarBase=e=>e.defineComponentFromSchema("core::AvatarBase",AvatarBaseSchema),AvatarEmoteCommand=e=>e.defineValueSetComponentFromSchema("core::AvatarEmoteCommand",AvatarEmoteCommandSchema,{timestampFunction:e=>e.timestamp,maxElements:100}),AvatarEquippedData=e=>e.defineComponentFromSchema("core::AvatarEquippedData",AvatarEquippedDataSchema),AvatarModifierArea=e=>e.defineComponentFromSchema("core::AvatarModifierArea",AvatarModifierAreaSchema),AvatarShape=e=>e.defineComponentFromSchema("core::AvatarShape",AvatarShapeSchema),Billboard=e=>e.defineComponentFromSchema("core::Billboard",BillboardSchema),CameraMode=e=>e.defineComponentFromSchema("core::CameraMode",CameraModeSchema),CameraModeArea=e=>e.defineComponentFromSchema("core::CameraModeArea",CameraModeAreaSchema),EngineInfo=e=>e.defineComponentFromSchema("core::EngineInfo",EngineInfoSchema),GltfContainer=e=>e.defineComponentFromSchema("core::GltfContainer",GltfContainerSchema),GltfContainerLoadingState=e=>e.defineComponentFromSchema("core::GltfContainerLoadingState",GltfContainerLoadingStateSchema),InputModifier=e=>e.defineComponentFromSchema("core::InputModifier",InputModifierSchema),MainCamera=e=>e.defineComponentFromSchema("core::MainCamera",MainCameraSchema),Material$2=e=>e.defineComponentFromSchema("core::Material",MaterialSchema),MeshCollider$1=e=>e.defineComponentFromSchema("core::MeshCollider",MeshColliderSchema),MeshRenderer$2=e=>e.defineComponentFromSchema("core::MeshRenderer",MeshRendererSchema),NftShape=e=>e.defineComponentFromSchema("core::NftShape",NftShapeSchema),PlayerIdentityData=e=>e.defineComponentFromSchema("core::PlayerIdentityData",PlayerIdentityDataSchema),PointerEvents=e=>e.defineComponentFromSchema("core::PointerEvents",PointerEventsSchema),PointerEventsResult=e=>e.defineValueSetComponentFromSchema("core::PointerEventsResult",PointerEventsResultSchema,{timestampFunction:e=>e.timestamp,maxElements:100}),PointerLock=e=>e.defineComponentFromSchema("core::PointerLock",PointerLockSchema),Raycast=e=>e.defineComponentFromSchema("core::Raycast",RaycastSchema),RaycastResult=e=>e.defineComponentFromSchema("core::RaycastResult",RaycastResultSchema),RealmInfo=e=>e.defineComponentFromSchema("core::RealmInfo",RealmInfoSchema),TextShape=e=>e.defineComponentFromSchema("core::TextShape",TextShapeSchema),Tween$2=e=>e.defineComponentFromSchema("core::Tween",TweenSchema),TweenSequence$1=e=>e.defineComponentFromSchema("core::TweenSequence",TweenSequenceSchema),TweenState=e=>e.defineComponentFromSchema("core::TweenState",TweenStateSchema),UiBackground=e=>e.defineComponentFromSchema("core::UiBackground",UiBackgroundSchema),UiCanvasInformation=e=>e.defineComponentFromSchema("core::UiCanvasInformation",UiCanvasInformationSchema),UiDropdown=e=>e.defineComponentFromSchema("core::UiDropdown",UiDropdownSchema),UiDropdownResult=e=>e.defineComponentFromSchema("core::UiDropdownResult",UiDropdownResultSchema),UiInput=e=>e.defineComponentFromSchema("core::UiInput",UiInputSchema),UiInputResult=e=>e.defineComponentFromSchema("core::UiInputResult",UiInputResultSchema),UiText=e=>e.defineComponentFromSchema("core::UiText",UiTextSchema),UiTransform=e=>e.defineComponentFromSchema("core::UiTransform",UiTransformSchema),VideoEvent=e=>e.defineValueSetComponentFromSchema("core::VideoEvent",VideoEventSchema,{timestampFunction:e=>e.timestamp,maxElements:100}),VideoPlayer=e=>e.defineComponentFromSchema("core::VideoPlayer",VideoPlayerSchema),VirtualCamera=e=>e.defineComponentFromSchema("core::VirtualCamera",VirtualCameraSchema),VisibilityComponent=e=>e.defineComponentFromSchema("core::VisibilityComponent",VisibilityComponentSchema),componentDefinitionByName={"core::Animator":Animator,"core::AudioEvent":AudioEvent,"core::AudioSource":AudioSource,"core::AudioStream":AudioStream,"core::AvatarAttach":AvatarAttach,"core::AvatarBase":AvatarBase,"core::AvatarEmoteCommand":AvatarEmoteCommand,"core::AvatarEquippedData":AvatarEquippedData,"core::AvatarModifierArea":AvatarModifierArea,"core::AvatarShape":AvatarShape,"core::Billboard":Billboard,"core::CameraMode":CameraMode,"core::CameraModeArea":CameraModeArea,"core::EngineInfo":EngineInfo,"core::GltfContainer":GltfContainer,"core::GltfContainerLoadingState":GltfContainerLoadingState,"core::InputModifier":InputModifier,"core::MainCamera":MainCamera,"core::Material":Material$2,"core::MeshCollider":MeshCollider$1,"core::MeshRenderer":MeshRenderer$2,"core::NftShape":NftShape,"core::PlayerIdentityData":PlayerIdentityData,"core::PointerEvents":PointerEvents,"core::PointerEventsResult":PointerEventsResult,"core::PointerLock":PointerLock,"core::Raycast":Raycast,"core::RaycastResult":RaycastResult,"core::RealmInfo":RealmInfo,"core::TextShape":TextShape,"core::Tween":Tween$2,"core::TweenSequence":TweenSequence$1,"core::TweenState":TweenState,"core::UiBackground":UiBackground,"core::UiCanvasInformation":UiCanvasInformation,"core::UiDropdown":UiDropdown,"core::UiDropdownResult":UiDropdownResult,"core::UiInput":UiInput,"core::UiInputResult":UiInputResult,"core::UiText":UiText,"core::UiTransform":UiTransform,"core::VideoEvent":VideoEvent,"core::VideoPlayer":VideoPlayer,"core::VirtualCamera":VirtualCamera,"core::VisibilityComponent":VisibilityComponent},TextureHelper={Common:e=>({tex:{$case:"texture",texture:e}}),Avatar:e=>({tex:{$case:"avatarTexture",avatarTexture:e}}),Video:e=>({tex:{$case:"videoTexture",videoTexture:e}})};function defineMaterialComponent(e){const t=Material$2(e);return{...t,Texture:TextureHelper,setBasicMaterial(e,n){t.createOrReplace(e,{material:{$case:"unlit",unlit:n}})},setPbrMaterial(e,n){t.createOrReplace(e,{material:{$case:"pbr",pbr:n}})}}}function defineMeshColliderComponent(e){const t=MeshCollider$1(e);function n(e){return Array.isArray(e)?e.map((e=>e)).reduce(((e,t)=>e|t),0):e||void 0}return{...t,setBox(e,i){t.createOrReplace(e,{mesh:{$case:"box",box:{}},collisionMask:n(i)})},setPlane(e,i){t.createOrReplace(e,{mesh:{$case:"plane",plane:{}},collisionMask:n(i)})},setCylinder(e,i,o,r){t.createOrReplace(e,{mesh:{$case:"cylinder",cylinder:{radiusBottom:i,radiusTop:o}},collisionMask:n(r)})},setSphere(e,i){t.createOrReplace(e,{mesh:{$case:"sphere",sphere:{}},collisionMask:n(i)})}}}function defineMeshRendererComponent(e){const t=MeshRenderer$2(e);return{...t,setBox(e,n){t.createOrReplace(e,{mesh:{$case:"box",box:{uvs:n||[]}}})},setPlane(e,n){t.createOrReplace(e,{mesh:{$case:"plane",plane:{uvs:n||[]}}})},setCylinder(e,n,i){t.createOrReplace(e,{mesh:{$case:"cylinder",cylinder:{radiusBottom:n,radiusTop:i}}})},setSphere(e){t.createOrReplace(e,{mesh:{$case:"sphere",sphere:{}}})}}}const TweenHelper={Move:e=>({$case:"move",move:e}),Rotate:e=>({$case:"rotate",rotate:e}),Scale:e=>({$case:"scale",scale:e}),TextureMove:e=>({$case:"textureMove",textureMove:e})};function defineTweenComponent(e){return{...Tween$2(e),Mode:TweenHelper}}const IArray=e=>({serialize(t,n){n.writeUint32(t.length);for(const i of t)e.serialize(i,n)},deserialize(t){const n=[],i=t.readUint32();for(let o=0;o<i;o++)n.push(e.deserialize(t));return n},create:()=>[],jsonSchema:{type:"array",items:e.jsonSchema,serializationType:"array"}}),Bool={serialize(e,t){t.writeInt8(e?1:0)},deserialize:e=>1===e.readInt8(),create:()=>!1,jsonSchema:{type:"boolean",serializationType:"boolean"}},Int64={serialize(e,t){t.writeInt64(BigInt(e))},deserialize:e=>Number(e.readInt64()),create:()=>0,jsonSchema:{type:"integer",serializationType:"int64"}},Int32={serialize(e,t){t.writeInt32(e)},deserialize:e=>e.readInt32(),create:()=>0,jsonSchema:{type:"integer",serializationType:"int32"}},Int16={serialize(e,t){t.writeInt16(e)},deserialize:e=>e.readInt16(),create:()=>0,jsonSchema:{type:"integer",serializationType:"int16"}},Int8={serialize(e,t){t.writeInt8(e)},deserialize:e=>e.readInt8(),create:()=>0,jsonSchema:{type:"integer",serializationType:"int8"}},FlatString={serialize(e,t){t.writeUtf8String(e)},deserialize:e=>e.readUtf8String(),create:()=>"",jsonSchema:{type:"string",serializationType:"utf8-string"}},EcsString=FlatString;function validateMemberValuesAreNumbersAndInRangeInt32(e){const t=-(2**31),n=2**31-1;let i=0,o=0;for(const r in e){if("number"==typeof e[r]){if(e[r]>n||e[r]<t)throw new Error("Enum member values must be numbers within the range of -2147483648 to 2147483647.");i++}o++}if(o!==2*i)throw new Error("All enum member values must be of numeric type.")}function validateMemberValuesAreStrings(e){for(const t in e)if("string"!=typeof e[t])throw new Error("All enum member values must be of string type.")}const IntEnumReflectionType="enum-int",IntEnum=(e,t)=>(validateMemberValuesAreNumbersAndInRangeInt32(e),{serialize(e,t){Int32.serialize(e,t)},deserialize:e=>Int32.deserialize(e),create:()=>t,jsonSchema:{type:"integer",enum:Object.values(e).filter((e=>Number.isInteger(e))),default:t,serializationType:IntEnumReflectionType,enumObject:e}}),StringEnumReflectionType="enum-string",StringEnum=(e,t)=>(validateMemberValuesAreStrings(e),{serialize(e,t){FlatString.serialize(e,t)},deserialize:e=>FlatString.deserialize(e),create:()=>t,jsonSchema:{type:"string",enum:Object.values(e),default:t,serializationType:StringEnumReflectionType,enumObject:e}}),Float32={serialize(e,t){t.writeFloat32(e)},deserialize:e=>e.readFloat32(),create:()=>0,jsonSchema:{type:"number",serializationType:"float32"}},Float64={serialize(e,t){t.writeFloat64(e)},deserialize:e=>e.readFloat64(),create:()=>0,jsonSchema:{type:"number",serializationType:"float64"}},Color3Schema={serialize(e,t){t.writeFloat32(e.r),t.writeFloat32(e.g),t.writeFloat32(e.b)},deserialize:e=>({r:e.readFloat32(),g:e.readFloat32(),b:e.readFloat32()}),create:()=>({r:0,g:0,b:0}),jsonSchema:{type:"object",properties:{r:{type:"number"},g:{type:"number"},b:{type:"number"}},serializationType:"color3"}},Color4Schema={serialize(e,t){t.writeFloat32(e.r),t.writeFloat32(e.g),t.writeFloat32(e.b),t.writeFloat32(e.a)},deserialize:e=>({r:e.readFloat32(),g:e.readFloat32(),b:e.readFloat32(),a:e.readFloat32()}),create:()=>({r:0,g:0,b:0,a:0}),jsonSchema:{type:"object",properties:{r:{type:"number"},g:{type:"number"},b:{type:"number"},a:{type:"number"}},serializationType:"color4"}},EntitySchema={serialize(e,t){t.writeInt32(e)},deserialize:e=>e.readInt32(),create:()=>0,jsonSchema:{type:"integer",serializationType:"entity"}},QuaternionSchema={serialize(e,t){t.writeFloat32(e.x),t.writeFloat32(e.y),t.writeFloat32(e.z),t.writeFloat32(e.w)},deserialize:e=>({x:e.readFloat32(),y:e.readFloat32(),z:e.readFloat32(),w:e.readFloat32()}),create:()=>({x:0,y:0,z:0,w:0}),jsonSchema:{type:"object",properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"},w:{type:"number"}},serializationType:"quaternion"}},Vector3Schema={serialize(e,t){t.writeFloat32(e.x),t.writeFloat32(e.y),t.writeFloat32(e.z)},deserialize:e=>({x:e.readFloat32(),y:e.readFloat32(),z:e.readFloat32()}),create:()=>({x:0,y:0,z:0}),jsonSchema:{type:"object",properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"},w:{type:"number"}},serializationType:"vector3"}},IMap=(e,t)=>{const n=Object.keys(e).reduce(((t,n)=>(t[n]=e[n].jsonSchema,t)),{});return{serialize(t,n){for(const i in e)e[i].serialize(t[i],n)},deserialize(t){const n={};for(const i in e)n[i]=e[i].deserialize(t);return n},create(){const n={};for(const t in e)n[t]=e[t].create();return{...n,...t}},extend:n=>{const i={};for(const t in e)i[t]=e[t].create();return{...i,...t,...n}},jsonSchema:{type:"object",properties:n,serializationType:"map"}}},IOptional=e=>({serialize(t,n){t?(n.writeInt8(1),e.serialize(t,n)):n.writeInt8(0)},deserialize(t){if(t.readInt8())return e.deserialize(t)},create(){},jsonSchema:{type:e.jsonSchema.type,serializationType:"optional",optionalJsonSchema:e.jsonSchema}}),IOneOf=e=>{const t=Object.keys(e),n=t.reduce(((e,t,n)=>(e[t]=n,e)),{}),i=t.reduce(((t,n)=>(t[n]=e[n].jsonSchema,t)),{});return{serialize({$case:t,value:i},o){const r=n[t.toString()]+1;o.writeUint8(r),e[t].serialize(i,o)},deserialize(n){const i=t[n.readInt8()-1];return{$case:i,value:e[i].deserialize(n)}},create:()=>({}),jsonSchema:{type:"object",properties:i,serializationType:"one-of"}}},isSchemaType=(e,t)=>t.includes(e.serializationType),isOneOfJsonSchema=e=>isSchemaType(e,["one-of"]),getUnknownSchema=()=>({type:{type:"object",serializationType:"unknown"},value:void 0}),isCompoundType=e=>isSchemaType(e,["array","map"]),getTypeAndValue=(e,t,n)=>{const i=e[n],o=t[n];if(isOneOfJsonSchema(i)){const e=o;if(!e.$case)return getUnknownSchema();const r=i.properties[e.$case];return isCompoundType(r)&&(t[n]={[e.$case]:e.value}),{type:r,value:e.value}}return{type:i,value:o}},primitiveSchemas={[Bool.jsonSchema.serializationType]:Bool,[EcsString.jsonSchema.serializationType]:EcsString,[Float32.jsonSchema.serializationType]:Float32,[Float64.jsonSchema.serializationType]:Float64,[Int8.jsonSchema.serializationType]:Int8,[Int16.jsonSchema.serializationType]:Int16,[Int32.jsonSchema.serializationType]:Int32,[Int64.jsonSchema.serializationType]:Int64,[Vector3Schema.jsonSchema.serializationType]:Vector3Schema,[QuaternionSchema.jsonSchema.serializationType]:QuaternionSchema,[Color3Schema.jsonSchema.serializationType]:Color3Schema,[Color4Schema.jsonSchema.serializationType]:Color4Schema,[EntitySchema.jsonSchema.serializationType]:EntitySchema};function jsonSchemaToSchema(e){if(primitiveSchemas[e.serializationType])return primitiveSchemas[e.serializationType];if("map"===e.serializationType){const t=e,n={};for(const e in t.properties)n[e]=jsonSchemaToSchema(t.properties[e]);return IMap(n)}if("optional"===e.serializationType){return IOptional(jsonSchemaToSchema(e.optionalJsonSchema))}if("array"===e.serializationType){return IArray(jsonSchemaToSchema(e.items))}if("enum-int"===e.serializationType){const t=e;return IntEnum(t.enumObject,t.default)}if("enum-string"===e.serializationType){const t=e;return StringEnum(t.enumObject,t.default)}if("one-of"===e.serializationType){const t=e,n={};for(const e in t.properties)n[e]=jsonSchemaToSchema(t.properties[e]);return IOneOf(n)}throw new Error(`${e.serializationType} is not supported as reverse schema generation.`)}function mutateValues(e,t,n){if("map"===e.serializationType){const{properties:i}=e,o=t;for(const e in i){const{type:t,value:r}=getTypeAndValue(i,o,e);if("unknown"!==t.serializationType)if(isCompoundType(t))mutateValues(t,r,n);else{const i=n(r,t);i.changed&&(o[e]=i.value)}}}else if("array"===e.serializationType){const{items:i}=e,o=t;for(let e=0,t=o.length;e<t;e++){const{type:t,value:r}=getTypeAndValue({items:i},{items:o[e]},"items");if(isCompoundType(t))mutateValues(t,r,n);else{const i=n(r,t);i.changed&&(o[e]=i.value)}}}}var Schemas;function defineNameComponent(e){return e.defineComponent("core-schema::Name",{value:Schemas.String})}function defineNetworkEntityComponent(e){return e.defineComponent("core-schema::Network-Entity",{networkId:Schemas.Int64,entityId:Schemas.Entity})}function defineNetworkParentComponent(e){return e.defineComponent("core-schema::Network-Parent",{networkId:Schemas.Int64,entityId:Schemas.Entity})}!function(e){e.Boolean=Bool,e.String=EcsString,e.Float=Float32,e.Double=Float64,e.Byte=Int8,e.Short=Int16,e.Int=Int32,e.Int64=Int64,e.Number=Float32,e.Vector3=Vector3Schema,e.Quaternion=QuaternionSchema,e.Color3=Color3Schema,e.Color4=Color4Schema,e.Entity=EntitySchema,e.EnumNumber=IntEnum,e.EnumString=StringEnum,e.Array=IArray,e.Map=IMap,e.Optional=IOptional,e.OneOf=IOneOf,e.fromJson=jsonSchemaToSchema,e.mutateNestedValues=mutateValues}(Schemas||(Schemas={}));const TRANSFORM_LENGTH=44,TransformSchema={serialize(e,t){const n=t.incrementWriteOffset(TRANSFORM_LENGTH);t.setFloat32(n,e.position.x),t.setFloat32(n+4,e.position.y),t.setFloat32(n+8,e.position.z),t.setFloat32(n+12,e.rotation.x),t.setFloat32(n+16,e.rotation.y),t.setFloat32(n+20,e.rotation.z),t.setFloat32(n+24,e.rotation.w),t.setFloat32(n+28,e.scale.x),t.setFloat32(n+32,e.scale.y),t.setFloat32(n+36,e.scale.z),t.setUint32(n+40,e.parent||0)},deserialize(e){const t=e.incrementReadOffset(TRANSFORM_LENGTH);return{position:{x:e.getFloat32(t),y:e.getFloat32(t+4),z:e.getFloat32(t+8)},rotation:{x:e.getFloat32(t+12),y:e.getFloat32(t+16),z:e.getFloat32(t+20),w:e.getFloat32(t+24)},scale:{x:e.getFloat32(t+28),y:e.getFloat32(t+32),z:e.getFloat32(t+36)},parent:e.getUint32(t+40)}},create:()=>({position:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},rotation:{x:0,y:0,z:0,w:1},parent:0}),extend:e=>({position:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},rotation:{x:0,y:0,z:0,w:1},parent:0,...e}),jsonSchema:{type:"object",properties:{position:{type:"object",properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"}}},scale:{type:"object",properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"}}},rotation:{type:"object",properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"},w:{type:"number"}}},parent:{type:"integer"}},serializationType:"transform"}};function defineTransformComponent(e){const t=e.defineComponentFromSchema("core::Transform",TransformSchema);return{...t,create:(e,n)=>t.create(e,TransformSchema.extend(n)),createOrReplace:(e,n)=>t.createOrReplace(e,TransformSchema.extend(n))}}var MediaState;!function(e){e[e.MS_NONE=0]="MS_NONE",e[e.MS_ERROR=1]="MS_ERROR",e[e.MS_LOADING=2]="MS_LOADING",e[e.MS_READY=3]="MS_READY",e[e.MS_PLAYING=4]="MS_PLAYING",e[e.MS_BUFFERING=5]="MS_BUFFERING",e[e.MS_SEEKING=6]="MS_SEEKING",e[e.MS_PAUSED=7]="MS_PAUSED"}(MediaState||(MediaState={}));const Transform$1=e=>defineTransformComponent(e),Material$1=e=>defineMaterialComponent(e),MeshRenderer$1=e=>defineMeshRendererComponent(e),MeshCollider=e=>defineMeshColliderComponent(e),Tween$1=e=>defineTweenComponent(e),Name=e=>defineNameComponent(e),NetworkEntity=e=>defineNetworkEntityComponent(e),NetworkParent=e=>defineNetworkParentComponent(e),coreComponentMappings={"core::Transform":1,"core::Animator":1042,"core::AudioEvent":1105,"core::AudioSource":1020,"core::AudioStream":1021,"core::AvatarAttach":1073,"core::AvatarBase":1087,"core::AvatarEmoteCommand":1088,"core::AvatarEquippedData":1091,"core::AvatarModifierArea":1070,"core::AvatarShape":1080,"core::Billboard":1090,"core::CameraMode":1072,"core::CameraModeArea":1071,"core::EngineInfo":1048,"core::GltfContainer":1041,"core::GltfContainerLoadingState":1049,"core::InputModifier":1078,"core::MainCamera":1075,"core::MapPin":1097,"core::Material":1017,"core::MeshCollider":1019,"core::MeshRenderer":1018,"core::NftShape":1040,"core::PlayerIdentityData":1089,"core::PointerEvents":1062,"core::PointerEventsResult":1063,"core::PointerLock":1074,"core::Raycast":1067,"core::RaycastResult":1068,"core::RealmInfo":1106,"core::TextShape":1030,"core::Tween":1102,"core::TweenSequence":1104,"core::TweenState":1103,"core::UiBackground":1053,"core::UiCanvasInformation":1054,"core::UiDropdown":1094,"core::UiDropdownResult":1096,"core::UiInput":1093,"core::UiInputResult":1095,"core::UiText":1052,"core::UiTransform":1050,"core::VideoEvent":1044,"core::VideoPlayer":1043,"core::VirtualCamera":1076,"core::VisibilityComponent":1081},CRC_TABLE=new Int32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function _crc32(e,t){let n=~t;for(let t=0;t<e.length;t++)n=CRC_TABLE[255&(n^e[t])]^n>>>8;return~n}function unsignedCRC32(e,t=0){return _crc32(e,t)>>>0}const MAX_STATIC_COMPONENT=2048;function componentNumberFromName(e){if(coreComponentMappings[e])return coreComponentMappings[e];const t=new Uint8Array(128);return utf8$2.write(e,t,0),(unsignedCRC32(t)+MAX_STATIC_COMPONENT&4294967295)>>>0}const __DEV__="boolean"==typeof DEBUG&&DEBUG||"object"==typeof process&&("production"!==process.env?.NODE_ENV||"development"===process.env?.NODE_ENV)||!1;function checkNotThenable(e,t){if(__DEV__&&e&&"object"==typeof e&&"function"==typeof e.then)throw new Error(t);return e}function createVersionGSet(){const e=new Map;return{addTo(t,n){if(n<0)return!1;const i=e.get(t);return void 0!==i&&i>=n||e.set(t,n),!0},has(t,n){const i=e.get(t);return void 0!==i&&i>=n},getMap:()=>e}}const MAX_U16=65535,MASK_UPPER_16_ON_32=4294901760,MAX_ENTITY_NUMBER=MAX_U16,RESERVED_STATIC_ENTITIES=512;var EntityUtils,EntityState;function createEntityContainer(e){const t=e?.reservedStaticEntities??RESERVED_STATIC_ENTITIES;let n=t;const i=new Set;let o=[];const r=createVersionGSet();function a(){if(n>MAX_ENTITY_NUMBER-1)throw new Error(`It fails trying to generate an entity out of range ${MAX_ENTITY_NUMBER}.`);const e=n++,t=r.getMap().has(e)?r.getMap().get(e)+1:0,o=EntityUtils.toEntityId(e,t);return i.has(o)?a():(i.add(o),o)}function s(e){const[t,n]=EntityUtils.fromEntityId(e);r.addTo(t,n);for(let e=0;e<=n;e++)i.delete(EntityUtils.toEntityId(t,e));return!0}return{generateEntity:function(){if(i.size+t>=n)return a();for(const[e,t]of r.getMap())if(t<MAX_U16){const n=EntityUtils.toEntityId(e,t+1);if(!i.has(n)&&!o.includes(n))return i.add(n),n}return a()},removeEntity:function(e){return!(e<t)&&(i.has(e)?(i.delete(e),o.push(e)):s(e),!0)},getExistingEntities:()=>new Set(i),getEntityState:function(e){const[n,o]=EntityUtils.fromEntityId(e);if(n<t)return EntityState.Reserved;if(i.has(e))return EntityState.UsedEntity;const a=r.getMap().get(n);return void 0!==a&&a>=o?EntityState.Removed:EntityState.Unknown},releaseRemovedEntities:function(){const e=o;if(e.length){o=[];for(const t of e){const[e,n]=EntityUtils.fromEntityId(t);r.addTo(e,n)}}return e},updateRemovedEntity:s,updateUsedEntity:function(e){const[t,n]=EntityUtils.fromEntityId(e);if(r.has(t,n))return!1;if(n>0){for(let e=0;e<=n-1;e++)i.delete(EntityUtils.toEntityId(t,e));r.addTo(t,n-1)}return i.add(e),!0}}}!function(e){e.fromEntityId=function(e){return[(e&MAX_U16)>>>0,((e&MASK_UPPER_16_ON_32)>>16&MAX_U16)>>>0]},e.toEntityId=function(e,t){return(e&MAX_U16|(t&MAX_U16)<<16)>>>0}}(EntityUtils||(EntityUtils={})),function(e){e[e.Unknown=0]="Unknown",e[e.UsedEntity=1]="UsedEntity",e[e.Removed=2]="Removed",e[e.Reserved=3]="Reserved"}(EntityState||(EntityState={}));var __classPrivateFieldGet=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},_ReadWriteByteBuffer_instances,_ReadWriteByteBuffer_woAdd,_ReadWriteByteBuffer_roAdd;function getNextSize(e,t){const n=Math.max(e,t)+1024;return 1024*Math.ceil(n/1024)}const defaultInitialCapacity=10240;class ReadWriteByteBuffer{constructor(e,t,n){_ReadWriteByteBuffer_instances.add(this),this._buffer=e||new Uint8Array(defaultInitialCapacity),this.view=new DataView(this._buffer.buffer,this._buffer.byteOffset),this.woffset=n??(e?this._buffer.length:null)??0,this.roffset=t??0}buffer(){return this._buffer}bufferLength(){return this._buffer.length}resetBuffer(){this.roffset=0,this.woffset=0}currentReadOffset(){return this.roffset}currentWriteOffset(){return this.woffset}incrementReadOffset(e){return __classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,e)}remainingBytes(){return this.woffset-this.roffset}readFloat32(){return this.view.getFloat32(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,4),!0)}readFloat64(){return this.view.getFloat64(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,8),!0)}readInt8(){return this.view.getInt8(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,1))}readInt16(){return this.view.getInt16(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,2),!0)}readInt32(){return this.view.getInt32(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,4),!0)}readInt64(){return this.view.getBigInt64(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,8),!0)}readUint8(){return this.view.getUint8(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,1))}readUint16(){return this.view.getUint16(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,2),!0)}readUint32(){return this.view.getUint32(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,4),!0)}readUint64(){return this.view.getBigUint64(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,8),!0)}readBuffer(){const e=this.view.getUint32(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,4),!0);return this._buffer.subarray(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,e),__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,0))}readUtf8String(){const e=this.view.getUint32(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,4),!0);return utf8$2.read(this._buffer,__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,e),__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,0))}incrementWriteOffset(e){return __classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,e)}toBinary(){return this._buffer.subarray(0,this.woffset)}toCopiedBinary(){return new Uint8Array(this.toBinary())}writeBuffer(e,t=!0){t&&this.writeUint32(e.byteLength);const n=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,e.byteLength);this._buffer.set(e,n)}writeUtf8String(e,t=!0){const n=utf8$2.length(e);t&&this.writeUint32(n);const i=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,n);utf8$2.write(e,this._buffer,i)}writeFloat32(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,4);this.view.setFloat32(t,e,!0)}writeFloat64(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,8);this.view.setFloat64(t,e,!0)}writeInt8(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,1);this.view.setInt8(t,e)}writeInt16(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,2);this.view.setInt16(t,e,!0)}writeInt32(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,4);this.view.setInt32(t,e,!0)}writeInt64(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,8);this.view.setBigInt64(t,e,!0)}writeUint8(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,1);this.view.setUint8(t,e)}writeUint16(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,2);this.view.setUint16(t,e,!0)}writeUint32(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,4);this.view.setUint32(t,e,!0)}writeUint64(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,8);this.view.setBigUint64(t,e,!0)}getFloat32(e){return this.view.getFloat32(e,!0)}getFloat64(e){return this.view.getFloat64(e,!0)}getInt8(e){return this.view.getInt8(e)}getInt16(e){return this.view.getInt16(e,!0)}getInt32(e){return this.view.getInt32(e,!0)}getInt64(e){return this.view.getBigInt64(e,!0)}getUint8(e){return this.view.getUint8(e)}getUint16(e){return this.view.getUint16(e,!0)}getUint32(e){return this.view.getUint32(e,!0)}getUint64(e){return this.view.getBigUint64(e,!0)}setFloat32(e,t){this.view.setFloat32(e,t,!0)}setFloat64(e,t){this.view.setFloat64(e,t,!0)}setInt8(e,t){this.view.setInt8(e,t)}setInt16(e,t){this.view.setInt16(e,t,!0)}setInt32(e,t){this.view.setInt32(e,t,!0)}setInt64(e,t){this.view.setBigInt64(e,t,!0)}setUint8(e,t){this.view.setUint8(e,t)}setUint16(e,t){this.view.setUint16(e,t,!0)}setUint32(e,t){this.view.setUint32(e,t,!0)}setUint64(e,t){this.view.setBigUint64(e,t,!0)}}var CrdtMessageType;_ReadWriteByteBuffer_instances=new WeakSet,_ReadWriteByteBuffer_woAdd=function(e){if(this.woffset+e>this._buffer.byteLength){const t=getNextSize(this._buffer.byteLength,this.woffset+e),n=new Uint8Array(t);n.set(this._buffer);const i=this._buffer.byteOffset;this._buffer=n,this.view=new DataView(this._buffer.buffer,i)}return this.woffset+=e,this.woffset-e},_ReadWriteByteBuffer_roAdd=function(e){if(this.roffset+e>this.woffset)throw new Error("Outside of the bounds of writen data.");return this.roffset+=e,this.roffset-e},function(e){e[e.RESERVED=0]="RESERVED",e[e.PUT_COMPONENT=1]="PUT_COMPONENT",e[e.DELETE_COMPONENT=2]="DELETE_COMPONENT",e[e.DELETE_ENTITY=3]="DELETE_ENTITY",e[e.APPEND_VALUE=4]="APPEND_VALUE",e[e.PUT_COMPONENT_NETWORK=5]="PUT_COMPONENT_NETWORK",e[e.DELETE_COMPONENT_NETWORK=6]="DELETE_COMPONENT_NETWORK",e[e.DELETE_ENTITY_NETWORK=7]="DELETE_ENTITY_NETWORK",e[e.MAX_MESSAGE_TYPE=8]="MAX_MESSAGE_TYPE"}(CrdtMessageType||(CrdtMessageType={}));const CRDT_MESSAGE_HEADER_LENGTH=8;var ProcessMessageResultType,CrdtMessageProtocol,DeleteComponent,AppendValueOperation,DeleteEntity,PutComponentOperation,PutNetworkComponentOperation,DeleteComponentNetwork,DeleteEntityNetwork;function isNetworkMessage(e){return[CrdtMessageType.DELETE_COMPONENT_NETWORK,CrdtMessageType.DELETE_ENTITY_NETWORK,CrdtMessageType.PUT_COMPONENT_NETWORK].includes(e.type)}function networkMessageToLocal(e,t,n,i){const o=n.currentWriteOffset();e.type===CrdtMessageType.PUT_COMPONENT_NETWORK?PutComponentOperation.write(t,e.timestamp,e.componentId,e.data,n):e.type===CrdtMessageType.DELETE_COMPONENT_NETWORK?DeleteComponent.write(t,e.componentId,e.timestamp,n):e.type===CrdtMessageType.DELETE_ENTITY_NETWORK&&DeleteEntity.write(t,n),i.writeBuffer(n.buffer().subarray(o,n.currentWriteOffset()),!1)}function localMessageToNetwork(e,t,n,i){const o=n.currentWriteOffset();e.type===CrdtMessageType.PUT_COMPONENT?PutNetworkComponentOperation.write(t.entityId,e.timestamp,e.componentId,t.networkId,e.data,n):e.type===CrdtMessageType.DELETE_COMPONENT?DeleteComponentNetwork.write(t.entityId,e.componentId,e.timestamp,t.networkId,n):e.type===CrdtMessageType.DELETE_ENTITY&&DeleteEntityNetwork.write(t.entityId,t.networkId,n),i.writeBuffer(n.buffer().subarray(o,n.currentWriteOffset()),!1)}!function(e){e[e.StateUpdatedTimestamp=1]="StateUpdatedTimestamp",e[e.StateOutdatedTimestamp=2]="StateOutdatedTimestamp",e[e.NoChanges=3]="NoChanges",e[e.StateOutdatedData=4]="StateOutdatedData",e[e.StateUpdatedData=5]="StateUpdatedData",e[e.EntityWasDeleted=6]="EntityWasDeleted",e[e.EntityDeleted=7]="EntityDeleted"}(ProcessMessageResultType||(ProcessMessageResultType={})),function(e){function t(e){const t=e.remainingBytes();if(t<CRDT_MESSAGE_HEADER_LENGTH)return!1;return!(t<e.getUint32(e.currentReadOffset()))}function n(e){if(!t(e))return null;const n=e.currentReadOffset();return{length:e.getUint32(n),type:e.getUint32(n+4)}}e.validate=t,e.readHeader=function(e){return t(e)?{length:e.readUint32(),type:e.readUint32()}:null},e.getHeader=n,e.consumeMessage=function(e){const t=n(e);return!!t&&(e.incrementReadOffset(t.length),!0)}}(CrdtMessageProtocol||(CrdtMessageProtocol={})),function(e){e.MESSAGE_HEADER_LENGTH=12,e.write=function(t,n,i,o){const r=CRDT_MESSAGE_HEADER_LENGTH+e.MESSAGE_HEADER_LENGTH,a=o.incrementWriteOffset(r);o.setUint32(a,r),o.setUint32(a+4,CrdtMessageType.DELETE_COMPONENT),o.setUint32(a+8,t),o.setUint32(a+12,n),o.setUint32(a+16,i)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.DELETE_COMPONENT)throw new Error("DeleteComponentOperation tried to read another message type.");return{...t,entityId:e.readUint32(),componentId:e.readUint32(),timestamp:e.readUint32()}}}(DeleteComponent||(DeleteComponent={})),function(e){e.MESSAGE_HEADER_LENGTH=16,e.write=function(t,n,i,o,r){const a=r.incrementWriteOffset(CRDT_MESSAGE_HEADER_LENGTH+e.MESSAGE_HEADER_LENGTH);r.writeBuffer(o,!1);const s=r.currentWriteOffset()-a;r.setUint32(a,s),r.setUint32(a+4,CrdtMessageType.APPEND_VALUE),r.setUint32(a+8,t),r.setUint32(a+12,i),r.setUint32(a+16,n);const c=s-e.MESSAGE_HEADER_LENGTH-CRDT_MESSAGE_HEADER_LENGTH;r.setUint32(a+20,c)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.APPEND_VALUE)throw new Error("AppendValueOperation tried to read another message type.");return{...t,entityId:e.readUint32(),componentId:e.readUint32(),timestamp:e.readUint32(),data:e.readBuffer()}}}(AppendValueOperation||(AppendValueOperation={})),function(e){e.MESSAGE_HEADER_LENGTH=4,e.write=function(e,t){t.writeUint32(CRDT_MESSAGE_HEADER_LENGTH+4),t.writeUint32(CrdtMessageType.DELETE_ENTITY),t.writeUint32(e)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.DELETE_ENTITY)throw new Error("DeleteEntity tried to read another message type.");return{...t,entityId:e.readUint32()}}}(DeleteEntity||(DeleteEntity={})),function(e){e.MESSAGE_HEADER_LENGTH=16,e.write=function(t,n,i,o,r){const a=r.incrementWriteOffset(CRDT_MESSAGE_HEADER_LENGTH+e.MESSAGE_HEADER_LENGTH);r.writeBuffer(o,!1);const s=r.currentWriteOffset()-a;r.setUint32(a,s),r.setUint32(a+4,CrdtMessageType.PUT_COMPONENT),r.setUint32(a+8,t),r.setUint32(a+12,i),r.setUint32(a+16,n);const c=s-e.MESSAGE_HEADER_LENGTH-CRDT_MESSAGE_HEADER_LENGTH;r.setUint32(a+20,c)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.PUT_COMPONENT)throw new Error("PutComponentOperation tried to read another message type.");return{...t,entityId:e.readUint32(),componentId:e.readUint32(),timestamp:e.readUint32(),data:e.readBuffer()}}}(PutComponentOperation||(PutComponentOperation={})),function(e){e.MESSAGE_HEADER_LENGTH=20,e.write=function(t,n,i,o,r,a){const s=a.incrementWriteOffset(CRDT_MESSAGE_HEADER_LENGTH+e.MESSAGE_HEADER_LENGTH);a.writeBuffer(r,!1);const c=a.currentWriteOffset()-s;a.setUint32(s,c),a.setUint32(s+4,CrdtMessageType.PUT_COMPONENT_NETWORK),a.setUint32(s+8,t),a.setUint32(s+12,i),a.setUint32(s+16,n),a.setUint32(s+20,o);const u=c-e.MESSAGE_HEADER_LENGTH-CRDT_MESSAGE_HEADER_LENGTH;a.setUint32(s+24,u)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.PUT_COMPONENT_NETWORK)throw new Error("PutComponentNetworkOperation tried to read another message type.");return{...t,entityId:e.readUint32(),componentId:e.readUint32(),timestamp:e.readUint32(),networkId:e.readUint32(),data:e.readBuffer()}}}(PutNetworkComponentOperation||(PutNetworkComponentOperation={})),function(e){e.MESSAGE_HEADER_LENGTH=16,e.write=function(t,n,i,o,r){const a=CRDT_MESSAGE_HEADER_LENGTH+e.MESSAGE_HEADER_LENGTH,s=r.incrementWriteOffset(a);r.setUint32(s,a),r.setUint32(s+4,CrdtMessageType.DELETE_COMPONENT_NETWORK),r.setUint32(s+8,t),r.setUint32(s+12,n),r.setUint32(s+16,i),r.setUint32(s+20,o)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.DELETE_COMPONENT_NETWORK)throw new Error("DeleteComponentOperation tried to read another message type.");return{...t,entityId:e.readUint32(),componentId:e.readUint32(),timestamp:e.readUint32(),networkId:e.readUint32()}}}(DeleteComponentNetwork||(DeleteComponentNetwork={})),function(e){e.MESSAGE_HEADER_LENGTH=8,e.write=function(e,t,n){n.writeUint32(CRDT_MESSAGE_HEADER_LENGTH+4),n.writeUint32(CrdtMessageType.DELETE_ENTITY_NETWORK),n.writeUint32(e),n.writeUint32(t)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.DELETE_ENTITY_NETWORK)throw new Error("DeleteEntityNetwork tried to read another message type.");return{...t,entityId:e.readUint32(),networkId:e.readUint32()}}}(DeleteEntityNetwork||(DeleteEntityNetwork={}));const buffer=new ReadWriteByteBuffer;function fixTransformParent(e,t,n){buffer.resetBuffer();let i=t;if(!i&&"data"in e&&(i=TransformSchema.deserialize(new ReadWriteByteBuffer(e.data))),!i)throw new Error("Invalid parent transform");const o={...i,parent:n};return TransformSchema.serialize(o,buffer),buffer.toBinary()}function crdtSceneSystem(e,t){const n=[],i=NetworkEntity(e),o=NetworkParent(e),r=Transform$1(e),a=[],s=[];function c(e){return e.splice(0,e.length)}function u(t){if("networkId"in t)for(const[n,o]of e.getEntitiesWith(i))if(o.networkId===t.networkId&&o.entityId===t.entityId)return{entityId:n,network:o};return{entityId:t.entityId}}return{sendMessages:async function(a){const l=c(s),f=new ReadWriteByteBuffer;for(const i of e.componentsIter())for(const e of i.getCrdtUpdates()){const o=f.currentWriteOffset();if(n.some((t=>t.filter(e)))&&(e.type===CrdtMessageType.PUT_COMPONENT?PutComponentOperation.write(e.entityId,e.timestamp,e.componentId,e.data,f):e.type===CrdtMessageType.DELETE_COMPONENT?DeleteComponent.write(e.entityId,i.componentId,e.timestamp,f):e.type===CrdtMessageType.APPEND_VALUE&&AppendValueOperation.write(e.entityId,e.timestamp,e.componentId,e.data,f),l.push({...e,messageBuffer:f.buffer().subarray(o,f.currentWriteOffset())})),t){const n=e.type===CrdtMessageType.PUT_COMPONENT||e.type===CrdtMessageType.APPEND_VALUE?i.get(e.entityId):void 0;t(e.entityId,e.type,i,n)}}for(const e of a){const n=f.currentWriteOffset();DeleteEntity.write(e,f),l.push({type:CrdtMessageType.DELETE_ENTITY,entityId:e,messageBuffer:f.buffer().subarray(n,f.currentWriteOffset())}),t&&t(e,CrdtMessageType.DELETE_ENTITY)}const d=new ReadWriteByteBuffer;for(const e in n){const t=13,a=[],s=Number(e),c=n[s],f="renderer"===c.type,h="network"===c.type;d.resetBuffer();const p=new ReadWriteByteBuffer;for(const e of l){if(h&&d.toBinary().byteLength/1024>t&&(a.push(d.toBinary()),d.resetBuffer()),e.transportId===s)continue;if(!c.filter(e))continue;const{entityId:n}=u(e),l="componentId"in e&&e.componentId===r.componentId&&r.has(n)&&o.has(n)&&i.has(n);if(f&&e.type===CrdtMessageType.PUT_COMPONENT&&l){const t=u(o.get(n)),i=fixTransformParent(e,r.get(n),t.entityId),a=p.currentWriteOffset();PutComponentOperation.write(n,e.timestamp,e.componentId,i,p),d.writeBuffer(p.buffer().subarray(a,p.currentWriteOffset()),!1)}else if(f&&isNetworkMessage(e)){let t="data"in e?e.data:new Uint8Array;if(l){const i=u(o.get(n));t=fixTransformParent(e,r.get(n),i.entityId)}networkMessageToLocal({...e,data:t},n,p,d)}else{if(h&&!isNetworkMessage(e)){const t=i.getOrNull(e.entityId);if(t){localMessageToNetwork(e,t,p,d);continue}}d.writeBuffer(e.messageBuffer,!1)}}h&&d.currentWriteOffset()&&a.push(d.toBinary());const m=h?a:d.toBinary();await c.send(m)}},receiveMessages:async function(){const n=c(a),l=[];for(const a of n){let{entityId:n,network:c}=u(a);if(isNetworkMessage(a)&&!c&&(n=e.addEntity(),c={entityId:a.entityId,networkId:a.networkId},i.createOrReplace(n,c)),a.type===CrdtMessageType.DELETE_ENTITY||a.type===CrdtMessageType.DELETE_ENTITY_NETWORK)l.push(n),s.push(a);else{const c=e.entityContainer.getEntityState(n);if(c===EntityState.Removed)continue;c===EntityState.Unknown&&e.entityContainer.updateUsedEntity(n);const u=e.getComponentOrNull(a.componentId);if(u){a.type===CrdtMessageType.PUT_COMPONENT&&u.componentId===r.componentId&&i.has(n)&&o.has(n)&&(a.data=fixTransformParent(a));const[e,c]=u.updateFromCrdt({...a,entityId:n});e||(s.push(a),t&&t(n,a.type,u,c))}else s.push(a)}}for(const n of l){for(const t of e.componentsIter())t.entityDeleted(n,!0);e.entityContainer.updateRemovedEntity(n),t&&t(n,CrdtMessageType.DELETE_ENTITY)}},addTransport:function(e){const t=n.push(e)-1;var i;e.onmessage=(i=t,function(e){const t=new ReadWriteByteBuffer(e);let n;for(;n=CrdtMessageProtocol.getHeader(t);){const e=t.currentReadOffset();let o;n.type===CrdtMessageType.DELETE_COMPONENT?o=DeleteComponent.read(t):n.type===CrdtMessageType.DELETE_COMPONENT_NETWORK?o=DeleteComponentNetwork.read(t):n.type===CrdtMessageType.PUT_COMPONENT?o=PutComponentOperation.read(t):n.type===CrdtMessageType.PUT_COMPONENT_NETWORK?o=PutNetworkComponentOperation.read(t):n.type===CrdtMessageType.DELETE_ENTITY?o=DeleteEntity.read(t):n.type===CrdtMessageType.DELETE_ENTITY_NETWORK?o=DeleteEntityNetwork.read(t):n.type===CrdtMessageType.APPEND_VALUE?o=AppendValueOperation.read(t):t.incrementReadOffset(n.length),o&&a.push({...o,transportId:i,messageBuffer:t.buffer().subarray(e,t.currentReadOffset())})}})}}}var CrdtUtils;function dataCompare(e,t){if(e===t)return 0;if(null===e&&null!==t)return-1;if(null!==e&&null===t)return 1;if(e instanceof Uint8Array&&t instanceof Uint8Array){const n=e.byteLength-t.byteLength;if(0!==n)return n>0?1:-1;let i;for(let n=0,o=e.byteLength;n<o;n++)if(i=e[n]-t[n],0!==i)return i>0?1:-1;return 0}if("string"==typeof e){const n=e.length-t.length;return 0!==n?n>0?1:-1:e.localeCompare(t)}return e>t?1:-1}function deepReadonly(e){return Object.freeze({...e})}function incrementTimestamp(e,t){const n=(t.get(e)||0)+1;return t.set(e,n),n}function createDumpLwwFunctionFromCrdt(e,t,n,i){return function(o,r){for(const[a,s]of t)if(!r||r(a))if(i.has(a)){const t=i.get(a),r=new ReadWriteByteBuffer;n.serialize(t,r),PutComponentOperation.write(a,s,e,r.toBinary(),o)}else DeleteComponent.write(a,e,s,o)}}function createUpdateLwwFromCrdt(e,t,n,i){return o=>{if(o.type!==CrdtMessageType.PUT_COMPONENT&&o.type!==CrdtMessageType.PUT_COMPONENT_NETWORK&&o.type!==CrdtMessageType.DELETE_COMPONENT&&o.type!==CrdtMessageType.DELETE_COMPONENT_NETWORK)return[null,i.get(o.entityId)];const r=function(e){const{entityId:o,timestamp:r}=e,a=t.get(o);if(void 0===a||a<r)return ProcessMessageResultType.StateUpdatedTimestamp;if(a>r)return ProcessMessageResultType.StateOutdatedTimestamp;if(e.type===CrdtMessageType.DELETE_COMPONENT&&!i.has(o))return ProcessMessageResultType.NoChanges;let s=0;if(i.has(o)){const t=new ReadWriteByteBuffer;n.serialize(i.get(o),t),s=dataCompare(t.toBinary(),e.data||null)}else s=dataCompare(null,e.data);return 0===s?ProcessMessageResultType.NoChanges:s>0?ProcessMessageResultType.StateOutdatedData:ProcessMessageResultType.StateUpdatedData}(o),a=o.entityId;switch(r){case ProcessMessageResultType.StateUpdatedData:case ProcessMessageResultType.StateUpdatedTimestamp:if(t.set(a,o.timestamp),o.type===CrdtMessageType.PUT_COMPONENT||o.type===CrdtMessageType.PUT_COMPONENT_NETWORK){const e=new ReadWriteByteBuffer(o.data);i.set(a,n.deserialize(e))}else i.delete(a);return[null,i.get(a)];case ProcessMessageResultType.StateOutdatedTimestamp:case ProcessMessageResultType.StateOutdatedData:if(i.has(a)){const o=new ReadWriteByteBuffer;return n.serialize(i.get(a),o),[{type:CrdtMessageType.PUT_COMPONENT,componentId:e,data:o.toBinary(),entityId:a,timestamp:t.get(a)},i.get(a)]}return[{type:CrdtMessageType.DELETE_COMPONENT,componentId:e,entityId:a,timestamp:t.get(a)},void 0]}return[null,i.get(a)]}}function createGetCrdtMessagesForLww(e,t,n,i,o){return function*(){for(const r of n){const n=incrementTimestamp(r,t);if(o.has(r)){const t=new ReadWriteByteBuffer;i.serialize(o.get(r),t);const a={type:CrdtMessageType.PUT_COMPONENT,componentId:e,entityId:r,data:t.toBinary(),timestamp:n};yield a}else{const t={type:CrdtMessageType.DELETE_COMPONENT,componentId:e,entityId:r,timestamp:n};yield t}}n.clear()}}function createComponentDefinitionFromSchema(e,t,n){const i=new Map,o=new Set,r=new Map,a=new Map;return{get componentId(){return t},get componentName(){return e},get componentType(){return 0},schema:n,has:e=>i.has(e),deleteFrom(e,t=!0){const n=i.get(e);return i.delete(e)&&t&&o.add(e),n||null},entityDeleted(e,t){i.delete(e)&&t&&o.add(e)},getOrNull(e){const t=i.get(e);return t?deepReadonly(t):null},get(t){const n=i.get(t);if(!n)throw new Error(`[getFrom] Component ${e} for entity #${t} not found`);return deepReadonly(n)},create(t,r){if(i.get(t))throw new Error(`[create] Component ${e} for ${t} already exists`);const a=void 0===r?n.create():n.extend?n.extend(r):r;return i.set(t,a),o.add(t),a},createOrReplace(e,t){const r=void 0===t?n.create():n.extend?n.extend(t):t;return i.set(e,r),o.add(e),r},getMutableOrNull(e){const t=i.get(e);return t?(o.add(e),t):null},getOrCreateMutable(e,t){const n=i.get(e);return n?(o.add(e),n):this.create(e,t)},getMutable(t){const n=this.getMutableOrNull(t);if(null===n)throw new Error(`[mutable] Component ${e} for ${t} not found`);return n},*iterator(){for(const[e,t]of i)yield[e,t]},*dirtyIterator(){for(const e of o)yield e},getCrdtUpdates:createGetCrdtMessagesForLww(t,r,o,n,i),updateFromCrdt:createUpdateLwwFromCrdt(t,r,n,i),dumpCrdtStateToBuffer:createDumpLwwFunctionFromCrdt(t,r,n,i),onChange(e,t){const n=a.get(e)??[];n.push(t),a.set(e,n)},__onChangeCallbacks(e,t){const n=a.get(e);if(n)for(const e of n)e(t)}}}!function(e){var t;(t=e.SynchronizedEntityType||(e.SynchronizedEntityType={}))[t.NETWORKED=0]="NETWORKED",t[t.RENDERER=1]="RENDERER"}(CrdtUtils||(CrdtUtils={}));const SYSTEMS_REGULAR_PRIORITY=1e5;function SystemContainer(){const e=[];function t(){e.sort(((e,t)=>t.priority-e.priority))}return{add:function(n,i,o){const r=o??n.name;if(e.find((e=>e.fn===n)))throw new Error(`System ${JSON.stringify(r)} already added to the engine`);e.push({fn:n,priority:i,name:r}),t()},remove:function(n){let i=-1;return i="string"==typeof n?e.findIndex((e=>e.name===n)):e.findIndex((e=>e.fn===n)),-1!==i&&(e.splice(i,1),t(),!0)},getSystems:()=>e}}const emptyReadonlySet=freezeSet(new Set);function frozenError(){throw new Error("The set is frozen")}function freezeSet(e){return e.add=frozenError,e.clear=frozenError,e}function sortByTimestamp(e,t){return e.timestamp>t.timestamp?1:-1}function createValueSetComponentDefinitionFromSchema(e,t,n,i){const o=new Map,r=new Set,a=[],s=new Map;function c(e){const t=o.get(e);if(t){for(function(e){const t=e.raw.length;return t>1&&e.raw[t-1].timestamp<=e.raw[t-2].timestamp}(t)&&t.raw.sort(sortByTimestamp);t.raw.length>i.maxElements;)t.raw.shift();const e=freezeSet(new Set(t?.raw.map((e=>e.value))));return t.frozenSet=e,e}return emptyReadonlySet}function u(e,t){let r=o.get(e);r||(r={raw:[],frozenSet:emptyReadonlySet},o.set(e,r));const a=n.extend?n.extend(t):t,s=i.timestampFunction(a);return __DEV__&&Object.freeze(a),r.raw.push({value:a,timestamp:s}),{set:c(e),value:a}}const l={get componentId(){return t},get componentName(){return e},get componentType(){return 1},schema:n,has:e=>o.has(e),entityDeleted(e){o.delete(e)},get(e){const t=o.get(e);return t?t.frozenSet:emptyReadonlySet},addValue(e,i){const{set:o,value:s}=u(e,i);r.add(e);const c=new ReadWriteByteBuffer;return n.serialize(s,c),a.push({componentId:t,data:c.toBinary(),entityId:e,timestamp:0,type:CrdtMessageType.APPEND_VALUE}),o},*iterator(){for(const[e,t]of o)yield[e,t.frozenSet]},*dirtyIterator(){for(const e of r)yield e},getCrdtUpdates:()=>(r.clear(),a.splice(0,a.length)),updateFromCrdt(e){if(e.type===CrdtMessageType.APPEND_VALUE){const t=new ReadWriteByteBuffer(e.data),{value:i}=u(e.entityId,n.deserialize(t));return[null,i]}return[null,void 0]},dumpCrdtStateToBuffer:function(e,i){for(const[r,{raw:a}]of o)if(!i||i(r))for(const i of a){const o=new ReadWriteByteBuffer;n.serialize(i.value,o),AppendValueOperation.write(r,0,t,o.toBinary(),e)}},onChange(e,t){const n=s.get(e)??[];n.push(t),s.set(e,n)},__onChangeCallbacks(e,t){const n=s.get(e);if(n)for(const e of n)e(t)}};return l}function*genEntityTree(e,t){if(t.has(e)){t.delete(e);for(const[n,i]of t)i.parent===e&&(yield*genEntityTree(n,t));yield e}}function getComponentEntityTree(e,t,n){return genEntityTree(t,new Map(e.getEntitiesWith(n)))}function removeNetworkEntityChildrens(e,t){const n=NetworkParent(e),i=NetworkEntity(e);e.removeEntity(t);const o=i.getOrNull(t);if(o)for(const[t,i]of e.getEntitiesWith(n))i.entityId===o.entityId&&i.networkId===o.networkId&&removeNetworkEntityChildrens(e,t)}function removeEntityWithChildren(e,t){const n=Transform$1(e);if(NetworkEntity(e).has(t))return removeNetworkEntityChildrens(e,t);for(const i of getComponentEntityTree(e,t,n))e.removeEntity(i)}var ComponentType;function preEngine(e){const t=e?.entityContainer??createEntityContainer(),n=new Map,i=SystemContainer();let o=!1;function r(e){for(const[,t]of n)"core-schema::Network-Entity"!==t.componentName&&t.entityDeleted(e,!0);return t.removeEntity(e)}function a(e,t){const i=componentNumberFromName(e),r=n.get(i);if(r)return r;if(o)throw new Error("Engine is already sealed. No components can be added at this stage");const a=createComponentDefinitionFromSchema(e,i,t);return n.set(i,a),a}function s(e,t,i){const r=componentNumberFromName(e),a=n.get(r);if(a)return a;if(o)throw new Error("Engine is already sealed. No components can be added at this stage");const s=createComponentDefinitionFromSchema(e,r,Schemas.Map(t,i)),c={...s,create:(e,t)=>s.create(e,t),createOrReplace:(e,t)=>s.createOrReplace(e,t)};return n.set(r,c),c}function*c(...e){for(const[t,...n]of function*(...e){const[t,...n]=e;for(const[i]of t.iterator()){let t=!0;for(const e of n)if(!e.has(i)){t=!1;break}t&&(yield[i,...e])}}(...e))yield[t,...n.map((e=>e.get(t)))]}return Transform$1({defineComponentFromSchema:a}),{addEntity:function(){return t.generateEntity()},removeEntity:r,removeEntityWithChildren:function(e){return removeEntityWithChildren({removeEntity:r,defineComponentFromSchema:a,getEntitiesWith:c,defineComponent:s},e)},addSystem:function(e,t=SYSTEMS_REGULAR_PRIORITY,n){i.add(e,t,n)},getSystems:function(){return i.getSystems()},removeSystem:function(e){return i.remove(e)},defineComponent:s,defineComponentFromSchema:a,defineValueSetComponentFromSchema:function(e,t,i){const r=componentNumberFromName(e),a=n.get(r);if(a)return a;if(o)throw new Error("Engine is already sealed. No components can be added at this stage");const s=createValueSetComponentDefinitionFromSchema(e,r,t,i);return n.set(r,s),s},getEntitiesWith:c,getComponent:function(e){const t="number"==typeof e?e:componentNumberFromName(e),i=n.get(t);if(!i)throw new Error(`Component ${e} not found. You need to declare the components at the beginnig of the engine declaration`);return i},getComponentOrNull:function(e){const t="number"==typeof e?e:componentNumberFromName(e);return n.get(t)??null},getEntityOrNullByName:function(e){const t=Name({defineComponent:s});for(const[n,i]of c(t))if(i.value===e)return n;return null},removeComponentDefinition:function(e){if(o)throw new Error("Engine is already sealed. No components can be removed at this stage");const t="number"==typeof e?e:componentNumberFromName(e);n.delete(t)},registerComponentDefinition:function(e,t){if(o)throw new Error("Engine is already sealed. No components can be added at this stage");const i=componentNumberFromName(e);if(n.get(i))throw new Error(`Component number ${i} was already registered.`);if(t.componentName!==e)throw new Error(`Component name doesn't match componentDefinition.componentName ${e} != ${t.componentName}`);if(t.componentId!==i)throw new Error(`Component number doesn't match componentDefinition.componentId ${i} != ${t.componentId}`);return n.set(i,t),t},entityContainer:t,componentsIter:function(){return n.values()},seal:function(){o||(o=!0)}}}function Engine(e){const t=preEngine(e),n=crdtSceneSystem(t,((n,i,o,r)=>{if(i===CrdtMessageType.DELETE_ENTITY)for(const e of t.componentsIter())e?.__onChangeCallbacks(n,void 0);else o?.__onChangeCallbacks(n,r);return e?.onChangeFunction(n,i,o,r)}));return{_id:Date.now(),addEntity:t.addEntity,removeEntity:t.removeEntity,removeEntityWithChildren:t.removeEntityWithChildren,addSystem:t.addSystem,removeSystem:t.removeSystem,defineComponent:t.defineComponent,defineComponentFromSchema:t.defineComponentFromSchema,defineValueSetComponentFromSchema:t.defineValueSetComponentFromSchema,registerComponentDefinition:t.registerComponentDefinition,getEntitiesWith:t.getEntitiesWith,getComponent:t.getComponent,getComponentOrNull:t.getComponentOrNull,removeComponentDefinition:t.removeComponentDefinition,componentsIter:t.componentsIter,seal:t.seal,getEntityOrNullByName:t.getEntityOrNullByName,update:async function(e){await n.receiveMessages();for(const n of t.getSystems()){checkNotThenable(n.fn(e),`A system (${n.name||"anonymous"}) returned a thenable. Systems cannot be async functions. Documentation: https://dcl.gg/sdk/sync-systems`)}const i=t.entityContainer.releaseRemovedEntities();await n.sendMessages(i)},RootEntity:0,PlayerEntity:1,CameraEntity:2,getEntityState:t.entityContainer.getEntityState,addTransport:n.addTransport,entityContainer:t.entityContainer}}!function(e){e[e.LastWriteWinElementSet=0]="LastWriteWinElementSet",e[e.GrowOnlyValueSet=1]="GrowOnlyValueSet"}(ComponentType||(ComponentType={}));const cacheTween=new Map;function createTweenSystem(e){if(cacheTween.has(e._id))return cacheTween.get(e._id);const t=Tween$1(e),n=TweenState(e),i=TweenSequence$1(e),o=new Map;function r(e){const i=n.getOrNull(e),r=t.getOrNull(e),s=o.get(e);return!(!i||!r)&&!(!a(e)&&1!==i.state||s?.completed||!((s?.frames??0)>2))}function a(e){const n=t.getOrNull(e),i=o.get(e)?.tween;if(n&&!i||!n&&i)return!0;const r=new ReadWriteByteBuffer;t.schema.serialize(n,r);return dataCompare(r.toBinary(),i)}const s=[];function c(e){if("move"===e.mode?.$case&&e.mode.move)return{...e,mode:{...e.mode,move:{start:e.mode.move.end,end:e.mode.move.start}}};if("rotate"===e.mode?.$case&&e.mode.rotate)return{...e,mode:{...e.mode,rotate:{start:e.mode.rotate.end,end:e.mode.rotate.start}}};if("scale"===e.mode?.$case&&e.mode.scale)return{...e,mode:{...e.mode,scale:{start:e.mode.scale.end,end:e.mode.scale.start}}};if("textureMove"===e.mode?.$case&&e.mode.textureMove)return{...e,mode:{...e.mode,textureMove:{start:e.mode.textureMove.end,end:e.mode.textureMove.start}}};throw new Error("Invalid tween")}e.addSystem((()=>{for(const e of s)e();s.length=0;for(const[n,u]of e.getEntitiesWith(t)){if(a(n)){const e=new ReadWriteByteBuffer;t.schema.serialize(u,e),o.set(n,{tween:e.toBinary(),frames:0,completed:!1,changed:!0});continue}const e=o.get(n);if(e.frames+=1,e.changed=!1,r(n)){e.frames=0,e.completed=!0;const r=i.getOrNull(n);if(!r)continue;const{sequence:a}=r;if(a&&a.length){const[e,...o]=a;t.createOrReplace(n,e);const s=i.getMutable(n);s.sequence=o,0===r.loop&&s.sequence.push(u)}else 1===r.loop?t.createOrReplace(n,c(u)):0===r.loop&&(t.deleteFrom(n),o.delete(n),s.push((()=>{t.createOrReplace(n,u)})))}}}),Number.NEGATIVE_INFINITY);const u={tweenCompleted:r};return cacheTween.set(e._id,u),u}function pointerEventColliderChecker(e){const t=PointerEvents(e),n=MeshCollider(e),i=GltfContainer(e),o=UiTransform(e),r=new Set;let a=0;function s(s){if(a+=s,!(a<=10)){a=0;for(const[a]of e.getEntitiesWith(t)){if(r.has(a))continue;if(i.has(a))continue;if(o.has(a))continue;const e=n.getOrNull(a);e&&(void 0===e.collisionMask||1&e.collisionMask)||(r.add(a),console.log(` Missing MeshCollider component on entity ${a}. Add a MeshCollider to the entity so it can be clickeable by the player.\nSee https://docs.decentraland.org/creator/development-guide/sdk7/colliders/#pointer-blocking`))}}}e.removeSystem(s),e.addSystem(s)}const engine=Engine();createTweenSystem(engine),pointerEventColliderChecker(engine);const TweenSequence=TweenSequence$1(engine);var CameraType,InputAction,PointerEventType,LoadingState,TextAlignMode,Font;function getCompositeRootComponent(e){const t=e.getComponentOrNull("composite::root");return t||e.defineComponent("composite::root",{src:Schemas.String,entities:Schemas.Array(Schemas.Map({src:Schemas.Entity,dest:Schemas.Entity}))})}!function(e){e[e.CT_FIRST_PERSON=0]="CT_FIRST_PERSON",e[e.CT_THIRD_PERSON=1]="CT_THIRD_PERSON",e[e.CT_CINEMATIC=2]="CT_CINEMATIC"}(CameraType||(CameraType={})),function(e){e[e.IA_POINTER=0]="IA_POINTER",e[e.IA_PRIMARY=1]="IA_PRIMARY",e[e.IA_SECONDARY=2]="IA_SECONDARY",e[e.IA_ANY=3]="IA_ANY",e[e.IA_FORWARD=4]="IA_FORWARD",e[e.IA_BACKWARD=5]="IA_BACKWARD",e[e.IA_RIGHT=6]="IA_RIGHT",e[e.IA_LEFT=7]="IA_LEFT",e[e.IA_JUMP=8]="IA_JUMP",e[e.IA_WALK=9]="IA_WALK",e[e.IA_ACTION_3=10]="IA_ACTION_3",e[e.IA_ACTION_4=11]="IA_ACTION_4",e[e.IA_ACTION_5=12]="IA_ACTION_5",e[e.IA_ACTION_6=13]="IA_ACTION_6"}(InputAction||(InputAction={})),function(e){e[e.PET_UP=0]="PET_UP",e[e.PET_DOWN=1]="PET_DOWN",e[e.PET_HOVER_ENTER=2]="PET_HOVER_ENTER",e[e.PET_HOVER_LEAVE=3]="PET_HOVER_LEAVE"}(PointerEventType||(PointerEventType={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.LOADING=1]="LOADING",e[e.NOT_FOUND=2]="NOT_FOUND",e[e.FINISHED_WITH_ERROR=3]="FINISHED_WITH_ERROR",e[e.FINISHED=4]="FINISHED"}(LoadingState||(LoadingState={})),function(e){e[e.TAM_TOP_LEFT=0]="TAM_TOP_LEFT",e[e.TAM_TOP_CENTER=1]="TAM_TOP_CENTER",e[e.TAM_TOP_RIGHT=2]="TAM_TOP_RIGHT",e[e.TAM_MIDDLE_LEFT=3]="TAM_MIDDLE_LEFT",e[e.TAM_MIDDLE_CENTER=4]="TAM_MIDDLE_CENTER",e[e.TAM_MIDDLE_RIGHT=5]="TAM_MIDDLE_RIGHT",e[e.TAM_BOTTOM_LEFT=6]="TAM_BOTTOM_LEFT",e[e.TAM_BOTTOM_CENTER=7]="TAM_BOTTOM_CENTER",e[e.TAM_BOTTOM_RIGHT=8]="TAM_BOTTOM_RIGHT"}(TextAlignMode||(TextAlignMode={})),function(e){e[e.F_SANS_SERIF=0]="F_SANS_SERIF",e[e.F_SERIF=1]="F_SERIF",e[e.F_MONOSPACE=2]="F_MONOSPACE"}(Font||(Font={}));const currentWorkingDir="/";function normalizeStringPosix(e,t=!1){let n,i="",o=0,r=-1,a=0;for(let s=0;s<=e.length;++s){if(s<e.length)n=e.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(r===s-1||1===a);else if(r!==s-1&&2===a){if(i.length<2||2!==o||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){const e=i.lastIndexOf("/");if(e!==i.length-1){-1===e?(i="",o=0):(i=i.slice(0,e),o=i.length-1-i.lastIndexOf("/")),r=s,a=0;continue}}else if(2===i.length||1===i.length){i="",o=0,r=s,a=0;continue}t&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+="/"+e.slice(r+1,s):i=e.slice(r+1,s),o=s-r-1;r=s,a=0}else 46===n&&-1!==a?++a:a=-1}return i}function resolve(...e){let t,n="",i=!1;for(let o=e.length-1;o>=-1&&!i;o--){let r;o>=0?r=e[o]:(void 0===t&&(t=currentWorkingDir),r=t),0!==r.length&&(n=r+"/"+n,i=47===r.charCodeAt(0))}return n=normalizeStringPosix(n,!i),i?n.length>0?"/"+n:"/":n.length>0?n:"."}function dirname(e){if(0===e.length)return".";let t=e.charCodeAt(0);const n=47===t;let i=-1,o=!0;for(let n=e.length-1;n>=1;--n)if(t=e.charCodeAt(n),47===t){if(!o){i=n;break}}else o=!1;return-1===i?n?"/":".":n&&1===i?"//":e.slice(0,i)}function resolveComposite(e,t){return(e.startsWith(".")?resolve(t,e):resolve(e)).substring(1)}var EntityMappingMode,NullValue,Struct,Struct_FieldsEntry,Value,ListValue;function getComponentValue(e,t){return"json"===t.data?.$case?t.data.json:e.schema.deserialize(new ReadWriteByteBuffer(t.data?.binary))}function getComponentDefinition(e,t){const n=e.getComponentOrNull(t.name);if(n)return n;if(t.name.startsWith("core::")){if(t.name in componentDefinitionByName)return componentDefinitionByName[t.name](e);throw new Error(`The core component ${t.name} was not found.`)}if(t.jsonSchema)return e.defineComponentFromSchema(t.name,Schemas.fromJson(t.jsonSchema));throw new Error(`${t.name} is not defined and there is no schema to define it.`)}function getEntityMapping(e,t,n,{entityMapping:i}){const o=n.get(t);if(o)return o;if(i?.type===EntityMappingMode.EMM_DIRECT_MAPPING){const e=i.getCompositeEntity(t);return n.set(t,e),e}const r=i?.type===EntityMappingMode.EMM_NEXT_AVAILABLE?i.getNextAvailableEntity():e.addEntity();if(null===r)throw new Error("There is no more entities to allocate");return n.set(t,r),r}function instanceComposite(e,t,n,i){const{rootEntity:o,alreadyRequestedSrc:r,entityMapping:a}=i,s=r||new Set,c=dirname(resolve(t.src)),u=componentNumberFromName("core::Transform"),l=getCompositeRootComponent(e),f=new Map,d=t=>getEntityMapping(e,t,f,i),h=o??d(0);o&&f.set(0,o);const p=t.composite.components.find((e=>e.name===l.componentName));if(p)for(const[i,o]of p.data){const r=resolveComposite(getComponentValue(l,o).src,c),u=n.getCompositeOrNull(r),f=d(i);if(u){if(s.has(u.src)||u.src===t.src)throw new Error(`Composite ${t.src} has a recursive instanciation while try to instance ${u.src}. Previous instances: ${s.toString()}`);instanceComposite(e,u,n,{rootEntity:f,alreadyRequestedSrc:new Set(s).add(u.src),entityMapping:a?.type===EntityMappingMode.EMM_NEXT_AVAILABLE?a:void 0})}}for(const n of t.composite.components){if(n.name===l.componentName)continue;const t=getComponentDefinition(e,n);for(const[e,i]of n.data){const n=getComponentValue(t,i),o=d(e),r=t.create(o,n);if(t.componentId===u){const e=r;e.parent?e.parent=d(e.parent):e.parent=d(0)}else Schemas.mutateNestedValues(t.schema.jsonSchema,r,((e,t)=>"entity"===t.serializationType?{changed:!0,value:d(e)}:{changed:!1}))}}const m=l.getMutableOrNull(h)||l.create(h);for(const[e,t]of f)m.entities.push({src:e,dest:t});return m.src=t.src,h}function nullValueFromJSON(e){switch(e){case 0:case"NULL_VALUE":return 0;default:throw new tsProtoGlobalThis$1.Error("Unrecognized enum value "+e+" for enum NullValue")}}function nullValueToJSON(e){if(0===e)return"NULL_VALUE";throw new tsProtoGlobalThis$1.Error("Unrecognized enum value "+e+" for enum NullValue")}function createBaseStruct(){return{fields:new Map}}function createBaseStruct_FieldsEntry(){return{key:"",value:void 0}}function createBaseValue(){return{kind:void 0}}function createBaseListValue(){return{values:[]}}!function(e){e[e.EMM_NONE=0]="EMM_NONE",e[e.EMM_NEXT_AVAILABLE=1]="EMM_NEXT_AVAILABLE",e[e.EMM_DIRECT_MAPPING=2]="EMM_DIRECT_MAPPING"}(EntityMappingMode||(EntityMappingMode={})),function(e){e[e.NULL_VALUE=0]="NULL_VALUE"}(NullValue||(NullValue={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return e.fields.forEach(((e,n)=>{void 0!==e&&Struct_FieldsEntry.encode({key:n,value:e},t.uint32(10).fork()).ldelim()})),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseStruct();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;const t=Struct_FieldsEntry.decode(n,n.uint32());void 0!==t.value&&o.fields.set(t.key,t.value);continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o},e.fromJSON=function(e){return{fields:isObject$1(e.fields)?Object.entries(e.fields).reduce(((e,[t,n])=>(e.set(t,n),e)),new Map):new Map}},e.toJSON=function(e){const t={fields:{}};return e.fields&&e.fields.forEach(((e,n)=>{t.fields[n]=e})),t},e.wrap=function(e){const t=createBaseStruct();return void 0!==e&&Object.keys(e).forEach((n=>{t.fields.set(n,e[n])})),t},e.unwrap=function(e){const t={};return[...e.fields.keys()].forEach((n=>{t[n]=e.fields.get(n)})),t}}(Struct||(Struct={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.key&&t.uint32(10).string(e.key),void 0!==e.value&&Value.encode(Value.wrap(e.value),t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseStruct_FieldsEntry();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.key=n.string();continue;case 2:if(18!==e)break;o.value=Value.unwrap(Value.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o},e.fromJSON=function(e){return{key:isSet$1(e.key)?String(e.key):"",value:isSet$1(e?.value)?e.value:void 0}},e.toJSON=function(e){const t={};return void 0!==e.key&&(t.key=e.key),void 0!==e.value&&(t.value=e.value),t}}(Struct_FieldsEntry||(Struct_FieldsEntry={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.kind?.$case){case"nullValue":t.uint32(8).int32(e.kind.nullValue);break;case"numberValue":t.uint32(17).double(e.kind.numberValue);break;case"stringValue":t.uint32(26).string(e.kind.stringValue);break;case"boolValue":t.uint32(32).bool(e.kind.boolValue);break;case"structValue":Struct.encode(Struct.wrap(e.kind.structValue),t.uint32(42).fork()).ldelim();break;case"listValue":ListValue.encode(ListValue.wrap(e.kind.listValue),t.uint32(50).fork()).ldelim()}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseValue();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.kind={$case:"nullValue",nullValue:n.int32()};continue;case 2:if(17!==e)break;o.kind={$case:"numberValue",numberValue:n.double()};continue;case 3:if(26!==e)break;o.kind={$case:"stringValue",stringValue:n.string()};continue;case 4:if(32!==e)break;o.kind={$case:"boolValue",boolValue:n.bool()};continue;case 5:if(42!==e)break;o.kind={$case:"structValue",structValue:Struct.unwrap(Struct.decode(n,n.uint32()))};continue;case 6:if(50!==e)break;o.kind={$case:"listValue",listValue:ListValue.unwrap(ListValue.decode(n,n.uint32()))};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o},e.fromJSON=function(e){return{kind:isSet$1(e.nullValue)?{$case:"nullValue",nullValue:nullValueFromJSON(e.nullValue)}:isSet$1(e.numberValue)?{$case:"numberValue",numberValue:Number(e.numberValue)}:isSet$1(e.stringValue)?{$case:"stringValue",stringValue:String(e.stringValue)}:isSet$1(e.boolValue)?{$case:"boolValue",boolValue:Boolean(e.boolValue)}:isSet$1(e.structValue)?{$case:"structValue",structValue:e.structValue}:isSet$1(e.listValue)?{$case:"listValue",listValue:[...e.listValue]}:void 0}},e.toJSON=function(e){const t={};return"nullValue"===e.kind?.$case&&(t.nullValue=void 0!==e.kind?.nullValue?nullValueToJSON(e.kind?.nullValue):void 0),"numberValue"===e.kind?.$case&&(t.numberValue=e.kind?.numberValue),"stringValue"===e.kind?.$case&&(t.stringValue=e.kind?.stringValue),"boolValue"===e.kind?.$case&&(t.boolValue=e.kind?.boolValue),"structValue"===e.kind?.$case&&(t.structValue=e.kind?.structValue),"listValue"===e.kind?.$case&&(t.listValue=e.kind?.listValue),t},e.wrap=function(e){const t=createBaseValue();if(null===e)t.kind={$case:"nullValue",nullValue:0};else if("boolean"==typeof e)t.kind={$case:"boolValue",boolValue:e};else if("number"==typeof e)t.kind={$case:"numberValue",numberValue:e};else if("string"==typeof e)t.kind={$case:"stringValue",stringValue:e};else if(Array.isArray(e))t.kind={$case:"listValue",listValue:e};else if("object"==typeof e)t.kind={$case:"structValue",structValue:e};else if(void 0!==e)throw new Error("Unsupported any value type: "+typeof e);return t},e.unwrap=function(e){return"nullValue"===e.kind?.$case?null:"numberValue"===e.kind?.$case?e.kind?.numberValue:"stringValue"===e.kind?.$case?e.kind?.stringValue:"boolValue"===e.kind?.$case?e.kind?.boolValue:"structValue"===e.kind?.$case?e.kind?.structValue:"listValue"===e.kind?.$case?e.kind?.listValue:void 0}}(Value||(Value={})),function(e){e.encode=function(e,t=minimal.Writer.create()){for(const n of e.values)Value.encode(Value.wrap(n),t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseListValue();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.values.push(Value.unwrap(Value.decode(n,n.uint32())));continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o},e.fromJSON=function(e){return{values:Array.isArray(e?.values)?[...e.values]:[]}},e.toJSON=function(e){const t={};return e.values?t.values=e.values.map((e=>e)):t.values=[],t},e.wrap=function(e){const t=createBaseListValue();return t.values=e??[],t},e.unwrap=function(e){return e?.hasOwnProperty("values")&&Array.isArray(e.values)?e.values:e}}(ListValue||(ListValue={}));const tsProtoGlobalThis$1=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw"Unable to locate global object"})();function isObject$1(e){return"object"==typeof e&&null!==e}function isSet$1(e){return null!=e}function createBaseComponentData(){return{data:void 0}}var ComponentData,CompositeComponent,CompositeComponent_DataEntry,CompositeDefinition;function createBaseCompositeComponent(){return{name:"",jsonSchema:void 0,data:new Map}}function createBaseCompositeComponent_DataEntry(){return{key:0,value:void 0}}function createBaseCompositeDefinition(){return{version:0,components:[]}}!function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.data?.$case){case"json":Value.encode(Value.wrap(e.data.json),t.uint32(10).fork()).ldelim();break;case"binary":t.uint32(18).bytes(e.data.binary)}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseComponentData();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.data={$case:"json",json:Value.unwrap(Value.decode(n,n.uint32()))};continue;case 2:if(18!==e)break;o.data={$case:"binary",binary:n.bytes()};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o},e.fromJSON=function(e){return{data:isSet(e.json)?{$case:"json",json:e.json}:isSet(e.binary)?{$case:"binary",binary:bytesFromBase64(e.binary)}:void 0}},e.toJSON=function(e){const t={};return"json"===e.data?.$case&&(t.json=e.data?.json),"binary"===e.data?.$case&&(t.binary=void 0!==e.data?.binary?base64FromBytes(e.data?.binary):void 0),t}}(ComponentData||(ComponentData={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.name&&t.uint32(10).string(e.name),void 0!==e.jsonSchema&&Value.encode(Value.wrap(e.jsonSchema),t.uint32(18).fork()).ldelim(),e.data.forEach(((e,n)=>{CompositeComponent_DataEntry.encode({key:n,value:e},t.uint32(26).fork()).ldelim()})),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseCompositeComponent();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.name=n.string();continue;case 2:if(18!==e)break;o.jsonSchema=Value.unwrap(Value.decode(n,n.uint32()));continue;case 3:if(26!==e)break;const t=CompositeComponent_DataEntry.decode(n,n.uint32());void 0!==t.value&&o.data.set(t.key,t.value);continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o},e.fromJSON=function(e){return{name:isSet(e.name)?String(e.name):"",jsonSchema:isSet(e?.jsonSchema)?e.jsonSchema:void 0,data:isObject(e.data)?Object.entries(e.data).reduce(((e,[t,n])=>(e.set(Number(t),ComponentData.fromJSON(n)),e)),new Map):new Map}},e.toJSON=function(e){const t={};return void 0!==e.name&&(t.name=e.name),void 0!==e.jsonSchema&&(t.jsonSchema=e.jsonSchema),t.data={},e.data&&e.data.forEach(((e,n)=>{t.data[n]=ComponentData.toJSON(e)})),t}}(CompositeComponent||(CompositeComponent={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.key&&t.uint32(8).int32(e.key),void 0!==e.value&&ComponentData.encode(e.value,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseCompositeComponent_DataEntry();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.key=n.int32();continue;case 2:if(18!==e)break;o.value=ComponentData.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o},e.fromJSON=function(e){return{key:isSet(e.key)?Number(e.key):0,value:isSet(e.value)?ComponentData.fromJSON(e.value):void 0}},e.toJSON=function(e){const t={};return void 0!==e.key&&(t.key=Math.round(e.key)),void 0!==e.value&&(t.value=e.value?ComponentData.toJSON(e.value):void 0),t}}(CompositeComponent_DataEntry||(CompositeComponent_DataEntry={})),function(e){e.encode=function(e,t=minimal.Writer.create()){0!==e.version&&t.uint32(8).int32(e.version);for(const n of e.components)CompositeComponent.encode(n,t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let i=void 0===t?n.len:n.pos+t;const o=createBaseCompositeDefinition();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.version=n.int32();continue;case 2:if(18!==e)break;o.components.push(CompositeComponent.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return o},e.fromJSON=function(e){return{version:isSet(e.version)?Number(e.version):0,components:Array.isArray(e?.components)?e.components.map((e=>CompositeComponent.fromJSON(e))):[]}},e.toJSON=function(e){const t={};return void 0!==e.version&&(t.version=Math.round(e.version)),e.components?t.components=e.components.map((e=>e?CompositeComponent.toJSON(e):void 0)):t.components=[],t}}(CompositeDefinition||(CompositeDefinition={}));const tsProtoGlobalThis=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw"Unable to locate global object"})();function bytesFromBase64(e){if(tsProtoGlobalThis.Buffer)return Uint8Array.from(tsProtoGlobalThis.Buffer.from(e,"base64"));{const t=tsProtoGlobalThis.atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n[e]=t.charCodeAt(e);return n}}function base64FromBytes(e){if(tsProtoGlobalThis.Buffer)return tsProtoGlobalThis.Buffer.from(e).toString("base64");{const t=[];return e.forEach((e=>{t.push(String.fromCharCode(e))})),tsProtoGlobalThis.btoa(t.join(""))}}function isObject(e){return"object"==typeof e&&null!==e}function isSet(e){return null!=e}var Composite;!function(e){e.fromJson=function(e){return CompositeDefinition.fromJSON(e)},e.fromBinary=function(e){return CompositeDefinition.decode(e)},e.toJson=function(e){return CompositeDefinition.toJSON(e)},e.toBinary=function(e){return CompositeDefinition.encode(e).finish()},e.instance=function(e,t,n,i={}){instanceComposite(e,t,n,i)},e.resolveAndNormalizePath=function(e,t="/"){return resolveComposite(e,t)}}(Composite||(Composite={}));const Transform=Transform$1(engine),Material=Material$1(engine),MeshRenderer=MeshRenderer$1(engine);Name(engine);const Tween=Tween$1(engine),ToGammaSpace=1/2.2,ToLinearSpace=2.2,Epsilon=1e-6,DEG2RAD=Math.PI/180,RAD2DEG=360/(2*Math.PI);var Scalar,Vector3,Plane,Matrix,Quaternion,Vector2,Color4,Color3,InterpolationType;function getWorldPosition(e){let t=Transform.getOrNull(e);if(!t)return Vector3.Zero();let n=t.parent;return n?(Transform.get(n).rotation,Vector3.add(getWorldPosition(n),Vector3.rotate(t.position,getWorldRotation(n)))):t.position}function getWorldRotation(e){let t=Transform.getOrNull(e);if(!t)return Quaternion.Identity();let n=t.parent;return n?Quaternion.multiply(t.rotation,getWorldRotation(n)):t.rotation}function createCatmullRomSpline(e,t,n){const i=new Array,o=1/t;let r=0;if(n){const n=e.length;for(let a=0;a<n;a++){r=0;for(let s=0;s<t;s++)i.push(Vector3.catmullRom(e[a%n],e[(a+1)%n],e[(a+2)%n],e[(a+3)%n],r)),r+=o}i.push(i[0])}else{const n=new Array;n.push(Vector3.clone(e[0])),Array.prototype.push.apply(n,e),n.push(Vector3.clone(e[e.length-1]));let a=0;for(;a<n.length-3;a++){r=0;for(let e=0;e<t;e++)i.push(Vector3.catmullRom(n[a],n[a+1],n[a+2],n[a+3],r)),r+=o}a--,i.push(Vector3.catmullRom(n[a],n[a+1],n[a+2],n[a+3],r))}return i}function areAABBIntersecting(e,t,n,i){return e.x<=i.x&&t.x>=n.x&&e.y<=i.y&&t.y>=n.y&&e.z<=i.z&&t.z>=n.z}function areSpheresIntersecting(e,t,n,i){const o=t+i;return Vector3.distanceSquared(e,n)<o*o}function areAABBSphereIntersecting(e,t,n,i){let o=0;return n.x<e.x&&(o+=(e.x-n.x)*(e.x-n.x)),n.x>t.x&&(o+=(n.x-t.x)*(n.x-t.x)),n.y<e.y&&(o+=(e.y-n.y)*(e.y-n.y)),n.y>t.y&&(o+=(n.y-t.y)*(n.y-t.y)),n.z<e.z&&(o+=(e.z-n.z)*(e.z-n.z)),n.z>t.z&&(o+=(n.z-t.z)*(n.z-t.z)),o<i*i}!function(e){function t(e){const t=+e;return 0===t||isNaN(t)?t:t>0?1:-1}function n(e,t=0,n=1){return Math.min(n,Math.max(t,e))}function i(e,t){return e-Math.floor(e/t)*t}function o(e,t){let n=i(t-e,360);return n>180&&(n-=360),n}function r(e,n,i){let o=0;return o=Math.abs(n-e)<=i?n:e+t(n-e)*i,o}e.TwoPi=2*Math.PI,e.withinEpsilon=function(e,t,n=1401298e-51){const i=e-t;return-n<=i&&i<=n},e.toHex=function(e){const t=e.toString(16);return e<=15?("0"+t).toUpperCase():t.toUpperCase()},e.sign=t,e.clamp=n,e.log2=function(e){return Math.log(e)*Math.LOG2E},e.repeat=i,e.normalize=function(e,t,n){return(e-t)/(n-t)},e.denormalize=function(e,t,n){return e*(n-t)+t},e.deltaAngle=o,e.pingPong=function(e,t){const n=i(e,2*t);return t-Math.abs(n-t)},e.smoothStep=function(e,t,i){let o=n(i);return o=-2*o*o*o+3*o*o,t*o+e*(1-o)},e.moveTowards=r,e.moveTowardsAngle=function(e,t,n){const i=o(e,t);let a=0;return a=-n<i&&i<n?t:r(e,e+i,n),a},e.lerp=function(e,t,n){return e+(t-e)*n},e.lerpAngle=function(e,t,o){let r=i(t-e,360);return r>180&&(r-=360),e+r*n(o)},e.inverseLerp=function(e,t,i){let o=0;return o=e!==t?n((i-e)/(t-e)):0,o},e.hermite=function(e,t,n,i,o){const r=o*o,a=o*r;return e*(2*a-3*r+1)+n*(-2*a+3*r)+t*(a-2*r+o)+i*(a-r)},e.randomRange=function(e,t){return e===t?e:Math.random()*(t-e)+e},e.rangeToPercent=function(e,t,n){return(e-t)/(n-t)},e.percentToRange=function(e,t,n){return(n-t)*e+t},e.normalizeRadians=function(t){return t-e.TwoPi*Math.floor((t+Math.PI)/e.TwoPi)}}(Scalar||(Scalar={})),function(e){function t(e=0,t=0,n=0){return{x:e,y:t,z:n}}function n(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}}function i(e,t){t.x=e.x,t.y=e.y,t.z=e.z}function o(e,t,n,i){i.x=e,i.y=t,i.z=n}function r(e){return t(e.x,e.y,e.z)}function a(e,n=0){return t(e[n],e[n+1],e[n+2])}function s(e,t,n){n.x=e[t],n.y=e[t+1],n.z=e[t+2]}function c(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}function u(e,t,n){n.x=e.x*t,n.y=e.y*t,n.z=e.z*t}function l(e,n){const i=t(0,0,0);return f(e,n,i),i}function f(e,t,n){0!==t&&1!==t?u(e,1/t,n):i(e,n)}function d(e){return l(e,c(e))}function h(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}function p(e,t,n){const{x:i,y:o,z:r}=e,a=t._m,s=1/(a[3]*i+a[7]*o+a[11]*r+a[15]);n.x=(a[0]*i+a[4]*o+a[8]*r+a[12])*s,n.y=(a[1]*i+a[5]*o+a[9]*r+a[13])*s,n.z=(a[2]*i+a[6]*o+a[10]*r+a[14])*s}function m(e,t,n){const{x:i,y:o,z:r}=e,{x:a,y:s,z:c,w:u}=t,l=u*i+s*r-c*o,f=u*o+c*i-a*r,d=u*r+a*o-s*i,h=-a*i-s*o-c*r;n.x=l*u+h*-a+f*-c-d*-s,n.y=f*u+h*-s+d*-a-l*-c,n.z=d*u+h*-c+l*-s-f*-a}function y(e,t,n,i){i.x=e.x+(t.x-e.x)*n,i.y=e.y+(t.y-e.y)*n,i.z=e.z+(t.z-e.z)*n}function g(e,t,n){n.x=e.y*t.z-e.z*t.y,n.y=e.z*t.x-e.x*t.z,n.z=e.x*t.y-e.y*t.x}function E(e,t,n){return _(e.x,e.y,e.z,t,n)}function _(e,t,n,i,o){const r=i._m,a=e*r[0]+t*r[4]+n*r[8]+r[12],s=e*r[1]+t*r[5]+n*r[9]+r[13],c=e*r[2]+t*r[6]+n*r[10]+r[14],u=1/(e*r[3]+t*r[7]+n*r[11]+r[15]);o.x=a*u,o.y=s*u,o.z=c*u}function T(e,t,n){v(e.x,e.y,e.z,t,n)}function v(e,t,n,i,o){const r=i._m;o.x=e*r[0]+t*r[4]+n*r[8],o.y=e*r[1]+t*r[5]+n*r[9],o.z=e*r[2]+t*r[6]+n*r[10]}function S(e,t,n,i){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;a=a>n.y?n.y:a,a=a<t.y?t.y:a;let s=e.z;s=s>n.z?n.z:s,s=s<t.z?t.z:s,o(r,a,s,i)}function b(e,t){const n=e.x-t.x,i=e.y-t.y,o=e.z-t.z;return n*n+i*i+o*o}function A(e,t,n,o){const r=Quaternion.create();Quaternion.fromAxisToRotationQuaternionToRef(e,t,n,r),i(Quaternion.toEulerAngles(r),o)}function w(e,t,n){n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z}function P(e,t,n,i,o){o.x=e.x*t,o.y=e.y*n,o.z=e.z*i}function B(e,t,n,i,o){t>e.x?o.x=t:o.x=e.x,n>e.y?o.y=n:o.y=e.y,i>e.z?o.z=i:o.z=e.z}function R(e,t,n,i,o){t<e.x?o.x=t:o.x=e.x,n<e.y?o.y=n:o.y=e.y,i<e.z?o.z=i:o.z=e.z}function C(){return t(0,0,0)}e.isNonUniform=function(e){const t=Math.abs(e.x);return t!==Math.abs(e.y)||t!==Math.abs(e.z)},e.create=t,e.add=n,e.addToRef=function(e,t,n){n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z},e.subtract=function(e,t){return{x:e.x-t.x,y:e.y-t.y,z:e.z-t.z}},e.subtractToRef=function(e,t,n){n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z},e.subtractFromFloatsToRef=function(e,t,n,i,o){o.x=e.x-t,o.y=e.y-n,o.z=e.z-i},e.negate=function(e){return{x:-e.x,y:-e.y,z:-e.z}},e.copyFrom=i,e.copyFromFloats=o,e.clone=r,e.getClipFactor=function(e,t,n,i){const o=h(e,n)-i;return o/(o-(h(t,n)-i))},e.getAngleBetweenVectors=function(e,n,i){const o=d(e),r=d(n),a=h(o,r),s=t();return g(o,r,s),h(s,i)>0?Math.acos(a):-Math.acos(a)},e.fromArray=a,e.fromFloatArray=function(e,t){return a(e,t)},e.fromArrayToRef=s,e.fromFloatArrayToRef=function(e,t,n){return s(e,t,n)},e.length=c,e.lengthSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z},e.scaleToRef=u,e.scale=function(e,n){return t(e.x*n,e.y*n,e.z*n)},e.normalizeFromLength=l,e.normalizeFromLengthToRef=f,e.normalize=d,e.normalizeToRef=function(e,t){f(e,c(e),t)},e.dot=h,e.applyMatrix4=function(e,t){const n=r(e);return p(e,t,n),n},e.applyMatrix4ToRef=p,e.rotate=function(e,n){const i=t();return m(e,n,i),i},e.rotateToRef=m,e.lerp=function(e,n,i){const o=t(0,0,0);return y(e,n,i,o),o},e.lerpToRef=y,e.cross=function(e,t){const n=C();return g(e,t,n),n},e.crossToRef=g,e.transformCoordinates=function(e,t){const n=C();return E(e,t,n),n},e.transformCoordinatesToRef=E,e.transformCoordinatesFromFloatsToRef=_,e.transformNormal=function(e,t){const n=C();return T(e,t,n),n},e.transformNormalToRef=T,e.transformNormalFromFloatsToRef=v,e.catmullRom=function(e,n,i,o,r){const a=r*r,s=r*a;return t(.5*(2*n.x+(-e.x+i.x)*r+(2*e.x-5*n.x+4*i.x-o.x)*a+(-e.x+3*n.x-3*i.x+o.x)*s),.5*(2*n.y+(-e.y+i.y)*r+(2*e.y-5*n.y+4*i.y-o.y)*a+(-e.y+3*n.y-3*i.y+o.y)*s),.5*(2*n.z+(-e.z+i.z)*r+(2*e.z-5*n.z+4*i.z-o.z)*a+(-e.z+3*n.z-3*i.z+o.z)*s))},e.clamp=function(e,n,i){const o=t();return S(e,n,i,o),o},e.clampToRef=S,e.hermite=function(e,n,i,o,r){const a=r*r,s=r*a,c=2*s-3*a+1,u=-2*s+3*a,l=s-2*a+r,f=s-a;return t(e.x*c+i.x*u+n.x*l+o.x*f,e.y*c+i.y*u+n.y*l+o.y*f,e.z*c+i.z*u+n.z*l+o.z*f)},e.minimize=function(e,n){const i=t();return R(n,e.x,e.y,e.z,i),i},e.maximize=function(e,n){const i=t();return B(e,n.x,n.y,n.z,i),i},e.distance=function(e,t){return Math.sqrt(b(e,t))},e.distanceSquared=b,e.center=function(e,t){const i=n(e,t);return u(i,.5,i),i},e.rotationFromAxis=function(e,t,n){const i=C();return A(e,t,n,i),i},e.rotationFromAxisToRef=A,e.toString=function(e){return`(${e.x}, ${e.y}, ${e.z})`},e.getHashCode=function(e){let t=e.x||0;return t=397*t^(e.y||0),t=397*t^(e.z||0),t},e.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z},e.equalsWithEpsilon=function(e,t,n=Epsilon){return Scalar.withinEpsilon(e.x,t.x,n)&&Scalar.withinEpsilon(e.y,t.y,n)&&Scalar.withinEpsilon(e.z,t.z,n)},e.equalsToFloats=function(e,t,n,i){return e.x===t&&e.y===n&&e.z===i},e.multiply=function(e,n){const i=t();return w(e,n,i),i},e.multiplyToRef=w,e.multiplyByFloatsToRef=P,e.multiplyByFloats=function(e,n,i,o){const r=t();return P(e,n,i,o,r),r},e.divide=function(e,t){return{x:e.x/t.x,y:e.y/t.y,z:e.z/t.z}},e.divideToRef=function(e,t,n){n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z},e.maximizeInPlaceFromFloatsToRef=B,e.minimizeInPlaceFromFloatsToRef=R,e.floor=function(e){return t(Math.floor(e.x),Math.floor(e.y),Math.floor(e.z))},e.fract=function(e){return t(e.x-Math.floor(e.x),e.y-Math.floor(e.y),e.z-Math.floor(e.z))},e.Zero=C,e.One=function(){return t(1,1,1)},e.Up=function(){return t(0,1,0)},e.Down=function(){return t(0,-1,0)},e.Forward=function(){return t(0,0,1)},e.Backward=function(){return t(0,0,-1)},e.Right=function(){return t(1,0,0)},e.Left=function(){return t(-1,0,0)},e.Random=function(){return t(Math.random(),Math.random(),Math.random())}}(Vector3||(Vector3={})),function(e){function t(e,t,n,i){return{normal:Vector3.create(e,t,n),d:i}}e.create=t,e.fromArray=function(e){return t(e[0],e[1],e[2],e[3])},e.fromPoints=function(e,n,i){return t(0,0,0,0)},e.romPositionAndNormal=function(e,n){const i=t(0,0,0,0);return i.normal=Vector3.normalize(n),i.d=-(n.x*e.x+n.y*e.y+n.z*e.z),i},e.signedDistanceToPlaneFromPositionAndNormal=function(e,t,n){const i=-(t.x*e.x+t.y*e.y+t.z*e.z);return Vector3.dot(n,t)+i},e.asArray=function(e){return[e.normal.x,e.normal.y,e.normal.z,e.d]},e.clone=function(e){return t(e.normal.x,e.normal.y,e.normal.z,e.d)},e.getHashCode=function(e){return 0},e.normalize=function(e){const n=t(0,0,0,0),i=Math.sqrt(e.normal.x*e.normal.x+e.normal.y*e.normal.y+e.normal.z*e.normal.z);let o=0;return 0!==i&&(o=1/i),n.normal.x=e.normal.x*o,n.normal.y=e.normal.y*o,n.normal.z=e.normal.z*o,n.d*=o,e},e.transform=function(e,n){const i=Matrix.create();Matrix.transposeToRef(n,i);const o=i._m,r=e.normal.x,a=e.normal.y,s=e.normal.z,c=e.d;return t(r*o[0]+a*o[1]+s*o[2]+c*o[3],r*o[4]+a*o[5]+s*o[6]+c*o[7],r*o[8]+a*o[9]+s*o[10]+c*o[11],r*o[12]+a*o[13]+s*o[14]+c*o[15])},e.dotCoordinate=function(e,t){return e.normal.x*t.x+e.normal.y*t.y+e.normal.z*t.z+e.d},e.copyFromPoints=function(e,t,n){const i=t.x-e.x,o=t.y-e.y,r=t.z-e.z,a=n.x-e.x,s=n.y-e.y,c=n.z-e.z,u=o*c-r*s,l=r*a-i*c,f=i*s-o*a,d=Math.sqrt(u*u+l*l+f*f);let h;h=0!==d?1/d:0;const p=Vector3.create(u*h,l*h,f*h);return{normal:p,d:-(p.x*e.x+p.y*e.y+p.z*e.z)}},e.isFrontFacingTo=function(e,t,n){return Vector3.dot(e.normal,t)<=n},e.signedDistanceTo=function(e,t){return Vector3.dot(t,e.normal)+e.d}}(Plane||(Plane={})),function(e){e.m=function(e){return e._m};let t=0;const n={};function i(){const e={updateFlag:0,isIdentity:!1,isIdentity3x2:!0,_isIdentityDirty:!0,_isIdentity3x2Dirty:!0,_m:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};return F(e,!1),e}function o(e,t,n){for(let i=0;i<16;i++)n._m[i]=e[i+t];R(n)}function r(e,t,n,i,o,r,a,s,c,u,l,f,d,h,p,m,y){const g=y._m;g[0]=e,g[1]=t,g[2]=n,g[3]=i,g[4]=o,g[5]=r,g[6]=a,g[7]=s,g[8]=c,g[9]=u,g[10]=l,g[11]=f,g[12]=d,g[13]=h,g[14]=p,g[15]=m,R(y)}function a(e,t,n,o,r,a,s,c,u,l,f,d,h,p,m,y){const g=i(),E=g._m;return E[0]=e,E[1]=t,E[2]=n,E[3]=o,E[4]=r,E[5]=a,E[6]=s,E[7]=c,E[8]=u,E[9]=l,E[10]=f,E[11]=d,E[12]=h,E[13]=p,E[14]=m,E[15]=y,R(g),g}function s(e,t,n,o){const r=[i(),i(),i()];p(e.x,e.y,e.z,r[1]),B(t,r[0]),U(r[1],r[0],o),O(o,n)}function c(){const e=a(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return F(e,!0),e}function u(e,t){const n=Math.sin(e),i=Math.cos(e);r(1,0,0,0,0,i,n,0,0,-n,i,0,0,0,0,1,t),F(t,1===i&&0===n)}function l(e,t){const n=Math.sin(e),i=Math.cos(e);r(i,0,-n,0,0,1,0,0,n,0,i,0,0,0,0,1,t),F(t,1===i&&0===n)}function f(e,t){const n=Math.sin(e),i=Math.cos(e);r(i,n,0,0,-n,i,0,0,0,0,1,0,0,0,0,1,t),F(t,1===i&&0===n)}function d(e,t,n){const i=Math.sin(-t),o=Math.cos(-t),r=1-o,a=Vector3.normalize(e),s=n._m;s[0]=a.x*a.x*r+o,s[1]=a.x*a.y*r-a.z*i,s[2]=a.x*a.z*r+a.y*i,s[3]=0,s[4]=a.y*a.x*r+a.z*i,s[5]=a.y*a.y*r+o,s[6]=a.y*a.z*r-a.x*i,s[7]=0,s[8]=a.z*a.x*r-a.y*i,s[9]=a.z*a.y*r+a.x*i,s[10]=a.z*a.z*r+o,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,R(n)}function h(e,t,n,i){const o=Quaternion.Zero();Quaternion.fromRotationYawPitchRollToRef(e,t,n,o),B(o,i)}function p(e,t,n,i){r(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1,i),F(i,1===e&&1===t&&1===n)}function m(e,t,n,i){r(1,0,0,0,0,1,0,0,0,0,1,0,e,t,n,1,i),F(i,0===e&&0===t&&0===n)}function y(e,t,n,i){for(let o=0;o<16;o++)i._m[o]=e._m[o]*(1-n)+t._m[o]*n;R(i)}function g(e,t,n,i){const o=Vector3.Zero(),r=Quaternion.Zero(),a=Vector3.Zero();$(e,o,r,a);const c=Vector3.Zero(),u=Quaternion.Zero(),l=Vector3.Zero();$(t,c,u,l);const f=Vector3.Zero();Vector3.lerpToRef(o,c,n,f);const d=Quaternion.Zero();Quaternion.slerpToRef(r,u,n,d);const h=Vector3.Zero();Vector3.lerpToRef(a,l,n,h),s(f,d,h,i)}function E(e,t,n,i){const o=Vector3.Zero(),a=Vector3.Zero(),s=Vector3.Zero();Vector3.subtractToRef(t,e,s),Vector3.normalizeToRef(s,s),Vector3.crossToRef(n,s,o);const c=Vector3.lengthSquared(o);0===c?o.x=1:Vector3.normalizeFromLengthToRef(o,Math.sqrt(c),o),Vector3.crossToRef(s,o,a),Vector3.normalizeToRef(a,a);const u=-Vector3.dot(o,e),l=-Vector3.dot(a,e),f=-Vector3.dot(s,e);r(o.x,a.x,s.x,0,o.y,a.y,s.y,0,o.z,a.z,s.z,0,u,l,f,1,i)}function _(e,t,n,i){const o=Vector3.Zero(),a=Vector3.Zero(),s=Vector3.Zero();Vector3.subtractToRef(e,t,s),Vector3.normalizeToRef(s,s),Vector3.crossToRef(n,s,o);const c=Vector3.lengthSquared(o);0===c?o.x=1:Vector3.normalizeFromLengthToRef(o,Math.sqrt(c),o),Vector3.crossToRef(s,o,a),Vector3.normalizeToRef(a,a);const u=-Vector3.dot(o,e),l=-Vector3.dot(a,e),f=-Vector3.dot(s,e);r(o.x,a.x,s.x,0,o.y,a.y,s.y,0,o.z,a.z,s.z,0,u,l,f,1,i)}function T(e,t,n,i,o){const a=2/e,s=2/t,c=2/(i-n),u=-(i+n)/(i-n);r(a,0,0,0,0,s,0,0,0,0,c,0,0,0,u,1,o),F(o,1===a&&1===s&&1===c&&0===u)}function v(e,t,n,i,o,a,s){r(2/(t-e),0,0,0,0,2/(i-n),0,0,0,0,2/(a-o),0,(e+t)/(e-t),(i+n)/(n-i),-(a+o)/(a-o),1,s),R(s)}function S(e,t,n,i,o,r,a){v(e,t,n,i,o,r,a),a._m[10]*=-1}function b(e,t,n,i,o,a=!0){const s=n,c=i,u=1/Math.tan(.5*e);r(a?u/t:u,0,0,0,0,a?u:u*t,0,0,0,0,(c+s)/(c-s),1,0,0,-2*c*s/(c-s),0,o),F(o,!1)}function A(e,t,n,i,o,a=!0){const s=n,c=i,u=1/Math.tan(.5*e);r(a?u/t:u,0,0,0,0,a?u:u*t,0,0,0,0,-(c+s)/(c-s),-1,0,0,-2*c*s/(c-s),0,o),F(o,!1)}function w(e,t){const n=t._m,i=e._m;n[0]=i[0],n[1]=i[4],n[2]=i[8],n[3]=i[12],n[4]=i[1],n[5]=i[5],n[6]=i[9],n[7]=i[13],n[8]=i[2],n[9]=i[6],n[10]=i[10],n[11]=i[14],n[12]=i[3],n[13]=i[7],n[14]=i[11],n[15]=i[15],F(t,e.isIdentity,e._isIdentityDirty)}function P(e,t){const n=Plane.normalize(e),i=n.normal.x,o=n.normal.y,a=n.normal.z,s=-2*i,c=-2*o,u=-2*a;r(s*i+1,c*i,u*i,0,s*o,c*o+1,u*o,0,s*a,c*a,u*a+1,0,s*n.d,c*n.d,u*n.d,1,t)}function B(e,t){const n=e.x*e.x,i=e.y*e.y,o=e.z*e.z,r=e.x*e.y,a=e.z*e.w,s=e.z*e.x,c=e.y*e.w,u=e.y*e.z,l=e.x*e.w;t._m[0]=1-2*(i+o),t._m[1]=2*(r+a),t._m[2]=2*(s-c),t._m[3]=0,t._m[4]=2*(r-a),t._m[5]=1-2*(o+n),t._m[6]=2*(u+l),t._m[7]=0,t._m[8]=2*(s+c),t._m[9]=2*(u-l),t._m[10]=1-2*(i+n),t._m[11]=0,t._m[12]=0,t._m[13]=0,t._m[14]=0,t._m[15]=1,R(t)}function R(e){e.updateFlag=t++,e.isIdentity=!1,e.isIdentity3x2=!1,e._isIdentityDirty=!0,e._isIdentity3x2Dirty=!0}function C(e){if(!0===e.isIdentity)return 1;const t=e._m,n=t[0],i=t[1],o=t[2],r=t[3],a=t[4],s=t[5],c=t[6],u=t[7],l=t[8],f=t[9],d=t[10],h=t[11],p=t[12],m=t[13],y=t[14],g=t[15],E=d*g-y*h,_=f*g-m*h,T=f*y-m*d,v=l*g-p*h,S=l*y-d*p,b=l*m-p*f;return n*+(s*E-c*_+u*T)+i*-(a*E-c*v+u*S)+o*+(a*_-s*v+u*b)+r*-(a*T-s*S+c*b)}function M(e,t,n){for(let i=0;i<16;i++)n._m[i]=e._m[i]+t._m[i];R(n)}function I(e,t){if(!0===e.isIdentity)return void k(e,t);const n=e._m,i=n[0],o=n[1],a=n[2],s=n[3],c=n[4],u=n[5],l=n[6],f=n[7],d=n[8],h=n[9],p=n[10],m=n[11],y=n[12],g=n[13],E=n[14],_=n[15],T=p*_-E*m,v=h*_-g*m,S=h*E-g*p,b=d*_-y*m,A=d*E-p*y,w=d*g-y*h,P=+(u*T-l*v+f*S),B=-(c*T-l*b+f*A),R=+(c*v-u*b+f*w),C=-(c*S-u*A+l*w),M=i*P+o*B+a*R+s*C;if(0===M)return void k(e,t);const I=1/M,N=l*_-E*f,O=u*_-g*f,x=u*E-g*l,U=c*_-y*f,L=c*E-y*l,$=c*g-y*u,D=l*m-p*f,z=u*m-h*f,F=u*p-h*l,V=c*m-d*f,W=c*p-d*l,G=c*h-d*u;r(P*I,-(o*T-a*v+s*S)*I,+(o*N-a*O+s*x)*I,-(o*D-a*z+s*F)*I,B*I,+(i*T-a*b+s*A)*I,-(i*N-a*U+s*L)*I,+(i*D-a*V+s*W)*I,R*I,-(i*v-o*b+s*w)*I,+(i*O-o*U+s*$)*I,-(i*z-o*V+s*G)*I,C*I,+(i*S-o*A+a*w)*I,-(i*x-o*L+a*$)*I,+(i*F-o*W+a*G)*I,t)}function N(e,t,n,i){e._m[12]=t,e._m[13]=n,e._m[14]=i,R(e)}function O(e,t){N(e,t.x,t.y,t.z)}function k(e,t){x(e,t._m),F(t,e.isIdentity,e._isIdentityDirty,e.isIdentity3x2,e._isIdentity3x2Dirty)}function x(e,t,n=0){for(let i=0;i<16;i++)t[n+i]=e._m[i]}function U(e,t,n){e.isIdentity?k(t,n):t.isIdentity?k(e,n):(L(e,t,n._m,0),R(n))}function L(e,t,n,i){const o=e._m,r=t._m,a=o[0],s=o[1],c=o[2],u=o[3],l=o[4],f=o[5],d=o[6],h=o[7],p=o[8],m=o[9],y=o[10],g=o[11],E=o[12],_=o[13],T=o[14],v=o[15],S=r[0],b=r[1],A=r[2],w=r[3],P=r[4],B=r[5],R=r[6],C=r[7],M=r[8],I=r[9],N=r[10],O=r[11],k=r[12],x=r[13],U=r[14],L=r[15];n[i]=a*S+s*P+c*M+u*k,n[i+1]=a*b+s*B+c*I+u*x,n[i+2]=a*A+s*R+c*N+u*U,n[i+3]=a*w+s*C+c*O+u*L,n[i+4]=l*S+f*P+d*M+h*k,n[i+5]=l*b+f*B+d*I+h*x,n[i+6]=l*A+f*R+d*N+h*U,n[i+7]=l*w+f*C+d*O+h*L,n[i+8]=p*S+m*P+y*M+g*k,n[i+9]=p*b+m*B+y*I+g*x,n[i+10]=p*A+m*R+y*N+g*U,n[i+11]=p*w+m*C+y*O+g*L,n[i+12]=E*S+_*P+T*M+v*k,n[i+13]=E*b+_*B+T*I+v*x,n[i+14]=E*A+_*R+T*N+v*U,n[i+15]=E*w+_*C+T*O+v*L}function $(e,t,n,o){if(e.isIdentity)return o&&(o.x=0,o.y=0,o.z=0),t&&(t.x=1,t.y=1,t.z=1),n&&(n.w=1,n.x=0,n.y=0,n.z=0),!0;const a=e._m;o&&(o.x=a[12],o.y=a[13],o.z=a[14]);const s=t||Vector3.Zero();if(s.x=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]),s.y=Math.sqrt(a[4]*a[4]+a[5]*a[5]+a[6]*a[6]),s.z=Math.sqrt(a[8]*a[8]+a[9]*a[9]+a[10]*a[10]),C(e)<=0&&(s.y*=-1),0===s.x||0===s.y||0===s.z)return n&&(n.w=1,n.x=0,n.y=0,n.z=0),!1;if(n){const e=1/s.x,t=1/s.y,o=1/s.z,c=i();r(a[0]*e,a[1]*e,a[2]*e,0,a[4]*t,a[5]*t,a[6]*t,0,a[8]*o,a[9]*o,a[10]*o,0,0,0,0,1,c),Quaternion.fromRotationMatrixToRef(c,n)}return!0}function D(e,t,n){for(let i=0;i<16;i++)n._m[i]=e._m[i]*t;R(n)}function z(e,t){const n=Vector3.Zero();if(!$(e,n))return void(t=c());const i=e._m,o=1/n.x,a=1/n.y,s=1/n.z;r(i[0]*o,i[1]*o,i[2]*o,0,i[4]*a,i[5]*a,i[6]*a,0,i[8]*s,i[9]*s,i[10]*s,0,0,0,0,1,t)}function F(e,n,i=!1,o=!1,r=!0){e.updateFlag=t++,e.isIdentity=n,e.isIdentity3x2=n||o,e._isIdentityDirty=!e.isIdentity&&i,e._isIdentity3x2Dirty=!e.isIdentity3x2&&r}e.IdentityReadonly=function(){return n},e.create=i,e.fromArray=function(e,t=0){const n=i();return o(e,t,n),n},e.fromArrayToRef=o,e.fromFloatArrayToRefScaled=function(e,t,n,i){for(let o=0;o<16;o++)i._m[o]=e[o+t]*n;R(i)},e.fromValuesToRef=r,e.fromValues=a,e.compose=function(e,t,n){const o=i();return s(e,t,n,o),o},e.composeToRef=s,e.Identity=c,e.IdentityToRef=function(e){r(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,e),F(e,!0)},e.Zero=function(){const e=a(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return F(e,!1),e},e.RotationX=function(e){const t=i();return u(e,t),t},e.rotationXToRef=u,e.rotationY=function(e){const t=i();return l(e,t),t},e.rotationYToRef=l,e.rotationZ=function(e){const t=i();return f(e,t),t},e.rotationZToRef=f,e.rotationAxis=function(e,t){const n=i();return d(e,t,n),n},e.rotationAxisToRef=d,e.rotationYawPitchRoll=function(e,t,n){const o=i();return h(e,t,n,o),o},e.rotationYawPitchRollToRef=h,e.scaling=function(e,t,n){const o=i();return p(e,t,n,o),o},e.scalingToRef=p,e.translation=function(e,t,n){const o=i();return m(e,t,n,o),o},e.translationToRef=m,e.lerp=function(e,t,n){const o=i();return y(e,t,n,o),o},e.lerpToRef=y,e.decomposeLerp=function(e,t,n){const o=i();return g(e,t,n,o),o},e.decomposeLerpToRef=g,e.LookAtLH=function(e,t,n){const o=i();return E(e,t,n,o),o},e.lookAtLHToRef=E,e.lookAtRH=function(e,t,n){const o=i();return _(e,t,n,o),o},e.lookAtRHToRef=_,e.orthoLH=function(e,t,n,o){const r=i();return T(e,t,n,o,r),r},e.orthoLHToRef=T,e.OrthoOffCenterLH=function(e,t,n,o,r,a){const s=i();return v(e,t,n,o,r,a,s),s},e.orthoOffCenterLHToRef=v,e.orthoOffCenterRH=function(e,t,n,o,r,a){const s=i();return S(e,t,n,o,r,a,s),s},e.orthoOffCenterRHToRef=S,e.perspectiveLH=function(e,t,n,o){const a=i();return r(2*n/e,0,0,0,0,2*n/t,0,0,0,0,(o+n)/(o-n),1,0,0,-2*o*n/(o-n),0,a),F(a,!1),a},e.perspectiveFovLH=function(e,t,n,o){const r=i();return b(e,t,n,o,r),r},e.perspectiveFovLHToRef=b,e.PerspectiveFovRH=function(e,t,n,o){const r=i();return A(e,t,n,o,r),r},e.perspectiveFovRHToRef=A,e.perspectiveFovWebVRToRef=function(e,t,n,i,o=!1){const r=o?-1:1,a=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),c=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),l=2/(c+u),f=2/(a+s),d=i._m;d[0]=l,d[1]=d[2]=d[3]=d[4]=0,d[5]=f,d[6]=d[7]=0,d[8]=(c-u)*l*.5,d[9]=-(a-s)*f*.5,d[10]=-n/(t-n),d[11]=1*r,d[12]=d[13]=d[15]=0,d[14]=-2*n*t/(n-t),R(i)},e.GetAsMatrix2x2=function(e){return[e._m[0],e._m[1],e._m[4],e._m[5]]},e.GetAsMatrix3x3=function(e){return[e._m[0],e._m[1],e._m[2],e._m[4],e._m[5],e._m[6],e._m[8],e._m[9],e._m[10]]},e.transpose=function(e){const t=i();return w(e,t),t},e.transposeToRef=w,e.reflection=function(e){const t=i();return P(e,t),t},e.reflectionToRef=P,e.fromXYZAxesToRef=function(e,t,n,i){r(e.x,e.y,e.z,0,t.x,t.y,t.z,0,n.x,n.y,n.z,0,0,0,0,1,i)},e.fromQuaternionToRef=B,e.isIdentityUpdate=function(e){if(e._isIdentityDirty){e._isIdentityDirty=!1;const t=e._m;e.isIdentity=1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}return e.isIdentity},e.isIdentityAs3x2Update=function(e){return e._isIdentity3x2Dirty&&(e._isIdentity3x2Dirty=!1,1!==e._m[0]||1!==e._m[5]||1!==e._m[15]||0!==e._m[1]||0!==e._m[2]||0!==e._m[3]||0!==e._m[4]||0!==e._m[6]||0!==e._m[7]||0!==e._m[8]||0!==e._m[9]||0!==e._m[10]||0!==e._m[11]||0!==e._m[12]||0!==e._m[13]||0!==e._m[14]?e.isIdentity3x2=!1:e.isIdentity3x2=!0),e.isIdentity3x2},e.determinant=C,e.toArray=function(e){return e._m},e.asArray=function(e){return e._m},e.reset=function(e){r(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,e),F(e,!1)},e.add=function(e,t){const n=i();return M(e,t,n),n},e.addToRef=M,e.addToSelf=function(e,t){for(let n=0;n<16;n++)e._m[n]+=t._m[n];R(e)},e.invert=function(e){const t=i();return I(e,t),t},e.invertToRef=I,e.addAtIndex=function(e,t,n){e._m[t]+=n,R(e)},e.multiplyAtIndex=function(e,t,n){return e._m[t]*=n,R(e),e},e.setTranslationFromFloats=N,e.setTranslation=O,e.getTranslation=function(e){return Vector3.create(e._m[12],e._m[13],e._m[14])},e.getTranslationToRef=function(e,t){t.x=e._m[12],t.y=e._m[13],t.z=e._m[14]},e.removeRotationAndScaling=function(e){const t=e._m;return r(1,0,0,0,0,1,0,0,0,0,1,0,t[12],t[13],t[14],t[15],e),F(e,0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]),e},e.multiply=function(e,t){const n=i();return U(e,t,n),n},e.copy=k,e.copyToArray=x,e.multiplyToRef=U,e.multiplyToArray=L,e.equals=function(e,t){const n=t;if(!n)return!1;if((e.isIdentity||n.isIdentity)&&!e._isIdentityDirty&&!n._isIdentityDirty)return e.isIdentity&&n.isIdentity;const i=e._m,o=n._m;return i[0]===o[0]&&i[1]===o[1]&&i[2]===o[2]&&i[3]===o[3]&&i[4]===o[4]&&i[5]===o[5]&&i[6]===o[6]&&i[7]===o[7]&&i[8]===o[8]&&i[9]===o[9]&&i[10]===o[10]&&i[11]===o[11]&&i[12]===o[12]&&i[13]===o[13]&&i[14]===o[14]&&i[15]===o[15]},e.clone=function(e){const t=i();return k(e,t),t},e.getHashCode=function(e){let t=e._m[0]||0;for(let n=1;n<16;n++)t=397*t^(e._m[n]||0);return t},e.decompose=$,e.setRowFromFloats=function(e,t,n,i,o,r){if(t<0||t>3)return;const a=4*t;e._m[a+0]=n,e._m[a+1]=i,e._m[a+2]=o,e._m[a+3]=r,R(e)},e.scale=function(e,t){const n=i();return D(e,t,n),n},e.scaleToRef=D,e.scaleAndAddToRef=function(e,t,n){for(let i=0;i<16;i++)n._m[i]+=e._m[i]*t;R(n)},e.normalMatrixToRef=function(e,t){const n=i();I(e,n),w(n,t);const o=t._m;r(o[0],o[1],o[2],0,o[4],o[5],o[6],0,o[8],o[9],o[10],0,0,0,0,1,t)},e.getRotationMatrix=function(e){const t=i();return z(e,t),t},e.getRotationMatrixToRef=z,e.toggleModelMatrixHandInPlace=function(e){e._m[2]*=-1,e._m[6]*=-1,e._m[8]*=-1,e._m[9]*=-1,e._m[14]*=-1,R(e)},e.toggleProjectionMatrixHandInPlace=function(e){e._m[8]*=-1,e._m[9]*=-1,e._m[10]*=-1,e._m[11]*=-1,R(e)}}(Matrix||(Matrix={})),function(e){function t(e=0,t=0,n=0,i=1){return{x:e,y:t,z:n,w:i}}function n(e,n,i){const o=.5*n,r=.5*e,a=.5*i,s=Math.cos(o),c=Math.cos(r),u=Math.cos(a),l=Math.sin(o),f=Math.sin(r),d=Math.sin(a);return t(c*l*u+f*s*d,f*s*u-c*l*d,c*s*d-f*l*u,c*s*u+f*l*d)}function i(e){return Math.sqrt(o(e))}function o(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w}function r(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w}function a(e,t){const n=r(e,t);return 2*Math.acos(Math.min(Math.abs(n),1))*RAD2DEG}function s(e){const n=1/i(e);return t(e.x*n,e.y*n,e.z*n,e.w*n)}function c(){return t(0,0,0,1)}function u(t,n,i){const o=e.Identity();return e.slerpToRef(t,n,i,o),o}function l(e,t,n){n.x=e.x*t.w+e.y*t.z-e.z*t.y+e.w*t.x,n.y=-e.x*t.z+e.y*t.w+e.z*t.x+e.w*t.y,n.z=e.x*t.y-e.y*t.x+e.z*t.w+e.w*t.z,n.w=-e.x*t.x-e.y*t.y-e.z*t.z+e.w*t.w}function f(t,n,i,o){const r=Matrix.create();Matrix.fromXYZAxesToRef(Vector3.normalize(t),Vector3.normalize(n),Vector3.normalize(i),r),e.fromRotationMatrixToRef(r,o)}function d(t,n,i=Vector3.Up(),o){const r=Matrix.Identity();Matrix.lookAtLHToRef(t,n,i,r),Matrix.invertToRef(r,r),e.fromRotationMatrixToRef(r,o)}e.create=t,e.add=function(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z,w:e.w+t.w}},e.fromRotationYawPitchRoll=n,e.fromEulerDegrees=function(e,t,i){return n(t*DEG2RAD,e*DEG2RAD,i*DEG2RAD)},e.length=i,e.lengthSquared=o,e.dot=r,e.angle=a,e.rotateTowards=function(e,t,n){const i=a(e,t);return 0===i?t:u(e,t,Math.min(1,n/i))},e.lookRotation=function(e,n={x:0,y:1,z:0}){const i=Vector3.normalize(e),o=Vector3.normalize(Vector3.cross(n,i)),r=Vector3.cross(i,o),a=o.x,s=o.y,c=o.z,u=r.x,l=r.y,f=r.z,d=i.x,h=i.y,p=i.z,m=a+l+p,y=t();if(m>0){let e=Math.sqrt(m+1);return y.w=.5*e,e=.5/e,y.x=(f-h)*e,y.y=(d-c)*e,y.z=(s-u)*e,y}if(a>=l&&a>=p){const e=Math.sqrt(1+a-l-p),t=.5/e;return y.x=.5*e,y.y=(s+u)*t,y.z=(c+d)*t,y.w=(f-h)*t,y}if(l>p){const e=Math.sqrt(1+l-a-p),t=.5/e;return y.x=(u+s)*t,y.y=.5*e,y.z=(h+f)*t,y.w=(d-c)*t,y}const g=Math.sqrt(1+p-a-l),E=.5/g;return y.x=(d+c)*E,y.y=(h+f)*E,y.z=.5*g,y.w=(s-u)*E,y},e.normalize=s,e.fromToRotation=function(e,n,i=Vector3.Up()){const o=Vector3.normalize(e),r=Vector3.normalize(n),a=Vector3.cross(o,r),u=Math.sqrt(Vector3.lengthSquared(o)*Vector3.lengthSquared(r))+Vector3.dot(o,r);return Vector3.lengthSquared(a)<1e-4?Math.abs(u)<1e-4?s(t(i.x,i.y,i.z,0)):c():s(t(a.x,a.y,a.z,u))},e.Identity=c,e.toEulerAngles=function(e){const t=Vector3.create(),n=e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w,i=e.x*e.w-e.y*e.z;return i>.4995*n?(t.x=Math.PI/2,t.y=2*Math.atan2(e.y,e.x),t.z=0):i<-.4995*n?(t.x=-Math.PI/2,t.y=-2*Math.atan2(e.y,e.x),t.z=0):(t.x=Math.asin(2*(e.w*e.x-e.y*e.z)),t.y=Math.atan2(2*e.w*e.y+2*e.z*e.x,1-2*(e.x*e.x+e.y*e.y)),t.z=Math.atan2(2*e.w*e.z+2*e.x*e.y,1-2*(e.z*e.z+e.x*e.x))),t.x*=RAD2DEG,t.y*=RAD2DEG,t.z*=RAD2DEG,t.x=Scalar.repeat(t.x,360),t.y=Scalar.repeat(t.y,360),t.z=Scalar.repeat(t.z,360),t},e.fromRotationYawPitchRollToRef=function(e,t,n,i){const o=.5*t,r=.5*e,a=.5*n,s=Math.cos(o),c=Math.cos(r),u=Math.cos(a),l=Math.sin(o),f=Math.sin(r),d=Math.sin(a);i.x=c*l*u+f*s*d,i.y=f*s*u-c*l*d,i.z=c*s*d-f*l*u,i.w=c*s*u+f*l*d},e.fromRotationMatrixToRef=function(e,t){const n=e._m,i=n[0],o=n[4],r=n[8],a=n[1],s=n[5],c=n[9],u=n[2],l=n[6],f=n[10],d=i+s+f;let h;d>0?(h=.5/Math.sqrt(d+1),t.w=.25/h,t.x=(l-c)*h,t.y=(r-u)*h,t.z=(a-o)*h):i>s&&i>f?(h=2*Math.sqrt(1+i-s-f),t.w=(l-c)/h,t.x=.25*h,t.y=(o+a)/h,t.z=(r+u)/h):s>f?(h=2*Math.sqrt(1+s-i-f),t.w=(r-u)/h,t.x=(o+a)/h,t.y=.25*h,t.z=(c+l)/h):(h=2*Math.sqrt(1+f-i-s),t.w=(a-o)/h,t.x=(r+u)/h,t.y=(c+l)/h,t.z=.25*h)},e.slerp=u,e.slerpToRef=function(e,t,n,i){let o,r,a=e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w,s=!1;if(a<0&&(s=!0,a=-a),a>.999999)r=1-n,o=s?-n:n;else{const e=Math.acos(a),t=1/Math.sin(e);r=Math.sin((1-n)*e)*t,o=s?-Math.sin(n*e)*t:Math.sin(n*e)*t}i.x=r*e.x+o*t.x,i.y=r*e.y+o*t.y,i.z=r*e.z+o*t.z,i.w=r*e.w+o*t.w},e.multiply=function(e,n){const i=t(0,0,0,1);return l(e,n,i),i},e.multiplyToRef=l,e.fromAngleAxis=function(t,n){if(0===Vector3.lengthSquared(n))return e.Identity();const i=c();let o=t*DEG2RAD;o*=.5;const r=Vector3.normalize(n);return Vector3.scaleToRef(r,Math.sin(o),r),i.x=r.x,i.y=r.y,i.z=r.z,i.w=Math.cos(o),s(i)},e.fromAxisToRotationQuaternion=function(t,n,i){const o=e.create(0,0,0,0);return f(t,n,i,o),o},e.fromAxisToRotationQuaternionToRef=f,e.Zero=function(){return t(0,0,0,0)},e.fromLookAt=function(t,n,i=Vector3.Up()){const o=e.Identity();return d(t,n,i,o),o},e.fromLookAtToRef=d}(Quaternion||(Quaternion={})),function(e){function t(e=0,t=0){return{x:e,y:t}}e.create=t,e.Zero=function(){return t(0,0)},e.One=function(){return t(1,1)}}(Vector2||(Vector2={})),function(e){function t(e=0,t=0,n=0,i=1){return{r:e,g:t,b:n,a:i}}function n(){return t(0,0,0,0)}function i(e,t,n){n.r=e.r+t.r,n.g=e.g+t.g,n.b=e.b+t.b,n.a=e.a+t.a}function o(e,t,n){n.r=e.r-t.r,n.g=e.g-t.g,n.b=e.b-t.b,n.a=e.a-t.a}function r(e,t){t.r=Math.pow(e.r,ToLinearSpace),t.g=Math.pow(e.g,ToLinearSpace),t.b=Math.pow(e.b,ToLinearSpace),t.a=e.a}function a(e,t){t.r=Math.pow(e.r,ToGammaSpace),t.g=Math.pow(e.g,ToGammaSpace),t.b=Math.pow(e.b,ToGammaSpace),t.a=e.a}e.create=t,e.fromHexString=function(n){if("#"!==n.substring(0,1)||7!==n.length&&9!==n.length)return t(0,0,0,1);const i=parseInt(n.substring(1,3),16),o=parseInt(n.substring(3,5),16),r=parseInt(n.substring(5,7),16),a=n.substring(7,9),s=a?parseInt(a,16):255;return e.fromInts(i,o,r,s)},e.lerp=function(n,i,o){const r=t(0,0,0,0);return e.lerpToRef(n,i,o,r),r},e.lerpToRef=function(e,t,n,i){i.r=e.r+(t.r-e.r)*n,i.g=e.g+(t.g-e.g)*n,i.b=e.b+(t.b-e.b)*n,i.a=e.a+(t.a-e.a)*n},e.Red=function(){return t(1,0,0,1)},e.Green=function(){return t(0,1,0,1)},e.Blue=function(){return t(0,0,1,1)},e.Black=function(){return t(0,0,0,1)},e.White=function(){return t(1,1,1,1)},e.Purple=function(){return t(.5,0,.5,1)},e.Magenta=function(){return t(1,0,1,1)},e.Yellow=function(){return t(1,1,0,1)},e.Gray=function(){return t(.5,.5,.5,1)},e.Teal=function(){return t(0,1,1,1)},e.Clear=n,e.fromColor3=function(e,n=1){return t(e.r,e.g,e.b,n)},e.fromArray=function(e,n=0){return t(e[n],e[n+1],e[n+2],e[n+3])},e.fromInts=function(e,n,i,o){return t(e/255,n/255,i/255,o/255)},e.checkColors4=function(e,t){if(e.length===3*t){const t=[];for(let n=0;n<e.length;n+=3){const i=n/3*4;t[i]=e[n],t[i+1]=e[n+1],t[i+2]=e[n+2],t[i+3]=1}return t}return e},e.addToRef=i,e.toArray=function(e,t,n=0){t[n]=e.r,t[n+1]=e.g,t[n+2]=e.b,t[n+3]=e.a},e.add=function(e,t){const o=n();return i(e,t,o),o},e.subtract=function(e,t){const i=n();return o(e,t,i),i},e.subtractToRef=o,e.scale=function(e,n){return t(e.r*n,e.g*n,e.b*n,e.a*n)},e.scaleToRef=function(e,t,n){n.r=e.r*t,n.g=e.g*t,n.b=e.b*t,n.a=e.a*t},e.scaleAndAddToRef=function(e,t,n){n.r+=e.r*t,n.g+=e.g*t,n.b+=e.b*t,n.a+=e.a*t},e.clampToRef=function(e,t=0,n=1,i){i.r=Scalar.clamp(e.r,t,n),i.g=Scalar.clamp(e.g,t,n),i.b=Scalar.clamp(e.b,t,n),i.a=Scalar.clamp(e.a,t,n)},e.multiply=function(e,n){return t(e.r*n.r,e.g*n.g,e.b*n.b,e.a*n.a)},e.multiplyToRef=function(e,t,n){n.r=e.r*t.r,n.g=e.g*t.g,n.b=e.b*t.b,n.a=e.a*t.a},e.toString=function(e){return"{R: "+e.r+" G:"+e.g+" B:"+e.b+" A:"+e.a+"}"},e.getHashCode=function(e){let t=e.r||0;return t=397*t^(e.g||0),t=397*t^(e.b||0),t=397*t^(e.a||0),t},e.clone=function(e){return t(e.r,e.g,e.b,e.a)},e.copyFrom=function(e,t){t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a},e.copyFromFloats=function(e,t,n,i,o){o.r=e,o.g=t,o.b=n,o.a=i},e.set=function(e,t,n,i,o){o.r=e,o.g=t,o.b=n,o.a=i},e.toHexString=function(e){const t=255*e.r|0,n=255*e.g|0,i=255*e.b|0,o=255*e.a|0;return"#"+Scalar.toHex(t)+Scalar.toHex(n)+Scalar.toHex(i)+Scalar.toHex(o)},e.toLinearSpace=function(e){const n=t();return r(e,n),n},e.toLinearSpaceToRef=r,e.toGammaSpace=function(e){const n=t();return a(e,n),n},e.toGammaSpaceToRef=a}(Color4||(Color4={})),function(e){function t(e=0,t=0,n=0){return{r:e,g:t,b:n}}function n(e,n,i){return t(e/255,n/255,i/255)}function i(e,t,n=0){t[n]=e.r,t[n+1]=e.g,t[n+2]=e.b}function o(e,t=0,n=1,i){i.r=Scalar.clamp(e.r,t,n),i.g=Scalar.clamp(e.g,t,n),i.b=Scalar.clamp(e.b,t,n)}function r(e,t){t.r=Math.pow(e.r,ToLinearSpace),t.g=Math.pow(e.g,ToLinearSpace),t.b=Math.pow(e.b,ToLinearSpace)}function a(e,t){t.r=Math.pow(e.r,ToGammaSpace),t.g=Math.pow(e.g,ToGammaSpace),t.b=Math.pow(e.b,ToGammaSpace)}e.create=t,e.fromHexString=function(e){return"#"!==e.substring(0,1)||7!==e.length?t(0,0,0):n(parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16))},e.fromArray=function(e,n=0){return t(e[n],e[n+1],e[n+2])},e.fromInts=n,e.lerp=function(n,i,o){const r=t(0,0,0);return e.lerpToRef(n,i,o,r),r},e.lerpToRef=function(e,t,n,i){i.r=e.r+(t.r-e.r)*n,i.g=e.g+(t.g-e.g)*n,i.b=e.b+(t.b-e.b)*n},e.Red=function(){return t(1,0,0)},e.Green=function(){return t(0,1,0)},e.Blue=function(){return t(0,0,1)},e.Black=function(){return t(0,0,0)},e.White=function(){return t(1,1,1)},e.Purple=function(){return t(.5,0,.5)},e.Magenta=function(){return t(1,0,1)},e.Yellow=function(){return t(1,1,0)},e.Gray=function(){return t(.5,.5,.5)},e.Teal=function(){return t(0,1,1)},e.Random=function(){return t(Math.random(),Math.random(),Math.random())},e.toString=function(e){return"{R: "+e.r+" G:"+e.g+" B:"+e.b+"}"},e.getHashCode=function(e){let t=e.r||0;return t=397*t^(e.g||0),t=397*t^(e.b||0),t},e.toArray=i,e.toColor4=function(e,t=1){return Color4.create(e.r,e.g,e.b,t)},e.asArray=function(e){const t=new Array;return i(e,t,0),t},e.toLuminance=function(e){return.3*e.r+.59*e.g+.11*e.b},e.multiply=function(e,n){return t(e.r*n.r,e.g*n.g,e.b*n.b)},e.multiplyToRef=function(e,t,n){n.r=e.r*t.r,n.g=e.g*t.g,n.b=e.b*t.b},e.equals=function(e,t){return t&&e.r===t.r&&e.g===t.g&&e.b===t.b},e.equalsFloats=function(e,t,n,i){return e.r===t&&e.g===n&&e.b===i},e.scale=function(e,n){return t(e.r*n,e.g*n,e.b*n)},e.scaleToRef=function(e,t,n){n.r=e.r*t,n.g=e.g*t,n.b=e.b*t},e.scaleAndAddToRef=function(e,t,n){n.r+=e.r*t,n.g+=e.g*t,n.b+=e.b*t},e.clampToRef=o,e.clamp=function(t,n=0,i=1){const r=e.Black();return o(t,n,i,r),r},e.add=function(e,n){return t(e.r+n.r,e.g+n.g,e.b+n.b)},e.addToRef=function(e,t,n){n.r=e.r+t.r,n.g=e.g+t.g,n.b=e.b+t.b},e.subtract=function(e,n){return t(e.r-n.r,e.g-n.g,e.b-n.b)},e.subtractToRef=function(e,t,n){n.r=e.r-t.r,n.g=e.g-t.g,n.b=e.b-t.b},e.clone=function(e){return t(e.r,e.g,e.b)},e.copyFrom=function(e,t){t.r=e.r,t.g=e.g,t.b=e.b},e.set=function(e,t,n,i){e.r=t,e.g=n,e.b=i},e.toHexString=function(e){const t=255*e.r|0,n=255*e.g|0,i=255*e.b|0;return"#"+Scalar.toHex(t)+Scalar.toHex(n)+Scalar.toHex(i)},e.toLinearSpace=function(e){const n=t();return r(e,n),n},e.toLinearSpaceToRef=r,e.toGammaSpace=function(e){const n=t();return a(e,n),n},e.toGammaSpaceToRef=a}(Color3||(Color3={})),function(e){e.LINEAR="linear",e.EASEINQUAD="easeinquad",e.EASEOUTQUAD="easeoutquad",e.EASEQUAD="easequad",e.EASEINSINE="easeinsine",e.EASEOUTSINE="easeoutsine",e.EASESINE="easeinoutsine",e.EASEINEXPO="easeinexpo",e.EASEOUTEXPO="easeoutexpo",e.EASEEXPO="easeinoutexpo",e.EASEINELASTIC="easeinelastic",e.EASEOUTELASTIC="easeoutelastic",e.EASEELASTIC="easeinoutelastic",e.EASEINBOUNCE="easeinbounce",e.EASEOUTEBOUNCE="easeoutbounce",e.EASEBOUNCE="easeinoutbounce"}(InterpolationType||(InterpolationType={}));const REGULAR_PRIORITY=1e5;var priority;function createTimers(e){const t=new Map;let n=0;return e.addSystem((function(e){let n=[],i=[];for(let[o,r]of t)r.accumulatedTime+=1e3*e,r.accumulatedTime<r.interval||(i.push(r.callback),r.recurrent?r.accumulatedTime-=Math.floor(r.accumulatedTime/r.interval)*r.interval:n.push(o));for(let e of n)t.delete(e);for(let e of i)e()}),priority.TimerSystemPriority),{setTimeout(e,i){let o=n++;return t.set(o,{callback:e,interval:i,recurrent:!1,accumulatedTime:0}),o},clearTimeout(e){t.delete(e)},setInterval(e,i){let o=n++;return t.set(o,{callback:e,interval:i,recurrent:!0,accumulatedTime:0}),o},clearInterval(e){t.delete(e)}}}!function(e){e.TimerSystemPriority=REGULAR_PRIORITY+256,e.TweenSystemPriority=REGULAR_PRIORITY+192,e.PerpetualMotionSystemPriority=REGULAR_PRIORITY+192,e.PathSystemPriority=REGULAR_PRIORITY+192,e.TriggerSystemPriority=REGULAR_PRIORITY+128,e.ActionSystemPriority=REGULAR_PRIORITY+64}(priority||(priority={}));const timers=createTimers(engine);var ToggleState,AXIS;function createToggles(e,t){const n=e.defineComponent("dcl.utils.Toggle",{state:Schemas.EnumNumber(ToggleState,ToggleState.Off)});let i=new Map;return t.setInterval((function(){for(const t of i.keys())e.getEntityState(t)!=EntityState.Removed&&n.has(t)||i.delete(t)}),5e3),{addToggle(e,t,o){i.set(e,o),n.createOrReplace(e,{state:t})},removeToggle(e){i.delete(e),n.deleteFrom(e)},setCallback(e,t){i.set(e,t)},set(e,t){if(n.get(e).state!=t){n.getMutable(e).state=t;const o=i.get(e);o&&o(t)}},flip(e){this.set(e,1-n.get(e).state)},isOn:e=>n.get(e).state==ToggleState.On}}function getEasingFunctionFromInterpolation(e){switch(e){case InterpolationType.LINEAR:return 0;case InterpolationType.EASEINQUAD:return 1;case InterpolationType.EASEOUTQUAD:return 2;case InterpolationType.EASEQUAD:return 3;case InterpolationType.EASEINSINE:return 4;case InterpolationType.EASEOUTSINE:return 5;case InterpolationType.EASESINE:return 6;case InterpolationType.EASEINEXPO:return 7;case InterpolationType.EASEOUTEXPO:return 8;case InterpolationType.EASEEXPO:return 9;case InterpolationType.EASEINELASTIC:return 10;case InterpolationType.EASEOUTELASTIC:return 11;case InterpolationType.EASEELASTIC:return 12;case InterpolationType.EASEINBOUNCE:return 13;case InterpolationType.EASEOUTEBOUNCE:return 14;case InterpolationType.EASEBOUNCE:return 15;default:return 0}}function createTweens(e){const t=new Map;function n(e){Tween.deleteFrom(e),t.delete(e)}function i(e){return function(n,i,o,r,a=InterpolationType.LINEAR,s){const c=0===r?1:0;t.set(n,{normalizedTime:c,callback:s}),Tween.createOrReplace(n,{duration:1e3*r,easingFunction:getEasingFunctionFromInterpolation(a),currentTime:c,mode:Tween.Mode[e]({start:i,end:o})})}}function o(e){if(!t.has(e))throw new Error(`Entity ${e} is not registered with tweens system`);return t.get(e)}return e.addSystem((function(n){const i=[];for(const[o,r]of t.entries()){if(e.getEntityState(o)==EntityState.Removed||!Tween.has(o)){t.delete(o);continue}const a=Tween.get(o);r.normalizedTime+=1e3*n,r.normalizedTime>=a.duration&&i.push(o)}for(const e of i){const n=t.get(e)?.callback;Tween.deleteFrom(e),t.delete(e),n&&n()}}),priority.TweenSystemPriority),{startTranslation:i("Move"),stopTranslation:n,startRotation:i("Rotate"),stopRotation:n,startScaling:i("Scale"),stopScaling:n,getTranslationOnFinishCallback:o,getRotationOnFinishCallback:o,getScalingOnFinishCallback:o}}function createPerpetualMotions(e){const t=e.defineComponent("dcl.utils.PerpetualRotation",{velocity:Schemas.Quaternion});return e.addSystem((function(n){for(const[i,o]of e.getEntitiesWith(t,Transform)){const e=Quaternion.slerp(Quaternion.Identity(),o.velocity,n),t=Transform.getMutable(i);t.rotation=Quaternion.normalize(Quaternion.multiply(t.rotation,e))}}),priority.PerpetualMotionSystemPriority),{startRotation(e,n){t.createOrReplace(e,{velocity:n})},stopRotation(e){Tween.has(e)&&Tween.deleteFrom(e),TweenSequence.has(e)&&TweenSequence.deleteFrom(e),t.has(e)&&t.deleteFrom(e)},smoothRotation(e,t,n){let i=Quaternion.fromEulerDegrees(0,180,0),o=Quaternion.fromEulerDegrees(0,360,0);switch(n){case AXIS.X:i=Quaternion.fromEulerDegrees(180,0,0),o=Quaternion.fromEulerDegrees(360,0,0);break;case AXIS.Y:i=Quaternion.fromEulerDegrees(0,180,0),o=Quaternion.fromEulerDegrees(0,360,0);break;case AXIS.Z:i=Quaternion.fromEulerDegrees(0,0,180),o=Quaternion.fromEulerDegrees(0,0,360)}Tween.createOrReplace(e,{mode:Tween.Mode.Rotate({start:Quaternion.fromEulerDegrees(0,0,0),end:i}),duration:t/2,easingFunction:0}),TweenSequence.create(e,{loop:0,sequence:[{mode:Tween.Mode.Rotate({start:i,end:o}),duration:t/2,easingFunction:0}]})}}}function createPaths(e){const t=e.defineComponent("dcl.utils.FollowPath",{points:Schemas.Array(Schemas.Vector3),faceDirection:Schemas.Boolean,speed:Schemas.Number,normalizedTime:Schemas.Number,currentIndex:Schemas.Number,segmentTimes:Schemas.Array(Schemas.Number),curveSegmentCount:Schemas.Number}),n=new Map,i=new Map;function o(e){n.delete(e),i.delete(e),t.deleteFrom(e)}function r(e,o,r,a,s,c,u){if(o.length<2)throw new Error("At least 2 points are required to form a path.");if(0==r)throw new Error("Path duration must not be zero");if(s){const e=Vector3.equals(o[0],o[o.length-1]);e&&(o.pop(),o.unshift(o.pop())),o=createCatmullRomSpline(o,s,e)}else s=1;n.set(e,c),i.set(e,u);let l=0;const f=[];for(let e=0;e<o.length-1;e++){let t=Vector3.distance(o[e],o[e+1]);l+=t,f.push(t)}const d=[0];for(let e=0;e<f.length;e++)d.push(f[e]/l+d[e]);t.createOrReplace(e,{points:o,segmentTimes:d,curveSegmentCount:s,speed:1/r,normalizedTime:0,currentIndex:0,faceDirection:a})}return e.addSystem((function(r){const a=[],s=[];for(const i of n.keys()){if(e.getEntityState(i)==EntityState.Removed||!t.has(i)){o(i);continue}const n=Transform.getMutable(i),c=t.getMutable(i);for(c.normalizedTime=Scalar.clamp(c.normalizedTime+r*c.speed,0,1),c.normalizedTime>=1&&a.push(i);c.normalizedTime>=c.segmentTimes[c.currentIndex]&&c.currentIndex<c.points.length-1;){if(c.faceDirection){const e=Vector3.subtract(c.points[c.currentIndex+1],c.points[c.currentIndex]);n.rotation=Quaternion.lookRotation(e)}if(c.currentIndex>0&&c.currentIndex%c.curveSegmentCount==0){const e=c.currentIndex/c.curveSegmentCount,t=c.points[c.currentIndex],n=c.points[c.currentIndex+c.curveSegmentCount];s.push({entity:i,index:e,coords:t,nextCoords:n})}c.currentIndex+=1}const u=c.segmentTimes[c.currentIndex]-c.segmentTimes[c.currentIndex-1],l=(c.segmentTimes[c.currentIndex]-c.normalizedTime)/u;n.position=Vector3.lerp(c.points[c.currentIndex],c.points[c.currentIndex-1],l)}for(const e of s){const t=i.get(e.entity);t&&t(e.index,e.coords,e.nextCoords)}for(const e of a){const t=n.get(e);o(e),t&&t()}}),priority.PathSystemPriority),{startStraightPath:(e,t,n,i,o,a)=>r(e,t,n,i,0,o,a),startSmoothPath(e,t,n,i,o,a,s){if(i<2||!Number.isInteger(i))throw new Error(`segmentCount must be an integer that is greater than 2, got: ${i}`);return r(e,t,n,o,i,a,s)},stopPath(e){o(e)},getOnFinishCallback(e){if(!n.has(e))throw new Error(`Entity ${e} is not registered in triggers system`);return n.get(e)}}}!function(e){e[e.Off=0]="Off",e[e.On=1]="On"}(ToggleState||(ToggleState={})),createToggles(engine,timers),createTweens(engine),function(e){e.X="x",e.Y="y",e.Z="z"}(AXIS||(AXIS={})),createPerpetualMotions(engine),createPaths(engine);const LAYER_1=1,ALL_LAYERS=255,NO_LAYERS=0;let PLAYER_LAYER_ID=LAYER_1;function createTriggers(e){const t=engine.defineComponent("dcl.utils.Trigger",{active:Schemas.Boolean,layerMask:Schemas.Int,triggeredByMask:Schemas.Int,areas:Schemas.Array(Schemas.OneOf({box:Schemas.Map({position:Schemas.Vector3,scale:Schemas.Vector3}),sphere:Schemas.Map({position:Schemas.Vector3,radius:Schemas.Number})})),debugColor:Schemas.Color3}),n=new Map,i=new Map;let o=!1;const r=new Map,a=new Map;function s(e,t,n,i){for(let o=0;o<t.areas.length;++o){const r=e[o],a=t.areas[o];if("box"==a.$case){const e=a.value,t=Vector3.subtract(r,Vector3.scale(e.scale,.5)),o=Vector3.add(t,e.scale);for(let e=0;e<i.areas.length;++e){const r=n[e],a=i.areas[e];if("box"==a.$case){const e=a.value,n=Vector3.subtract(r,Vector3.scale(e.scale,.5));if(areAABBIntersecting(t,o,n,Vector3.add(n,e.scale)))return!0}else if(areAABBSphereIntersecting(t,o,r,a.value.radius))return!0}}else{const e=a.value.radius;for(let t=0;t<i.areas.length;++t){const o=n[t],a=i.areas[t];if("box"==a.$case){const t=a.value,n=Vector3.subtract(o,Vector3.scale(t.scale,.5));if(areAABBSphereIntersecting(n,Vector3.add(n,t.scale),r,e))return!0}else if(areSpheresIntersecting(r,e,o,a.value.radius))return!0}}}return!1}function c(n,i){let o=EMPTY_IMMUTABLE_SET;const r=t.get(n);if(!r.active)return o;if(r.triggeredByMask==PLAYER_LAYER_ID){const a=e.PlayerEntity,c=t.get(e.PlayerEntity);if(a==n)return o;if(!c.active)return o;if(!(r.triggeredByMask&c.layerMask))return o;s(i.get(n),r,i.get(a),c)&&(o===EMPTY_IMMUTABLE_SET&&(o=new Set),o.add(a))}else for(const[a,c]of e.getEntitiesWith(t,Transform)){if(a==n)continue;if(!c.active)continue;if(!(r.triggeredByMask&c.layerMask))continue;s(i.get(n),r,i.get(a),c)&&(o===EMPTY_IMMUTABLE_SET&&(o=new Set),o.add(a))}return o}function u(e){e||(e=[{type:"box"}]);const t=[];for(const n of e)"box"==n.type?t.push({$case:"box",value:{position:n.position?n.position:Vector3.Zero(),scale:n.scale?n.scale:Vector3.One()}}):t.push({$case:"sphere",value:{position:n.position?n.position:Vector3.Zero(),radius:n.radius?n.radius:1}});return t}e.addSystem((function(s){!function(){const o=[],s=[],u=new Map;for(const o of r.keys()){if(e.getEntityState(o)==EntityState.Removed||!t.has(o)){for(const t of a.get(o))e.removeEntity(t);for(const e of r.values())e.has(o)&&e.delete(o);a.delete(o),r.delete(o),n.delete(o),i.delete(o);continue}const s=[],c=getWorldPosition(o),l=getWorldRotation(o),f=t.get(o);for(const e of f.areas)s.push(Vector3.add(c,Vector3.rotate(e.value.position,l)));u.set(o,s)}for(const e of r.keys()){const t=c(e,u),n=r.get(e);for(const i of n)t.has(i)||s.push([e,i]);for(const i of t)n.has(i)||o.push([e,i]);r.set(e,t)}for(const[e,t]of o){const i=n.get(e);i&&i(t)}for(const[e,t]of s){const n=i.get(e);n&&n(t)}}(),function(n){if(n)for(const[n,i]of e.getEntitiesWith(t,Transform)){let t=a.get(n);const o=i.areas.length;for(;t.length>o;)e.removeEntity(t.pop());for(;t.length<o;)t.push(e.addEntity());const r=getWorldPosition(n),s=getWorldRotation(n);for(let e=0;e<o;++e){const n=i.areas[e],o=t[e];let a;if("box"==n.$case)a=n.value.scale,MeshRenderer.setBox(o);else{const e=n.value.radius;a={x:e,y:e,z:e},MeshRenderer.setSphere(o)}Transform.createOrReplace(o,{position:Vector3.add(r,Vector3.rotate(n.value.position,s)),scale:a});const c=i.active?i.debugColor:Color3.Black();Material.setPbrMaterial(o,{albedoColor:Color4.fromInts(255*c.r,255*c.g,255*c.b,75)})}}}(o)}),priority.TriggerSystemPriority);const l={addTrigger(e,o=NO_LAYERS,s=NO_LAYERS,c,l,f,d){if(o<0||o>ALL_LAYERS||!Number.isInteger(o))throw new Error(`Bad layerMask: ${o}. Expected a non-negative integer no greater than ${ALL_LAYERS}`);if(s<0||s>ALL_LAYERS||!Number.isInteger(s))throw new Error(`Bad triggeredByMask: ${s}. Expected a non-negative integer no greater than ${ALL_LAYERS}`);a.set(e,[]),r.set(e,new Set),n.set(e,l),i.set(e,f),t.createOrReplace(e,{active:!0,layerMask:o,triggeredByMask:s,areas:u(c),debugColor:d||Color3.Red()})},removeTrigger(o){const s=r.get(o),c=i.get(o);for(const t of a.get(o))e.removeEntity(t);a.delete(o),r.delete(o),n.delete(o),i.delete(o),t.deleteFrom(o);const u=[];for(const[e,t]of r)t.has(o)&&(t.delete(o),u.push(e));if(c)for(const e of s)c(e);for(const e of u){const t=i.get(e);t&&t(o)}},oneTimeTrigger(e,t=NO_LAYERS,n=NO_LAYERS,i,o,r){this.addTrigger(e,t,n,i,(function(t){triggers.removeTrigger(e),o&&o(t)}),void 0,r)},enableTrigger(e,n){t.getMutable(e).active=n},isTriggerEnabled:e=>t.get(e).active,getLayerMask:e=>t.get(e).layerMask,setLayerMask(e,n){if(n<0||n>ALL_LAYERS||!Number.isInteger(n))throw new Error(`Bad layerMask: ${n}. Expected a non-negative integer no greater than ${ALL_LAYERS}`);t.getMutable(e).layerMask=n},getTriggeredByMask:e=>t.get(e).triggeredByMask,setTriggeredByMask(e,n){if(n<0||n>ALL_LAYERS||!Number.isInteger(n))throw new Error(`Bad layerMask: ${n}. Expected a non-negative integer no greater than ${ALL_LAYERS}`);t.getMutable(e).triggeredByMask=n},getAreas:e=>t.get(e).areas,setAreas(e,n){t.getMutable(e).areas=u(n)},setOnEnterCallback(e,t){n.set(e,t)},setOnExitCallback(e,t){i.set(e,t)},enableDebugDraw(t){if(o=t,!t)for(const t of a.values()){for(const n of t)e.removeEntity(n);t.length=0}},isDebugDrawEnabled:()=>o};return l.addTrigger(e.PlayerEntity,PLAYER_LAYER_ID,NO_LAYERS,[{type:"box",scale:{x:.65,y:1.92,z:.65},position:{x:0,y:.96,z:0}}],void 0,void 0,Color3.Green()),l}const triggers=createTriggers(engine),EMPTY_IMMUTABLE_SET=new Set;var actions;EMPTY_IMMUTABLE_SET.add=e=>{throw new Error("EMPTY_SET is read only")},EMPTY_IMMUTABLE_SET.delete=e=>{throw new Error("EMPTY_SET is read only")},EMPTY_IMMUTABLE_SET.has=e=>!1,function(e){e.SequenceRunner=class{constructor(e,t,n){this.beginSequenceNode=null,this.currentSequenceNode=null,this.running=!1,this.started=!1,this.engine=e,this.systemFn=e=>{this.update(e)},this.engine.addSystem(this.systemFn,priority.ActionSystemPriority),t&&this.startSequence(t),n&&this.setOnFinishCallback(n)}startSequence(e){this.beginSequenceNode=e.beginSequenceNode,this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1}destroy(){this.engine.removeSystem(this.systemFn)}setOnFinishCallback(e){this.onFinishCallback=e}isRunning(){return this.running}stop(){this.running=!1}resume(){null!=this.beginSequenceNode&&(this.running=!0)}reset(){this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1}getRunningAction(){let e=this.currentSequenceNode;if(this.currentSequenceNode instanceof n)do{e=e.currentInnerSequence}while(e instanceof n);return e.action}update(e){if(this.running)return this.started?void(this.currentSequenceNode.hasFinish()?(this.currentSequenceNode.onFinish(),this.currentSequenceNode=this.currentSequenceNode.next,this.currentSequenceNode?this.currentSequenceNode.onStart():(this.running=!1,this.onFinishCallback&&this.onFinishCallback())):this.currentSequenceNode.update(e)):(this.currentSequenceNode.onStart(),void(this.started=!0))}};e.SequenceBuilder=class{constructor(){this.currentSequenceNode=null,this.beginSequenceNode=null,this.whileNodeStack=[]}then(e){if(null==this.currentSequenceNode)this.currentSequenceNode=new t,this.currentSequenceNode.action=e,this.beginSequenceNode=this.currentSequenceNode;else{let n=new t;n.action=e,this.currentSequenceNode=this.currentSequenceNode.then(n)}return this}if(e){let t=new i(e);return null==this.currentSequenceNode?(this.currentSequenceNode=t,this.beginSequenceNode=t):this.currentSequenceNode=this.currentSequenceNode.then(t),this}else(){let e=this.currentSequenceNode.getSequence();if(!(e instanceof i))throw new Error("IF statement is needed to be called before ELSE statement.");{e.closed=!0;let t=new o(e);this.currentSequenceNode=this.currentSequenceNode.then(t)}return this}endIf(){let e=this.currentSequenceNode.getSequence();if(!(e instanceof i||e instanceof o))throw new Error("IF statement is needed to be called before ENDIF statement.");return e.closed=!0,this}while(e){let t=new r(e);return null==this.currentSequenceNode?(this.currentSequenceNode=t,this.beginSequenceNode=t):this.currentSequenceNode=this.currentSequenceNode.then(t),this.whileNodeStack.push(t),this}endWhile(){let e=this.currentSequenceNode.getSequence();if(!(e instanceof r))throw new Error("WHILE statement is needed to be called before ENDWHILE statement.");return e.closed=!0,this.whileNodeStack.length>0&&this.whileNodeStack.splice(this.whileNodeStack.length-1,1),this}breakWhile(){if(!(this.whileNodeStack.length>0))throw new Error("WHILE statement is needed to be called before BREAKWHILE statement.");return this.currentSequenceNode=this.currentSequenceNode.then(new a(this.whileNodeStack[this.whileNodeStack.length-1])),this}};class t{constructor(){this.action=null,this.next=null}then(e){return this.next=e,e}onStart(){this.action&&this.action.onStart()}update(e){this.action&&this.action.update(e)}onFinish(){this.action&&this.action.onFinish()}hasFinish(){return!this.action||this.action.hasFinished}getSequence(){return this}}e.SequenceNode=t;class n extends t{constructor(){super(...arguments),this.currentInnerSequence=null,this.startingInnerSequence=null,this.closed=!1}then(e){if(null==this.currentInnerSequence)this.currentInnerSequence=e,this.startingInnerSequence=e;else{if(this.closed)return this.next=e,e;this.currentInnerSequence=this.currentInnerSequence.then(e)}return this}onStart(){this.currentInnerSequence=this.startingInnerSequence,this.currentInnerSequence&&this.currentInnerSequence.onStart()}update(e){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(e))}onFinish(){this.currentInnerSequence&&this.currentInnerSequence.onFinish()}hasFinish(){return null==this.currentInnerSequence}getSequence(){if(this.currentInnerSequence){let e=this.currentInnerSequence.getSequence();if(e instanceof n&&!e.closed)return e}return this}}class i extends n{constructor(e){super(),this.result=!1,this.condition=e}onStart(){this.result=this.condition(),this.result?super.onStart():this.currentInnerSequence=null}}class o extends n{constructor(e){super(),this.ifSequence=null,this.ifSequence=e}onStart(){this.ifSequence&&!this.ifSequence.result?super.onStart():this.currentInnerSequence=null}}class r extends n{constructor(e){super(),this.breakWhile=!1,this.condition=e}onStart(){this.breakWhile=!1,this.condition()?super.onStart():this.currentInnerSequence=null}update(e){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,null==this.currentInnerSequence&&(this.currentInnerSequence=this.startingInnerSequence),this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(e))}hasFinish(){return this.breakWhile||!this.condition()}}class a extends t{constructor(e){super(),this.whileNode=e}onStart(){this.whileNode.breakWhile=!0}}}(actions||(actions={}));const CLASSNAME="XMLHttpRequest";class XMLHttpRequest$1{constructor(){this.requestHeaders={};console.log(CLASSNAME,"constructor","ENTRY")}getAllResponseHeaders(){return this.responseHeadersRaw}setRequestHeader(e,t){console.log(CLASSNAME,"setRequestHeader","ENTRY",e,t),this.requestHeaders[e]=t}open(e,t){console.log(CLASSNAME,"open","ENTRY",e,t),this.method=e,this.url=t}send(e){const t="send";if(console.log(CLASSNAME,t,"ENTRY",e),!this.url)throw new Error("url is required");if(!this.method)throw new Error("method is required");fetch(this.url,{method:this.method,headers:this.requestHeaders,body:e,timeout:this.timeout}).then((async e=>{console.log(CLASSNAME,t,"PROMISE.ENTRY",e),this.status=e.status,this.statusText=e.statusText,this.response=await e.text(),this.responseHeadersRaw="",e.headers.forEach(((e,t)=>{this.responseHeadersRaw+=t+": "+e+"\r\n"})),console.log(CLASSNAME,t,"PROMISE.RESULT","this.status",this.status,"this.responseHeadersRaw",this.responseHeadersRaw),this.onload&&this.onload()})).catch((e=>{console.log("catching reason",e),!e.code||20!=e.code&&23!=e.code||(e.type="timeout"),this.onerror&&(this.onerror(e),console.log("on error reason",e))}))}}let player;Object.assign(globalThis,{FormData:class{},clearTimeout:timers.clearTimeout,setTimeout:timers.setTimeout,XMLHttpRequest:XMLHttpRequest$1}),null==console||console.warn||(console.warn=(...e)=>console.log("WARNING",...e));let pendingQuestConnections=[],dclEngine,dclGetPlayer;const lscQuestEvent=mitt();var LSCQUEST_EVENTS;!function(e){e.QUEST_ERROR="QUEST_ERROR",e.QUEST_DATA="QUEST_DATA",e.QUEST_STARTED="QUEST_STARTED",e.QUEST_COMPLETE="QUEST_COMPLETE",e.QUEST_END="QUEST_END",e.QUEST_UPDATE="QUEST_UPDATE",e.QUEST_DISCONNECT="QUEST_DISCONNECT",e.QUEST_ACTION="QUEST_ACTION",e.QUEST_START="QUEST_START",e.QUEST_STEP_COMPLETE="STEP_COMPLETE",e.QUEST_TASK_COMPLETE="TASK_COMPLETE"}(LSCQUEST_EVENTS||(LSCQUEST_EVENTS={}));const lscQuestConnections=new Map,lscQuestUserData=new Map;async function LSCQuestConnect(e,t,n){dclEngine=e,dclGetPlayer=t,e.addSystem(CheckPlayerSystem),e.addSystem(ConnectQuestSystem),lscQuestConnections.has(n)||pendingQuestConnections.push(n)}function LSCQuestStart(e){let t=lscQuestConnections.get(e);if(t)try{t.send(LSCQUEST_EVENTS.QUEST_START,{questId:e})}catch(e){console.log("error sending quest action",e)}}function LSCQuestAction(e,t,n){let i=lscQuestConnections.get(e);if(i)try{i.send(LSCQUEST_EVENTS.QUEST_ACTION,{questId:e,stepId:t,taskId:n,metaverse:"DECENTRALAND"})}catch(e){console.log("error sending quest action",e)}}function setLSCQuestListeners(e,t){e.onMessage(LSCQUEST_EVENTS.QUEST_ERROR,(e=>{console.log("quest error ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_ERROR,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_DATA,(e=>{console.log("user quest data ",e),lscQuestUserData.set(t,e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_DATA,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_STARTED,(e=>{console.log("started quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_STARTED,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_COMPLETE,(e=>{console.log("complete quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_COMPLETE,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_END,(e=>{console.log("ended quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_END,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_UPDATE,(e=>{console.log("update quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_UPDATE,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_STEP_COMPLETE,(e=>{console.log("step complete quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_STEP_COMPLETE,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_TASK_COMPLETE,(e=>{console.log("task complete quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_TASK_COMPLETE,e)}))}let time=0;function CheckPlayerSystem(e){time>0?time-=e:(player=dclGetPlayer(),player?dclEngine.removeSystem(CheckPlayerSystem):time=1)}function ConnectQuestSystem(){if(player&&pendingQuestConnections.length>0){makeQuestConnection(""+pendingQuestConnections.shift())}}async function makeQuestConnection(e){const t=await getRealm({}),n={userId:player.userId,name:player.name,realm:t.realmInfo?.baseUrl,questId:e};let i=new lib.Client({hostname:"lkdcl.co",pathname:"/questing",secure:!0});try{const t=await i.joinOrCreate("angzaar_questing",n);return lscQuestConnections.set(e,t),setLSCQuestListeners(t,player.userId),t.onLeave(((t,n)=>{console.log("left quest room",e,t,n),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_DISCONNECT,{questId:e,code:t,reason:n})})),t}catch(e){throw console.error("Error connecting to LSC Quest System",e),e}}export{LSCQUEST_EVENTS,LSCQuestAction,LSCQuestConnect,LSCQuestStart,lscQuestConnections,lscQuestEvent,lscQuestUserData};
//# sourceMappingURL=index.js.map
