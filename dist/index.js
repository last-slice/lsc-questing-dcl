import require$$0$3 from"events";import require$$1$1,{request}from"https";import require$$2,{globalAgent}from"http";import require$$3 from"net";import require$$4 from"tls";import require$$1 from"crypto";import require$$0$2 from"stream";import require$$7,{parse as parse$2,resolve as resolve$1}from"url";import require$$0 from"zlib";import require$$0$1 from"buffer";import{getRealm}from"~system/Runtime";var CloseCode;ArrayBuffer.isView||(ArrayBuffer.isView=e=>null!==e&&"object"==typeof e&&e.buffer instanceof ArrayBuffer),"undefined"==typeof globalThis&&"undefined"!=typeof window&&(window.globalThis=window),function(e){e[e.CONSENTED=4e3]="CONSENTED",e[e.DEVMODE_RESTART=4010]="DEVMODE_RESTART"}(CloseCode||(CloseCode={}));class ServerError extends Error{code;constructor(e,t){super(t),this.name="ServerError",this.code=e}}function Decoder(e,t){if(this._offset=t,e instanceof ArrayBuffer)this._buffer=e,this._view=new DataView(this._buffer);else{if(!ArrayBuffer.isView(e))throw new Error("Invalid argument");this._buffer=e.buffer,this._view=new DataView(this._buffer,e.byteOffset,e.byteLength)}}function utf8Read$2(e,t,n){for(var r="",i=0,o=t,a=t+n;o<a;o++){var s=e.getUint8(o);if(128&s)if(192!=(224&s))if(224!=(240&s)){if(240!=(248&s))throw new Error("Invalid byte "+s.toString(16));(i=(7&s)<<18|(63&e.getUint8(++o))<<12|(63&e.getUint8(++o))<<6|63&e.getUint8(++o))>=65536?(i-=65536,r+=String.fromCharCode(55296+(i>>>10),56320+(1023&i))):r+=String.fromCharCode(i)}else r+=String.fromCharCode((15&s)<<12|(63&e.getUint8(++o))<<6|63&e.getUint8(++o));else r+=String.fromCharCode((31&s)<<6|63&e.getUint8(++o));else r+=String.fromCharCode(s)}return r}function decode$2(e,t=0){var n=new Decoder(e,t),r=n._parse();if(n._offset!==e.byteLength)throw new Error(e.byteLength-n._offset+" trailing bytes");return r}Decoder.prototype._array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this._parse();return t},Decoder.prototype._map=function(e){for(var t={},n=0;n<e;n++)t[this._parse()]=this._parse();return t},Decoder.prototype._str=function(e){var t=utf8Read$2(this._view,this._offset,e);return this._offset+=e,t},Decoder.prototype._bin=function(e){var t=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,t},Decoder.prototype._parse=function(){var e,t=this._view.getUint8(this._offset++),n=0,r=0,i=0,o=0;if(t<192)return t<128?t:t<144?this._map(15&t):t<160?this._array(15&t):this._str(31&t);if(t>223)return-1*(255-t+1);switch(t){case 192:return null;case 194:return!1;case 195:return!0;case 196:return n=this._view.getUint8(this._offset),this._offset+=1,this._bin(n);case 197:return n=this._view.getUint16(this._offset),this._offset+=2,this._bin(n);case 198:return n=this._view.getUint32(this._offset),this._offset+=4,this._bin(n);case 199:if(n=this._view.getUint8(this._offset),r=this._view.getInt8(this._offset+1),this._offset+=2,-1===r){var a=this._view.getUint32(this._offset);return i=this._view.getInt32(this._offset+4),o=this._view.getUint32(this._offset+8),this._offset+=12,new Date(1e3*(4294967296*i+o)+a/1e6)}return[r,this._bin(n)];case 200:return n=this._view.getUint16(this._offset),r=this._view.getInt8(this._offset+2),this._offset+=3,[r,this._bin(n)];case 201:return n=this._view.getUint32(this._offset),r=this._view.getInt8(this._offset+4),this._offset+=5,[r,this._bin(n)];case 202:return e=this._view.getFloat32(this._offset),this._offset+=4,e;case 203:return e=this._view.getFloat64(this._offset),this._offset+=8,e;case 204:return e=this._view.getUint8(this._offset),this._offset+=1,e;case 205:return e=this._view.getUint16(this._offset),this._offset+=2,e;case 206:return e=this._view.getUint32(this._offset),this._offset+=4,e;case 207:return i=this._view.getUint32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,i+o;case 208:return e=this._view.getInt8(this._offset),this._offset+=1,e;case 209:return e=this._view.getInt16(this._offset),this._offset+=2,e;case 210:return e=this._view.getInt32(this._offset),this._offset+=4,e;case 211:return i=this._view.getInt32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,i+o;case 212:return r=this._view.getInt8(this._offset),this._offset+=1,0===r?void(this._offset+=1):[r,this._bin(1)];case 213:return r=this._view.getInt8(this._offset),this._offset+=1,[r,this._bin(2)];case 214:return r=this._view.getInt8(this._offset),this._offset+=1,-1===r?(e=this._view.getUint32(this._offset),this._offset+=4,new Date(1e3*e)):[r,this._bin(4)];case 215:return r=this._view.getInt8(this._offset),this._offset+=1,0===r?(i=this._view.getInt32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,new Date(i+o)):-1===r?(i=this._view.getUint32(this._offset),o=this._view.getUint32(this._offset+4),this._offset+=8,new Date(1e3*(4294967296*(3&i)+o)+(i>>>2)/1e6)):[r,this._bin(8)];case 216:return r=this._view.getInt8(this._offset),this._offset+=1,[r,this._bin(16)];case 217:return n=this._view.getUint8(this._offset),this._offset+=1,this._str(n);case 218:return n=this._view.getUint16(this._offset),this._offset+=2,this._str(n);case 219:return n=this._view.getUint32(this._offset),this._offset+=4,this._str(n);case 220:return n=this._view.getUint16(this._offset),this._offset+=2,this._array(n);case 221:return n=this._view.getUint32(this._offset),this._offset+=4,this._array(n);case 222:return n=this._view.getUint16(this._offset),this._offset+=2,this._map(n);case 223:return n=this._view.getUint32(this._offset),this._offset+=4,this._map(n)}throw new Error("Could not parse")};var TIMESTAMP32_MAX_SEC=4294967295,TIMESTAMP64_MAX_SEC=17179869183;function utf8Write$1(e,t,n){for(var r=0,i=0,o=n.length;i<o;i++)(r=n.charCodeAt(i))<128?e.setUint8(t++,r):r<2048?(e.setUint8(t++,192|r>>6),e.setUint8(t++,128|63&r)):r<55296||r>=57344?(e.setUint8(t++,224|r>>12),e.setUint8(t++,128|r>>6&63),e.setUint8(t++,128|63&r)):(i++,r=65536+((1023&r)<<10|1023&n.charCodeAt(i)),e.setUint8(t++,240|r>>18),e.setUint8(t++,128|r>>12&63),e.setUint8(t++,128|r>>6&63),e.setUint8(t++,128|63&r))}function utf8Length$2(e){for(var t=0,n=0,r=0,i=e.length;r<i;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function _encode(e,t,n){var r=typeof n,i=0,o=0,a=0,s=0,c=0,u=0;if("string"===r){if((c=utf8Length$2(n))<32)e.push(160|c),u=1;else if(c<256)e.push(217,c),u=2;else if(c<65536)e.push(218,c>>8,c),u=3;else{if(!(c<4294967296))throw new Error("String too long");e.push(219,c>>24,c>>16,c>>8,c),u=5}return t.push({_str:n,_length:c,_offset:e.length}),u+c}if("number"===r)return Math.floor(n)===n&&isFinite(n)?n>=0?n<128?(e.push(n),1):n<256?(e.push(204,n),2):n<65536?(e.push(205,n>>8,n),3):n<4294967296?(e.push(206,n>>24,n>>16,n>>8,n),5):(a=n/Math.pow(2,32)|0,s=n>>>0,e.push(207,a>>24,a>>16,a>>8,a,s>>24,s>>16,s>>8,s),9):n>=-32?(e.push(n),1):n>=-128?(e.push(208,n),2):n>=-32768?(e.push(209,n>>8,n),3):n>=-2147483648?(e.push(210,n>>24,n>>16,n>>8,n),5):(a=Math.floor(n/Math.pow(2,32)),s=n>>>0,e.push(211,a>>24,a>>16,a>>8,a,s>>24,s>>16,s>>8,s),9):(e.push(203),t.push({_float:n,_length:8,_offset:e.length}),9);if("object"===r){if(null===n)return e.push(192),1;if(Array.isArray(n)){if((c=n.length)<16)e.push(144|c),u=1;else if(c<65536)e.push(220,c>>8,c),u=3;else{if(!(c<4294967296))throw new Error("Array too large");e.push(221,c>>24,c>>16,c>>8,c),u=5}for(i=0;i<c;i++)u+=_encode(e,t,n[i]);return u}if(n instanceof Date){var l=n.getTime(),f=Math.floor(l/1e3),d=1e6*(l-1e3*f);return f>=0&&d>=0&&f<=TIMESTAMP64_MAX_SEC?0===d&&f<=TIMESTAMP32_MAX_SEC?(e.push(214,255,f>>24,f>>16,f>>8,f),6):(a=f/4294967296,s=4294967295&f,e.push(215,255,d>>22,d>>14,d>>6,a,s>>24,s>>16,s>>8,s),10):(a=Math.floor(f/4294967296),s=f>>>0,e.push(199,12,255,d>>24,d>>16,d>>8,d,a>>24,a>>16,a>>8,a,s>>24,s>>16,s>>8,s),15)}if(n instanceof ArrayBuffer){if((c=n.byteLength)<256)e.push(196,c),u=2;else if(c<65536)e.push(197,c>>8,c),u=3;else{if(!(c<4294967296))throw new Error("Buffer too large");e.push(198,c>>24,c>>16,c>>8,c),u=5}return t.push({_bin:n,_length:c,_offset:e.length}),u+c}if("function"==typeof n.toJSON)return _encode(e,t,n.toJSON());var h=[],p="",m=Object.keys(n);for(i=0,o=m.length;i<o;i++)void 0!==n[p=m[i]]&&"function"!=typeof n[p]&&h.push(p);if((c=h.length)<16)e.push(128|c),u=1;else if(c<65536)e.push(222,c>>8,c),u=3;else{if(!(c<4294967296))throw new Error("Object too large");e.push(223,c>>24,c>>16,c>>8,c),u=5}for(i=0;i<c;i++)u+=_encode(e,t,p=h[i]),u+=_encode(e,t,n[p]);return u}if("boolean"===r)return e.push(n?195:194),1;if("undefined"===r)return e.push(192),1;if("function"==typeof n.toJSON)return _encode(e,t,n.toJSON());throw new Error("Could not encode")}function encode$2(e){var t=[],n=[],r=_encode(t,n,e),i=new ArrayBuffer(r),o=new DataView(i),a=0,s=0,c=-1;n.length>0&&(c=n[0]._offset);for(var u,l=0,f=0,d=0,h=t.length;d<h;d++)if(o.setUint8(s+d,t[d]),d+1===c){if(l=(u=n[a])._length,f=s+c,u._bin)for(var p=new Uint8Array(u._bin),m=0;m<l;m++)o.setUint8(f+m,p[m]);else u._str?utf8Write$1(o,f,u._str):void 0!==u._float&&o.setFloat64(f,u._float);s+=l,n[++a]&&(c=n[a]._offset)}return i}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},bufferUtil$1={exports:{}};const BINARY_TYPES$2=["nodebuffer","arraybuffer","fragments"],hasBlob$1="undefined"!=typeof Blob;hasBlob$1&&BINARY_TYPES$2.push("blob");var constants={BINARY_TYPES:BINARY_TYPES$2,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:hasBlob$1,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}},unmask$1,mask;const{EMPTY_BUFFER:EMPTY_BUFFER$3}=constants,FastBuffer$2=Buffer[Symbol.species];function concat$3(e,t){if(0===e.length)return EMPTY_BUFFER$3;if(1===e.length)return e[0];const n=Buffer.allocUnsafe(t);let r=0;for(let t=0;t<e.length;t++){const i=e[t];n.set(i,r),r+=i.length}return r<t?new FastBuffer$2(n.buffer,n.byteOffset,r):n}function _mask(e,t,n,r,i){for(let o=0;o<i;o++)n[r+o]=e[o]^t[3&o]}function _unmask(e,t){for(let n=0;n<e.length;n++)e[n]^=t[3&n]}function toArrayBuffer$1(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)}function toBuffer$2(e){if(toBuffer$2.readOnly=!0,Buffer.isBuffer(e))return e;let t;return e instanceof ArrayBuffer?t=new FastBuffer$2(e):ArrayBuffer.isView(e)?t=new FastBuffer$2(e.buffer,e.byteOffset,e.byteLength):(t=Buffer.from(e),toBuffer$2.readOnly=!1),t}if(bufferUtil$1.exports={concat:concat$3,mask:_mask,toArrayBuffer:toArrayBuffer$1,toBuffer:toBuffer$2,unmask:_unmask},!process.env.WS_NO_BUFFER_UTIL)try{const e=require("bufferutil");mask=bufferUtil$1.exports.mask=function(t,n,r,i,o){o<48?_mask(t,n,r,i,o):e.mask(t,n,r,i,o)},unmask$1=bufferUtil$1.exports.unmask=function(t,n){t.length<32?_unmask(t,n):e.unmask(t,n)}}catch(e){}const kDone=Symbol("kDone"),kRun=Symbol("kRun");class Limiter$1{constructor(e){this[kDone]=()=>{this.pending--,this[kRun]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[kRun]()}[kRun](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[kDone])}}}var limiter=Limiter$1;const zlib=require$$0,bufferUtil=bufferUtil$1.exports,Limiter=limiter,{kStatusCode:kStatusCode$2}=constants,FastBuffer$1=Buffer[Symbol.species],TRAILER=Buffer.from([0,0,255,255]),kPerMessageDeflate=Symbol("permessage-deflate"),kTotalLength=Symbol("total-length"),kCallback=Symbol("callback"),kBuffers=Symbol("buffers"),kError$1=Symbol("error");let zlibLimiter;class PerMessageDeflate$3{constructor(e,t,n){if(this._maxPayload=0|n,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!zlibLimiter){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;zlibLimiter=new Limiter(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[kCallback];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,n=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(n.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?n.client_max_window_bits=t.clientMaxWindowBits:!0!==n.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete n.client_max_window_bits,n}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let n=e[t];if(n.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(n=n[0],"client_max_window_bits"===t){if(!0!==n){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}else if("server_max_window_bits"===t){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==n)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}e[t]=n}))})),e}decompress(e,t,n){zlibLimiter.add((r=>{this._decompress(e,t,((e,t)=>{r(),n(e,t)}))}))}compress(e,t,n){zlibLimiter.add((r=>{this._compress(e,t,((e,t)=>{r(),n(e,t)}))}))}_decompress(e,t,n){const r=this._isServer?"client":"server";if(!this._inflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?zlib.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=zlib.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[kPerMessageDeflate]=this,this._inflate[kTotalLength]=0,this._inflate[kBuffers]=[],this._inflate.on("error",inflateOnError),this._inflate.on("data",inflateOnData)}this._inflate[kCallback]=n,this._inflate.write(e),t&&this._inflate.write(TRAILER),this._inflate.flush((()=>{const e=this._inflate[kError$1];if(e)return this._inflate.close(),this._inflate=null,void n(e);const i=bufferUtil.concat(this._inflate[kBuffers],this._inflate[kTotalLength]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[kTotalLength]=0,this._inflate[kBuffers]=[],t&&this.params[`${r}_no_context_takeover`]&&this._inflate.reset()),n(null,i)}))}_compress(e,t,n){const r=this._isServer?"server":"client";if(!this._deflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?zlib.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=zlib.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[kTotalLength]=0,this._deflate[kBuffers]=[],this._deflate.on("data",deflateOnData)}this._deflate[kCallback]=n,this._deflate.write(e),this._deflate.flush(zlib.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=bufferUtil.concat(this._deflate[kBuffers],this._deflate[kTotalLength]);t&&(e=new FastBuffer$1(e.buffer,e.byteOffset,e.length-4)),this._deflate[kCallback]=null,this._deflate[kTotalLength]=0,this._deflate[kBuffers]=[],t&&this.params[`${r}_no_context_takeover`]&&this._deflate.reset(),n(null,e)}))}}var permessageDeflate=PerMessageDeflate$3;function deflateOnData(e){this[kBuffers].push(e),this[kTotalLength]+=e.length}function inflateOnData(e){this[kTotalLength]+=e.length,this[kPerMessageDeflate]._maxPayload<1||this[kTotalLength]<=this[kPerMessageDeflate]._maxPayload?this[kBuffers].push(e):(this[kError$1]=new RangeError("Max payload size exceeded"),this[kError$1].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[kError$1][kStatusCode$2]=1009,this.removeListener("data",inflateOnData),this.reset())}function inflateOnError(e){this[kPerMessageDeflate]._inflate=null,e[kStatusCode$2]=1007,this[kCallback](e)}var validation={exports:{}},isValidUTF8_1;const{isUtf8:isUtf8}=require$$0$1,{hasBlob:hasBlob}=constants,tokenChars$1=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function isValidStatusCode$2(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999}function _isValidUTF8(e){const t=e.length;let n=0;for(;n<t;)if(128&e[n])if(192==(224&e[n])){if(n+1===t||128!=(192&e[n+1])||192==(254&e[n]))return!1;n+=2}else if(224==(240&e[n])){if(n+2>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||224===e[n]&&128==(224&e[n+1])||237===e[n]&&160==(224&e[n+1]))return!1;n+=3}else{if(240!=(248&e[n]))return!1;if(n+3>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||128!=(192&e[n+3])||240===e[n]&&128==(240&e[n+1])||244===e[n]&&e[n+1]>143||e[n]>244)return!1;n+=4}else n++;return!0}function isBlob$2(e){return hasBlob&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&("Blob"===e[Symbol.toStringTag]||"File"===e[Symbol.toStringTag])}if(validation.exports={isBlob:isBlob$2,isValidStatusCode:isValidStatusCode$2,isValidUTF8:_isValidUTF8,tokenChars:tokenChars$1},isUtf8)isValidUTF8_1=validation.exports.isValidUTF8=function(e){return e.length<24?_isValidUTF8(e):isUtf8(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{const e=require("utf-8-validate");isValidUTF8_1=validation.exports.isValidUTF8=function(t){return t.length<32?_isValidUTF8(t):e(t)}}catch(e){}const{Writable:Writable}=require$$0$2,PerMessageDeflate$2=permessageDeflate,{BINARY_TYPES:BINARY_TYPES$1,EMPTY_BUFFER:EMPTY_BUFFER$2,kStatusCode:kStatusCode$1,kWebSocket:kWebSocket$2}=constants,{concat:concat$2,toArrayBuffer:toArrayBuffer,unmask:unmask}=bufferUtil$1.exports,{isValidStatusCode:isValidStatusCode$1,isValidUTF8:isValidUTF8}=validation.exports,FastBuffer=Buffer[Symbol.species],GET_INFO=0,GET_PAYLOAD_LENGTH_16=1,GET_PAYLOAD_LENGTH_64=2,GET_MASK=3,GET_DATA=4,INFLATING=5,DEFER_EVENT=6;class Receiver$1 extends Writable{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||BINARY_TYPES$1[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[kWebSocket$2]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=GET_INFO}_write(e,t,n){if(8===this._opcode&&this._state==GET_INFO)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new FastBuffer(t.buffer,t.byteOffset+e,t.length-e),new FastBuffer(t.buffer,t.byteOffset,e)}const t=Buffer.allocUnsafe(e);do{const n=this._buffers[0],r=t.length-e;e>=n.length?t.set(this._buffers.shift(),r):(t.set(new Uint8Array(n.buffer,n.byteOffset,e),r),this._buffers[0]=new FastBuffer(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return t}startLoop(e){this._loop=!0;do{switch(this._state){case GET_INFO:this.getInfo(e);break;case GET_PAYLOAD_LENGTH_16:this.getPayloadLength16(e);break;case GET_PAYLOAD_LENGTH_64:this.getPayloadLength64(e);break;case GET_MASK:this.getMask();break;case GET_DATA:this.getData(e);break;case INFLATING:case DEFER_EVENT:return void(this._loop=!1)}}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2)return void(this._loop=!1);const t=this.consume(2);if(48&t[0]){return void e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"))}const n=!(64&~t[0]);if(!n||this._extensions[PerMessageDeflate$2.extensionName]){if(this._fin=!(128&~t[0]),this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(n){return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}if(!this._fragmented){return void e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"))}this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented){return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"))}this._compressed=n}else{if(!(this._opcode>7&&this._opcode<11)){return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"))}if(!this._fin){return void e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"))}if(n){return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength){return void e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=!(128&~t[1]),this._isServer){if(!this._masked){return void e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}}else if(this._masked){return void e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"))}126===this._payloadLength?this._state=GET_PAYLOAD_LENGTH_16:127===this._payloadLength?this._state=GET_PAYLOAD_LENGTH_64:this.haveLength(e)}else{e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}}getPayloadLength16(e){this._bufferedBytes<2?this._loop=!1:(this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e))}getPayloadLength64(e){if(this._bufferedBytes<8)return void(this._loop=!1);const t=this.consume(8),n=t.readUInt32BE(0);if(n>Math.pow(2,21)-1){e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"))}else this._payloadLength=n*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"))}else this._masked?this._state=GET_MASK:this._state=GET_DATA}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=GET_DATA)}getData(e){let t=EMPTY_BUFFER$2;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&unmask(t,this._mask)}if(this._opcode>7)this.controlMessage(t,e);else{if(this._compressed)return this._state=INFLATING,void this.decompress(t,e);t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}}decompress(e,t){this._extensions[PerMessageDeflate$2.extensionName].decompress(e,this._fin,((e,n)=>{if(e)return t(e);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0){const e=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");return void t(e)}this._fragments.push(n)}this.dataMessage(t),this._state===GET_INFO&&this.startLoop(t)}))}dataMessage(e){if(!this._fin)return void(this._state=GET_INFO);const t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let r;r="nodebuffer"===this._binaryType?concat$2(n,t):"arraybuffer"===this._binaryType?toArrayBuffer(concat$2(n,t)):"blob"===this._binaryType?new Blob(n):n,this._allowSynchronousEvents?(this.emit("message",r,!0),this._state=GET_INFO):(this._state=DEFER_EVENT,setImmediate((()=>{this.emit("message",r,!0),this._state=GET_INFO,this.startLoop(e)})))}else{const r=concat$2(n,t);if(!this._skipUTF8Validation&&!isValidUTF8(r)){const t=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void e(t)}this._state===INFLATING||this._allowSynchronousEvents?(this.emit("message",r,!1),this._state=GET_INFO):(this._state=DEFER_EVENT,setImmediate((()=>{this.emit("message",r,!1),this._state=GET_INFO,this.startLoop(e)})))}}controlMessage(e,t){if(8!==this._opcode)this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=GET_INFO):(this._state=DEFER_EVENT,setImmediate((()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=GET_INFO,this.startLoop(t)})));else{if(0===e.length)this._loop=!1,this.emit("conclude",1005,EMPTY_BUFFER$2),this.end();else{const n=e.readUInt16BE(0);if(!isValidStatusCode$1(n)){const e=this.createError(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");return void t(e)}const r=new FastBuffer(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!isValidUTF8(r)){const e=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void t(e)}this._loop=!1,this.emit("conclude",n,r),this.end()}this._state=GET_INFO}}createError(e,t,n,r,i){this._loop=!1,this._errored=!0;const o=new e(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,this.createError),o.code=i,o[kStatusCode$1]=r,o}}var receiver=Receiver$1;const{randomFillSync:randomFillSync}=require$$1,PerMessageDeflate$1=permessageDeflate,{EMPTY_BUFFER:EMPTY_BUFFER$1,kWebSocket:kWebSocket$1,NOOP:NOOP$1}=constants,{isBlob:isBlob$1,isValidStatusCode:isValidStatusCode}=validation.exports,{mask:applyMask,toBuffer:toBuffer$1}=bufferUtil$1.exports,kByteLength=Symbol("kByteLength"),maskBuffer=Buffer.alloc(4),RANDOM_POOL_SIZE=8192;let randomPool,randomPoolPointer=RANDOM_POOL_SIZE;const DEFAULT=0,DEFLATING=1,GET_BLOB_DATA=2;class Sender$1{constructor(e,t,n){this._extensions=t||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=DEFAULT,this.onerror=NOOP$1,this[kWebSocket$1]=void 0}static frame(e,t){let n,r,i=!1,o=2,a=!1;t.mask&&(n=t.maskBuffer||maskBuffer,t.generateMask?t.generateMask(n):(randomPoolPointer===RANDOM_POOL_SIZE&&(void 0===randomPool&&(randomPool=Buffer.alloc(RANDOM_POOL_SIZE)),randomFillSync(randomPool,0,RANDOM_POOL_SIZE),randomPoolPointer=0),n[0]=randomPool[randomPoolPointer++],n[1]=randomPool[randomPoolPointer++],n[2]=randomPool[randomPoolPointer++],n[3]=randomPool[randomPoolPointer++]),a=!(n[0]|n[1]|n[2]|n[3]),o=6),"string"==typeof e?r=t.mask&&!a||void 0===t[kByteLength]?(e=Buffer.from(e)).length:t[kByteLength]:(r=e.length,i=t.mask&&t.readOnly&&!a);let s=r;r>=65536?(o+=8,s=127):r>125&&(o+=2,s=126);const c=Buffer.allocUnsafe(i?r+o:o);return c[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(c[0]|=64),c[1]=s,126===s?c.writeUInt16BE(r,2):127===s&&(c[2]=c[3]=0,c.writeUIntBE(r,4,6)),t.mask?(c[1]|=128,c[o-4]=n[0],c[o-3]=n[1],c[o-2]=n[2],c[o-1]=n[3],a?[c,e]:i?(applyMask(e,n,c,o,r),[c]):(applyMask(e,n,e,0,r),[c,e])):[c,e]}close(e,t,n,r){let i;if(void 0===e)i=EMPTY_BUFFER$1;else{if("number"!=typeof e||!isValidStatusCode(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const n=Buffer.byteLength(t);if(n>123)throw new RangeError("The message must not be greater than 123 bytes");i=Buffer.allocUnsafe(2+n),i.writeUInt16BE(e,0),"string"==typeof t?i.write(t,2):i.set(t,2)}else i=Buffer.allocUnsafe(2),i.writeUInt16BE(e,0)}const o={[kByteLength]:i.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._state!==DEFAULT?this.enqueue([this.dispatch,i,!1,o,r]):this.sendFrame(Sender$1.frame(i,o),r)}ping(e,t,n){let r,i;if("string"==typeof e?(r=Buffer.byteLength(e),i=!1):isBlob$1(e)?(r=e.size,i=!1):(r=(e=toBuffer$1(e)).length,i=toBuffer$1.readOnly),r>125)throw new RangeError("The data size must not be greater than 125 bytes");const o={[kByteLength]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};isBlob$1(e)?this._state!==DEFAULT?this.enqueue([this.getBlobData,e,!1,o,n]):this.getBlobData(e,!1,o,n):this._state!==DEFAULT?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(Sender$1.frame(e,o),n)}pong(e,t,n){let r,i;if("string"==typeof e?(r=Buffer.byteLength(e),i=!1):isBlob$1(e)?(r=e.size,i=!1):(r=(e=toBuffer$1(e)).length,i=toBuffer$1.readOnly),r>125)throw new RangeError("The data size must not be greater than 125 bytes");const o={[kByteLength]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};isBlob$1(e)?this._state!==DEFAULT?this.enqueue([this.getBlobData,e,!1,o,n]):this.getBlobData(e,!1,o,n):this._state!==DEFAULT?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(Sender$1.frame(e,o),n)}send(e,t,n){const r=this._extensions[PerMessageDeflate$1.extensionName];let i,o,a=t.binary?2:1,s=t.compress;"string"==typeof e?(i=Buffer.byteLength(e),o=!1):isBlob$1(e)?(i=e.size,o=!1):(i=(e=toBuffer$1(e)).length,o=toBuffer$1.readOnly),this._firstFragment?(this._firstFragment=!1,s&&r&&r.params[r._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(s=i>=r._threshold),this._compress=s):(s=!1,a=0),t.fin&&(this._firstFragment=!0);const c={[kByteLength]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:o,rsv1:s};isBlob$1(e)?this._state!==DEFAULT?this.enqueue([this.getBlobData,e,this._compress,c,n]):this.getBlobData(e,this._compress,c,n):this._state!==DEFAULT?this.enqueue([this.dispatch,e,this._compress,c,n]):this.dispatch(e,this._compress,c,n)}getBlobData(e,t,n,r){this._bufferedBytes+=n[kByteLength],this._state=GET_BLOB_DATA,e.arrayBuffer().then((e=>{if(this._socket.destroyed){const e=new Error("The socket was closed while the blob was being read");return void process.nextTick(callCallbacks,this,e,r)}this._bufferedBytes-=n[kByteLength];const i=toBuffer$1(e);t?this.dispatch(i,t,n,r):(this._state=DEFAULT,this.sendFrame(Sender$1.frame(i,n),r),this.dequeue())})).catch((e=>{process.nextTick(onError,this,e,r)}))}dispatch(e,t,n,r){if(!t)return void this.sendFrame(Sender$1.frame(e,n),r);const i=this._extensions[PerMessageDeflate$1.extensionName];this._bufferedBytes+=n[kByteLength],this._state=DEFLATING,i.compress(e,n.fin,((e,t)=>{if(this._socket.destroyed){callCallbacks(this,new Error("The socket was closed while data was being compressed"),r)}else this._bufferedBytes-=n[kByteLength],this._state=DEFAULT,n.readOnly=!1,this.sendFrame(Sender$1.frame(t,n),r),this.dequeue()}))}dequeue(){for(;this._state===DEFAULT&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][kByteLength],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][kByteLength],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}var sender=Sender$1;function callCallbacks(e,t,n){"function"==typeof n&&n(t);for(let n=0;n<e._queue.length;n++){const r=e._queue[n],i=r[r.length-1];"function"==typeof i&&i(t)}}function onError(e,t,n){callCallbacks(e,t,n),e.onerror(t)}const{kForOnEventAttribute:kForOnEventAttribute$1,kListener:kListener$1}=constants,kCode=Symbol("kCode"),kData=Symbol("kData"),kError=Symbol("kError"),kMessage=Symbol("kMessage"),kReason=Symbol("kReason"),kTarget=Symbol("kTarget"),kType=Symbol("kType"),kWasClean=Symbol("kWasClean");class Event{constructor(e){this[kTarget]=null,this[kType]=e}get target(){return this[kTarget]}get type(){return this[kType]}}Object.defineProperty(Event.prototype,"target",{enumerable:!0}),Object.defineProperty(Event.prototype,"type",{enumerable:!0});class CloseEvent extends Event{constructor(e,t={}){super(e),this[kCode]=void 0===t.code?0:t.code,this[kReason]=void 0===t.reason?"":t.reason,this[kWasClean]=void 0!==t.wasClean&&t.wasClean}get code(){return this[kCode]}get reason(){return this[kReason]}get wasClean(){return this[kWasClean]}}Object.defineProperty(CloseEvent.prototype,"code",{enumerable:!0}),Object.defineProperty(CloseEvent.prototype,"reason",{enumerable:!0}),Object.defineProperty(CloseEvent.prototype,"wasClean",{enumerable:!0});class ErrorEvent extends Event{constructor(e,t={}){super(e),this[kError]=void 0===t.error?null:t.error,this[kMessage]=void 0===t.message?"":t.message}get error(){return this[kError]}get message(){return this[kMessage]}}Object.defineProperty(ErrorEvent.prototype,"error",{enumerable:!0}),Object.defineProperty(ErrorEvent.prototype,"message",{enumerable:!0});class MessageEvent extends Event{constructor(e,t={}){super(e),this[kData]=void 0===t.data?null:t.data}get data(){return this[kData]}}Object.defineProperty(MessageEvent.prototype,"data",{enumerable:!0});const EventTarget={addEventListener(e,t,n={}){for(const r of this.listeners(e))if(!n[kForOnEventAttribute$1]&&r[kListener$1]===t&&!r[kForOnEventAttribute$1])return;let r;if("message"===e)r=function(e,n){const r=new MessageEvent("message",{data:n?e:e.toString()});r[kTarget]=this,callListener(t,this,r)};else if("close"===e)r=function(e,n){const r=new CloseEvent("close",{code:e,reason:n.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});r[kTarget]=this,callListener(t,this,r)};else if("error"===e)r=function(e){const n=new ErrorEvent("error",{error:e,message:e.message});n[kTarget]=this,callListener(t,this,n)};else{if("open"!==e)return;r=function(){const e=new Event("open");e[kTarget]=this,callListener(t,this,e)}}r[kForOnEventAttribute$1]=!!n[kForOnEventAttribute$1],r[kListener$1]=t,n.once?this.once(e,r):this.on(e,r)},removeEventListener(e,t){for(const n of this.listeners(e))if(n[kListener$1]===t&&!n[kForOnEventAttribute$1]){this.removeListener(e,n);break}}};var eventTarget={CloseEvent:CloseEvent,ErrorEvent:ErrorEvent,Event:Event,EventTarget:EventTarget,MessageEvent:MessageEvent};function callListener(e,t,n){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,n):e.call(t,n)}const{tokenChars:tokenChars}=validation.exports;function push$5(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}function parse$1(e){const t=Object.create(null);let n,r,i=Object.create(null),o=!1,a=!1,s=!1,c=-1,u=-1,l=-1,f=0;for(;f<e.length;f++)if(u=e.charCodeAt(f),void 0===n)if(-1===l&&1===tokenChars[u])-1===c&&(c=f);else if(0===f||32!==u&&9!==u){if(59!==u&&44!==u)throw new SyntaxError(`Unexpected character at index ${f}`);{if(-1===c)throw new SyntaxError(`Unexpected character at index ${f}`);-1===l&&(l=f);const r=e.slice(c,l);44===u?(push$5(t,r,i),i=Object.create(null)):n=r,c=l=-1}}else-1===l&&-1!==c&&(l=f);else if(void 0===r)if(-1===l&&1===tokenChars[u])-1===c&&(c=f);else if(32===u||9===u)-1===l&&-1!==c&&(l=f);else if(59===u||44===u){if(-1===c)throw new SyntaxError(`Unexpected character at index ${f}`);-1===l&&(l=f),push$5(i,e.slice(c,l),!0),44===u&&(push$5(t,n,i),i=Object.create(null),n=void 0),c=l=-1}else{if(61!==u||-1===c||-1!==l)throw new SyntaxError(`Unexpected character at index ${f}`);r=e.slice(c,f),c=l=-1}else if(a){if(1!==tokenChars[u])throw new SyntaxError(`Unexpected character at index ${f}`);-1===c?c=f:o||(o=!0),a=!1}else if(s)if(1===tokenChars[u])-1===c&&(c=f);else if(34===u&&-1!==c)s=!1,l=f;else{if(92!==u)throw new SyntaxError(`Unexpected character at index ${f}`);a=!0}else if(34===u&&61===e.charCodeAt(f-1))s=!0;else if(-1===l&&1===tokenChars[u])-1===c&&(c=f);else if(-1===c||32!==u&&9!==u){if(59!==u&&44!==u)throw new SyntaxError(`Unexpected character at index ${f}`);{if(-1===c)throw new SyntaxError(`Unexpected character at index ${f}`);-1===l&&(l=f);let a=e.slice(c,l);o&&(a=a.replace(/\\/g,""),o=!1),push$5(i,r,a),44===u&&(push$5(t,n,i),i=Object.create(null),n=void 0),r=void 0,c=l=-1}}else-1===l&&(l=f);if(-1===c||s||32===u||9===u)throw new SyntaxError("Unexpected end of input");-1===l&&(l=f);const d=e.slice(c,l);return void 0===n?push$5(t,d,i):(void 0===r?push$5(i,d,!0):push$5(i,r,o?d.replace(/\\/g,""):d),push$5(t,n,i)),t}function format$1(e){return Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>[t].concat(Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")}var extension={format:format$1,parse:parse$1};const EventEmitter$2=require$$0$3,https=require$$1$1,http=require$$2,net=require$$3,tls=require$$4,{randomBytes:randomBytes,createHash:createHash}=require$$1,{URL:URL$3}=require$$7,PerMessageDeflate=permessageDeflate,Receiver=receiver,Sender=sender,{isBlob:isBlob}=validation.exports,{BINARY_TYPES:BINARY_TYPES,EMPTY_BUFFER:EMPTY_BUFFER,GUID:GUID,kForOnEventAttribute:kForOnEventAttribute,kListener:kListener,kStatusCode:kStatusCode,kWebSocket:kWebSocket,NOOP:NOOP}=constants,{EventTarget:{addEventListener:addEventListener,removeEventListener:removeEventListener}}=eventTarget,{format:format,parse:parse}=extension,{toBuffer:toBuffer}=bufferUtil$1.exports,closeTimeout=3e4,kAborted=Symbol("kAborted"),protocolVersions=[8,13],readyStates=["CONNECTING","OPEN","CLOSING","CLOSED"],subprotocolRegex=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class WebSocket$1 extends EventEmitter$2{constructor(e,t,n){super(),this._binaryType=BINARY_TYPES[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=EMPTY_BUFFER,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=WebSocket$1.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(n=t,t=[]):t=[t]),initAsClient(this,e,t,n)):(this._autoPong=n.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){BINARY_TYPES.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,n){const r=new Receiver({allowSynchronousEvents:n.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation}),i=new Sender(e,this._extensions,n.generateMask);this._receiver=r,this._sender=i,this._socket=e,r[kWebSocket]=this,i[kWebSocket]=this,e[kWebSocket]=this,r.on("conclude",receiverOnConclude),r.on("drain",receiverOnDrain),r.on("error",receiverOnError),r.on("message",receiverOnMessage),r.on("ping",receiverOnPing),r.on("pong",receiverOnPong),i.onerror=senderOnError,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",socketOnClose),e.on("data",socketOnData),e.on("end",socketOnEnd),e.on("error",socketOnError),this._readyState=WebSocket$1.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=WebSocket$1.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[PerMessageDeflate.extensionName]&&this._extensions[PerMessageDeflate.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=WebSocket$1.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==WebSocket$1.CLOSED)if(this.readyState!==WebSocket$1.CONNECTING)this.readyState!==WebSocket$1.CLOSING?(this._readyState=WebSocket$1.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),setCloseTimer(this)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{const e="WebSocket was closed before the connection was established";abortHandshake(this,this._req,e)}}pause(){this.readyState!==WebSocket$1.CONNECTING&&this.readyState!==WebSocket$1.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,n){if(this.readyState===WebSocket$1.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===WebSocket$1.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||EMPTY_BUFFER,t,n)):sendAfterClose(this,e,n)}pong(e,t,n){if(this.readyState===WebSocket$1.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===WebSocket$1.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||EMPTY_BUFFER,t,n)):sendAfterClose(this,e,n)}resume(){this.readyState!==WebSocket$1.CONNECTING&&this.readyState!==WebSocket$1.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,n){if(this.readyState===WebSocket$1.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(n=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==WebSocket$1.OPEN)return void sendAfterClose(this,e,n);const r={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[PerMessageDeflate.extensionName]||(r.compress=!1),this._sender.send(e||EMPTY_BUFFER,r,n)}terminate(){if(this.readyState!==WebSocket$1.CLOSED)if(this.readyState!==WebSocket$1.CONNECTING)this._socket&&(this._readyState=WebSocket$1.CLOSING,this._socket.destroy());else{const e="WebSocket was closed before the connection was established";abortHandshake(this,this._req,e)}}}Object.defineProperty(WebSocket$1,"CONNECTING",{enumerable:!0,value:readyStates.indexOf("CONNECTING")}),Object.defineProperty(WebSocket$1.prototype,"CONNECTING",{enumerable:!0,value:readyStates.indexOf("CONNECTING")}),Object.defineProperty(WebSocket$1,"OPEN",{enumerable:!0,value:readyStates.indexOf("OPEN")}),Object.defineProperty(WebSocket$1.prototype,"OPEN",{enumerable:!0,value:readyStates.indexOf("OPEN")}),Object.defineProperty(WebSocket$1,"CLOSING",{enumerable:!0,value:readyStates.indexOf("CLOSING")}),Object.defineProperty(WebSocket$1.prototype,"CLOSING",{enumerable:!0,value:readyStates.indexOf("CLOSING")}),Object.defineProperty(WebSocket$1,"CLOSED",{enumerable:!0,value:readyStates.indexOf("CLOSED")}),Object.defineProperty(WebSocket$1.prototype,"CLOSED",{enumerable:!0,value:readyStates.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(WebSocket$1.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(WebSocket$1.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[kForOnEventAttribute])return t[kListener];return null},set(t){for(const t of this.listeners(e))if(t[kForOnEventAttribute]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[kForOnEventAttribute]:!0})}})})),WebSocket$1.prototype.addEventListener=addEventListener,WebSocket$1.prototype.removeEventListener=removeEventListener;var websocket=WebSocket$1;function initAsClient(e,t,n,r){const i={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:protocolVersions[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...r,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(e._autoPong=i.autoPong,!protocolVersions.includes(i.protocolVersion))throw new RangeError(`Unsupported protocol version: ${i.protocolVersion} (supported versions: ${protocolVersions.join(", ")})`);let o;if(t instanceof URL$3)o=t;else try{o=new URL$3(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}"http:"===o.protocol?o.protocol="ws:":"https:"===o.protocol&&(o.protocol="wss:"),e._url=o.href;const a="wss:"===o.protocol,s="ws+unix:"===o.protocol;let c;if("ws:"===o.protocol||a||s?s&&!o.pathname?c="The URL's pathname is empty":o.hash&&(c="The URL contains a fragment identifier"):c='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"',c){const t=new SyntaxError(c);if(0===e._redirects)throw t;return void emitErrorAndClose(e,t)}const u=a?443:80,l=randomBytes(16).toString("base64"),f=a?https.request:http.request,d=new Set;let h,p;if(i.createConnection=i.createConnection||(a?tlsConnect:netConnect),i.defaultPort=i.defaultPort||u,i.port=o.port||u,i.host=o.hostname.startsWith("[")?o.hostname.slice(1,-1):o.hostname,i.headers={...i.headers,"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":l,Connection:"Upgrade",Upgrade:"websocket"},i.path=o.pathname+o.search,i.timeout=i.handshakeTimeout,i.perMessageDeflate&&(h=new PerMessageDeflate(!0!==i.perMessageDeflate?i.perMessageDeflate:{},!1,i.maxPayload),i.headers["Sec-WebSocket-Extensions"]=format({[PerMessageDeflate.extensionName]:h.offer()})),n.length){for(const e of n){if("string"!=typeof e||!subprotocolRegex.test(e)||d.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");d.add(e)}i.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(i.origin&&(i.protocolVersion<13?i.headers["Sec-WebSocket-Origin"]=i.origin:i.headers.Origin=i.origin),(o.username||o.password)&&(i.auth=`${o.username}:${o.password}`),s){const e=i.path.split(":");i.socketPath=e[0],i.path=e[1]}if(i.followRedirects){if(0===e._redirects){e._originalIpc=s,e._originalSecure=a,e._originalHostOrSocketPath=s?i.socketPath:o.host;const t=r&&r.headers;if(r={...r,headers:{}},t)for(const[e,n]of Object.entries(t))r.headers[e.toLowerCase()]=n}else if(0===e.listenerCount("redirect")){const t=s?!!e._originalIpc&&i.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&o.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!a)&&(delete i.headers.authorization,delete i.headers.cookie,t||delete i.headers.host,i.auth=void 0)}i.auth&&!r.headers.authorization&&(r.headers.authorization="Basic "+Buffer.from(i.auth).toString("base64")),p=e._req=f(i),e._redirects&&e.emit("redirect",e.url,p)}else p=e._req=f(i);i.timeout&&p.on("timeout",(()=>{abortHandshake(e,p,"Opening handshake has timed out")})),p.on("error",(t=>{null===p||p[kAborted]||(p=e._req=null,emitErrorAndClose(e,t))})),p.on("response",(o=>{const a=o.headers.location,s=o.statusCode;if(a&&i.followRedirects&&s>=300&&s<400){if(++e._redirects>i.maxRedirects)return void abortHandshake(e,p,"Maximum redirects exceeded");let o;p.abort();try{o=new URL$3(a,t)}catch(t){const n=new SyntaxError(`Invalid URL: ${a}`);return void emitErrorAndClose(e,n)}initAsClient(e,o,n,r)}else e.emit("unexpected-response",p,o)||abortHandshake(e,p,`Unexpected server response: ${o.statusCode}`)})),p.on("upgrade",((t,n,r)=>{if(e.emit("upgrade",t),e.readyState!==WebSocket$1.CONNECTING)return;p=e._req=null;const o=t.headers.upgrade;if(void 0===o||"websocket"!==o.toLowerCase())return void abortHandshake(e,n,"Invalid Upgrade header");const a=createHash("sha1").update(l+GUID).digest("base64");if(t.headers["sec-websocket-accept"]!==a)return void abortHandshake(e,n,"Invalid Sec-WebSocket-Accept header");const s=t.headers["sec-websocket-protocol"];let c;if(void 0!==s?d.size?d.has(s)||(c="Server sent an invalid subprotocol"):c="Server sent a subprotocol but none was requested":d.size&&(c="Server sent no subprotocol"),c)return void abortHandshake(e,n,c);s&&(e._protocol=s);const u=t.headers["sec-websocket-extensions"];if(void 0!==u){if(!h){return void abortHandshake(e,n,"Server sent a Sec-WebSocket-Extensions header but no extension was requested")}let t;try{t=parse(u)}catch(t){return void abortHandshake(e,n,"Invalid Sec-WebSocket-Extensions header")}const r=Object.keys(t);if(1!==r.length||r[0]!==PerMessageDeflate.extensionName){return void abortHandshake(e,n,"Server indicated an extension that was not requested")}try{h.accept(t[PerMessageDeflate.extensionName])}catch(t){return void abortHandshake(e,n,"Invalid Sec-WebSocket-Extensions header")}e._extensions[PerMessageDeflate.extensionName]=h}e.setSocket(n,r,{allowSynchronousEvents:i.allowSynchronousEvents,generateMask:i.generateMask,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation})})),i.finishRequest?i.finishRequest(p,e):p.end()}function emitErrorAndClose(e,t){e._readyState=WebSocket$1.CLOSING,e._errorEmitted=!0,e.emit("error",t),e.emitClose()}function netConnect(e){return e.path=e.socketPath,net.connect(e)}function tlsConnect(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=net.isIP(e.host)?"":e.host),tls.connect(e)}function abortHandshake(e,t,n){e._readyState=WebSocket$1.CLOSING;const r=new Error(n);Error.captureStackTrace(r,abortHandshake),t.setHeader?(t[kAborted]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(emitErrorAndClose,e,r)):(t.destroy(r),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function sendAfterClose(e,t,n){if(t){const n=isBlob(t)?t.size:toBuffer(t).length;e._socket?e._sender._bufferedBytes+=n:e._bufferedAmount+=n}if(n){const t=new Error(`WebSocket is not open: readyState ${e.readyState} (${readyStates[e.readyState]})`);process.nextTick(n,t)}}function receiverOnConclude(e,t){const n=this[kWebSocket];n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=e,void 0!==n._socket[kWebSocket]&&(n._socket.removeListener("data",socketOnData),process.nextTick(resume,n._socket),1005===e?n.close():n.close(e,t))}function receiverOnDrain(){const e=this[kWebSocket];e.isPaused||e._socket.resume()}function receiverOnError(e){const t=this[kWebSocket];void 0!==t._socket[kWebSocket]&&(t._socket.removeListener("data",socketOnData),process.nextTick(resume,t._socket),t.close(e[kStatusCode])),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e))}function receiverOnFinish(){this[kWebSocket].emitClose()}function receiverOnMessage(e,t){this[kWebSocket].emit("message",e,t)}function receiverOnPing(e){const t=this[kWebSocket];t._autoPong&&t.pong(e,!this._isServer,NOOP),t.emit("ping",e)}function receiverOnPong(e){this[kWebSocket].emit("pong",e)}function resume(e){e.resume()}function senderOnError(e){const t=this[kWebSocket];t.readyState!==WebSocket$1.CLOSED&&(t.readyState===WebSocket$1.OPEN&&(t._readyState=WebSocket$1.CLOSING,setCloseTimer(t)),this._socket.end(),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e)))}function setCloseTimer(e){e._closeTimer=setTimeout(e._socket.destroy.bind(e._socket),closeTimeout)}function socketOnClose(){const e=this[kWebSocket];let t;this.removeListener("close",socketOnClose),this.removeListener("data",socketOnData),this.removeListener("end",socketOnEnd),e._readyState=WebSocket$1.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[kWebSocket]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",receiverOnFinish),e._receiver.on("finish",receiverOnFinish))}function socketOnData(e){this[kWebSocket]._receiver.write(e)||this.pause()}function socketOnEnd(){const e=this[kWebSocket];e._readyState=WebSocket$1.CLOSING,e._receiver.end(),this.end()}function socketOnError(){const e=this[kWebSocket];this.removeListener("error",socketOnError),this.on("error",NOOP),e&&(e._readyState=WebSocket$1.CLOSING,this.destroy())}const WebSocket=globalThis.WebSocket||websocket;class WebSocketTransport{events;ws;protocols;constructor(e){this.events=e}send(e){e instanceof ArrayBuffer?this.ws.send(e):Array.isArray(e)&&this.ws.send(new Uint8Array(e).buffer)}connect(e){this.ws=new WebSocket(e,this.protocols),this.ws.binaryType="arraybuffer",this.ws.onopen=this.events.onopen,this.ws.onmessage=this.events.onmessage,this.ws.onclose=this.events.onclose,this.ws.onerror=this.events.onerror}close(e,t){this.ws.close(e,t)}get isOpen(){return this.ws.readyState===WebSocket.OPEN}}class Connection{transport;events={};constructor(){this.transport=new WebSocketTransport(this.events)}send(e){this.transport.send(e)}connect(e){this.transport.connect(e)}close(e,t){this.transport.close(e,t)}get isOpen(){return this.transport.isOpen}}var Protocol,ErrorCode;function utf8Read$1(e,t){const n=e[t++];for(var r="",i=0,o=t,a=t+n;o<a;o++){var s=e[o];if(128&s)if(192!=(224&s))if(224!=(240&s)){if(240!=(248&s))throw new Error("Invalid byte "+s.toString(16));(i=(7&s)<<18|(63&e[++o])<<12|(63&e[++o])<<6|63&e[++o])>=65536?(i-=65536,r+=String.fromCharCode(55296+(i>>>10),56320+(1023&i))):r+=String.fromCharCode(i)}else r+=String.fromCharCode((15&s)<<12|(63&e[++o])<<6|63&e[++o]);else r+=String.fromCharCode((31&s)<<6|63&e[++o]);else r+=String.fromCharCode(s)}return r}function utf8Length$1(e=""){let t=0,n=0;for(let r=0,i=e.length;r<i;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n+1}!function(e){e[e.HANDSHAKE=9]="HANDSHAKE",e[e.JOIN_ROOM=10]="JOIN_ROOM",e[e.ERROR=11]="ERROR",e[e.LEAVE_ROOM=12]="LEAVE_ROOM",e[e.ROOM_DATA=13]="ROOM_DATA",e[e.ROOM_STATE=14]="ROOM_STATE",e[e.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",e[e.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA",e[e.ROOM_DATA_BYTES=17]="ROOM_DATA_BYTES"}(Protocol||(Protocol={})),function(e){e[e.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",e[e.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",e[e.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",e[e.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",e[e.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",e[e.AUTH_FAILED=4215]="AUTH_FAILED",e[e.APPLICATION_ERROR=4216]="APPLICATION_ERROR"}(ErrorCode||(ErrorCode={}));const serializers={};function registerSerializer(e,t){serializers[e]=t}function getSerializer(e){const t=serializers[e];if(!t)throw new Error("missing serializer: "+e);return t}const createNanoEvents=()=>({emit(e,...t){let n=this.events[e]||[];for(let e=0,r=n.length;e<r;e++)n[e](...t)},events:{},on(e,t){return this.events[e]?.push(t)||(this.events[e]=[t]),()=>{this.events[e]=this.events[e]?.filter((e=>t!==e))}}});class EventEmitter$1{handlers=[];register(e,t=!1){return this.handlers.push(e),this}invoke(...e){this.handlers.forEach((t=>t.apply(this,e)))}invokeAsync(...e){return Promise.all(this.handlers.map((t=>t.apply(this,e))))}remove(e){const t=this.handlers.indexOf(e);this.handlers[t]=this.handlers[this.handlers.length-1],this.handlers.pop()}clear(){this.handlers=[]}}function createSignal(){const e=new EventEmitter$1;function t(t){return e.register(t,null===this)}return t.once=t=>{const n=function(...r){t.apply(this,r),e.remove(n)};e.register(n)},t.remove=t=>e.remove(t),t.invoke=(...t)=>e.invoke(...t),t.invokeAsync=(...t)=>e.invokeAsync(...t),t.clear=()=>e.clear(),t}const SWITCH_TO_STRUCTURE=255,TYPE_ID=213;var OPERATION;!function(e){e[e.ADD=128]="ADD",e[e.REPLACE=0]="REPLACE",e[e.DELETE=64]="DELETE",e[e.DELETE_AND_ADD=192]="DELETE_AND_ADD",e[e.TOUCH=1]="TOUCH",e[e.CLEAR=10]="CLEAR"}(OPERATION||(OPERATION={}));class ChangeTree{constructor(e,t,n){this.changed=!1,this.changes=new Map,this.allChanges=new Set,this.caches={},this.currentCustomOperation=0,this.ref=e,this.setParent(t,n)}setParent(e,t,n){if(this.indexes||(this.indexes=this.ref instanceof Schema?this.ref._definition.indexes:{}),this.parent=e,this.parentIndex=n,t)if(this.root=t,this.ref instanceof Schema){const e=this.ref._definition;for(let n in e.schema){const r=this.ref[n];if(r&&r.$changes){const i=e.indexes[n];r.$changes.setParent(this.ref,t,i)}}}else"object"==typeof this.ref&&this.ref.forEach(((e,t)=>{if(e instanceof Schema){const n=e.$changes,r=this.ref.$changes.indexes[t];n.setParent(this.ref,this.root,r)}}))}operation(e){this.changes.set(--this.currentCustomOperation,e)}change(e,t=OPERATION.ADD){const n="number"==typeof e?e:this.indexes[e];this.assertValidIndex(n,e);const r=this.changes.get(n);r&&r.op!==OPERATION.DELETE&&r.op!==OPERATION.TOUCH||this.changes.set(n,{op:r&&r.op===OPERATION.DELETE?OPERATION.DELETE_AND_ADD:t,index:n}),this.allChanges.add(n),this.changed=!0,this.touchParents()}touch(e){const t="number"==typeof e?e:this.indexes[e];this.assertValidIndex(t,e),this.changes.has(t)||this.changes.set(t,{op:OPERATION.TOUCH,index:t}),this.allChanges.add(t),this.touchParents()}touchParents(){this.parent&&this.parent.$changes.touch(this.parentIndex)}getType(e){if(this.ref._definition){const t=this.ref._definition;return t.schema[t.fieldsByIndex[e]]}{const e=this.parent._definition,t=e.schema[e.fieldsByIndex[this.parentIndex]];return Object.values(t)[0]}}getChildrenFilter(){const e=this.parent._definition.childFilters;return e&&e[this.parentIndex]}getValue(e){return this.ref.getByIndex(e)}delete(e){const t="number"==typeof e?e:this.indexes[e];if(void 0===t)return void console.warn(`@colyseus/schema ${this.ref.constructor.name}: trying to delete non-existing index: ${e} (${t})`);const n=this.getValue(t);this.changes.set(t,{op:OPERATION.DELETE,index:t}),this.allChanges.delete(t),delete this.caches[t],n&&n.$changes&&(n.$changes.parent=void 0),this.changed=!0,this.touchParents()}discard(e=!1,t=!1){this.ref instanceof Schema||this.changes.forEach((e=>{if(e.op===OPERATION.DELETE){const t=this.ref.getIndex(e.index);delete this.indexes[t]}})),this.changes.clear(),this.changed=e,t&&this.allChanges.clear(),this.currentCustomOperation=0}discardAll(){this.changes.forEach((e=>{const t=this.getValue(e.index);t&&t.$changes&&t.$changes.discardAll()})),this.discard()}cache(e,t){this.caches[e]=t}clone(){return new ChangeTree(this.ref,this.parent,this.root)}ensureRefId(){void 0===this.refId&&(this.refId=this.root.getNextUniqueId())}assertValidIndex(e,t){if(void 0===e)throw new Error(`ChangeTree: missing index for field "${t}"`)}}function addCallback(e,t,n,r){return e[t]||(e[t]=[]),e[t].push(n),r?.forEach(((e,t)=>n(e,t))),()=>spliceOne(e[t],e[t].indexOf(n))}function removeChildRefs(e){const t="string"!=typeof this.$changes.getType();this.$items.forEach(((n,r)=>{e.push({refId:this.$changes.refId,op:OPERATION.DELETE,field:r,value:void 0,previousValue:n}),t&&this.$changes.root.removeRef(n.$changes.refId)}))}function spliceOne(e,t){if(-1===t||t>=e.length)return!1;const n=e.length-1;for(let r=t;r<n;r++)e[r]=e[r+1];return e.length=n,!0}const DEFAULT_SORT=(e,t)=>{const n=e.toString(),r=t.toString();return n<r?-1:n>r?1:0};function getArrayProxy(e){return e.$proxy=!0,e=new Proxy(e,{get:(e,t)=>"symbol"==typeof t||isNaN(t)?e[t]:e.at(t),set:(e,t,n)=>{if("symbol"==typeof t||isNaN(t))e[t]=n;else{const r=Array.from(e.$items.keys()),i=parseInt(r[t]||t);null==n?e.deleteAt(i):e.setAt(i,n)}return!0},deleteProperty:(e,t)=>("number"==typeof t?e.deleteAt(t):delete e[t],!0),has:(e,t)=>"symbol"==typeof t||isNaN(Number(t))?Reflect.has(e,t):e.$items.has(Number(t))})}class ArraySchema{onAdd(e,t=!0){return addCallback(this.$callbacks||(this.$callbacks={}),OPERATION.ADD,e,t?this.$items:void 0)}onRemove(e){return addCallback(this.$callbacks||(this.$callbacks={}),OPERATION.DELETE,e)}onChange(e){return addCallback(this.$callbacks||(this.$callbacks={}),OPERATION.REPLACE,e)}static is(e){return Array.isArray(e)||void 0!==e.array}constructor(...e){this.$changes=new ChangeTree(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,this.push.apply(this,e)}set length(e){0===e?this.clear():this.splice(e,this.length-e)}get length(){return this.$items.size}push(...e){let t;return e.forEach((e=>{t=this.$refId++,this.setAt(t,e)})),t}pop(){const e=Array.from(this.$indexes.values()).pop();if(void 0===e)return;this.$changes.delete(e),this.$indexes.delete(e);const t=this.$items.get(e);return this.$items.delete(e),t}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),e<0||e>=this.length)return;const t=Array.from(this.$items.keys())[e];return this.$items.get(t)}setAt(e,t){if(null==t)return void console.error("ArraySchema items cannot be null nor undefined; Use `deleteAt(index)` instead.");if(this.$items.get(e)===t)return;void 0!==t.$changes&&t.$changes.setParent(this,this.$changes.root,e);const n=this.$changes.indexes[e]?.op??OPERATION.ADD;this.$changes.indexes[e]=e,this.$indexes.set(e,e),this.$items.set(e,t),this.$changes.change(e,n)}deleteAt(e){const t=Array.from(this.$items.keys())[e];return void 0!==t&&this.$deleteAt(t)}$deleteAt(e){return this.$changes.delete(e),this.$indexes.delete(e),this.$items.delete(e)}clear(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&removeChildRefs.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:OPERATION.CLEAR}),this.$changes.touchParents()}concat(...e){return new ArraySchema(...Array.from(this.$items.values()).concat(...e))}join(e){return Array.from(this.$items.values()).join(e)}reverse(){const e=Array.from(this.$items.keys());return Array.from(this.$items.values()).reverse().forEach(((t,n)=>{this.setAt(e[n],t)})),this}shift(){const e=Array.from(this.$items.keys()).shift();if(void 0===e)return;const t=this.$items.get(e);return this.$deleteAt(e),t}slice(e,t){const n=new ArraySchema;return n.push(...Array.from(this.$items.values()).slice(e,t)),n}sort(e=DEFAULT_SORT){const t=Array.from(this.$items.keys());return Array.from(this.$items.values()).sort(e).forEach(((e,n)=>{this.setAt(t[n],e)})),this}splice(e,t=this.length-e,...n){const r=Array.from(this.$items.keys()),i=[];for(let n=e;n<e+t;n++)i.push(this.$items.get(r[n])),this.$deleteAt(r[n]);for(let t=0;t<n.length;t++)this.setAt(e+t,n[t]);return i}unshift(...e){const t=this.length,n=e.length,r=Array.from(this.$items.values());return e.forEach(((e,t)=>{this.setAt(t,e)})),r.forEach(((e,t)=>{this.setAt(n+t,e)})),t+n}indexOf(e,t){return Array.from(this.$items.values()).indexOf(e,t)}lastIndexOf(e,t=this.length-1){return Array.from(this.$items.values()).lastIndexOf(e,t)}every(e,t){return Array.from(this.$items.values()).every(e,t)}some(e,t){return Array.from(this.$items.values()).some(e,t)}forEach(e,t){Array.from(this.$items.values()).forEach(e,t)}map(e,t){return Array.from(this.$items.values()).map(e,t)}filter(e,t){return Array.from(this.$items.values()).filter(e,t)}reduce(e,t){return Array.prototype.reduce.apply(Array.from(this.$items.values()),arguments)}reduceRight(e,t){return Array.prototype.reduceRight.apply(Array.from(this.$items.values()),arguments)}find(e,t){return Array.from(this.$items.values()).find(e,t)}findIndex(e,t){return Array.from(this.$items.values()).findIndex(e,t)}fill(e,t,n){throw new Error("ArraySchema#fill() not implemented")}copyWithin(e,t,n){throw new Error("ArraySchema#copyWithin() not implemented")}toString(){return this.$items.toString()}toLocaleString(){return this.$items.toLocaleString()}[Symbol.iterator](){return Array.from(this.$items.values())[Symbol.iterator]()}static get[Symbol.species](){return ArraySchema}entries(){return this.$items.entries()}keys(){return this.$items.keys()}values(){return this.$items.values()}includes(e,t){return Array.from(this.$items.values()).includes(e,t)}flatMap(e,t){throw new Error("ArraySchema#flatMap() is not supported.")}flat(e){throw new Error("ArraySchema#flat() is not supported.")}findLast(){const e=Array.from(this.$items.values());return e.findLast.apply(e,arguments)}findLastIndex(...e){const t=Array.from(this.$items.values());return t.findLastIndex.apply(t,arguments)}with(e,t){const n=Array.from(this.$items.values());return n[e]=t,new ArraySchema(...n)}toReversed(){return Array.from(this.$items.values()).reverse()}toSorted(e){return Array.from(this.$items.values()).sort(e)}toSpliced(e,t,...n){const r=Array.from(this.$items.values());return r.toSpliced.apply(r,arguments)}setIndex(e,t){this.$indexes.set(e,t)}getIndex(e){return this.$indexes.get(e)}getByIndex(e){return this.$items.get(this.$indexes.get(e))}deleteByIndex(e){const t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)}toArray(){return Array.from(this.$items.values())}toJSON(){return this.toArray().map((e=>"function"==typeof e.toJSON?e.toJSON():e))}clone(e){let t;return t=e?new ArraySchema(...Array.from(this.$items.values())):new ArraySchema(...this.map((e=>e.$changes?e.clone():e))),t}}function getMapProxy(e){return e.$proxy=!0,e=new Proxy(e,{get:(e,t)=>"symbol"!=typeof t&&void 0===e[t]?e.get(t):e[t],set:(e,t,n)=>("symbol"!=typeof t&&-1===t.indexOf("$")&&"onAdd"!==t&&"onRemove"!==t&&"onChange"!==t?e.set(t,n):e[t]=n,!0),deleteProperty:(e,t)=>(e.delete(t),!0)})}class MapSchema{onAdd(e,t=!0){return addCallback(this.$callbacks||(this.$callbacks={}),OPERATION.ADD,e,t?this.$items:void 0)}onRemove(e){return addCallback(this.$callbacks||(this.$callbacks={}),OPERATION.DELETE,e)}onChange(e){return addCallback(this.$callbacks||(this.$callbacks={}),OPERATION.REPLACE,e)}static is(e){return void 0!==e.map}constructor(e){if(this.$changes=new ChangeTree(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e)if(e instanceof Map||e instanceof MapSchema)e.forEach(((e,t)=>this.set(t,e)));else for(const t in e)this.set(t,e[t])}[Symbol.iterator](){return this.$items[Symbol.iterator]()}get[Symbol.toStringTag](){return this.$items[Symbol.toStringTag]}static get[Symbol.species](){return MapSchema}set(e,t){if(null==t)throw new Error(`MapSchema#set('${e}', ${t}): trying to set ${t} value on '${e}'.`);e=e.toString();const n=void 0!==this.$changes.indexes[e],r=n?this.$changes.indexes[e]:this.$refId++;let i=n?OPERATION.REPLACE:OPERATION.ADD;const o=void 0!==t.$changes;if(o&&t.$changes.setParent(this,this.$changes.root,r),n){if(!o&&this.$items.get(e)===t)return;o&&this.$items.get(e)!==t&&(i=OPERATION.ADD)}else this.$changes.indexes[e]=r,this.$indexes.set(r,e);return this.$items.set(e,t),this.$changes.change(e,i),this}get(e){return this.$items.get(e)}delete(e){return this.$changes.delete(e.toString()),this.$items.delete(e)}clear(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&removeChildRefs.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:OPERATION.CLEAR}),this.$changes.touchParents()}has(e){return this.$items.has(e)}forEach(e){this.$items.forEach(e)}entries(){return this.$items.entries()}keys(){return this.$items.keys()}values(){return this.$items.values()}get size(){return this.$items.size}setIndex(e,t){this.$indexes.set(e,t)}getIndex(e){return this.$indexes.get(e)}getByIndex(e){return this.$items.get(this.$indexes.get(e))}deleteByIndex(e){const t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)}toJSON(){const e={};return this.forEach(((t,n)=>{e[n]="function"==typeof t.toJSON?t.toJSON():t})),e}clone(e){let t;return e?t=Object.assign(new MapSchema,this):(t=new MapSchema,this.forEach(((e,n)=>{e.$changes?t.set(n,e.clone()):t.set(n,e)}))),t}}const registeredTypes={};function registerType(e,t){registeredTypes[e]=t}function getType(e){return registeredTypes[e]}class SchemaDefinition{constructor(){this.indexes={},this.fieldsByIndex={},this.deprecated={},this.descriptors={}}static create(e){const t=new SchemaDefinition;return t.schema=Object.assign({},e&&e.schema||{}),t.indexes=Object.assign({},e&&e.indexes||{}),t.fieldsByIndex=Object.assign({},e&&e.fieldsByIndex||{}),t.descriptors=Object.assign({},e&&e.descriptors||{}),t.deprecated=Object.assign({},e&&e.deprecated||{}),t}addField(e,t){const n=this.getNextFieldIndex();this.fieldsByIndex[n]=e,this.indexes[e]=n,this.schema[e]=Array.isArray(t)?{array:t[0]}:t}hasField(e){return void 0!==this.indexes[e]}addFilter(e,t){return this.filters||(this.filters={},this.indexesWithFilters=[]),this.filters[this.indexes[e]]=t,this.indexesWithFilters.push(this.indexes[e]),!0}addChildrenFilter(e,t){const n=this.indexes[e],r=this.schema[e];if(getType(Object.keys(r)[0]))return this.childFilters||(this.childFilters={}),this.childFilters[n]=t,!0;console.warn(`@filterChildren: field '${e}' can't have children. Ignoring filter.`)}getChildrenFilter(e){return this.childFilters&&this.childFilters[this.indexes[e]]}getNextFieldIndex(){return Object.keys(this.schema||{}).length}}class Context{constructor(){this.types={},this.schemas=new Map,this.useFilters=!1}has(e){return this.schemas.has(e)}get(e){return this.types[e]}add(e,t=this.schemas.size){e._definition=SchemaDefinition.create(e._definition),e._typeid=t,this.types[t]=e,this.schemas.set(e,t)}static create(e={}){return function(t){return e.context||(e.context=new Context),type(t,e)}}}const globalContext=new Context;function type(e,t={}){return function(n,r){const i=t.context||globalContext,o=n.constructor;if(o._context=i,!e)throw new Error(`${o.name}: @type() reference provided for "${r}" is undefined. Make sure you don't have any circular dependencies.`);i.has(o)||i.add(o);const a=o._definition;if(a.addField(r,e),a.descriptors[r]){if(a.deprecated[r])return;try{throw new Error(`@colyseus/schema: Duplicate '${r}' definition on '${o.name}'.\nCheck @type() annotation`)}catch(e){const t=e.stack.split("\n")[4].trim();throw new Error(`${e.message} ${t}`)}}const s=ArraySchema.is(e),c=!s&&MapSchema.is(e);if("string"!=typeof e&&!Schema.is(e)){const t=Object.values(e)[0];"string"==typeof t||i.has(t)||i.add(t)}if(t.manual)return void(a.descriptors[r]={enumerable:!0,configurable:!0,writable:!0});const u=`_${r}`;a.descriptors[u]={enumerable:!1,configurable:!1,writable:!0},a.descriptors[r]={get:function(){return this[u]},set:function(e){e!==this[u]&&(null!=e?(!s||e instanceof ArraySchema||(e=new ArraySchema(...e)),!c||e instanceof MapSchema||(e=new MapSchema(e)),void 0===e.$proxy&&(c?e=getMapProxy(e):s&&(e=getArrayProxy(e))),this.$changes.change(r),e.$changes&&e.$changes.setParent(this,this.$changes.root,this._definition.indexes[r])):this[u]&&this.$changes.delete(r),this[u]=e)},enumerable:!0,configurable:!0}}}function utf8Length(e){for(var t=0,n=0,r=0,i=e.length;r<i;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function utf8Write(e,t,n){for(var r=0,i=0,o=n.length;i<o;i++)(r=n.charCodeAt(i))<128?e[t++]=r:r<2048?(e[t++]=192|r>>6,e[t++]=128|63&r):r<55296||r>=57344?(e[t++]=224|r>>12,e[t++]=128|r>>6&63,e[t++]=128|63&r):(i++,r=65536+((1023&r)<<10|1023&n.charCodeAt(i)),e[t++]=240|r>>18,e[t++]=128|r>>12&63,e[t++]=128|r>>6&63,e[t++]=128|63&r)}function int8$1(e,t){e.push(255&t)}function uint8$1(e,t){e.push(255&t)}function int16$1(e,t){e.push(255&t),e.push(t>>8&255)}function uint16$1(e,t){e.push(255&t),e.push(t>>8&255)}function int32$1(e,t){e.push(255&t),e.push(t>>8&255),e.push(t>>16&255),e.push(t>>24&255)}function uint32$1(e,t){const n=t>>24,r=t>>16,i=t>>8,o=t;e.push(255&o),e.push(255&i),e.push(255&r),e.push(255&n)}function int64$1(e,t){const n=Math.floor(t/Math.pow(2,32));uint32$1(e,t>>>0),uint32$1(e,n)}function uint64$1(e,t){const n=t/Math.pow(2,32)|0;uint32$1(e,t>>>0),uint32$1(e,n)}function float32$1(e,t){writeFloat32(e,t)}function float64$1(e,t){writeFloat64(e,t)}const _int32$1=new Int32Array(2),_float32$1=new Float32Array(_int32$1.buffer),_float64$1=new Float64Array(_int32$1.buffer);function writeFloat32(e,t){_float32$1[0]=t,int32$1(e,_int32$1[0])}function writeFloat64(e,t){_float64$1[0]=t,int32$1(e,_int32$1[0]),int32$1(e,_int32$1[1])}function boolean$1(e,t){return uint8$1(e,t?1:0)}function string$1(e,t){t||(t="");let n=utf8Length(t),r=0;if(n<32)e.push(160|n),r=1;else if(n<256)e.push(217),uint8$1(e,n),r=2;else if(n<65536)e.push(218),uint16$1(e,n),r=3;else{if(!(n<4294967296))throw new Error("String too long");e.push(219),uint32$1(e,n),r=5}return utf8Write(e,e.length,t),r+n}function number$1(e,t){return isNaN(t)?number$1(e,0):isFinite(t)?t!==(0|t)?(e.push(203),writeFloat64(e,t),9):t>=0?t<128?(uint8$1(e,t),1):t<256?(e.push(204),uint8$1(e,t),2):t<65536?(e.push(205),uint16$1(e,t),3):t<4294967296?(e.push(206),uint32$1(e,t),5):(e.push(207),uint64$1(e,t),9):t>=-32?(e.push(224|t+32),1):t>=-128?(e.push(208),int8$1(e,t),2):t>=-32768?(e.push(209),int16$1(e,t),3):t>=-2147483648?(e.push(210),int32$1(e,t),5):(e.push(211),int64$1(e,t),9):number$1(e,t>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER)}var encode$1=Object.freeze({__proto__:null,boolean:boolean$1,float32:float32$1,float64:float64$1,int16:int16$1,int32:int32$1,int64:int64$1,int8:int8$1,number:number$1,string:string$1,uint16:uint16$1,uint32:uint32$1,uint64:uint64$1,uint8:uint8$1,utf8Write:utf8Write,writeFloat32:writeFloat32,writeFloat64:writeFloat64});function utf8Read(e,t,n){for(var r="",i=0,o=t,a=t+n;o<a;o++){var s=e[o];128&s?192!=(224&s)?224!=(240&s)?240!=(248&s)?console.error("Invalid byte "+s.toString(16)):(i=(7&s)<<18|(63&e[++o])<<12|(63&e[++o])<<6|63&e[++o])>=65536?(i-=65536,r+=String.fromCharCode(55296+(i>>>10),56320+(1023&i))):r+=String.fromCharCode(i):r+=String.fromCharCode((15&s)<<12|(63&e[++o])<<6|63&e[++o]):r+=String.fromCharCode((31&s)<<6|63&e[++o]):r+=String.fromCharCode(s)}return r}function int8(e,t){return uint8(e,t)<<24>>24}function uint8(e,t){return e[t.offset++]}function int16(e,t){return uint16(e,t)<<16>>16}function uint16(e,t){return e[t.offset++]|e[t.offset++]<<8}function int32(e,t){return e[t.offset++]|e[t.offset++]<<8|e[t.offset++]<<16|e[t.offset++]<<24}function uint32(e,t){return int32(e,t)>>>0}function float32(e,t){return readFloat32(e,t)}function float64(e,t){return readFloat64(e,t)}function int64(e,t){const n=uint32(e,t);return int32(e,t)*Math.pow(2,32)+n}function uint64(e,t){const n=uint32(e,t);return uint32(e,t)*Math.pow(2,32)+n}const _int32=new Int32Array(2),_float32=new Float32Array(_int32.buffer),_float64=new Float64Array(_int32.buffer);function readFloat32(e,t){return _int32[0]=int32(e,t),_float32[0]}function readFloat64(e,t){return _int32[0]=int32(e,t),_int32[1]=int32(e,t),_float64[0]}function boolean(e,t){return uint8(e,t)>0}function string(e,t){const n=e[t.offset++];let r;n<192?r=31&n:217===n?r=uint8(e,t):218===n?r=uint16(e,t):219===n&&(r=uint32(e,t));const i=utf8Read(e,t.offset,r);return t.offset+=r,i}function stringCheck(e,t){const n=e[t.offset];return n<192&&n>160||217===n||218===n||219===n}function number(e,t){const n=e[t.offset++];return n<128?n:202===n?readFloat32(e,t):203===n?readFloat64(e,t):204===n?uint8(e,t):205===n?uint16(e,t):206===n?uint32(e,t):207===n?uint64(e,t):208===n?int8(e,t):209===n?int16(e,t):210===n?int32(e,t):211===n?int64(e,t):n>223?-1*(255-n+1):void 0}function numberCheck(e,t){const n=e[t.offset];return n<128||n>=202&&n<=211}function arrayCheck(e,t){return e[t.offset]<160}function switchStructureCheck(e,t){return e[t.offset-1]===SWITCH_TO_STRUCTURE&&(e[t.offset]<128||e[t.offset]>=202&&e[t.offset]<=211)}var decode$1=Object.freeze({__proto__:null,arrayCheck:arrayCheck,boolean:boolean,float32:float32,float64:float64,int16:int16,int32:int32,int64:int64,int8:int8,number:number,numberCheck:numberCheck,readFloat32:readFloat32,readFloat64:readFloat64,string:string,stringCheck:stringCheck,switchStructureCheck:switchStructureCheck,uint16:uint16,uint32:uint32,uint64:uint64,uint8:uint8});class CollectionSchema{onAdd(e,t=!0){return addCallback(this.$callbacks||(this.$callbacks=[]),OPERATION.ADD,e,t?this.$items:void 0)}onRemove(e){return addCallback(this.$callbacks||(this.$callbacks=[]),OPERATION.DELETE,e)}onChange(e){return addCallback(this.$callbacks||(this.$callbacks=[]),OPERATION.REPLACE,e)}static is(e){return void 0!==e.collection}constructor(e){this.$changes=new ChangeTree(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach((e=>this.add(e)))}add(e){const t=this.$refId++;return void 0!==e.$changes&&e.$changes.setParent(this,this.$changes.root,t),this.$changes.indexes[t]=t,this.$indexes.set(t,t),this.$items.set(t,e),this.$changes.change(t),t}at(e){const t=Array.from(this.$items.keys())[e];return this.$items.get(t)}entries(){return this.$items.entries()}delete(e){const t=this.$items.entries();let n,r;for(;(r=t.next())&&!r.done;)if(e===r.value[1]){n=r.value[0];break}return void 0!==n&&(this.$changes.delete(n),this.$indexes.delete(n),this.$items.delete(n))}clear(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&removeChildRefs.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:OPERATION.CLEAR}),this.$changes.touchParents()}has(e){return Array.from(this.$items.values()).some((t=>t===e))}forEach(e){this.$items.forEach(((t,n,r)=>e(t,n,this)))}values(){return this.$items.values()}get size(){return this.$items.size}setIndex(e,t){this.$indexes.set(e,t)}getIndex(e){return this.$indexes.get(e)}getByIndex(e){return this.$items.get(this.$indexes.get(e))}deleteByIndex(e){const t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)}toArray(){return Array.from(this.$items.values())}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push("function"==typeof t.toJSON?t.toJSON():t)})),e}clone(e){let t;return e?t=Object.assign(new CollectionSchema,this):(t=new CollectionSchema,this.forEach((e=>{e.$changes?t.add(e.clone()):t.add(e)}))),t}}class SetSchema{onAdd(e,t=!0){return addCallback(this.$callbacks||(this.$callbacks=[]),OPERATION.ADD,e,t?this.$items:void 0)}onRemove(e){return addCallback(this.$callbacks||(this.$callbacks=[]),OPERATION.DELETE,e)}onChange(e){return addCallback(this.$callbacks||(this.$callbacks=[]),OPERATION.REPLACE,e)}static is(e){return void 0!==e.set}constructor(e){this.$changes=new ChangeTree(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach((e=>this.add(e)))}add(e){if(this.has(e))return!1;const t=this.$refId++;void 0!==e.$changes&&e.$changes.setParent(this,this.$changes.root,t);const n=this.$changes.indexes[t]?.op??OPERATION.ADD;return this.$changes.indexes[t]=t,this.$indexes.set(t,t),this.$items.set(t,e),this.$changes.change(t,n),t}entries(){return this.$items.entries()}delete(e){const t=this.$items.entries();let n,r;for(;(r=t.next())&&!r.done;)if(e===r.value[1]){n=r.value[0];break}return void 0!==n&&(this.$changes.delete(n),this.$indexes.delete(n),this.$items.delete(n))}clear(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&removeChildRefs.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:OPERATION.CLEAR}),this.$changes.touchParents()}has(e){const t=this.$items.values();let n,r=!1;for(;(n=t.next())&&!n.done;)if(e===n.value){r=!0;break}return r}forEach(e){this.$items.forEach(((t,n,r)=>e(t,n,this)))}values(){return this.$items.values()}get size(){return this.$items.size}setIndex(e,t){this.$indexes.set(e,t)}getIndex(e){return this.$indexes.get(e)}getByIndex(e){return this.$items.get(this.$indexes.get(e))}deleteByIndex(e){const t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)}toArray(){return Array.from(this.$items.values())}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push("function"==typeof t.toJSON?t.toJSON():t)})),e}clone(e){let t;return e?t=Object.assign(new SetSchema,this):(t=new SetSchema,this.forEach((e=>{e.$changes?t.add(e.clone()):t.add(e)}))),t}}class ClientState{constructor(){this.refIds=new WeakSet,this.containerIndexes=new WeakMap}addRefId(e){this.refIds.has(e)||(this.refIds.add(e),this.containerIndexes.set(e,new Set))}static get(e){return void 0===e.$filterState&&(e.$filterState=new ClientState),e.$filterState}}class ReferenceTracker{constructor(){this.refs=new Map,this.refCounts={},this.deletedRefs=new Set,this.nextUniqueId=0}getNextUniqueId(){return this.nextUniqueId++}addRef(e,t,n=!0){this.refs.set(e,t),n&&(this.refCounts[e]=(this.refCounts[e]||0)+1)}removeRef(e){const t=this.refCounts[e];void 0!==t?0!==t?(this.refCounts[e]=t-1,this.deletedRefs.add(e)):console.warn(`trying to remove reference ${e} with 0 refCount`):console.warn(`trying to remove reference ${e} that doesn't exist`)}clearRefs(){this.refs.clear(),this.deletedRefs.clear(),this.refCounts={}}garbageCollectDeletedRefs(){this.deletedRefs.forEach((e=>{if(this.refCounts[e]>0)return;const t=this.refs.get(e);if(t instanceof Schema)for(const e in t._definition.schema)"string"!=typeof t._definition.schema[e]&&t[e]&&t[e].$changes&&this.removeRef(t[e].$changes.refId);else{const e=t.$changes.parent._definition,n=e.schema[e.fieldsByIndex[t.$changes.parentIndex]];"function"==typeof Object.values(n)[0]&&Array.from(t.values()).forEach((e=>this.removeRef(e.$changes.refId)))}this.refs.delete(e),delete this.refCounts[e]})),this.deletedRefs.clear()}}class EncodeSchemaError extends Error{}function assertType(e,t,n,r){let i,o=!1;switch(t){case"number":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":case"int64":case"uint64":case"float32":case"float64":i="number",isNaN(e)&&console.log(`trying to encode "NaN" in ${n.constructor.name}#${r}`);break;case"string":i="string",o=!0;break;case"boolean":return}if(typeof e!==i&&(!o||o&&null!==e)){let t=`'${JSON.stringify(e)}'${e&&e.constructor&&` (${e.constructor.name})`||""}`;throw new EncodeSchemaError(`a '${i}' was expected, but ${t} was provided in ${n.constructor.name}#${r}`)}}function assertInstanceType(e,t,n,r){if(!(e instanceof t))throw new EncodeSchemaError(`a '${t.name}' was expected, but '${e.constructor.name}' was provided in ${n.constructor.name}#${r}`)}function encodePrimitiveType(e,t,n,r,i){assertType(n,e,r,i);const o=encode$1[e];if(!o)throw new EncodeSchemaError(`a '${e}' was expected, but ${n} was provided in ${r.constructor.name}#${i}`);o(t,n)}function decodePrimitiveType(e,t,n){return decode$1[e](t,n)}class Schema{static{this._definition=SchemaDefinition.create()}static onError(e){console.error(e)}static is(e){return e._definition&&void 0!==e._definition.schema}onChange(e){return addCallback(this.$callbacks||(this.$callbacks={}),OPERATION.REPLACE,e)}onRemove(e){return addCallback(this.$callbacks||(this.$callbacks={}),OPERATION.DELETE,e)}constructor(...e){Object.defineProperties(this,{$changes:{value:new ChangeTree(this,void 0,new ReferenceTracker),enumerable:!1,writable:!0},$callbacks:{value:void 0,enumerable:!1,writable:!0}});const t=this._definition.descriptors;t&&Object.defineProperties(this,t),e[0]&&this.assign(e[0])}assign(e){return Object.assign(this,e),this}get _definition(){return this.constructor._definition}setDirty(e,t){this.$changes.change(e,t)}listen(e,t,n=!0){return this.$callbacks||(this.$callbacks={}),this.$callbacks[e]||(this.$callbacks[e]=[]),this.$callbacks[e].push(t),n&&void 0!==this[e]&&t(this[e],void 0),()=>spliceOne(this.$callbacks[e],this.$callbacks[e].indexOf(t))}decode(e,t={offset:0},n=this){const r=[],i=this.$changes.root,o=e.length;let a=0;for(i.refs.set(a,this);t.offset<o;){let s=e[t.offset++];if(s==SWITCH_TO_STRUCTURE){a=number(e,t);const r=i.refs.get(a);if(!r)throw new Error(`"refId" not found: ${a}`);n=r;continue}const c=n.$changes,u=void 0!==n._definition,l=u?s>>6<<6:s;if(l===OPERATION.CLEAR){n.clear(r);continue}const f=u?s%(l||255):number(e,t),d=u?n._definition.fieldsByIndex[f]:"";let h,p,m,y=c.getType(f);if(u?p=n[`_${d}`]:(p=n.getByIndex(f),(l&OPERATION.ADD)===OPERATION.ADD?(m=n instanceof MapSchema?string(e,t):f,n.setIndex(f,m)):m=n.getIndex(f)),(l&OPERATION.DELETE)===OPERATION.DELETE&&(l!==OPERATION.DELETE_AND_ADD&&n.deleteByIndex(f),p&&p.$changes&&i.removeRef(p.$changes.refId),h=null),void 0!==d){if(l===OPERATION.DELETE);else if(Schema.is(y)){const n=number(e,t);if(h=i.refs.get(n),l!==OPERATION.REPLACE){const r=this.getSchemaType(e,t,y);h||(h=this.createTypeInstance(r),h.$changes.refId=n,p&&(h.$callbacks=p.$callbacks,p.$changes.refId&&n!==p.$changes.refId&&i.removeRef(p.$changes.refId))),i.addRef(n,h,h!==p)}}else if("string"==typeof y)h=decodePrimitiveType(y,e,t);else{const n=getType(Object.keys(y)[0]),o=number(e,t),a=i.refs.has(o)?p||i.refs.get(o):new n.constructor;if(h=a.clone(!0),h.$changes.refId=o,p&&(h.$callbacks=p.$callbacks,p.$changes.refId&&o!==p.$changes.refId)){i.removeRef(p.$changes.refId);const e=p.entries();let t;for(;(t=e.next())&&!t.done;){const[e,n]=t.value;r.push({refId:o,op:OPERATION.DELETE,field:e,value:void 0,previousValue:n})}}i.addRef(o,h,a!==p)}if(null!=h)if(h.$changes&&h.$changes.setParent(c.ref,c.root,f),n instanceof Schema)n[d]=h;else if(n instanceof MapSchema){const e=m;n.$items.set(e,h),n.$changes.allChanges.add(f)}else if(n instanceof ArraySchema)n.setAt(f,h);else if(n instanceof CollectionSchema){const e=n.add(h);n.setIndex(f,e)}else if(n instanceof SetSchema){const e=n.add(h);!1!==e&&n.setIndex(f,e)}p!==h&&r.push({refId:a,op:l,field:d,dynamicIndex:m,value:h,previousValue:p})}else{console.warn("@colyseus/schema: definition mismatch");const n={offset:t.offset};for(;t.offset<o&&(!switchStructureCheck(e,t)||(n.offset=t.offset+1,!i.refs.has(number(e,n))));)t.offset++}}return this._triggerChanges(r),i.garbageCollectDeletedRefs(),r}encode(e=!1,t=[],n=!1){const r=this.$changes,i=new WeakSet,o=[r];let a=1;for(let s=0;s<a;s++){const c=o[s],u=c.ref,l=u instanceof Schema;c.ensureRefId(),i.add(c),c!==r&&(c.changed||e)&&(uint8$1(t,SWITCH_TO_STRUCTURE),number$1(t,c.refId));const f=e?Array.from(c.allChanges):Array.from(c.changes.values());for(let r=0,s=f.length;r<s;r++){const s=e?{op:OPERATION.ADD,index:f[r]}:f[r],d=s.index,h=l?u._definition.fieldsByIndex&&u._definition.fieldsByIndex[d]:d,p=t.length;if(s.op!==OPERATION.TOUCH)if(l)uint8$1(t,d|s.op);else{if(uint8$1(t,s.op),s.op===OPERATION.CLEAR)continue;number$1(t,d)}if(!l&&(s.op&OPERATION.ADD)==OPERATION.ADD&&u instanceof MapSchema){string$1(t,c.ref.$indexes.get(d))}if(s.op===OPERATION.DELETE)continue;const m=c.getType(d),y=c.getValue(d);if(y&&y.$changes&&!i.has(y.$changes)&&(o.push(y.$changes),y.$changes.ensureRefId(),a++),s.op!==OPERATION.TOUCH){if(Schema.is(m))assertInstanceType(y,m,u,h),number$1(t,y.$changes.refId),(s.op&OPERATION.ADD)===OPERATION.ADD&&this.tryEncodeTypeId(t,m,y.constructor);else if("string"==typeof m)encodePrimitiveType(m,t,y,u,h);else{const e=getType(Object.keys(m)[0]);assertInstanceType(u[`_${h}`],e.constructor,u,h),number$1(t,y.$changes.refId)}n&&c.cache(d,t.slice(p))}}e||n||c.discard()}return t}encodeAll(e){return this.encode(!0,[],e)}applyFilters(e,t=!1){const n=this,r=new Set,i=ClientState.get(e),o=[this.$changes];let a=1,s=[];for(let c=0;c<a;c++){const u=o[c];if(r.has(u.refId))continue;const l=u.ref,f=l instanceof Schema;uint8$1(s,SWITCH_TO_STRUCTURE),number$1(s,u.refId);const d=i.refIds.has(u),h=t||!d;i.addRefId(u);const p=i.containerIndexes.get(u),m=h?Array.from(u.allChanges):Array.from(u.changes.values());if(!t&&f&&l._definition.indexesWithFilters){l._definition.indexesWithFilters.forEach((e=>{!p.has(e)&&u.allChanges.has(e)&&(h?m.push(e):m.push({op:OPERATION.ADD,index:e}))}))}for(let t=0,i=m.length;t<i;t++){const i=h?{op:OPERATION.ADD,index:m[t]}:m[t];if(i.op===OPERATION.CLEAR){uint8$1(s,i.op);continue}const c=i.index;if(i.op===OPERATION.DELETE){f?uint8$1(s,i.op|c):(uint8$1(s,i.op),number$1(s,c));continue}const d=u.getValue(c),y=u.getType(c);if(f){const t=l._definition.filters&&l._definition.filters[c];if(t&&!t.call(l,e,d,n)){d&&d.$changes&&r.add(d.$changes.refId);continue}}else{const t=u.parent,i=u.getChildrenFilter();if(i&&!i.call(t,e,l.$indexes.get(c),d,n)){d&&d.$changes&&r.add(d.$changes.refId);continue}}if(d.$changes&&(o.push(d.$changes),a++),i.op!==OPERATION.TOUCH)if(i.op===OPERATION.ADD||f)s.push.apply(s,u.caches[c]??[]),p.add(c);else if(p.has(c))s.push.apply(s,u.caches[c]??[]);else{if(p.add(c),uint8$1(s,OPERATION.ADD),number$1(s,c),l instanceof MapSchema){string$1(s,u.ref.$indexes.get(c))}d.$changes?number$1(s,d.$changes.refId):encode$1[y](s,d)}else if(d.$changes&&!f){if(uint8$1(s,OPERATION.ADD),number$1(s,c),l instanceof MapSchema){string$1(s,u.ref.$indexes.get(c))}number$1(s,d.$changes.refId)}}}return s}clone(){const e=new this.constructor,t=this._definition.schema;for(let n in t)"object"==typeof this[n]&&"function"==typeof this[n]?.clone?e[n]=this[n].clone():e[n]=this[n];return e}toJSON(){const e=this._definition.schema,t=this._definition.deprecated,n={};for(let r in e)t[r]||null===this[r]||void 0===this[r]||(n[r]="function"==typeof this[r].toJSON?this[r].toJSON():this[`_${r}`]);return n}discardAllChanges(){this.$changes.discardAll()}getByIndex(e){return this[this._definition.fieldsByIndex[e]]}deleteByIndex(e){this[this._definition.fieldsByIndex[e]]=void 0}tryEncodeTypeId(e,t,n){t._typeid!==n._typeid&&(uint8$1(e,TYPE_ID),number$1(e,n._typeid))}getSchemaType(e,t,n){let r;return e[t.offset]===TYPE_ID&&(t.offset++,r=this.constructor._context.get(number(e,t))),r||n}createTypeInstance(e){let t=new e;return t.$changes.root=this.$changes.root,t}_triggerChanges(e){const t=new Set,n=this.$changes.root.refs;for(let r=0;r<e.length;r++){const i=e[r],o=i.refId,a=n.get(o),s=a.$callbacks;if((i.op&OPERATION.DELETE)===OPERATION.DELETE&&i.previousValue instanceof Schema&&i.previousValue.$callbacks?.[OPERATION.DELETE]?.forEach((e=>e())),s){if(a instanceof Schema){if(!t.has(o))try{s?.[OPERATION.REPLACE]?.forEach((e=>e()))}catch(e){Schema.onError(e)}try{s.hasOwnProperty(i.field)&&s[i.field]?.forEach((e=>e(i.value,i.previousValue)))}catch(e){Schema.onError(e)}}else i.op===OPERATION.ADD&&void 0===i.previousValue?s[OPERATION.ADD]?.forEach((e=>e(i.value,i.dynamicIndex??i.field))):i.op===OPERATION.DELETE?void 0!==i.previousValue&&s[OPERATION.DELETE]?.forEach((e=>e(i.previousValue,i.dynamicIndex??i.field))):i.op===OPERATION.DELETE_AND_ADD&&(void 0!==i.previousValue&&s[OPERATION.DELETE]?.forEach((e=>e(i.previousValue,i.dynamicIndex??i.field))),s[OPERATION.ADD]?.forEach((e=>e(i.value,i.dynamicIndex??i.field)))),i.value!==i.previousValue&&s[OPERATION.REPLACE]?.forEach((e=>e(i.value,i.dynamicIndex??i.field)));t.add(o)}}}}function __decorate(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}"function"==typeof SuppressedError&&SuppressedError;const reflectionContext={context:new Context};class ReflectionField extends Schema{}__decorate([type("string",reflectionContext)],ReflectionField.prototype,"name",void 0),__decorate([type("string",reflectionContext)],ReflectionField.prototype,"type",void 0),__decorate([type("number",reflectionContext)],ReflectionField.prototype,"referencedType",void 0);class ReflectionType extends Schema{constructor(){super(...arguments),this.fields=new ArraySchema}}__decorate([type("number",reflectionContext)],ReflectionType.prototype,"id",void 0),__decorate([type([ReflectionField],reflectionContext)],ReflectionType.prototype,"fields",void 0);class Reflection extends Schema{constructor(){super(...arguments),this.types=new ArraySchema}static encode(e){const t=e.constructor,n=new Reflection;n.rootType=t._typeid;const r=(e,t)=>{for(let n in t){const r=new ReflectionField;let i;if(r.name=n,"string"==typeof t[n])i=t[n];else{const e=t[n];let o;Schema.is(e)?(i="ref",o=t[n]):(i=Object.keys(e)[0],"string"==typeof e[i]?i+=":"+e[i]:o=e[i]),r.referencedType=o?o._typeid:-1}r.type=i,e.fields.push(r)}n.types.push(e)},i=t._context?.types;for(let e in i){const t=new ReflectionType;t.id=Number(e),r(t,i[e]._definition.schema)}return n.encodeAll()}static decode(e,t){const n=new Context,r=new Reflection;r.decode(e,t);const i=r.types.reduce(((e,t)=>{const r=class extends Schema{},i=t.id;return e[i]=r,n.add(r,i),e}),{});r.types.forEach((e=>{const t=i[e.id];e.fields.forEach((e=>{if(void 0!==e.referencedType){let r=e.type,o=i[e.referencedType];if(!o){const t=e.type.split(":");r=t[0],o=t[1]}"ref"===r?type(o,{context:n})(t.prototype,e.name):type({[r]:o},{context:n})(t.prototype,e.name)}else type(e.type,{context:n})(t.prototype,e.name)}))}));const o=i[r.rootType],a=new o;for(let e in o._definition.schema){const t=o._definition.schema[e];"string"!=typeof t&&(a[e]="function"==typeof t?new t:new(getType(Object.keys(t)[0]).constructor))}return a}}__decorate([type([ReflectionType],reflectionContext)],Reflection.prototype,"types",void 0),__decorate([type("number",reflectionContext)],Reflection.prototype,"rootType",void 0),registerType("map",{constructor:MapSchema}),registerType("array",{constructor:ArraySchema}),registerType("set",{constructor:SetSchema}),registerType("collection",{constructor:CollectionSchema});class Room{roomId;sessionId;reconnectionToken;name;connection;onStateChange=createSignal();onError=createSignal();onLeave=createSignal();onJoin=createSignal();serializerId;serializer;hasJoined=!1;rootSchema;onMessageHandlers=createNanoEvents();constructor(e,t){this.roomId=null,this.name=e,t&&(this.serializer=new(getSerializer("schema")),this.rootSchema=t,this.serializer.state=new t),this.onError(((e,t)=>console.warn?.(`colyseus.js - onError => (${e}) ${t}`))),this.onLeave((()=>this.removeAllListeners()))}get id(){return this.roomId}connect(e,t,n=this){const r=new Connection;n.connection=r,r.events.onmessage=Room.prototype.onMessageCallback.bind(n),r.events.onclose=function(e){if(!n.hasJoined)return console.warn?.(`Room connection was closed unexpectedly (${e.code}): ${e.reason}`),void n.onError.invoke(e.code,e.reason);e.code===CloseCode.DEVMODE_RESTART&&t?t():(n.onLeave.invoke(e.code,e.reason),n.destroy())},r.events.onerror=function(e){console.warn?.(`Room, onError (${e.code}): ${e.reason}`),n.onError.invoke(e.code,e.reason)},r.connect(e)}leave(e=!0){return new Promise((t=>{this.onLeave((e=>t(e))),this.connection?e?this.connection.send([Protocol.LEAVE_ROOM]):this.connection.close():this.onLeave.invoke(CloseCode.CONSENTED)}))}onMessage(e,t){return this.onMessageHandlers.on(this.getMessageHandlerKey(e),t)}send(e,t){const n=[Protocol.ROOM_DATA];let r;if("string"==typeof e?encode$1.string(n,e):encode$1.number(n,e),void 0!==t){const e=encode$2(t);r=new Uint8Array(n.length+e.byteLength),r.set(new Uint8Array(n),0),r.set(new Uint8Array(e),n.length)}else r=new Uint8Array(n);this.connection.send(r.buffer)}sendBytes(e,t){const n=[Protocol.ROOM_DATA_BYTES];let r;"string"==typeof e?encode$1.string(n,e):encode$1.number(n,e),r=new Uint8Array(n.length+(t.byteLength||t.length)),r.set(new Uint8Array(n),0),r.set(new Uint8Array(t),n.length),this.connection.send(r.buffer)}get state(){return this.serializer.getState()}removeAllListeners(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={}}onMessageCallback(e){const t=Array.from(new Uint8Array(e.data)),n=t[0];if(n===Protocol.JOIN_ROOM){let e=1;const n=utf8Read$1(t,e);if(e+=utf8Length$1(n),this.serializerId=utf8Read$1(t,e),e+=utf8Length$1(this.serializerId),!this.serializer){const e=getSerializer(this.serializerId);this.serializer=new e}t.length>e&&this.serializer.handshake&&this.serializer.handshake(t,{offset:e}),this.reconnectionToken=`${this.roomId}:${n}`,this.hasJoined=!0,this.onJoin.invoke(),this.connection.send([Protocol.JOIN_ROOM])}else if(n===Protocol.ERROR){const e={offset:1},n=decode$1.number(t,e),r=decode$1.string(t,e);this.onError.invoke(n,r)}else if(n===Protocol.LEAVE_ROOM)this.leave();else if(n===Protocol.ROOM_DATA_SCHEMA){const e={offset:1},n=this.serializer.getState().constructor._context.get(decode$1.number(t,e)),r=new n;r.decode(t,e),this.dispatchMessage(n,r)}else if(n===Protocol.ROOM_STATE)t.shift(),this.setState(t);else if(n===Protocol.ROOM_STATE_PATCH)t.shift(),this.patch(t);else if(n===Protocol.ROOM_DATA){const n={offset:1},r=decode$1.stringCheck(t,n)?decode$1.string(t,n):decode$1.number(t,n),i=t.length>n.offset?decode$2(e.data,n.offset):void 0;this.dispatchMessage(r,i)}else if(n===Protocol.ROOM_DATA_BYTES){const e={offset:1},n=decode$1.stringCheck(t,e)?decode$1.string(t,e):decode$1.number(t,e);this.dispatchMessage(n,new Uint8Array(t.slice(e.offset)))}}setState(e){this.serializer.setState(e),this.onStateChange.invoke(this.serializer.getState())}patch(e){this.serializer.patch(e),this.onStateChange.invoke(this.serializer.getState())}dispatchMessage(e,t){const n=this.getMessageHandlerKey(e);this.onMessageHandlers.events[n]?this.onMessageHandlers.emit(n,t):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",e,t):console.warn?.(`colyseus.js: onMessage() not registered for type '${e}'.`)}destroy(){this.serializer&&this.serializer.teardown()}getMessageHandlerKey(e){switch(typeof e){case"function":return`$${e._typeid}`;case"string":return e;case"number":return`i${e}`;default:throw new Error("invalid message type.")}}}function toError(e,t,n){(n=n||new Error(t.statusMessage)).statusMessage=t.statusMessage,n.statusCode=t.statusCode,n.headers=t.headers,n.data=t.data,e(n)}function send(e,t,n={}){return new Promise(((r,i)=>{let o,a,s="",{redirect:c=!0}=n;n.method=e,t&&t.toJSON&&(t=t.toJSON()),Object.assign(n,"string"==typeof t?parse$2(t):t),n.agent="http:"===n.protocol?globalAgent:void 0,o=request(n,(t=>{if(t.statusCode>300&&c&&t.headers.location)return n.path=resolve$1(n.path,t.headers.location),send(e,n.path.startsWith("/")?n:n.path,n).then(r,i);t.on("data",(e=>{s+=e})),t.on("end",(()=>{if(a=t.headers["content-type"],a&&s&&a.includes("application/json"))try{s=JSON.parse(s,n.reviver)}catch(e){return toError(i,t,e)}t.data=s,t.statusCode>=400?toError(i,t):r(t)}))})),o.on("timeout",o.abort),o.on("error",(e=>{e.timeout=o.aborted,i(e)})),n.body&&(a="object"==typeof n.body&&!Buffer.isBuffer(n.body),a&&o.setHeader("content-type","application/json"),a=a?JSON.stringify(n.body):n.body,o.setHeader("content-length",Buffer.byteLength(a)),o.write(a)),o.end()}))}const get$1=send.bind(send,"GET"),post=send.bind(send,"POST"),patch=send.bind(send,"PATCH"),del=send.bind(send,"DELETE"),put=send.bind(send,"PUT");var httpie=Object.freeze({__proto__:null,send:send,get:get$1,post:post,patch:patch,del:del,put:put});class HTTP{client;authToken;constructor(e){this.client=e}get(e,t={}){return this.request("get",e,t)}post(e,t={}){return this.request("post",e,t)}del(e,t={}){return this.request("del",e,t)}put(e,t={}){return this.request("put",e,t)}request(e,t,n={}){return httpie[e](this.client.getHttpEndpoint(t),this.getOptions(n)).catch((e=>{const t=e.statusCode,n=e.data?.error||e.statusMessage||e.message;if(!t&&!n)throw e;throw new ServerError(t,n)}))}getOptions(e){return this.authToken&&(e.headers||(e.headers={}),e.headers.Authorization=`Bearer ${this.authToken}`),"undefined"!=typeof cc&&cc.sys&&cc.sys.isNative||(e.withCredentials=!0),e}}let storage;function getStorage(){if(!storage)try{storage="undefined"!=typeof cc&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:window.localStorage}catch(e){}return storage||(storage={cache:{},setItem:function(e,t){this.cache[e]=t},getItem:function(e){this.cache[e]},removeItem:function(e){delete this.cache[e]}}),storage}function setItem(e,t){getStorage().setItem(e,t)}function removeItem(e){getStorage().removeItem(e)}function getItem(e,t){const n=getStorage().getItem(e);"undefined"!=typeof Promise&&n instanceof Promise?n.then((e=>t(e))):t(n)}class Auth{http;settings={path:"/auth",key:"colyseus-auth-token"};#e=!1;#t;#n=void 0;#r=createNanoEvents();constructor(e){this.http=e,getItem(this.settings.key,(e=>this.token=e))}set token(e){this.http.authToken=e}get token(){return this.http.authToken}onChange(e){const t=this.#r.on("change",e);return this.#e||(this.#t=new Promise(((e,t)=>{this.getUserData().then((e=>{this.emitChange({...e,token:this.token})})).catch((e=>{this.emitChange({user:null,token:void 0})})).finally((()=>{e()}))}))),this.#e=!0,t}async getUserData(){if(this.token)return(await this.http.get(`${this.settings.path}/userdata`)).data;throw new Error("missing auth.token")}async registerWithEmailAndPassword(e,t,n){const r=(await this.http.post(`${this.settings.path}/register`,{body:{email:e,password:t,options:n}})).data;return this.emitChange(r),r}async signInWithEmailAndPassword(e,t){const n=(await this.http.post(`${this.settings.path}/login`,{body:{email:e,password:t}})).data;return this.emitChange(n),n}async signInAnonymously(e){const t=(await this.http.post(`${this.settings.path}/anonymous`,{body:{options:e}})).data;return this.emitChange(t),t}async sendPasswordResetEmail(e){return(await this.http.post(`${this.settings.path}/forgot-password`,{body:{email:e}})).data}async signInWithProvider(e,t={}){return new Promise(((n,r)=>{const i=t.width||480,o=t.height||768,a=this.token?`?token=${this.token}`:"",s=`Login with ${e[0].toUpperCase()+e.substring(1)}`,c=this.http.client.getHttpEndpoint(`${t.prefix||`${this.settings.path}/provider`}/${e}${a}`),u=screen.width/2-i/2,l=screen.height/2-o/2;this.#n=window.open(c,s,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+i+", height="+o+", top="+l+", left="+u);const f=e=>{void 0===e.data.user&&void 0===e.data.token||(clearInterval(d),this.#n.close(),this.#n=void 0,window.removeEventListener("message",f),void 0!==e.data.error?r(e.data.error):(n(e.data),this.emitChange(e.data)))},d=setInterval((()=>{this.#n&&!this.#n.closed||(this.#n=void 0,r("cancelled"),window.removeEventListener("message",f))}),200);window.addEventListener("message",f)}))}async signOut(){this.emitChange({user:null,token:null})}emitChange(e){void 0!==e.token&&(this.token=e.token,null===e.token?removeItem(this.settings.key):setItem(this.settings.key,e.token)),this.#r.emit("change",e)}}function discordURLBuilder(e){const t=window?.location?.hostname||"localhost",n=e.hostname.split("."),r=!e.hostname.includes("trycloudflare.com")&&!e.hostname.includes("discordsays.com")&&n.length>2?`/${n[0]}`:"";return e.pathname.startsWith("/.proxy")?`${e.protocol}//${t}${r}${e.pathname}${e.search}`:`${e.protocol}//${t}/.proxy/colyseus${r}${e.pathname}${e.search}`}class MatchMakeError extends Error{code;constructor(e,t){super(e),this.code=t,Object.setPrototypeOf(this,MatchMakeError.prototype)}}const DEFAULT_ENDPOINT="undefined"!=typeof window&&void 0!==window?.location?.hostname?`${window.location.protocol.replace("http","ws")}//${window.location.hostname}${window.location.port&&`:${window.location.port}`}`:"ws://127.0.0.1:2567";class Client{http;auth;settings;urlBuilder;constructor(e=DEFAULT_ENDPOINT,t){if("string"==typeof e){const t=e.startsWith("/")?new URL(e,DEFAULT_ENDPOINT):new URL(e),n="https:"===t.protocol||"wss:"===t.protocol,r=Number(t.port||(n?443:80));this.settings={hostname:t.hostname,pathname:t.pathname,port:r,secure:n}}else void 0===e.port&&(e.port=e.secure?443:80),void 0===e.pathname&&(e.pathname=""),this.settings=e;this.settings.pathname.endsWith("/")&&(this.settings.pathname=this.settings.pathname.slice(0,-1)),this.http=new HTTP(this),this.auth=new Auth(this.http),this.urlBuilder=t,!this.urlBuilder&&"undefined"!=typeof window&&window?.location?.hostname?.includes("discordsays.com")&&(this.urlBuilder=discordURLBuilder,console.log("Colyseus SDK: Discord Embedded SDK detected. Using custom URL builder."))}async joinOrCreate(e,t={},n){return await this.createMatchMakeRequest("joinOrCreate",e,t,n)}async create(e,t={},n){return await this.createMatchMakeRequest("create",e,t,n)}async join(e,t={},n){return await this.createMatchMakeRequest("join",e,t,n)}async joinById(e,t={},n){return await this.createMatchMakeRequest("joinById",e,t,n)}async reconnect(e,t){if("string"==typeof e&&"string"==typeof t)throw new Error("DEPRECATED: .reconnect() now only accepts 'reconnectionToken' as argument.\nYou can get this token from previously connected `room.reconnectionToken`");const[n,r]=e.split(":");if(!n||!r)throw new Error("Invalid reconnection token format.\nThe format should be roomId:reconnectionToken");return await this.createMatchMakeRequest("reconnect",n,{reconnectionToken:r},t)}async getAvailableRooms(e=""){return(await this.http.get(`matchmake/${e}`,{headers:{Accept:"application/json"}})).data}async consumeSeatReservation(e,t,n){const r=this.createRoom(e.room.name,t);r.roomId=e.room.roomId,r.sessionId=e.sessionId;const i={sessionId:r.sessionId};e.reconnectionToken&&(i.reconnectionToken=e.reconnectionToken);const o=n||r;return r.connect(this.buildEndpoint(e.room,i),e.devMode&&(async()=>{console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} Re-establishing connection with room id '${r.roomId}'...`);let n=0;const i=async()=>{n++;try{await this.consumeSeatReservation(e,t,o),console.info(`[Colyseus devMode]: ${String.fromCodePoint(9989)} Successfully re-established connection with room '${r.roomId}'`)}catch(e){n<8?(console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} retrying... (${n} out of 8)`),setTimeout(i,2e3)):console.info(`[Colyseus devMode]: ${String.fromCodePoint(10060)} Failed to reconnect. Is your server running? Please check server logs.`)}};setTimeout(i,2e3)}),o),new Promise(((e,t)=>{const n=(e,n)=>t(new ServerError(e,n));o.onError.once(n),o.onJoin.once((()=>{o.onError.remove(n),e(o)}))}))}async createMatchMakeRequest(e,t,n={},r,i){const o=(await this.http.post(`matchmake/${e}/${t}`,{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)})).data;if(o.error)throw new MatchMakeError(o.error,o.code);return"reconnect"===e&&(o.reconnectionToken=n.reconnectionToken),await this.consumeSeatReservation(o,r,i)}createRoom(e,t){return new Room(e,t)}buildEndpoint(e,t={}){const n=[];for(const e in t)t.hasOwnProperty(e)&&n.push(`${e}=${t[e]}`);let r=this.settings.secure?"wss://":"ws://";e.publicAddress?r+=`${e.publicAddress}`:r+=`${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}`;const i=`${r}/${e.processId}/${e.roomId}?${n.join("&")}`;return this.urlBuilder?this.urlBuilder(new URL(i)):i}getHttpEndpoint(e=""){const t=e.startsWith("/")?e:`/${e}`,n=`${this.settings.secure?"https":"http"}://${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}${t}`;return this.urlBuilder?this.urlBuilder(new URL(n)):n}getEndpointPort(){return 80!==this.settings.port&&443!==this.settings.port?`:${this.settings.port}`:""}}class SchemaSerializer{state;setState(e){return this.state.decode(e)}getState(){return this.state}patch(e){return this.state.decode(e)}teardown(){this.state?.$changes?.root.clearRefs()}handshake(e,t){if(this.state){(new Reflection).decode(e,t)}else this.state=Reflection.decode(e,t)}}class NoneSerializer{setState(e){}getState(){return null}patch(e){}teardown(){}handshake(e){}}function mitt(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map((function(e){e(n)})),(r=e.get("*"))&&r.slice().map((function(e){e(t,n)}))}}}registerSerializer("schema",SchemaSerializer),registerSerializer("none",NoneSerializer);var indexMinimal={},minimal$1={},aspromise=asPromise;function asPromise(e,t){for(var n=new Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}var base64$1={};!function(e){var t=base64$1;t.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var n=new Array(64),r=new Array(123),i=0;i<64;)r[n[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;t.encode=function(e,t,r){for(var i,o=null,a=[],s=0,c=0;t<r;){var u=e[t++];switch(c){case 0:a[s++]=n[u>>2],i=(3&u)<<4,c=1;break;case 1:a[s++]=n[i|u>>4],i=(15&u)<<2,c=2;break;case 2:a[s++]=n[i|u>>6],a[s++]=n[63&u],c=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=n[i],a[s++]=61,1===c&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var o="invalid encoding";t.decode=function(e,t,n){for(var i,a=n,s=0,c=0;c<e.length;){var u=e.charCodeAt(c++);if(61===u&&s>1)break;if(void 0===(u=r[u]))throw Error(o);switch(s){case 0:i=u,s=1;break;case 1:t[n++]=i<<2|(48&u)>>4,i=u,s=2;break;case 2:t[n++]=(15&i)<<4|(60&u)>>2,i=u,s=3;break;case 3:t[n++]=(3&i)<<6|u,s=0}}if(1===s)throw Error(o);return n-a},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}();var eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},EventEmitter.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},EventEmitter.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this};var float=factory(factory);function factory(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE),e.readFloatLE=n.bind(null,readUintLE),e.readFloatBE=n.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,i,o){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=r*Math.pow(2,-c))>>>0,i,o+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,i,o+n)}}}function n(e,t,n,r,i){var o=e(r,i+t),a=e(r,i+n),s=2*(a>>31)+1,c=a>>>20&2047,u=4294967296*(1048575&a)+o;return 2047===c?u?NaN:s*(1/0):0===c?5e-324*s*u:s*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0),e.readDoubleLE=n.bind(null,readUintLE,0,4),e.readDoubleBE=n.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function writeUintBE(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8$2={};!function(e){var t=utf8$2;t.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},t.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],a=0;t<n;)(r=e[t++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},t.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}}();var pool_1=pool;function pool(e,t,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){if(n<1||n>i)return e(n);a+n>r&&(o=e(r),a=0);var s=t.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}var longbits=LongBits$2,util$5=minimal$1;function LongBits$2(e,t){this.lo=e>>>0,this.hi=t>>>0}var zero=LongBits$2.zero=new LongBits$2(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits$2.zeroHash="\0\0\0\0\0\0\0\0";LongBits$2.fromNumber=function(e){if(0===e)return zero;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new LongBits$2(n,r)},LongBits$2.from=function(e){if("number"==typeof e)return LongBits$2.fromNumber(e);if(util$5.isString(e)){if(!util$5.Long)return LongBits$2.fromNumber(parseInt(e,10));e=util$5.Long.fromString(e)}return e.low||e.high?new LongBits$2(e.low>>>0,e.high>>>0):zero},LongBits$2.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},LongBits$2.prototype.toLong=function(e){return util$5.Long?new util$5.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var charCodeAt$2=String.prototype.charCodeAt;LongBits$2.fromHash=function(e){return e===zeroHash?zero:new LongBits$2((charCodeAt$2.call(e,0)|charCodeAt$2.call(e,1)<<8|charCodeAt$2.call(e,2)<<16|charCodeAt$2.call(e,3)<<24)>>>0,(charCodeAt$2.call(e,4)|charCodeAt$2.call(e,5)<<8|charCodeAt$2.call(e,6)<<16|charCodeAt$2.call(e,7)<<24)>>>0)},LongBits$2.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits$2.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits$2.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits$2.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10},function(e){var t=minimal$1;function n(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function r(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&n(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}t.asPromise=aspromise,t.base64=base64$1,t.EventEmitter=eventemitter,t.float=float,t.inquire=inquire_1,t.utf8=utf8$2,t.pool=pool_1,t.LongBits=longbits,t.isNode=Boolean(void 0!==commonjsGlobal&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),t.global=t.isNode&&commonjsGlobal||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||commonjsGlobal,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"==typeof e},t.isset=t.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},t.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,n){var r=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(r.lo,r.hi,n):r.toNumber(Boolean(n))},t.merge=n,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=r,t.ProtocolError=r("ProtocolError"),t.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},t.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):t._Buffer_from=t._Buffer_allocUnsafe=null}}();var writer=Writer$1,util$4=minimal$1,BufferWriter$1,LongBits$1=util$4.LongBits,base64=util$4.base64,utf8$1=util$4.utf8;function Op(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function noop$1(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer$1(){this.len=0,this.head=new Op(noop$1,0,0),this.tail=this.head,this.states=null}var create$4=function(){return util$4.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};function writeByte(e,t,n){t[n]=255&e}function writeVarint32(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function writeFixed32(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}Writer$1.create=create$4(),Writer$1.alloc=function(e){return new util$4.Array(e)},util$4.Array!==Array&&(Writer$1.alloc=util$4.pool(Writer$1.alloc,util$4.Array.prototype.subarray)),Writer$1.prototype._push=function(e,t,n){return this.tail=this.tail.next=new Op(e,t,n),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer$1.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer$1.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer$1.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer$1.prototype.uint64=function(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)},Writer$1.prototype.int64=Writer$1.prototype.uint64,Writer$1.prototype.sint64=function(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer$1.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer$1.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32,Writer$1.prototype.fixed64=function(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64,Writer$1.prototype.float=function(e){return this._push(util$4.float.writeFloatLE,4,e)},Writer$1.prototype.double=function(e){return this._push(util$4.float.writeDoubleLE,8,e)};var writeBytes=util$4.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};Writer$1.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(util$4.isString(e)){var n=Writer$1.alloc(t=base64.length(e));base64.decode(e,n,0),e=n}return this.uint32(t)._push(writeBytes,t,e)},Writer$1.prototype.string=function(e){var t=utf8$1.length(e);return t?this.uint32(t)._push(utf8$1.write,t,e):this._push(writeByte,1,0)},Writer$1.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop$1,0,0),this.len=0,this},Writer$1.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$1,0,0),this.len=0),this},Writer$1.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},Writer$1.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},Writer$1._configure=function(e){BufferWriter$1=e,Writer$1.create=create$4(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$3=minimal$1;function BufferWriter(){Writer.call(this)}function writeStringBuffer(e,t,n){e.length<40?util$3.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}BufferWriter._configure=function(){BufferWriter.alloc=util$3._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$3.Buffer&&util$3.Buffer.prototype instanceof Uint8Array&&"set"===util$3.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},BufferWriter.prototype.bytes=function(e){util$3.isString(e)&&(e=util$3._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(BufferWriter.writeBytesBuffer,t,e),this},BufferWriter.prototype.string=function(e){var t=util$3.Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this},BufferWriter._configure();var reader=Reader$1,util$2=minimal$1,BufferReader$1,LongBits=util$2.LongBits,utf8=util$2.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader$1(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")},create$3=function(){return util$2.Buffer?function(e){return(Reader$1.create=function(e){return util$2.Buffer.isBuffer(e)?new BufferReader$1(e):create_array(e)})(e)}:create_array},value;function readLongVarint(){var e=new LongBits(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.create=create$3(),Reader$1.prototype._slice=util$2.Array.prototype.subarray||util$2.Array.prototype.slice,Reader$1.prototype.uint32=(value=4294967295,function(){if(value=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return value;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return value}),Reader$1.prototype.int32=function(){return 0|this.uint32()},Reader$1.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},Reader$1.prototype.bool=function(){return 0!==this.uint32()},Reader$1.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=util$2.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader$1.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=util$2.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader$1.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw indexOutOfRange(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var r=util$2.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)},Reader$1.prototype.string=function(){var e=this.bytes();return utf8.read(e,0,e.length)},Reader$1.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader$1.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader$1._configure=function(e){BufferReader$1=e,Reader$1.create=create$3(),BufferReader$1._configure();var t=util$2.Long?"toLong":"toNumber";util$2.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$1=minimal$1;function BufferReader(e){Reader.call(this,e)}BufferReader._configure=function(){util$1.Buffer&&(BufferReader.prototype._slice=util$1.Buffer.prototype.slice)},BufferReader.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},BufferReader._configure();var rpc={},service=Service,util=minimal$1,exports;function Service(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(t,n,r,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return util.asPromise(e,a,t,n,r,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return a.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof r))try{n=r[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",n,t),o(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},exports=rpc,exports.Service=service;var roots={};!function(e){var t=indexMinimal;function n(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}t.build="minimal",t.Writer=writer,t.BufferWriter=writer_buffer,t.Reader=reader,t.BufferReader=reader_buffer,t.util=minimal$1,t.rpc=rpc,t.roots=roots,t.configure=n,n()}();var minimal=indexMinimal,PBAnimator,PBAnimationState;function createBasePBAnimator(){return{states:[]}}function createBasePBAnimationState(){return{clip:"",playing:void 0,weight:void 0,speed:void 0,loop:void 0,shouldReset:void 0}}!function(e){e.encode=function(e,t=minimal.Writer.create()){for(const n of e.states)PBAnimationState.encode(n,t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBAnimator();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.states.push(PBAnimationState.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBAnimator||(PBAnimator={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.clip&&t.uint32(18).string(e.clip),void 0!==e.playing&&t.uint32(24).bool(e.playing),void 0!==e.weight&&t.uint32(37).float(e.weight),void 0!==e.speed&&t.uint32(45).float(e.speed),void 0!==e.loop&&t.uint32(48).bool(e.loop),void 0!==e.shouldReset&&t.uint32(56).bool(e.shouldReset),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBAnimationState();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 2:if(18!==e)break;i.clip=n.string();continue;case 3:if(24!==e)break;i.playing=n.bool();continue;case 4:if(37!==e)break;i.weight=n.float();continue;case 5:if(45!==e)break;i.speed=n.float();continue;case 6:if(48!==e)break;i.loop=n.bool();continue;case 7:if(56!==e)break;i.shouldReset=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBAnimationState||(PBAnimationState={}));const AnimatorSchema={COMPONENT_ID:1042,serialize(e,t){const n=PBAnimator.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBAnimator.decode(e.buffer(),e.remainingBytes()),create:()=>PBAnimator.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAnimator"}};function createBasePBAudioEvent(){return{state:0,timestamp:0}}var PBAudioEvent;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.state&&t.uint32(8).int32(e.state),0!==e.timestamp&&t.uint32(16).uint32(e.timestamp),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBAudioEvent();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.state=n.int32();continue;case 2:if(16!==e)break;i.timestamp=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBAudioEvent||(PBAudioEvent={}));const AudioEventSchema={COMPONENT_ID:1105,serialize(e,t){const n=PBAudioEvent.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBAudioEvent.decode(e.buffer(),e.remainingBytes()),create:()=>PBAudioEvent.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAudioEvent"}};function createBasePBAudioSource(){return{playing:void 0,volume:void 0,loop:void 0,pitch:void 0,audioClipUrl:"",currentTime:void 0,global:void 0}}var PBAudioSource;!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.playing&&t.uint32(8).bool(e.playing),void 0!==e.volume&&t.uint32(21).float(e.volume),void 0!==e.loop&&t.uint32(24).bool(e.loop),void 0!==e.pitch&&t.uint32(37).float(e.pitch),""!==e.audioClipUrl&&t.uint32(42).string(e.audioClipUrl),void 0!==e.currentTime&&t.uint32(53).float(e.currentTime),void 0!==e.global&&t.uint32(56).bool(e.global),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBAudioSource();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.playing=n.bool();continue;case 2:if(21!==e)break;i.volume=n.float();continue;case 3:if(24!==e)break;i.loop=n.bool();continue;case 4:if(37!==e)break;i.pitch=n.float();continue;case 5:if(42!==e)break;i.audioClipUrl=n.string();continue;case 6:if(53!==e)break;i.currentTime=n.float();continue;case 7:if(56!==e)break;i.global=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBAudioSource||(PBAudioSource={}));const AudioSourceSchema={COMPONENT_ID:1020,serialize(e,t){const n=PBAudioSource.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBAudioSource.decode(e.buffer(),e.remainingBytes()),create:()=>PBAudioSource.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAudioSource"}};function createBasePBAudioStream(){return{playing:void 0,volume:void 0,url:""}}var PBAudioStream;!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.playing&&t.uint32(8).bool(e.playing),void 0!==e.volume&&t.uint32(21).float(e.volume),""!==e.url&&t.uint32(26).string(e.url),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBAudioStream();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.playing=n.bool();continue;case 2:if(21!==e)break;i.volume=n.float();continue;case 3:if(26!==e)break;i.url=n.string();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBAudioStream||(PBAudioStream={}));const AudioStreamSchema={COMPONENT_ID:1021,serialize(e,t){const n=PBAudioStream.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBAudioStream.decode(e.buffer(),e.remainingBytes()),create:()=>PBAudioStream.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAudioStream"}};var AvatarAnchorPointType,PBAvatarAttach;function createBasePBAvatarAttach(){return{avatarId:void 0,anchorPointId:0}}!function(e){e[e.AAPT_POSITION=0]="AAPT_POSITION",e[e.AAPT_NAME_TAG=1]="AAPT_NAME_TAG",e[e.AAPT_HEAD=4]="AAPT_HEAD",e[e.AAPT_NECK=5]="AAPT_NECK",e[e.AAPT_SPINE=6]="AAPT_SPINE",e[e.AAPT_SPINE1=7]="AAPT_SPINE1",e[e.AAPT_SPINE2=8]="AAPT_SPINE2",e[e.AAPT_HIP=9]="AAPT_HIP",e[e.AAPT_LEFT_SHOULDER=10]="AAPT_LEFT_SHOULDER",e[e.AAPT_LEFT_ARM=11]="AAPT_LEFT_ARM",e[e.AAPT_LEFT_FOREARM=12]="AAPT_LEFT_FOREARM",e[e.AAPT_LEFT_HAND=2]="AAPT_LEFT_HAND",e[e.AAPT_LEFT_HAND_INDEX=13]="AAPT_LEFT_HAND_INDEX",e[e.AAPT_RIGHT_SHOULDER=14]="AAPT_RIGHT_SHOULDER",e[e.AAPT_RIGHT_ARM=15]="AAPT_RIGHT_ARM",e[e.AAPT_RIGHT_FOREARM=16]="AAPT_RIGHT_FOREARM",e[e.AAPT_RIGHT_HAND=3]="AAPT_RIGHT_HAND",e[e.AAPT_RIGHT_HAND_INDEX=17]="AAPT_RIGHT_HAND_INDEX",e[e.AAPT_LEFT_UP_LEG=18]="AAPT_LEFT_UP_LEG",e[e.AAPT_LEFT_LEG=19]="AAPT_LEFT_LEG",e[e.AAPT_LEFT_FOOT=20]="AAPT_LEFT_FOOT",e[e.AAPT_LEFT_TOE_BASE=21]="AAPT_LEFT_TOE_BASE",e[e.AAPT_RIGHT_UP_LEG=22]="AAPT_RIGHT_UP_LEG",e[e.AAPT_RIGHT_LEG=23]="AAPT_RIGHT_LEG",e[e.AAPT_RIGHT_FOOT=24]="AAPT_RIGHT_FOOT",e[e.AAPT_RIGHT_TOE_BASE=25]="AAPT_RIGHT_TOE_BASE"}(AvatarAnchorPointType||(AvatarAnchorPointType={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.avatarId&&t.uint32(10).string(e.avatarId),0!==e.anchorPointId&&t.uint32(16).int32(e.anchorPointId),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBAvatarAttach();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.avatarId=n.string();continue;case 2:if(16!==e)break;i.anchorPointId=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBAvatarAttach||(PBAvatarAttach={}));const AvatarAttachSchema={COMPONENT_ID:1073,serialize(e,t){const n=PBAvatarAttach.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBAvatarAttach.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarAttach.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarAttach"}};function createBaseColor3(){return{r:0,g:0,b:0}}var Color3$1,Color4$1,PBAvatarBase;function createBaseColor4(){return{r:0,g:0,b:0,a:0}}function createBasePBAvatarBase(){return{skinColor:void 0,eyesColor:void 0,hairColor:void 0,bodyShapeUrn:"",name:""}}!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.r&&t.uint32(13).float(e.r),0!==e.g&&t.uint32(21).float(e.g),0!==e.b&&t.uint32(29).float(e.b),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseColor3();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.r=n.float();continue;case 2:if(21!==e)break;i.g=n.float();continue;case 3:if(29!==e)break;i.b=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(Color3$1||(Color3$1={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.r&&t.uint32(13).float(e.r),0!==e.g&&t.uint32(21).float(e.g),0!==e.b&&t.uint32(29).float(e.b),0!==e.a&&t.uint32(37).float(e.a),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseColor4();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.r=n.float();continue;case 2:if(21!==e)break;i.g=n.float();continue;case 3:if(29!==e)break;i.b=n.float();continue;case 4:if(37!==e)break;i.a=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(Color4$1||(Color4$1={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.skinColor&&Color3$1.encode(e.skinColor,t.uint32(10).fork()).ldelim(),void 0!==e.eyesColor&&Color3$1.encode(e.eyesColor,t.uint32(18).fork()).ldelim(),void 0!==e.hairColor&&Color3$1.encode(e.hairColor,t.uint32(26).fork()).ldelim(),""!==e.bodyShapeUrn&&t.uint32(34).string(e.bodyShapeUrn),""!==e.name&&t.uint32(42).string(e.name),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBAvatarBase();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.skinColor=Color3$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;i.eyesColor=Color3$1.decode(n,n.uint32());continue;case 3:if(26!==e)break;i.hairColor=Color3$1.decode(n,n.uint32());continue;case 4:if(34!==e)break;i.bodyShapeUrn=n.string();continue;case 5:if(42!==e)break;i.name=n.string();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBAvatarBase||(PBAvatarBase={}));const AvatarBaseSchema={COMPONENT_ID:1087,serialize(e,t){const n=PBAvatarBase.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBAvatarBase.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarBase.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarBase"}};function createBasePBAvatarEmoteCommand(){return{emoteUrn:"",loop:!1,timestamp:0}}var PBAvatarEmoteCommand;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.emoteUrn&&t.uint32(10).string(e.emoteUrn),!0===e.loop&&t.uint32(16).bool(e.loop),0!==e.timestamp&&t.uint32(24).uint32(e.timestamp),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBAvatarEmoteCommand();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.emoteUrn=n.string();continue;case 2:if(16!==e)break;i.loop=n.bool();continue;case 3:if(24!==e)break;i.timestamp=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBAvatarEmoteCommand||(PBAvatarEmoteCommand={}));const AvatarEmoteCommandSchema={COMPONENT_ID:1088,serialize(e,t){const n=PBAvatarEmoteCommand.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBAvatarEmoteCommand.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarEmoteCommand.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarEmoteCommand"}};function createBasePBAvatarEquippedData(){return{wearableUrns:[],emoteUrns:[]}}var PBAvatarEquippedData;!function(e){e.encode=function(e,t=minimal.Writer.create()){for(const n of e.wearableUrns)t.uint32(10).string(n);for(const n of e.emoteUrns)t.uint32(18).string(n);return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBAvatarEquippedData();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.wearableUrns.push(n.string());continue;case 2:if(18!==e)break;i.emoteUrns.push(n.string());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBAvatarEquippedData||(PBAvatarEquippedData={}));const AvatarEquippedDataSchema={COMPONENT_ID:1091,serialize(e,t){const n=PBAvatarEquippedData.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBAvatarEquippedData.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarEquippedData.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarEquippedData"}};function createBasePosition(){return{x:0,y:0,z:0}}var Position,Vector3$1,Vector2$1,Quaternion$1,AvatarModifierType,PBAvatarModifierArea;function createBaseVector3(){return{x:0,y:0,z:0}}function createBaseVector2(){return{x:0,y:0}}function createBaseQuaternion(){return{x:0,y:0,z:0,w:0}}function createBasePBAvatarModifierArea(){return{area:void 0,excludeIds:[],modifiers:[]}}!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.x&&t.uint32(13).float(e.x),0!==e.y&&t.uint32(21).float(e.y),0!==e.z&&t.uint32(29).float(e.z),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePosition();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.x=n.float();continue;case 2:if(21!==e)break;i.y=n.float();continue;case 3:if(29!==e)break;i.z=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(Position||(Position={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.x&&t.uint32(13).float(e.x),0!==e.y&&t.uint32(21).float(e.y),0!==e.z&&t.uint32(29).float(e.z),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseVector3();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.x=n.float();continue;case 2:if(21!==e)break;i.y=n.float();continue;case 3:if(29!==e)break;i.z=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(Vector3$1||(Vector3$1={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.x&&t.uint32(13).float(e.x),0!==e.y&&t.uint32(21).float(e.y),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseVector2();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.x=n.float();continue;case 2:if(21!==e)break;i.y=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(Vector2$1||(Vector2$1={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.x&&t.uint32(13).float(e.x),0!==e.y&&t.uint32(21).float(e.y),0!==e.z&&t.uint32(29).float(e.z),0!==e.w&&t.uint32(37).float(e.w),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseQuaternion();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.x=n.float();continue;case 2:if(21!==e)break;i.y=n.float();continue;case 3:if(29!==e)break;i.z=n.float();continue;case 4:if(37!==e)break;i.w=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(Quaternion$1||(Quaternion$1={})),function(e){e[e.AMT_HIDE_AVATARS=0]="AMT_HIDE_AVATARS",e[e.AMT_DISABLE_PASSPORTS=1]="AMT_DISABLE_PASSPORTS"}(AvatarModifierType||(AvatarModifierType={})),function(e){e.encode=function(e,t=minimal.Writer.create()){void 0!==e.area&&Vector3$1.encode(e.area,t.uint32(10).fork()).ldelim();for(const n of e.excludeIds)t.uint32(18).string(n);t.uint32(26).fork();for(const n of e.modifiers)t.int32(n);return t.ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBAvatarModifierArea();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.area=Vector3$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;i.excludeIds.push(n.string());continue;case 3:if(24===e){i.modifiers.push(n.int32());continue}if(26===e){const e=n.uint32()+n.pos;for(;n.pos<e;)i.modifiers.push(n.int32());continue}}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBAvatarModifierArea||(PBAvatarModifierArea={}));const AvatarModifierAreaSchema={COMPONENT_ID:1070,serialize(e,t){const n=PBAvatarModifierArea.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBAvatarModifierArea.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarModifierArea.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarModifierArea"}};
/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var wasm=null;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Long(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function isLong(e){return!0===(e&&e.__isLong__)}function ctz32(e){var t=Math.clz32(e&-e);return e?31-t:t}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=UINT_CACHE[e])?r:(n=fromBits(e,0,!0),i&&(UINT_CACHE[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=INT_CACHE[e])?r:(n=fromBits(e,e<0?-1:0,!1),i&&(INT_CACHE[e]=n),n)}function fromNumber(e,t){if(isNaN(e))return t?UZERO:ZERO;if(t){if(e<0)return UZERO;if(e>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(e<=-TWO_PWR_63_DBL)return MIN_VALUE;if(e+1>=TWO_PWR_63_DBL)return MAX_VALUE}return e<0?fromNumber(-e,t).neg():fromBits(e%TWO_PWR_32_DBL|0,e/TWO_PWR_32_DBL|0,t)}function fromBits(e,t,n){return new Long(e,t,n)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var pow_dbl=Math.pow;function fromString(e,t,n){if(0===e.length)throw Error("empty string");if("number"==typeof t?(n=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?UZERO:ZERO;if((n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return fromString(e.substring(1),t,n).neg();for(var i=fromNumber(pow_dbl(n,8)),o=ZERO,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+s),n);if(s<8){var u=fromNumber(pow_dbl(n,s));o=o.mul(u).add(fromNumber(c))}else o=(o=o.mul(i)).add(fromNumber(c))}return o.unsigned=t,o}function fromValue(e,t){return"number"==typeof e?fromNumber(e,t):"string"==typeof e?fromString(e,t):fromBits(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}Long.fromString=fromString,Long.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype,PBAvatarShape;function createBasePBAvatarShape(){return{id:"",name:void 0,bodyShape:void 0,skinColor:void 0,hairColor:void 0,eyeColor:void 0,expressionTriggerId:void 0,expressionTriggerTimestamp:void 0,talking:void 0,wearables:[],emotes:[]}}LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(MIN_VALUE)){var t=fromNumber(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=fromNumber(pow_dbl(e,6),this.unsigned),o=this,a="";;){var s=o.div(i),c=(o.sub(s.mul(i)).toInt()>>>0).toString(e);if((o=s).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},LongPrototype.getHighBits=function(){return this.high},LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0},LongPrototype.getLowBits=function(){return this.low},LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0},LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},LongPrototype.isSafeInteger=function(){var e=this.high>>21;return!e||!this.unsigned&&(-1===e&&!(0===this.low&&-2097152===this.high))},LongPrototype.isZero=function(){return 0===this.high&&0===this.low},LongPrototype.eqz=LongPrototype.isZero,LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function(){return this.unsigned||this.high>=0},LongPrototype.isOdd=function(){return!(1&~this.low)},LongPrototype.isEven=function(){return!(1&this.low)},LongPrototype.equals=function(e){return isLong(e)||(e=fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function(e){return!this.eq(e)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.ne=LongPrototype.notEquals,LongPrototype.lessThan=function(e){return this.comp(e)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function(e){return this.comp(e)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.le=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function(e){return this.comp(e)>0},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function(e){return this.comp(e)>=0},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.ge=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function(e){isLong(e)||(e=fromValue(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,c=0,u=0,l=0,f=0;return l+=(f+=i+(65535&e.low))>>>16,u+=(l+=r+s)>>>16,c+=(u+=n+a)>>>16,c+=t+o,fromBits((l&=65535)<<16|(f&=65535),(c&=65535)<<16|(u&=65535),this.unsigned)},LongPrototype.subtract=function(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function(e){if(this.isZero())return this;if(isLong(e)||(e=fromValue(e)),wasm)return fromBits(wasm.mul(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned);if(e.isZero())return this.unsigned?UZERO:ZERO;if(this.eq(MIN_VALUE))return e.isOdd()?MIN_VALUE:ZERO;if(e.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TWO_PWR_24)&&e.lt(TWO_PWR_24))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,c=65535&e.low,u=0,l=0,f=0,d=0;return f+=(d+=i*c)>>>16,l+=(f+=r*c)>>>16,f&=65535,l+=(f+=i*s)>>>16,u+=(l+=n*c)>>>16,l&=65535,u+=(l+=r*s)>>>16,l&=65535,u+=(l+=i*a)>>>16,u+=t*c+n*s+r*a+i*o,fromBits((f&=65535)<<16|(d&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");var t,n,r;if(wasm)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?fromBits((this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?UZERO:ZERO;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return UZERO;if(e.gt(this.shru(1)))return UONE;r=UZERO}else{if(this.eq(MIN_VALUE))return e.eq(ONE)||e.eq(NEG_ONE)?MIN_VALUE:e.eq(MIN_VALUE)?ONE:(t=this.shr(1).div(e).shl(1)).eq(ZERO)?e.isNegative()?ONE:NEG_ONE:(n=this.sub(e.mul(t)),r=t.add(n.div(e)));if(e.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=ZERO}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:pow_dbl(2,i-48),a=fromNumber(t),s=a.mul(e);s.isNegative()||s.gt(n);)s=(a=fromNumber(t-=o,this.unsigned)).mul(e);a.isZero()&&(a=ONE),r=r.add(a),n=n.sub(s)}return r},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function(e){return isLong(e)||(e=fromValue(e)),wasm?fromBits((this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.rem=LongPrototype.modulo,LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},LongPrototype.clz=LongPrototype.countLeadingZeros,LongPrototype.countTrailingZeros=function(){return this.low?ctz32(this.low):ctz32(this.high)+32},LongPrototype.ctz=LongPrototype.countTrailingZeros,LongPrototype.and=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)},LongPrototype.or=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)},LongPrototype.xor=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)},LongPrototype.shiftLeft=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):fromBits(32===e?this.high:this.high>>>e-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.shr_u=LongPrototype.shiftRightUnsigned,LongPrototype.rotateLeft=function(e){var t;return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?fromBits(this.high,this.low,this.unsigned):e<32?(t=32-e,fromBits(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),fromBits(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},LongPrototype.rotl=LongPrototype.rotateLeft,LongPrototype.rotateRight=function(e){var t;return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?fromBits(this.high,this.low,this.unsigned):e<32?(t=32-e,fromBits(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),fromBits(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},LongPrototype.rotr=LongPrototype.rotateRight,LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},LongPrototype.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Long.fromBytes=function(e,t,n){return n?Long.fromBytesLE(e,t):Long.fromBytesBE(e,t)},Long.fromBytesLE=function(e,t){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Long.fromBytesBE=function(e,t){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},"function"==typeof BigInt&&(Long.fromBigInt=function(e,t){return fromBits(Number(BigInt.asIntN(32,e)),Number(BigInt.asIntN(32,e>>BigInt(32))),t)},Long.fromValue=function(e,t){return"bigint"==typeof e?fromBigInt(e,t):fromValue(e,t)},LongPrototype.toBigInt=function(){var e=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|e}),function(e){e.encode=function(e,t=minimal.Writer.create()){""!==e.id&&t.uint32(10).string(e.id),void 0!==e.name&&t.uint32(18).string(e.name),void 0!==e.bodyShape&&t.uint32(26).string(e.bodyShape),void 0!==e.skinColor&&Color3$1.encode(e.skinColor,t.uint32(34).fork()).ldelim(),void 0!==e.hairColor&&Color3$1.encode(e.hairColor,t.uint32(42).fork()).ldelim(),void 0!==e.eyeColor&&Color3$1.encode(e.eyeColor,t.uint32(50).fork()).ldelim(),void 0!==e.expressionTriggerId&&t.uint32(58).string(e.expressionTriggerId),void 0!==e.expressionTriggerTimestamp&&t.uint32(64).int64(e.expressionTriggerTimestamp),void 0!==e.talking&&t.uint32(72).bool(e.talking);for(const n of e.wearables)t.uint32(82).string(n);for(const n of e.emotes)t.uint32(90).string(n);return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBAvatarShape();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.id=n.string();continue;case 2:if(18!==e)break;i.name=n.string();continue;case 3:if(26!==e)break;i.bodyShape=n.string();continue;case 4:if(34!==e)break;i.skinColor=Color3$1.decode(n,n.uint32());continue;case 5:if(42!==e)break;i.hairColor=Color3$1.decode(n,n.uint32());continue;case 6:if(50!==e)break;i.eyeColor=Color3$1.decode(n,n.uint32());continue;case 7:if(58!==e)break;i.expressionTriggerId=n.string();continue;case 8:if(64!==e)break;i.expressionTriggerTimestamp=longToNumber(n.int64());continue;case 9:if(72!==e)break;i.talking=n.bool();continue;case 10:if(82!==e)break;i.wearables.push(n.string());continue;case 11:if(90!==e)break;i.emotes.push(n.string());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBAvatarShape||(PBAvatarShape={}));const tsProtoGlobalThis$2=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw"Unable to locate global object"})();function longToNumber(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new tsProtoGlobalThis$2.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}minimal.util.Long!==Long&&(minimal.util.Long=Long,minimal.configure());const AvatarShapeSchema={COMPONENT_ID:1080,serialize(e,t){const n=PBAvatarShape.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBAvatarShape.decode(e.buffer(),e.remainingBytes()),create:()=>PBAvatarShape.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBAvatarShape"}};var BillboardMode,PBBillboard;function createBasePBBillboard(){return{billboardMode:void 0}}!function(e){e[e.BM_NONE=0]="BM_NONE",e[e.BM_X=1]="BM_X",e[e.BM_Y=2]="BM_Y",e[e.BM_Z=4]="BM_Z",e[e.BM_ALL=7]="BM_ALL"}(BillboardMode||(BillboardMode={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.billboardMode&&t.uint32(8).int32(e.billboardMode),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBBillboard();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.billboardMode=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBBillboard||(PBBillboard={}));const BillboardSchema={COMPONENT_ID:1090,serialize(e,t){const n=PBBillboard.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBBillboard.decode(e.buffer(),e.remainingBytes()),create:()=>PBBillboard.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBBillboard"}};function createBasePBCameraMode(){return{mode:0}}var PBCameraMode;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.mode&&t.uint32(8).int32(e.mode),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBCameraMode();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.mode=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBCameraMode||(PBCameraMode={}));const CameraModeSchema={COMPONENT_ID:1072,serialize(e,t){const n=PBCameraMode.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBCameraMode.decode(e.buffer(),e.remainingBytes()),create:()=>PBCameraMode.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBCameraMode"}};function createBasePBCameraModeArea(){return{area:void 0,mode:0}}var PBCameraModeArea;!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.area&&Vector3$1.encode(e.area,t.uint32(10).fork()).ldelim(),0!==e.mode&&t.uint32(16).int32(e.mode),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBCameraModeArea();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.area=Vector3$1.decode(n,n.uint32());continue;case 2:if(16!==e)break;i.mode=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBCameraModeArea||(PBCameraModeArea={}));const CameraModeAreaSchema={COMPONENT_ID:1071,serialize(e,t){const n=PBCameraModeArea.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBCameraModeArea.decode(e.buffer(),e.remainingBytes()),create:()=>PBCameraModeArea.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBCameraModeArea"}};function createBasePBEngineInfo(){return{frameNumber:0,totalRuntime:0,tickNumber:0}}var PBEngineInfo;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.frameNumber&&t.uint32(8).uint32(e.frameNumber),0!==e.totalRuntime&&t.uint32(21).float(e.totalRuntime),0!==e.tickNumber&&t.uint32(24).uint32(e.tickNumber),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBEngineInfo();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.frameNumber=n.uint32();continue;case 2:if(21!==e)break;i.totalRuntime=n.float();continue;case 3:if(24!==e)break;i.tickNumber=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBEngineInfo||(PBEngineInfo={}));const EngineInfoSchema={COMPONENT_ID:1048,serialize(e,t){const n=PBEngineInfo.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBEngineInfo.decode(e.buffer(),e.remainingBytes()),create:()=>PBEngineInfo.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBEngineInfo"}};function createBasePBGltfContainer(){return{src:"",visibleMeshesCollisionMask:void 0,invisibleMeshesCollisionMask:void 0}}var PBGltfContainer;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.src&&t.uint32(10).string(e.src),void 0!==e.visibleMeshesCollisionMask&&t.uint32(32).uint32(e.visibleMeshesCollisionMask),void 0!==e.invisibleMeshesCollisionMask&&t.uint32(40).uint32(e.invisibleMeshesCollisionMask),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBGltfContainer();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.src=n.string();continue;case 4:if(32!==e)break;i.visibleMeshesCollisionMask=n.uint32();continue;case 5:if(40!==e)break;i.invisibleMeshesCollisionMask=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBGltfContainer||(PBGltfContainer={}));const GltfContainerSchema={COMPONENT_ID:1041,serialize(e,t){const n=PBGltfContainer.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBGltfContainer.decode(e.buffer(),e.remainingBytes()),create:()=>PBGltfContainer.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBGltfContainer"}};function createBasePBGltfContainerLoadingState(){return{currentState:0}}var PBGltfContainerLoadingState;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.currentState&&t.uint32(8).int32(e.currentState),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBGltfContainerLoadingState();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.currentState=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBGltfContainerLoadingState||(PBGltfContainerLoadingState={}));const GltfContainerLoadingStateSchema={COMPONENT_ID:1049,serialize(e,t){const n=PBGltfContainerLoadingState.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBGltfContainerLoadingState.decode(e.buffer(),e.remainingBytes()),create:()=>PBGltfContainerLoadingState.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBGltfContainerLoadingState"}};function createBasePBInputModifier(){return{mode:void 0}}var PBInputModifier,PBInputModifier_StandardInput;function createBasePBInputModifier_StandardInput(){return{disableAll:void 0,disableWalk:void 0,disableJog:void 0,disableRun:void 0,disableJump:void 0,disableEmote:void 0}}!function(e){e.encode=function(e,t=minimal.Writer.create()){if("standard"===e.mode?.$case)PBInputModifier_StandardInput.encode(e.mode.standard,t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBInputModifier();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.mode={$case:"standard",standard:PBInputModifier_StandardInput.decode(n,n.uint32())};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBInputModifier||(PBInputModifier={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.disableAll&&t.uint32(8).bool(e.disableAll),void 0!==e.disableWalk&&t.uint32(16).bool(e.disableWalk),void 0!==e.disableJog&&t.uint32(24).bool(e.disableJog),void 0!==e.disableRun&&t.uint32(32).bool(e.disableRun),void 0!==e.disableJump&&t.uint32(40).bool(e.disableJump),void 0!==e.disableEmote&&t.uint32(48).bool(e.disableEmote),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBInputModifier_StandardInput();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.disableAll=n.bool();continue;case 2:if(16!==e)break;i.disableWalk=n.bool();continue;case 3:if(24!==e)break;i.disableJog=n.bool();continue;case 4:if(32!==e)break;i.disableRun=n.bool();continue;case 5:if(40!==e)break;i.disableJump=n.bool();continue;case 6:if(48!==e)break;i.disableEmote=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBInputModifier_StandardInput||(PBInputModifier_StandardInput={}));const InputModifierSchema={COMPONENT_ID:1078,serialize(e,t){const n=PBInputModifier.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBInputModifier.decode(e.buffer(),e.remainingBytes()),create:()=>PBInputModifier.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBInputModifier"}};function createBasePBMainCamera(){return{virtualCameraEntity:void 0}}var PBMainCamera;!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.virtualCameraEntity&&t.uint32(8).uint32(e.virtualCameraEntity),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMainCamera();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.virtualCameraEntity=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMainCamera||(PBMainCamera={}));const MainCameraSchema={COMPONENT_ID:1075,serialize(e,t){const n=PBMainCamera.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBMainCamera.decode(e.buffer(),e.remainingBytes()),create:()=>PBMainCamera.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBMainCamera"}};var TextureWrapMode,TextureFilterMode,Texture,AvatarTexture,VideoTexture,TextureUnion,MaterialTransparencyMode,PBMaterial,PBMaterial_UnlitMaterial,PBMaterial_PbrMaterial;function createBaseTexture(){return{src:"",wrapMode:void 0,filterMode:void 0,offset:void 0,tiling:void 0}}function createBaseAvatarTexture(){return{userId:"",wrapMode:void 0,filterMode:void 0}}function createBaseVideoTexture(){return{videoPlayerEntity:0,wrapMode:void 0,filterMode:void 0}}function createBaseTextureUnion(){return{tex:void 0}}function createBasePBMaterial(){return{material:void 0}}function createBasePBMaterial_UnlitMaterial(){return{texture:void 0,alphaTest:void 0,castShadows:void 0,diffuseColor:void 0,alphaTexture:void 0}}function createBasePBMaterial_PbrMaterial(){return{texture:void 0,alphaTest:void 0,castShadows:void 0,alphaTexture:void 0,emissiveTexture:void 0,bumpTexture:void 0,albedoColor:void 0,emissiveColor:void 0,reflectivityColor:void 0,transparencyMode:void 0,metallic:void 0,roughness:void 0,specularIntensity:void 0,emissiveIntensity:void 0,directIntensity:void 0}}!function(e){e[e.TWM_REPEAT=0]="TWM_REPEAT",e[e.TWM_CLAMP=1]="TWM_CLAMP",e[e.TWM_MIRROR=2]="TWM_MIRROR"}(TextureWrapMode||(TextureWrapMode={})),function(e){e[e.TFM_POINT=0]="TFM_POINT",e[e.TFM_BILINEAR=1]="TFM_BILINEAR",e[e.TFM_TRILINEAR=2]="TFM_TRILINEAR"}(TextureFilterMode||(TextureFilterMode={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.src&&t.uint32(10).string(e.src),void 0!==e.wrapMode&&t.uint32(16).int32(e.wrapMode),void 0!==e.filterMode&&t.uint32(24).int32(e.filterMode),void 0!==e.offset&&Vector2$1.encode(e.offset,t.uint32(34).fork()).ldelim(),void 0!==e.tiling&&Vector2$1.encode(e.tiling,t.uint32(42).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseTexture();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.src=n.string();continue;case 2:if(16!==e)break;i.wrapMode=n.int32();continue;case 3:if(24!==e)break;i.filterMode=n.int32();continue;case 4:if(34!==e)break;i.offset=Vector2$1.decode(n,n.uint32());continue;case 5:if(42!==e)break;i.tiling=Vector2$1.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(Texture||(Texture={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.userId&&t.uint32(10).string(e.userId),void 0!==e.wrapMode&&t.uint32(16).int32(e.wrapMode),void 0!==e.filterMode&&t.uint32(24).int32(e.filterMode),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseAvatarTexture();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.userId=n.string();continue;case 2:if(16!==e)break;i.wrapMode=n.int32();continue;case 3:if(24!==e)break;i.filterMode=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(AvatarTexture||(AvatarTexture={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.videoPlayerEntity&&t.uint32(8).uint32(e.videoPlayerEntity),void 0!==e.wrapMode&&t.uint32(16).int32(e.wrapMode),void 0!==e.filterMode&&t.uint32(24).int32(e.filterMode),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseVideoTexture();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.videoPlayerEntity=n.uint32();continue;case 2:if(16!==e)break;i.wrapMode=n.int32();continue;case 3:if(24!==e)break;i.filterMode=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(VideoTexture||(VideoTexture={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.tex?.$case){case"texture":Texture.encode(e.tex.texture,t.uint32(10).fork()).ldelim();break;case"avatarTexture":AvatarTexture.encode(e.tex.avatarTexture,t.uint32(18).fork()).ldelim();break;case"videoTexture":VideoTexture.encode(e.tex.videoTexture,t.uint32(26).fork()).ldelim()}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseTextureUnion();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.tex={$case:"texture",texture:Texture.decode(n,n.uint32())};continue;case 2:if(18!==e)break;i.tex={$case:"avatarTexture",avatarTexture:AvatarTexture.decode(n,n.uint32())};continue;case 3:if(26!==e)break;i.tex={$case:"videoTexture",videoTexture:VideoTexture.decode(n,n.uint32())};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(TextureUnion||(TextureUnion={})),function(e){e[e.MTM_OPAQUE=0]="MTM_OPAQUE",e[e.MTM_ALPHA_TEST=1]="MTM_ALPHA_TEST",e[e.MTM_ALPHA_BLEND=2]="MTM_ALPHA_BLEND",e[e.MTM_ALPHA_TEST_AND_ALPHA_BLEND=3]="MTM_ALPHA_TEST_AND_ALPHA_BLEND",e[e.MTM_AUTO=4]="MTM_AUTO"}(MaterialTransparencyMode||(MaterialTransparencyMode={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.material?.$case){case"unlit":PBMaterial_UnlitMaterial.encode(e.material.unlit,t.uint32(10).fork()).ldelim();break;case"pbr":PBMaterial_PbrMaterial.encode(e.material.pbr,t.uint32(18).fork()).ldelim()}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMaterial();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.material={$case:"unlit",unlit:PBMaterial_UnlitMaterial.decode(n,n.uint32())};continue;case 2:if(18!==e)break;i.material={$case:"pbr",pbr:PBMaterial_PbrMaterial.decode(n,n.uint32())};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMaterial||(PBMaterial={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.texture&&TextureUnion.encode(e.texture,t.uint32(10).fork()).ldelim(),void 0!==e.alphaTest&&t.uint32(21).float(e.alphaTest),void 0!==e.castShadows&&t.uint32(24).bool(e.castShadows),void 0!==e.diffuseColor&&Color4$1.encode(e.diffuseColor,t.uint32(34).fork()).ldelim(),void 0!==e.alphaTexture&&TextureUnion.encode(e.alphaTexture,t.uint32(42).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMaterial_UnlitMaterial();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.texture=TextureUnion.decode(n,n.uint32());continue;case 2:if(21!==e)break;i.alphaTest=n.float();continue;case 3:if(24!==e)break;i.castShadows=n.bool();continue;case 4:if(34!==e)break;i.diffuseColor=Color4$1.decode(n,n.uint32());continue;case 5:if(42!==e)break;i.alphaTexture=TextureUnion.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMaterial_UnlitMaterial||(PBMaterial_UnlitMaterial={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.texture&&TextureUnion.encode(e.texture,t.uint32(10).fork()).ldelim(),void 0!==e.alphaTest&&t.uint32(21).float(e.alphaTest),void 0!==e.castShadows&&t.uint32(24).bool(e.castShadows),void 0!==e.alphaTexture&&TextureUnion.encode(e.alphaTexture,t.uint32(34).fork()).ldelim(),void 0!==e.emissiveTexture&&TextureUnion.encode(e.emissiveTexture,t.uint32(42).fork()).ldelim(),void 0!==e.bumpTexture&&TextureUnion.encode(e.bumpTexture,t.uint32(50).fork()).ldelim(),void 0!==e.albedoColor&&Color4$1.encode(e.albedoColor,t.uint32(58).fork()).ldelim(),void 0!==e.emissiveColor&&Color3$1.encode(e.emissiveColor,t.uint32(66).fork()).ldelim(),void 0!==e.reflectivityColor&&Color3$1.encode(e.reflectivityColor,t.uint32(74).fork()).ldelim(),void 0!==e.transparencyMode&&t.uint32(80).int32(e.transparencyMode),void 0!==e.metallic&&t.uint32(93).float(e.metallic),void 0!==e.roughness&&t.uint32(101).float(e.roughness),void 0!==e.specularIntensity&&t.uint32(117).float(e.specularIntensity),void 0!==e.emissiveIntensity&&t.uint32(125).float(e.emissiveIntensity),void 0!==e.directIntensity&&t.uint32(133).float(e.directIntensity),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMaterial_PbrMaterial();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.texture=TextureUnion.decode(n,n.uint32());continue;case 2:if(21!==e)break;i.alphaTest=n.float();continue;case 3:if(24!==e)break;i.castShadows=n.bool();continue;case 4:if(34!==e)break;i.alphaTexture=TextureUnion.decode(n,n.uint32());continue;case 5:if(42!==e)break;i.emissiveTexture=TextureUnion.decode(n,n.uint32());continue;case 6:if(50!==e)break;i.bumpTexture=TextureUnion.decode(n,n.uint32());continue;case 7:if(58!==e)break;i.albedoColor=Color4$1.decode(n,n.uint32());continue;case 8:if(66!==e)break;i.emissiveColor=Color3$1.decode(n,n.uint32());continue;case 9:if(74!==e)break;i.reflectivityColor=Color3$1.decode(n,n.uint32());continue;case 10:if(80!==e)break;i.transparencyMode=n.int32();continue;case 11:if(93!==e)break;i.metallic=n.float();continue;case 12:if(101!==e)break;i.roughness=n.float();continue;case 14:if(117!==e)break;i.specularIntensity=n.float();continue;case 15:if(125!==e)break;i.emissiveIntensity=n.float();continue;case 16:if(133!==e)break;i.directIntensity=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMaterial_PbrMaterial||(PBMaterial_PbrMaterial={}));const MaterialSchema={COMPONENT_ID:1017,serialize(e,t){const n=PBMaterial.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBMaterial.decode(e.buffer(),e.remainingBytes()),create:()=>PBMaterial.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBMaterial"}};var ColliderLayer,PBMeshCollider,PBMeshCollider_BoxMesh,PBMeshCollider_CylinderMesh,PBMeshCollider_PlaneMesh,PBMeshCollider_SphereMesh;function createBasePBMeshCollider(){return{collisionMask:void 0,mesh:void 0}}function createBasePBMeshCollider_BoxMesh(){return{}}function createBasePBMeshCollider_CylinderMesh(){return{radiusTop:void 0,radiusBottom:void 0}}function createBasePBMeshCollider_PlaneMesh(){return{}}function createBasePBMeshCollider_SphereMesh(){return{}}!function(e){e[e.CL_NONE=0]="CL_NONE",e[e.CL_POINTER=1]="CL_POINTER",e[e.CL_PHYSICS=2]="CL_PHYSICS",e[e.CL_RESERVED1=4]="CL_RESERVED1",e[e.CL_RESERVED2=8]="CL_RESERVED2",e[e.CL_RESERVED3=16]="CL_RESERVED3",e[e.CL_RESERVED4=32]="CL_RESERVED4",e[e.CL_RESERVED5=64]="CL_RESERVED5",e[e.CL_RESERVED6=128]="CL_RESERVED6",e[e.CL_CUSTOM1=256]="CL_CUSTOM1",e[e.CL_CUSTOM2=512]="CL_CUSTOM2",e[e.CL_CUSTOM3=1024]="CL_CUSTOM3",e[e.CL_CUSTOM4=2048]="CL_CUSTOM4",e[e.CL_CUSTOM5=4096]="CL_CUSTOM5",e[e.CL_CUSTOM6=8192]="CL_CUSTOM6",e[e.CL_CUSTOM7=16384]="CL_CUSTOM7",e[e.CL_CUSTOM8=32768]="CL_CUSTOM8"}(ColliderLayer||(ColliderLayer={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(void 0!==e.collisionMask&&t.uint32(8).uint32(e.collisionMask),e.mesh?.$case){case"box":PBMeshCollider_BoxMesh.encode(e.mesh.box,t.uint32(18).fork()).ldelim();break;case"sphere":PBMeshCollider_SphereMesh.encode(e.mesh.sphere,t.uint32(26).fork()).ldelim();break;case"cylinder":PBMeshCollider_CylinderMesh.encode(e.mesh.cylinder,t.uint32(34).fork()).ldelim();break;case"plane":PBMeshCollider_PlaneMesh.encode(e.mesh.plane,t.uint32(42).fork()).ldelim()}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMeshCollider();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.collisionMask=n.uint32();continue;case 2:if(18!==e)break;i.mesh={$case:"box",box:PBMeshCollider_BoxMesh.decode(n,n.uint32())};continue;case 3:if(26!==e)break;i.mesh={$case:"sphere",sphere:PBMeshCollider_SphereMesh.decode(n,n.uint32())};continue;case 4:if(34!==e)break;i.mesh={$case:"cylinder",cylinder:PBMeshCollider_CylinderMesh.decode(n,n.uint32())};continue;case 5:if(42!==e)break;i.mesh={$case:"plane",plane:PBMeshCollider_PlaneMesh.decode(n,n.uint32())};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMeshCollider||(PBMeshCollider={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMeshCollider_BoxMesh();for(;n.pos<r;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMeshCollider_BoxMesh||(PBMeshCollider_BoxMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.radiusTop&&t.uint32(13).float(e.radiusTop),void 0!==e.radiusBottom&&t.uint32(21).float(e.radiusBottom),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMeshCollider_CylinderMesh();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.radiusTop=n.float();continue;case 2:if(21!==e)break;i.radiusBottom=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMeshCollider_CylinderMesh||(PBMeshCollider_CylinderMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMeshCollider_PlaneMesh();for(;n.pos<r;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMeshCollider_PlaneMesh||(PBMeshCollider_PlaneMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMeshCollider_SphereMesh();for(;n.pos<r;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMeshCollider_SphereMesh||(PBMeshCollider_SphereMesh={}));const MeshColliderSchema={COMPONENT_ID:1019,serialize(e,t){const n=PBMeshCollider.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBMeshCollider.decode(e.buffer(),e.remainingBytes()),create:()=>PBMeshCollider.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBMeshCollider"}};function createBasePBMeshRenderer(){return{mesh:void 0}}var PBMeshRenderer,PBMeshRenderer_BoxMesh,PBMeshRenderer_CylinderMesh,PBMeshRenderer_PlaneMesh,PBMeshRenderer_SphereMesh;function createBasePBMeshRenderer_BoxMesh(){return{uvs:[]}}function createBasePBMeshRenderer_CylinderMesh(){return{radiusTop:void 0,radiusBottom:void 0}}function createBasePBMeshRenderer_PlaneMesh(){return{uvs:[]}}function createBasePBMeshRenderer_SphereMesh(){return{}}!function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.mesh?.$case){case"box":PBMeshRenderer_BoxMesh.encode(e.mesh.box,t.uint32(10).fork()).ldelim();break;case"sphere":PBMeshRenderer_SphereMesh.encode(e.mesh.sphere,t.uint32(18).fork()).ldelim();break;case"cylinder":PBMeshRenderer_CylinderMesh.encode(e.mesh.cylinder,t.uint32(26).fork()).ldelim();break;case"plane":PBMeshRenderer_PlaneMesh.encode(e.mesh.plane,t.uint32(34).fork()).ldelim()}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMeshRenderer();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.mesh={$case:"box",box:PBMeshRenderer_BoxMesh.decode(n,n.uint32())};continue;case 2:if(18!==e)break;i.mesh={$case:"sphere",sphere:PBMeshRenderer_SphereMesh.decode(n,n.uint32())};continue;case 3:if(26!==e)break;i.mesh={$case:"cylinder",cylinder:PBMeshRenderer_CylinderMesh.decode(n,n.uint32())};continue;case 4:if(34!==e)break;i.mesh={$case:"plane",plane:PBMeshRenderer_PlaneMesh.decode(n,n.uint32())};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMeshRenderer||(PBMeshRenderer={})),function(e){e.encode=function(e,t=minimal.Writer.create()){t.uint32(10).fork();for(const n of e.uvs)t.float(n);return t.ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMeshRenderer_BoxMesh();for(;n.pos<r;){const e=n.uint32();if(e>>>3==1){if(13===e){i.uvs.push(n.float());continue}if(10===e){const e=n.uint32()+n.pos;for(;n.pos<e;)i.uvs.push(n.float());continue}}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMeshRenderer_BoxMesh||(PBMeshRenderer_BoxMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.radiusTop&&t.uint32(13).float(e.radiusTop),void 0!==e.radiusBottom&&t.uint32(21).float(e.radiusBottom),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMeshRenderer_CylinderMesh();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.radiusTop=n.float();continue;case 2:if(21!==e)break;i.radiusBottom=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMeshRenderer_CylinderMesh||(PBMeshRenderer_CylinderMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){t.uint32(10).fork();for(const n of e.uvs)t.float(n);return t.ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMeshRenderer_PlaneMesh();for(;n.pos<r;){const e=n.uint32();if(e>>>3==1){if(13===e){i.uvs.push(n.float());continue}if(10===e){const e=n.uint32()+n.pos;for(;n.pos<e;)i.uvs.push(n.float());continue}}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMeshRenderer_PlaneMesh||(PBMeshRenderer_PlaneMesh={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBMeshRenderer_SphereMesh();for(;n.pos<r;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBMeshRenderer_SphereMesh||(PBMeshRenderer_SphereMesh={}));const MeshRendererSchema={COMPONENT_ID:1018,serialize(e,t){const n=PBMeshRenderer.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBMeshRenderer.decode(e.buffer(),e.remainingBytes()),create:()=>PBMeshRenderer.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBMeshRenderer"}};var NftFrameType,PBNftShape;function createBasePBNftShape(){return{urn:"",style:void 0,color:void 0}}!function(e){e[e.NFT_CLASSIC=0]="NFT_CLASSIC",e[e.NFT_BAROQUE_ORNAMENT=1]="NFT_BAROQUE_ORNAMENT",e[e.NFT_DIAMOND_ORNAMENT=2]="NFT_DIAMOND_ORNAMENT",e[e.NFT_MINIMAL_WIDE=3]="NFT_MINIMAL_WIDE",e[e.NFT_MINIMAL_GREY=4]="NFT_MINIMAL_GREY",e[e.NFT_BLOCKY=5]="NFT_BLOCKY",e[e.NFT_GOLD_EDGES=6]="NFT_GOLD_EDGES",e[e.NFT_GOLD_CARVED=7]="NFT_GOLD_CARVED",e[e.NFT_GOLD_WIDE=8]="NFT_GOLD_WIDE",e[e.NFT_GOLD_ROUNDED=9]="NFT_GOLD_ROUNDED",e[e.NFT_METAL_MEDIUM=10]="NFT_METAL_MEDIUM",e[e.NFT_METAL_WIDE=11]="NFT_METAL_WIDE",e[e.NFT_METAL_SLIM=12]="NFT_METAL_SLIM",e[e.NFT_METAL_ROUNDED=13]="NFT_METAL_ROUNDED",e[e.NFT_PINS=14]="NFT_PINS",e[e.NFT_MINIMAL_BLACK=15]="NFT_MINIMAL_BLACK",e[e.NFT_MINIMAL_WHITE=16]="NFT_MINIMAL_WHITE",e[e.NFT_TAPE=17]="NFT_TAPE",e[e.NFT_WOOD_SLIM=18]="NFT_WOOD_SLIM",e[e.NFT_WOOD_WIDE=19]="NFT_WOOD_WIDE",e[e.NFT_WOOD_TWIGS=20]="NFT_WOOD_TWIGS",e[e.NFT_CANVAS=21]="NFT_CANVAS",e[e.NFT_NONE=22]="NFT_NONE"}(NftFrameType||(NftFrameType={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.urn&&t.uint32(10).string(e.urn),void 0!==e.style&&t.uint32(16).int32(e.style),void 0!==e.color&&Color3$1.encode(e.color,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBNftShape();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.urn=n.string();continue;case 2:if(16!==e)break;i.style=n.int32();continue;case 3:if(26!==e)break;i.color=Color3$1.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBNftShape||(PBNftShape={}));const NftShapeSchema={COMPONENT_ID:1040,serialize(e,t){const n=PBNftShape.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBNftShape.decode(e.buffer(),e.remainingBytes()),create:()=>PBNftShape.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBNftShape"}};function createBasePBPlayerIdentityData(){return{address:"",isGuest:!1}}var PBPlayerIdentityData;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.address&&t.uint32(10).string(e.address),!0===e.isGuest&&t.uint32(24).bool(e.isGuest),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBPlayerIdentityData();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.address=n.string();continue;case 3:if(24!==e)break;i.isGuest=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBPlayerIdentityData||(PBPlayerIdentityData={}));const PlayerIdentityDataSchema={COMPONENT_ID:1089,serialize(e,t){const n=PBPlayerIdentityData.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBPlayerIdentityData.decode(e.buffer(),e.remainingBytes()),create:()=>PBPlayerIdentityData.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBPlayerIdentityData"}};function createBasePBPointerEvents(){return{pointerEvents:[]}}var PBPointerEvents,PBPointerEvents_Info,PBPointerEvents_Entry;function createBasePBPointerEvents_Info(){return{button:void 0,hoverText:void 0,maxDistance:void 0,showFeedback:void 0,showHighlight:void 0}}function createBasePBPointerEvents_Entry(){return{eventType:0,eventInfo:void 0}}!function(e){e.encode=function(e,t=minimal.Writer.create()){for(const n of e.pointerEvents)PBPointerEvents_Entry.encode(n,t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBPointerEvents();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.pointerEvents.push(PBPointerEvents_Entry.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBPointerEvents||(PBPointerEvents={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.button&&t.uint32(8).int32(e.button),void 0!==e.hoverText&&t.uint32(18).string(e.hoverText),void 0!==e.maxDistance&&t.uint32(29).float(e.maxDistance),void 0!==e.showFeedback&&t.uint32(32).bool(e.showFeedback),void 0!==e.showHighlight&&t.uint32(40).bool(e.showHighlight),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBPointerEvents_Info();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.button=n.int32();continue;case 2:if(18!==e)break;i.hoverText=n.string();continue;case 3:if(29!==e)break;i.maxDistance=n.float();continue;case 4:if(32!==e)break;i.showFeedback=n.bool();continue;case 5:if(40!==e)break;i.showHighlight=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBPointerEvents_Info||(PBPointerEvents_Info={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.eventType&&t.uint32(8).int32(e.eventType),void 0!==e.eventInfo&&PBPointerEvents_Info.encode(e.eventInfo,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBPointerEvents_Entry();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.eventType=n.int32();continue;case 2:if(18!==e)break;i.eventInfo=PBPointerEvents_Info.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBPointerEvents_Entry||(PBPointerEvents_Entry={}));const PointerEventsSchema={COMPONENT_ID:1062,serialize(e,t){const n=PBPointerEvents.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBPointerEvents.decode(e.buffer(),e.remainingBytes()),create:()=>PBPointerEvents.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBPointerEvents"}};function createBaseRaycastHit(){return{position:void 0,globalOrigin:void 0,direction:void 0,normalHit:void 0,length:0,meshName:void 0,entityId:void 0}}var RaycastHit,PBPointerEventsResult;function createBasePBPointerEventsResult(){return{button:0,hit:void 0,state:0,timestamp:0,analog:void 0,tickNumber:0}}!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.position&&Vector3$1.encode(e.position,t.uint32(10).fork()).ldelim(),void 0!==e.globalOrigin&&Vector3$1.encode(e.globalOrigin,t.uint32(18).fork()).ldelim(),void 0!==e.direction&&Vector3$1.encode(e.direction,t.uint32(26).fork()).ldelim(),void 0!==e.normalHit&&Vector3$1.encode(e.normalHit,t.uint32(34).fork()).ldelim(),0!==e.length&&t.uint32(45).float(e.length),void 0!==e.meshName&&t.uint32(50).string(e.meshName),void 0!==e.entityId&&t.uint32(56).uint32(e.entityId),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseRaycastHit();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.position=Vector3$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;i.globalOrigin=Vector3$1.decode(n,n.uint32());continue;case 3:if(26!==e)break;i.direction=Vector3$1.decode(n,n.uint32());continue;case 4:if(34!==e)break;i.normalHit=Vector3$1.decode(n,n.uint32());continue;case 5:if(45!==e)break;i.length=n.float();continue;case 6:if(50!==e)break;i.meshName=n.string();continue;case 7:if(56!==e)break;i.entityId=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(RaycastHit||(RaycastHit={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.button&&t.uint32(8).int32(e.button),void 0!==e.hit&&RaycastHit.encode(e.hit,t.uint32(18).fork()).ldelim(),0!==e.state&&t.uint32(32).int32(e.state),0!==e.timestamp&&t.uint32(40).uint32(e.timestamp),void 0!==e.analog&&t.uint32(53).float(e.analog),0!==e.tickNumber&&t.uint32(56).uint32(e.tickNumber),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBPointerEventsResult();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.button=n.int32();continue;case 2:if(18!==e)break;i.hit=RaycastHit.decode(n,n.uint32());continue;case 4:if(32!==e)break;i.state=n.int32();continue;case 5:if(40!==e)break;i.timestamp=n.uint32();continue;case 6:if(53!==e)break;i.analog=n.float();continue;case 7:if(56!==e)break;i.tickNumber=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBPointerEventsResult||(PBPointerEventsResult={}));const PointerEventsResultSchema={COMPONENT_ID:1063,serialize(e,t){const n=PBPointerEventsResult.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBPointerEventsResult.decode(e.buffer(),e.remainingBytes()),create:()=>PBPointerEventsResult.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBPointerEventsResult"}};function createBasePBPointerLock(){return{isPointerLocked:!1}}var PBPointerLock;!function(e){e.encode=function(e,t=minimal.Writer.create()){return!0===e.isPointerLocked&&t.uint32(8).bool(e.isPointerLocked),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBPointerLock();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.isPointerLocked=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBPointerLock||(PBPointerLock={}));const PointerLockSchema={COMPONENT_ID:1074,serialize(e,t){const n=PBPointerLock.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBPointerLock.decode(e.buffer(),e.remainingBytes()),create:()=>PBPointerLock.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBPointerLock"}};var RaycastQueryType,PBRaycast;function createBasePBRaycast(){return{timestamp:void 0,originOffset:void 0,direction:void 0,maxDistance:0,queryType:0,continuous:void 0,collisionMask:void 0}}!function(e){e[e.RQT_HIT_FIRST=0]="RQT_HIT_FIRST",e[e.RQT_QUERY_ALL=1]="RQT_QUERY_ALL",e[e.RQT_NONE=2]="RQT_NONE"}(RaycastQueryType||(RaycastQueryType={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(void 0!==e.timestamp&&t.uint32(8).uint32(e.timestamp),void 0!==e.originOffset&&Vector3$1.encode(e.originOffset,t.uint32(18).fork()).ldelim(),e.direction?.$case){case"localDirection":Vector3$1.encode(e.direction.localDirection,t.uint32(50).fork()).ldelim();break;case"globalDirection":Vector3$1.encode(e.direction.globalDirection,t.uint32(26).fork()).ldelim();break;case"globalTarget":Vector3$1.encode(e.direction.globalTarget,t.uint32(58).fork()).ldelim();break;case"targetEntity":t.uint32(80).uint32(e.direction.targetEntity)}return 0!==e.maxDistance&&t.uint32(37).float(e.maxDistance),0!==e.queryType&&t.uint32(40).int32(e.queryType),void 0!==e.continuous&&t.uint32(64).bool(e.continuous),void 0!==e.collisionMask&&t.uint32(72).uint32(e.collisionMask),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBRaycast();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.timestamp=n.uint32();continue;case 2:if(18!==e)break;i.originOffset=Vector3$1.decode(n,n.uint32());continue;case 6:if(50!==e)break;i.direction={$case:"localDirection",localDirection:Vector3$1.decode(n,n.uint32())};continue;case 3:if(26!==e)break;i.direction={$case:"globalDirection",globalDirection:Vector3$1.decode(n,n.uint32())};continue;case 7:if(58!==e)break;i.direction={$case:"globalTarget",globalTarget:Vector3$1.decode(n,n.uint32())};continue;case 10:if(80!==e)break;i.direction={$case:"targetEntity",targetEntity:n.uint32()};continue;case 4:if(37!==e)break;i.maxDistance=n.float();continue;case 5:if(40!==e)break;i.queryType=n.int32();continue;case 8:if(64!==e)break;i.continuous=n.bool();continue;case 9:if(72!==e)break;i.collisionMask=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBRaycast||(PBRaycast={}));const RaycastSchema={COMPONENT_ID:1067,serialize(e,t){const n=PBRaycast.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBRaycast.decode(e.buffer(),e.remainingBytes()),create:()=>PBRaycast.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBRaycast"}};function createBasePBRaycastResult(){return{timestamp:void 0,globalOrigin:void 0,direction:void 0,hits:[],tickNumber:0}}var PBRaycastResult;!function(e){e.encode=function(e,t=minimal.Writer.create()){void 0!==e.timestamp&&t.uint32(8).uint32(e.timestamp),void 0!==e.globalOrigin&&Vector3$1.encode(e.globalOrigin,t.uint32(18).fork()).ldelim(),void 0!==e.direction&&Vector3$1.encode(e.direction,t.uint32(26).fork()).ldelim();for(const n of e.hits)RaycastHit.encode(n,t.uint32(34).fork()).ldelim();return 0!==e.tickNumber&&t.uint32(40).uint32(e.tickNumber),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBRaycastResult();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.timestamp=n.uint32();continue;case 2:if(18!==e)break;i.globalOrigin=Vector3$1.decode(n,n.uint32());continue;case 3:if(26!==e)break;i.direction=Vector3$1.decode(n,n.uint32());continue;case 4:if(34!==e)break;i.hits.push(RaycastHit.decode(n,n.uint32()));continue;case 5:if(40!==e)break;i.tickNumber=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBRaycastResult||(PBRaycastResult={}));const RaycastResultSchema={COMPONENT_ID:1068,serialize(e,t){const n=PBRaycastResult.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBRaycastResult.decode(e.buffer(),e.remainingBytes()),create:()=>PBRaycastResult.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBRaycastResult"}};function createBasePBRealmInfo(){return{baseUrl:"",realmName:"",networkId:0,commsAdapter:"",isPreview:!1,room:void 0,isConnectedSceneRoom:void 0}}var PBRealmInfo;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.baseUrl&&t.uint32(10).string(e.baseUrl),""!==e.realmName&&t.uint32(18).string(e.realmName),0!==e.networkId&&t.uint32(24).int32(e.networkId),""!==e.commsAdapter&&t.uint32(34).string(e.commsAdapter),!0===e.isPreview&&t.uint32(40).bool(e.isPreview),void 0!==e.room&&t.uint32(50).string(e.room),void 0!==e.isConnectedSceneRoom&&t.uint32(56).bool(e.isConnectedSceneRoom),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBRealmInfo();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.baseUrl=n.string();continue;case 2:if(18!==e)break;i.realmName=n.string();continue;case 3:if(24!==e)break;i.networkId=n.int32();continue;case 4:if(34!==e)break;i.commsAdapter=n.string();continue;case 5:if(40!==e)break;i.isPreview=n.bool();continue;case 6:if(50!==e)break;i.room=n.string();continue;case 7:if(56!==e)break;i.isConnectedSceneRoom=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBRealmInfo||(PBRealmInfo={}));const RealmInfoSchema={COMPONENT_ID:1106,serialize(e,t){const n=PBRealmInfo.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBRealmInfo.decode(e.buffer(),e.remainingBytes()),create:()=>PBRealmInfo.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBRealmInfo"}};function createBasePBTextShape(){return{text:"",font:void 0,fontSize:void 0,fontAutoSize:void 0,textAlign:void 0,width:void 0,height:void 0,paddingTop:void 0,paddingRight:void 0,paddingBottom:void 0,paddingLeft:void 0,lineSpacing:void 0,lineCount:void 0,textWrapping:void 0,shadowBlur:void 0,shadowOffsetX:void 0,shadowOffsetY:void 0,outlineWidth:void 0,shadowColor:void 0,outlineColor:void 0,textColor:void 0}}var PBTextShape;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.text&&t.uint32(10).string(e.text),void 0!==e.font&&t.uint32(16).int32(e.font),void 0!==e.fontSize&&t.uint32(29).float(e.fontSize),void 0!==e.fontAutoSize&&t.uint32(32).bool(e.fontAutoSize),void 0!==e.textAlign&&t.uint32(40).int32(e.textAlign),void 0!==e.width&&t.uint32(53).float(e.width),void 0!==e.height&&t.uint32(61).float(e.height),void 0!==e.paddingTop&&t.uint32(69).float(e.paddingTop),void 0!==e.paddingRight&&t.uint32(77).float(e.paddingRight),void 0!==e.paddingBottom&&t.uint32(85).float(e.paddingBottom),void 0!==e.paddingLeft&&t.uint32(93).float(e.paddingLeft),void 0!==e.lineSpacing&&t.uint32(101).float(e.lineSpacing),void 0!==e.lineCount&&t.uint32(104).int32(e.lineCount),void 0!==e.textWrapping&&t.uint32(112).bool(e.textWrapping),void 0!==e.shadowBlur&&t.uint32(125).float(e.shadowBlur),void 0!==e.shadowOffsetX&&t.uint32(133).float(e.shadowOffsetX),void 0!==e.shadowOffsetY&&t.uint32(141).float(e.shadowOffsetY),void 0!==e.outlineWidth&&t.uint32(149).float(e.outlineWidth),void 0!==e.shadowColor&&Color3$1.encode(e.shadowColor,t.uint32(154).fork()).ldelim(),void 0!==e.outlineColor&&Color3$1.encode(e.outlineColor,t.uint32(162).fork()).ldelim(),void 0!==e.textColor&&Color4$1.encode(e.textColor,t.uint32(170).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBTextShape();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.text=n.string();continue;case 2:if(16!==e)break;i.font=n.int32();continue;case 3:if(29!==e)break;i.fontSize=n.float();continue;case 4:if(32!==e)break;i.fontAutoSize=n.bool();continue;case 5:if(40!==e)break;i.textAlign=n.int32();continue;case 6:if(53!==e)break;i.width=n.float();continue;case 7:if(61!==e)break;i.height=n.float();continue;case 8:if(69!==e)break;i.paddingTop=n.float();continue;case 9:if(77!==e)break;i.paddingRight=n.float();continue;case 10:if(85!==e)break;i.paddingBottom=n.float();continue;case 11:if(93!==e)break;i.paddingLeft=n.float();continue;case 12:if(101!==e)break;i.lineSpacing=n.float();continue;case 13:if(104!==e)break;i.lineCount=n.int32();continue;case 14:if(112!==e)break;i.textWrapping=n.bool();continue;case 15:if(125!==e)break;i.shadowBlur=n.float();continue;case 16:if(133!==e)break;i.shadowOffsetX=n.float();continue;case 17:if(141!==e)break;i.shadowOffsetY=n.float();continue;case 18:if(149!==e)break;i.outlineWidth=n.float();continue;case 19:if(154!==e)break;i.shadowColor=Color3$1.decode(n,n.uint32());continue;case 20:if(162!==e)break;i.outlineColor=Color3$1.decode(n,n.uint32());continue;case 21:if(170!==e)break;i.textColor=Color4$1.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBTextShape||(PBTextShape={}));const TextShapeSchema={COMPONENT_ID:1030,serialize(e,t){const n=PBTextShape.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBTextShape.decode(e.buffer(),e.remainingBytes()),create:()=>PBTextShape.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBTextShape"}};var TextureMovementType,EasingFunction,PBTween,Move,Rotate,Scale,TextureMove;function createBasePBTween(){return{duration:0,easingFunction:0,mode:void 0,playing:void 0,currentTime:void 0}}function createBaseMove(){return{start:void 0,end:void 0,faceDirection:void 0}}function createBaseRotate(){return{start:void 0,end:void 0}}function createBaseScale(){return{start:void 0,end:void 0}}function createBaseTextureMove(){return{start:void 0,end:void 0,movementType:void 0}}!function(e){e[e.TMT_OFFSET=0]="TMT_OFFSET",e[e.TMT_TILING=1]="TMT_TILING"}(TextureMovementType||(TextureMovementType={})),function(e){e[e.EF_LINEAR=0]="EF_LINEAR",e[e.EF_EASEINQUAD=1]="EF_EASEINQUAD",e[e.EF_EASEOUTQUAD=2]="EF_EASEOUTQUAD",e[e.EF_EASEQUAD=3]="EF_EASEQUAD",e[e.EF_EASEINSINE=4]="EF_EASEINSINE",e[e.EF_EASEOUTSINE=5]="EF_EASEOUTSINE",e[e.EF_EASESINE=6]="EF_EASESINE",e[e.EF_EASEINEXPO=7]="EF_EASEINEXPO",e[e.EF_EASEOUTEXPO=8]="EF_EASEOUTEXPO",e[e.EF_EASEEXPO=9]="EF_EASEEXPO",e[e.EF_EASEINELASTIC=10]="EF_EASEINELASTIC",e[e.EF_EASEOUTELASTIC=11]="EF_EASEOUTELASTIC",e[e.EF_EASEELASTIC=12]="EF_EASEELASTIC",e[e.EF_EASEINBOUNCE=13]="EF_EASEINBOUNCE",e[e.EF_EASEOUTBOUNCE=14]="EF_EASEOUTBOUNCE",e[e.EF_EASEBOUNCE=15]="EF_EASEBOUNCE",e[e.EF_EASEINCUBIC=16]="EF_EASEINCUBIC",e[e.EF_EASEOUTCUBIC=17]="EF_EASEOUTCUBIC",e[e.EF_EASECUBIC=18]="EF_EASECUBIC",e[e.EF_EASEINQUART=19]="EF_EASEINQUART",e[e.EF_EASEOUTQUART=20]="EF_EASEOUTQUART",e[e.EF_EASEQUART=21]="EF_EASEQUART",e[e.EF_EASEINQUINT=22]="EF_EASEINQUINT",e[e.EF_EASEOUTQUINT=23]="EF_EASEOUTQUINT",e[e.EF_EASEQUINT=24]="EF_EASEQUINT",e[e.EF_EASEINCIRC=25]="EF_EASEINCIRC",e[e.EF_EASEOUTCIRC=26]="EF_EASEOUTCIRC",e[e.EF_EASECIRC=27]="EF_EASECIRC",e[e.EF_EASEINBACK=28]="EF_EASEINBACK",e[e.EF_EASEOUTBACK=29]="EF_EASEOUTBACK",e[e.EF_EASEBACK=30]="EF_EASEBACK"}(EasingFunction||(EasingFunction={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(0!==e.duration&&t.uint32(13).float(e.duration),0!==e.easingFunction&&t.uint32(16).int32(e.easingFunction),e.mode?.$case){case"move":Move.encode(e.mode.move,t.uint32(26).fork()).ldelim();break;case"rotate":Rotate.encode(e.mode.rotate,t.uint32(34).fork()).ldelim();break;case"scale":Scale.encode(e.mode.scale,t.uint32(42).fork()).ldelim();break;case"textureMove":TextureMove.encode(e.mode.textureMove,t.uint32(66).fork()).ldelim()}return void 0!==e.playing&&t.uint32(48).bool(e.playing),void 0!==e.currentTime&&t.uint32(61).float(e.currentTime),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBTween();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.duration=n.float();continue;case 2:if(16!==e)break;i.easingFunction=n.int32();continue;case 3:if(26!==e)break;i.mode={$case:"move",move:Move.decode(n,n.uint32())};continue;case 4:if(34!==e)break;i.mode={$case:"rotate",rotate:Rotate.decode(n,n.uint32())};continue;case 5:if(42!==e)break;i.mode={$case:"scale",scale:Scale.decode(n,n.uint32())};continue;case 8:if(66!==e)break;i.mode={$case:"textureMove",textureMove:TextureMove.decode(n,n.uint32())};continue;case 6:if(48!==e)break;i.playing=n.bool();continue;case 7:if(61!==e)break;i.currentTime=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBTween||(PBTween={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.start&&Vector3$1.encode(e.start,t.uint32(10).fork()).ldelim(),void 0!==e.end&&Vector3$1.encode(e.end,t.uint32(18).fork()).ldelim(),void 0!==e.faceDirection&&t.uint32(24).bool(e.faceDirection),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseMove();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.start=Vector3$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;i.end=Vector3$1.decode(n,n.uint32());continue;case 3:if(24!==e)break;i.faceDirection=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(Move||(Move={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.start&&Quaternion$1.encode(e.start,t.uint32(10).fork()).ldelim(),void 0!==e.end&&Quaternion$1.encode(e.end,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseRotate();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.start=Quaternion$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;i.end=Quaternion$1.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(Rotate||(Rotate={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.start&&Vector3$1.encode(e.start,t.uint32(10).fork()).ldelim(),void 0!==e.end&&Vector3$1.encode(e.end,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseScale();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.start=Vector3$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;i.end=Vector3$1.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(Scale||(Scale={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.start&&Vector2$1.encode(e.start,t.uint32(10).fork()).ldelim(),void 0!==e.end&&Vector2$1.encode(e.end,t.uint32(18).fork()).ldelim(),void 0!==e.movementType&&t.uint32(24).int32(e.movementType),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseTextureMove();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.start=Vector2$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;i.end=Vector2$1.decode(n,n.uint32());continue;case 3:if(24!==e)break;i.movementType=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(TextureMove||(TextureMove={}));const TweenSchema={COMPONENT_ID:1102,serialize(e,t){const n=PBTween.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBTween.decode(e.buffer(),e.remainingBytes()),create:()=>PBTween.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBTween"}};var TweenLoop,PBTweenSequence;function createBasePBTweenSequence(){return{sequence:[],loop:void 0}}!function(e){e[e.TL_RESTART=0]="TL_RESTART",e[e.TL_YOYO=1]="TL_YOYO"}(TweenLoop||(TweenLoop={})),function(e){e.encode=function(e,t=minimal.Writer.create()){for(const n of e.sequence)PBTween.encode(n,t.uint32(10).fork()).ldelim();return void 0!==e.loop&&t.uint32(16).int32(e.loop),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBTweenSequence();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.sequence.push(PBTween.decode(n,n.uint32()));continue;case 2:if(16!==e)break;i.loop=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBTweenSequence||(PBTweenSequence={}));const TweenSequenceSchema={COMPONENT_ID:1104,serialize(e,t){const n=PBTweenSequence.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBTweenSequence.decode(e.buffer(),e.remainingBytes()),create:()=>PBTweenSequence.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBTweenSequence"}};var TweenStateStatus,PBTweenState;function createBasePBTweenState(){return{state:0,currentTime:0}}!function(e){e[e.TS_ACTIVE=0]="TS_ACTIVE",e[e.TS_COMPLETED=1]="TS_COMPLETED",e[e.TS_PAUSED=2]="TS_PAUSED"}(TweenStateStatus||(TweenStateStatus={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.state&&t.uint32(8).int32(e.state),0!==e.currentTime&&t.uint32(21).float(e.currentTime),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBTweenState();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.state=n.int32();continue;case 2:if(21!==e)break;i.currentTime=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBTweenState||(PBTweenState={}));const TweenStateSchema={COMPONENT_ID:1103,serialize(e,t){const n=PBTweenState.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBTweenState.decode(e.buffer(),e.remainingBytes()),create:()=>PBTweenState.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBTweenState"}};function createBaseBorderRect(){return{top:0,left:0,right:0,bottom:0}}var BorderRect,Rect,BackgroundTextureMode,PBUiBackground;function createBaseRect(){return{x:0,y:0,width:0,height:0}}function createBasePBUiBackground(){return{color:void 0,texture:void 0,textureMode:0,textureSlices:void 0,uvs:[]}}!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.top&&t.uint32(13).float(e.top),0!==e.left&&t.uint32(21).float(e.left),0!==e.right&&t.uint32(29).float(e.right),0!==e.bottom&&t.uint32(37).float(e.bottom),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseBorderRect();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.top=n.float();continue;case 2:if(21!==e)break;i.left=n.float();continue;case 3:if(29!==e)break;i.right=n.float();continue;case 4:if(37!==e)break;i.bottom=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(BorderRect||(BorderRect={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.x&&t.uint32(13).float(e.x),0!==e.y&&t.uint32(21).float(e.y),0!==e.width&&t.uint32(29).float(e.width),0!==e.height&&t.uint32(37).float(e.height),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseRect();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.x=n.float();continue;case 2:if(21!==e)break;i.y=n.float();continue;case 3:if(29!==e)break;i.width=n.float();continue;case 4:if(37!==e)break;i.height=n.float();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(Rect||(Rect={})),function(e){e[e.NINE_SLICES=0]="NINE_SLICES",e[e.CENTER=1]="CENTER",e[e.STRETCH=2]="STRETCH"}(BackgroundTextureMode||(BackgroundTextureMode={})),function(e){e.encode=function(e,t=minimal.Writer.create()){void 0!==e.color&&Color4$1.encode(e.color,t.uint32(10).fork()).ldelim(),void 0!==e.texture&&TextureUnion.encode(e.texture,t.uint32(18).fork()).ldelim(),0!==e.textureMode&&t.uint32(24).int32(e.textureMode),void 0!==e.textureSlices&&BorderRect.encode(e.textureSlices,t.uint32(34).fork()).ldelim(),t.uint32(42).fork();for(const n of e.uvs)t.float(n);return t.ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBUiBackground();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.color=Color4$1.decode(n,n.uint32());continue;case 2:if(18!==e)break;i.texture=TextureUnion.decode(n,n.uint32());continue;case 3:if(24!==e)break;i.textureMode=n.int32();continue;case 4:if(34!==e)break;i.textureSlices=BorderRect.decode(n,n.uint32());continue;case 5:if(45===e){i.uvs.push(n.float());continue}if(42===e){const e=n.uint32()+n.pos;for(;n.pos<e;)i.uvs.push(n.float());continue}}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBUiBackground||(PBUiBackground={}));const UiBackgroundSchema={COMPONENT_ID:1053,serialize(e,t){const n=PBUiBackground.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBUiBackground.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiBackground.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiBackground"}};function createBasePBUiCanvasInformation(){return{devicePixelRatio:0,width:0,height:0,interactableArea:void 0}}var PBUiCanvasInformation;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.devicePixelRatio&&t.uint32(13).float(e.devicePixelRatio),0!==e.width&&t.uint32(16).int32(e.width),0!==e.height&&t.uint32(24).int32(e.height),void 0!==e.interactableArea&&BorderRect.encode(e.interactableArea,t.uint32(34).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBUiCanvasInformation();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.devicePixelRatio=n.float();continue;case 2:if(16!==e)break;i.width=n.int32();continue;case 3:if(24!==e)break;i.height=n.int32();continue;case 4:if(34!==e)break;i.interactableArea=BorderRect.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBUiCanvasInformation||(PBUiCanvasInformation={}));const UiCanvasInformationSchema={COMPONENT_ID:1054,serialize(e,t){const n=PBUiCanvasInformation.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBUiCanvasInformation.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiCanvasInformation.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiCanvasInformation"}};function createBasePBUiDropdown(){return{acceptEmpty:!1,emptyLabel:void 0,options:[],selectedIndex:void 0,disabled:!1,color:void 0,textAlign:void 0,font:void 0,fontSize:void 0}}var PBUiDropdown;!function(e){e.encode=function(e,t=minimal.Writer.create()){!0===e.acceptEmpty&&t.uint32(8).bool(e.acceptEmpty),void 0!==e.emptyLabel&&t.uint32(18).string(e.emptyLabel);for(const n of e.options)t.uint32(26).string(n);return void 0!==e.selectedIndex&&t.uint32(32).int32(e.selectedIndex),!0===e.disabled&&t.uint32(40).bool(e.disabled),void 0!==e.color&&Color4$1.encode(e.color,t.uint32(50).fork()).ldelim(),void 0!==e.textAlign&&t.uint32(80).int32(e.textAlign),void 0!==e.font&&t.uint32(88).int32(e.font),void 0!==e.fontSize&&t.uint32(96).int32(e.fontSize),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBUiDropdown();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.acceptEmpty=n.bool();continue;case 2:if(18!==e)break;i.emptyLabel=n.string();continue;case 3:if(26!==e)break;i.options.push(n.string());continue;case 4:if(32!==e)break;i.selectedIndex=n.int32();continue;case 5:if(40!==e)break;i.disabled=n.bool();continue;case 6:if(50!==e)break;i.color=Color4$1.decode(n,n.uint32());continue;case 10:if(80!==e)break;i.textAlign=n.int32();continue;case 11:if(88!==e)break;i.font=n.int32();continue;case 12:if(96!==e)break;i.fontSize=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBUiDropdown||(PBUiDropdown={}));const UiDropdownSchema={COMPONENT_ID:1094,serialize(e,t){const n=PBUiDropdown.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBUiDropdown.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiDropdown.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiDropdown"}};function createBasePBUiDropdownResult(){return{value:0}}var PBUiDropdownResult;!function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.value&&t.uint32(8).int32(e.value),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBUiDropdownResult();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.value=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBUiDropdownResult||(PBUiDropdownResult={}));const UiDropdownResultSchema={COMPONENT_ID:1096,serialize(e,t){const n=PBUiDropdownResult.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBUiDropdownResult.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiDropdownResult.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiDropdownResult"}};function createBasePBUiInput(){return{placeholder:"",color:void 0,placeholderColor:void 0,disabled:!1,textAlign:void 0,font:void 0,fontSize:void 0,value:void 0}}var PBUiInput;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.placeholder&&t.uint32(10).string(e.placeholder),void 0!==e.color&&Color4$1.encode(e.color,t.uint32(18).fork()).ldelim(),void 0!==e.placeholderColor&&Color4$1.encode(e.placeholderColor,t.uint32(26).fork()).ldelim(),!0===e.disabled&&t.uint32(32).bool(e.disabled),void 0!==e.textAlign&&t.uint32(80).int32(e.textAlign),void 0!==e.font&&t.uint32(88).int32(e.font),void 0!==e.fontSize&&t.uint32(96).int32(e.fontSize),void 0!==e.value&&t.uint32(106).string(e.value),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBUiInput();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.placeholder=n.string();continue;case 2:if(18!==e)break;i.color=Color4$1.decode(n,n.uint32());continue;case 3:if(26!==e)break;i.placeholderColor=Color4$1.decode(n,n.uint32());continue;case 4:if(32!==e)break;i.disabled=n.bool();continue;case 10:if(80!==e)break;i.textAlign=n.int32();continue;case 11:if(88!==e)break;i.font=n.int32();continue;case 12:if(96!==e)break;i.fontSize=n.int32();continue;case 13:if(106!==e)break;i.value=n.string();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBUiInput||(PBUiInput={}));const UiInputSchema={COMPONENT_ID:1093,serialize(e,t){const n=PBUiInput.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBUiInput.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiInput.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiInput"}};function createBasePBUiInputResult(){return{value:"",isSubmit:void 0}}var PBUiInputResult;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.value&&t.uint32(10).string(e.value),void 0!==e.isSubmit&&t.uint32(16).bool(e.isSubmit),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBUiInputResult();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.value=n.string();continue;case 2:if(16!==e)break;i.isSubmit=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBUiInputResult||(PBUiInputResult={}));const UiInputResultSchema={COMPONENT_ID:1095,serialize(e,t){const n=PBUiInputResult.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBUiInputResult.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiInputResult.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiInputResult"}};var TextWrap,PBUiText;function createBasePBUiText(){return{value:"",color:void 0,textAlign:void 0,font:void 0,fontSize:void 0,textWrap:void 0}}!function(e){e[e.TW_WRAP=0]="TW_WRAP",e[e.TW_NO_WRAP=1]="TW_NO_WRAP"}(TextWrap||(TextWrap={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.value&&t.uint32(10).string(e.value),void 0!==e.color&&Color4$1.encode(e.color,t.uint32(18).fork()).ldelim(),void 0!==e.textAlign&&t.uint32(24).int32(e.textAlign),void 0!==e.font&&t.uint32(32).int32(e.font),void 0!==e.fontSize&&t.uint32(40).int32(e.fontSize),void 0!==e.textWrap&&t.uint32(48).int32(e.textWrap),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBUiText();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.value=n.string();continue;case 2:if(18!==e)break;i.color=Color4$1.decode(n,n.uint32());continue;case 3:if(24!==e)break;i.textAlign=n.int32();continue;case 4:if(32!==e)break;i.font=n.int32();continue;case 5:if(40!==e)break;i.fontSize=n.int32();continue;case 6:if(48!==e)break;i.textWrap=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBUiText||(PBUiText={}));const UiTextSchema={COMPONENT_ID:1052,serialize(e,t){const n=PBUiText.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBUiText.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiText.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiText"}};var YGPositionType,YGAlign,YGUnit,YGFlexDirection,YGWrap,YGJustify,YGOverflow,YGDisplay,YGEdge,PointerFilterMode,PBUiTransform;function createBasePBUiTransform(){return{parent:0,rightOf:0,alignContent:void 0,alignItems:void 0,flexWrap:void 0,flexShrink:void 0,positionType:0,alignSelf:0,flexDirection:0,justifyContent:0,overflow:0,display:0,flexBasisUnit:0,flexBasis:0,flexGrow:0,widthUnit:0,width:0,heightUnit:0,height:0,minWidthUnit:0,minWidth:0,minHeightUnit:0,minHeight:0,maxWidthUnit:0,maxWidth:0,maxHeightUnit:0,maxHeight:0,positionLeftUnit:0,positionLeft:0,positionTopUnit:0,positionTop:0,positionRightUnit:0,positionRight:0,positionBottomUnit:0,positionBottom:0,marginLeftUnit:0,marginLeft:0,marginTopUnit:0,marginTop:0,marginRightUnit:0,marginRight:0,marginBottomUnit:0,marginBottom:0,paddingLeftUnit:0,paddingLeft:0,paddingTopUnit:0,paddingTop:0,paddingRightUnit:0,paddingRight:0,paddingBottomUnit:0,paddingBottom:0,pointerFilter:void 0}}!function(e){e[e.YGPT_RELATIVE=0]="YGPT_RELATIVE",e[e.YGPT_ABSOLUTE=1]="YGPT_ABSOLUTE"}(YGPositionType||(YGPositionType={})),function(e){e[e.YGA_AUTO=0]="YGA_AUTO",e[e.YGA_FLEX_START=1]="YGA_FLEX_START",e[e.YGA_CENTER=2]="YGA_CENTER",e[e.YGA_FLEX_END=3]="YGA_FLEX_END",e[e.YGA_STRETCH=4]="YGA_STRETCH",e[e.YGA_BASELINE=5]="YGA_BASELINE",e[e.YGA_SPACE_BETWEEN=6]="YGA_SPACE_BETWEEN",e[e.YGA_SPACE_AROUND=7]="YGA_SPACE_AROUND"}(YGAlign||(YGAlign={})),function(e){e[e.YGU_UNDEFINED=0]="YGU_UNDEFINED",e[e.YGU_POINT=1]="YGU_POINT",e[e.YGU_PERCENT=2]="YGU_PERCENT",e[e.YGU_AUTO=3]="YGU_AUTO"}(YGUnit||(YGUnit={})),function(e){e[e.YGFD_ROW=0]="YGFD_ROW",e[e.YGFD_COLUMN=1]="YGFD_COLUMN",e[e.YGFD_COLUMN_REVERSE=2]="YGFD_COLUMN_REVERSE",e[e.YGFD_ROW_REVERSE=3]="YGFD_ROW_REVERSE"}(YGFlexDirection||(YGFlexDirection={})),function(e){e[e.YGW_NO_WRAP=0]="YGW_NO_WRAP",e[e.YGW_WRAP=1]="YGW_WRAP",e[e.YGW_WRAP_REVERSE=2]="YGW_WRAP_REVERSE"}(YGWrap||(YGWrap={})),function(e){e[e.YGJ_FLEX_START=0]="YGJ_FLEX_START",e[e.YGJ_CENTER=1]="YGJ_CENTER",e[e.YGJ_FLEX_END=2]="YGJ_FLEX_END",e[e.YGJ_SPACE_BETWEEN=3]="YGJ_SPACE_BETWEEN",e[e.YGJ_SPACE_AROUND=4]="YGJ_SPACE_AROUND",e[e.YGJ_SPACE_EVENLY=5]="YGJ_SPACE_EVENLY"}(YGJustify||(YGJustify={})),function(e){e[e.YGO_VISIBLE=0]="YGO_VISIBLE",e[e.YGO_HIDDEN=1]="YGO_HIDDEN",e[e.YGO_SCROLL=2]="YGO_SCROLL"}(YGOverflow||(YGOverflow={})),function(e){e[e.YGD_FLEX=0]="YGD_FLEX",e[e.YGD_NONE=1]="YGD_NONE"}(YGDisplay||(YGDisplay={})),function(e){e[e.YGE_LEFT=0]="YGE_LEFT",e[e.YGE_TOP=1]="YGE_TOP",e[e.YGE_RIGHT=2]="YGE_RIGHT",e[e.YGE_BOTTOM=3]="YGE_BOTTOM",e[e.YGE_START=4]="YGE_START",e[e.YGE_END=5]="YGE_END",e[e.YGE_HORIZONTAL=6]="YGE_HORIZONTAL",e[e.YGE_VERTICAL=7]="YGE_VERTICAL",e[e.YGE_ALL=8]="YGE_ALL"}(YGEdge||(YGEdge={})),function(e){e[e.PFM_NONE=0]="PFM_NONE",e[e.PFM_BLOCK=1]="PFM_BLOCK"}(PointerFilterMode||(PointerFilterMode={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.parent&&t.uint32(8).int32(e.parent),0!==e.rightOf&&t.uint32(16).int32(e.rightOf),void 0!==e.alignContent&&t.uint32(24).int32(e.alignContent),void 0!==e.alignItems&&t.uint32(32).int32(e.alignItems),void 0!==e.flexWrap&&t.uint32(40).int32(e.flexWrap),void 0!==e.flexShrink&&t.uint32(53).float(e.flexShrink),0!==e.positionType&&t.uint32(56).int32(e.positionType),0!==e.alignSelf&&t.uint32(64).int32(e.alignSelf),0!==e.flexDirection&&t.uint32(72).int32(e.flexDirection),0!==e.justifyContent&&t.uint32(80).int32(e.justifyContent),0!==e.overflow&&t.uint32(88).int32(e.overflow),0!==e.display&&t.uint32(96).int32(e.display),0!==e.flexBasisUnit&&t.uint32(104).int32(e.flexBasisUnit),0!==e.flexBasis&&t.uint32(117).float(e.flexBasis),0!==e.flexGrow&&t.uint32(125).float(e.flexGrow),0!==e.widthUnit&&t.uint32(128).int32(e.widthUnit),0!==e.width&&t.uint32(141).float(e.width),0!==e.heightUnit&&t.uint32(144).int32(e.heightUnit),0!==e.height&&t.uint32(157).float(e.height),0!==e.minWidthUnit&&t.uint32(160).int32(e.minWidthUnit),0!==e.minWidth&&t.uint32(173).float(e.minWidth),0!==e.minHeightUnit&&t.uint32(176).int32(e.minHeightUnit),0!==e.minHeight&&t.uint32(189).float(e.minHeight),0!==e.maxWidthUnit&&t.uint32(192).int32(e.maxWidthUnit),0!==e.maxWidth&&t.uint32(205).float(e.maxWidth),0!==e.maxHeightUnit&&t.uint32(208).int32(e.maxHeightUnit),0!==e.maxHeight&&t.uint32(221).float(e.maxHeight),0!==e.positionLeftUnit&&t.uint32(224).int32(e.positionLeftUnit),0!==e.positionLeft&&t.uint32(237).float(e.positionLeft),0!==e.positionTopUnit&&t.uint32(240).int32(e.positionTopUnit),0!==e.positionTop&&t.uint32(253).float(e.positionTop),0!==e.positionRightUnit&&t.uint32(256).int32(e.positionRightUnit),0!==e.positionRight&&t.uint32(269).float(e.positionRight),0!==e.positionBottomUnit&&t.uint32(272).int32(e.positionBottomUnit),0!==e.positionBottom&&t.uint32(285).float(e.positionBottom),0!==e.marginLeftUnit&&t.uint32(288).int32(e.marginLeftUnit),0!==e.marginLeft&&t.uint32(301).float(e.marginLeft),0!==e.marginTopUnit&&t.uint32(304).int32(e.marginTopUnit),0!==e.marginTop&&t.uint32(317).float(e.marginTop),0!==e.marginRightUnit&&t.uint32(320).int32(e.marginRightUnit),0!==e.marginRight&&t.uint32(333).float(e.marginRight),0!==e.marginBottomUnit&&t.uint32(336).int32(e.marginBottomUnit),0!==e.marginBottom&&t.uint32(349).float(e.marginBottom),0!==e.paddingLeftUnit&&t.uint32(352).int32(e.paddingLeftUnit),0!==e.paddingLeft&&t.uint32(365).float(e.paddingLeft),0!==e.paddingTopUnit&&t.uint32(368).int32(e.paddingTopUnit),0!==e.paddingTop&&t.uint32(381).float(e.paddingTop),0!==e.paddingRightUnit&&t.uint32(384).int32(e.paddingRightUnit),0!==e.paddingRight&&t.uint32(397).float(e.paddingRight),0!==e.paddingBottomUnit&&t.uint32(400).int32(e.paddingBottomUnit),0!==e.paddingBottom&&t.uint32(413).float(e.paddingBottom),void 0!==e.pointerFilter&&t.uint32(416).int32(e.pointerFilter),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBUiTransform();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.parent=n.int32();continue;case 2:if(16!==e)break;i.rightOf=n.int32();continue;case 3:if(24!==e)break;i.alignContent=n.int32();continue;case 4:if(32!==e)break;i.alignItems=n.int32();continue;case 5:if(40!==e)break;i.flexWrap=n.int32();continue;case 6:if(53!==e)break;i.flexShrink=n.float();continue;case 7:if(56!==e)break;i.positionType=n.int32();continue;case 8:if(64!==e)break;i.alignSelf=n.int32();continue;case 9:if(72!==e)break;i.flexDirection=n.int32();continue;case 10:if(80!==e)break;i.justifyContent=n.int32();continue;case 11:if(88!==e)break;i.overflow=n.int32();continue;case 12:if(96!==e)break;i.display=n.int32();continue;case 13:if(104!==e)break;i.flexBasisUnit=n.int32();continue;case 14:if(117!==e)break;i.flexBasis=n.float();continue;case 15:if(125!==e)break;i.flexGrow=n.float();continue;case 16:if(128!==e)break;i.widthUnit=n.int32();continue;case 17:if(141!==e)break;i.width=n.float();continue;case 18:if(144!==e)break;i.heightUnit=n.int32();continue;case 19:if(157!==e)break;i.height=n.float();continue;case 20:if(160!==e)break;i.minWidthUnit=n.int32();continue;case 21:if(173!==e)break;i.minWidth=n.float();continue;case 22:if(176!==e)break;i.minHeightUnit=n.int32();continue;case 23:if(189!==e)break;i.minHeight=n.float();continue;case 24:if(192!==e)break;i.maxWidthUnit=n.int32();continue;case 25:if(205!==e)break;i.maxWidth=n.float();continue;case 26:if(208!==e)break;i.maxHeightUnit=n.int32();continue;case 27:if(221!==e)break;i.maxHeight=n.float();continue;case 28:if(224!==e)break;i.positionLeftUnit=n.int32();continue;case 29:if(237!==e)break;i.positionLeft=n.float();continue;case 30:if(240!==e)break;i.positionTopUnit=n.int32();continue;case 31:if(253!==e)break;i.positionTop=n.float();continue;case 32:if(256!==e)break;i.positionRightUnit=n.int32();continue;case 33:if(269!==e)break;i.positionRight=n.float();continue;case 34:if(272!==e)break;i.positionBottomUnit=n.int32();continue;case 35:if(285!==e)break;i.positionBottom=n.float();continue;case 36:if(288!==e)break;i.marginLeftUnit=n.int32();continue;case 37:if(301!==e)break;i.marginLeft=n.float();continue;case 38:if(304!==e)break;i.marginTopUnit=n.int32();continue;case 39:if(317!==e)break;i.marginTop=n.float();continue;case 40:if(320!==e)break;i.marginRightUnit=n.int32();continue;case 41:if(333!==e)break;i.marginRight=n.float();continue;case 42:if(336!==e)break;i.marginBottomUnit=n.int32();continue;case 43:if(349!==e)break;i.marginBottom=n.float();continue;case 44:if(352!==e)break;i.paddingLeftUnit=n.int32();continue;case 45:if(365!==e)break;i.paddingLeft=n.float();continue;case 46:if(368!==e)break;i.paddingTopUnit=n.int32();continue;case 47:if(381!==e)break;i.paddingTop=n.float();continue;case 48:if(384!==e)break;i.paddingRightUnit=n.int32();continue;case 49:if(397!==e)break;i.paddingRight=n.float();continue;case 50:if(400!==e)break;i.paddingBottomUnit=n.int32();continue;case 51:if(413!==e)break;i.paddingBottom=n.float();continue;case 52:if(416!==e)break;i.pointerFilter=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBUiTransform||(PBUiTransform={}));const UiTransformSchema={COMPONENT_ID:1050,serialize(e,t){const n=PBUiTransform.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBUiTransform.decode(e.buffer(),e.remainingBytes()),create:()=>PBUiTransform.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBUiTransform"}};var VideoState,PBVideoEvent;function createBasePBVideoEvent(){return{timestamp:0,tickNumber:0,currentOffset:0,videoLength:0,state:0}}!function(e){e[e.VS_NONE=0]="VS_NONE",e[e.VS_ERROR=1]="VS_ERROR",e[e.VS_LOADING=2]="VS_LOADING",e[e.VS_READY=3]="VS_READY",e[e.VS_PLAYING=4]="VS_PLAYING",e[e.VS_BUFFERING=5]="VS_BUFFERING",e[e.VS_SEEKING=6]="VS_SEEKING",e[e.VS_PAUSED=7]="VS_PAUSED"}(VideoState||(VideoState={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.timestamp&&t.uint32(8).uint32(e.timestamp),0!==e.tickNumber&&t.uint32(16).uint32(e.tickNumber),0!==e.currentOffset&&t.uint32(29).float(e.currentOffset),0!==e.videoLength&&t.uint32(37).float(e.videoLength),0!==e.state&&t.uint32(40).int32(e.state),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBVideoEvent();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.timestamp=n.uint32();continue;case 2:if(16!==e)break;i.tickNumber=n.uint32();continue;case 3:if(29!==e)break;i.currentOffset=n.float();continue;case 4:if(37!==e)break;i.videoLength=n.float();continue;case 5:if(40!==e)break;i.state=n.int32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBVideoEvent||(PBVideoEvent={}));const VideoEventSchema={COMPONENT_ID:1044,serialize(e,t){const n=PBVideoEvent.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBVideoEvent.decode(e.buffer(),e.remainingBytes()),create:()=>PBVideoEvent.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBVideoEvent"}};function createBasePBVideoPlayer(){return{src:"",playing:void 0,position:void 0,volume:void 0,playbackRate:void 0,loop:void 0}}var PBVideoPlayer;!function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.src&&t.uint32(10).string(e.src),void 0!==e.playing&&t.uint32(16).bool(e.playing),void 0!==e.position&&t.uint32(29).float(e.position),void 0!==e.volume&&t.uint32(37).float(e.volume),void 0!==e.playbackRate&&t.uint32(45).float(e.playbackRate),void 0!==e.loop&&t.uint32(48).bool(e.loop),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBVideoPlayer();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.src=n.string();continue;case 2:if(16!==e)break;i.playing=n.bool();continue;case 3:if(29!==e)break;i.position=n.float();continue;case 4:if(37!==e)break;i.volume=n.float();continue;case 5:if(45!==e)break;i.playbackRate=n.float();continue;case 6:if(48!==e)break;i.loop=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBVideoPlayer||(PBVideoPlayer={}));const VideoPlayerSchema={COMPONENT_ID:1043,serialize(e,t){const n=PBVideoPlayer.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBVideoPlayer.decode(e.buffer(),e.remainingBytes()),create:()=>PBVideoPlayer.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBVideoPlayer"}};function createBaseCameraTransition(){return{transitionMode:void 0}}var CameraTransition,PBVirtualCamera;function createBasePBVirtualCamera(){return{defaultTransition:void 0,lookAtEntity:void 0}}!function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.transitionMode?.$case){case"time":t.uint32(13).float(e.transitionMode.time);break;case"speed":t.uint32(21).float(e.transitionMode.speed)}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseCameraTransition();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(13!==e)break;i.transitionMode={$case:"time",time:n.float()};continue;case 2:if(21!==e)break;i.transitionMode={$case:"speed",speed:n.float()};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(CameraTransition||(CameraTransition={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.defaultTransition&&CameraTransition.encode(e.defaultTransition,t.uint32(10).fork()).ldelim(),void 0!==e.lookAtEntity&&t.uint32(16).uint32(e.lookAtEntity),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBVirtualCamera();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.defaultTransition=CameraTransition.decode(n,n.uint32());continue;case 2:if(16!==e)break;i.lookAtEntity=n.uint32();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBVirtualCamera||(PBVirtualCamera={}));const VirtualCameraSchema={COMPONENT_ID:1076,serialize(e,t){const n=PBVirtualCamera.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBVirtualCamera.decode(e.buffer(),e.remainingBytes()),create:()=>PBVirtualCamera.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBVirtualCamera"}};function createBasePBVisibilityComponent(){return{visible:void 0}}var PBVisibilityComponent;!function(e){e.encode=function(e,t=minimal.Writer.create()){return void 0!==e.visible&&t.uint32(8).bool(e.visible),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBasePBVisibilityComponent();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.visible=n.bool();continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i}}(PBVisibilityComponent||(PBVisibilityComponent={}));const VisibilityComponentSchema={COMPONENT_ID:1081,serialize(e,t){const n=PBVisibilityComponent.encode(e),r=new Uint8Array(n.finish(),0,n.len);t.writeBuffer(r,!1)},deserialize:e=>PBVisibilityComponent.decode(e.buffer(),e.remainingBytes()),create:()=>PBVisibilityComponent.decode(new Uint8Array),jsonSchema:{type:"object",properties:{},serializationType:"protocol-buffer",protocolBuffer:"PBVisibilityComponent"}},Animator=e=>e.defineComponentFromSchema("core::Animator",AnimatorSchema),AudioEvent=e=>e.defineValueSetComponentFromSchema("core::AudioEvent",AudioEventSchema,{timestampFunction:e=>e.timestamp,maxElements:100}),AudioSource=e=>e.defineComponentFromSchema("core::AudioSource",AudioSourceSchema),AudioStream=e=>e.defineComponentFromSchema("core::AudioStream",AudioStreamSchema),AvatarAttach=e=>e.defineComponentFromSchema("core::AvatarAttach",AvatarAttachSchema),AvatarBase=e=>e.defineComponentFromSchema("core::AvatarBase",AvatarBaseSchema),AvatarEmoteCommand=e=>e.defineValueSetComponentFromSchema("core::AvatarEmoteCommand",AvatarEmoteCommandSchema,{timestampFunction:e=>e.timestamp,maxElements:100}),AvatarEquippedData=e=>e.defineComponentFromSchema("core::AvatarEquippedData",AvatarEquippedDataSchema),AvatarModifierArea=e=>e.defineComponentFromSchema("core::AvatarModifierArea",AvatarModifierAreaSchema),AvatarShape=e=>e.defineComponentFromSchema("core::AvatarShape",AvatarShapeSchema),Billboard=e=>e.defineComponentFromSchema("core::Billboard",BillboardSchema),CameraMode=e=>e.defineComponentFromSchema("core::CameraMode",CameraModeSchema),CameraModeArea=e=>e.defineComponentFromSchema("core::CameraModeArea",CameraModeAreaSchema),EngineInfo=e=>e.defineComponentFromSchema("core::EngineInfo",EngineInfoSchema),GltfContainer=e=>e.defineComponentFromSchema("core::GltfContainer",GltfContainerSchema),GltfContainerLoadingState=e=>e.defineComponentFromSchema("core::GltfContainerLoadingState",GltfContainerLoadingStateSchema),InputModifier=e=>e.defineComponentFromSchema("core::InputModifier",InputModifierSchema),MainCamera=e=>e.defineComponentFromSchema("core::MainCamera",MainCameraSchema),Material$2=e=>e.defineComponentFromSchema("core::Material",MaterialSchema),MeshCollider$1=e=>e.defineComponentFromSchema("core::MeshCollider",MeshColliderSchema),MeshRenderer$2=e=>e.defineComponentFromSchema("core::MeshRenderer",MeshRendererSchema),NftShape=e=>e.defineComponentFromSchema("core::NftShape",NftShapeSchema),PlayerIdentityData=e=>e.defineComponentFromSchema("core::PlayerIdentityData",PlayerIdentityDataSchema),PointerEvents=e=>e.defineComponentFromSchema("core::PointerEvents",PointerEventsSchema),PointerEventsResult=e=>e.defineValueSetComponentFromSchema("core::PointerEventsResult",PointerEventsResultSchema,{timestampFunction:e=>e.timestamp,maxElements:100}),PointerLock=e=>e.defineComponentFromSchema("core::PointerLock",PointerLockSchema),Raycast=e=>e.defineComponentFromSchema("core::Raycast",RaycastSchema),RaycastResult=e=>e.defineComponentFromSchema("core::RaycastResult",RaycastResultSchema),RealmInfo=e=>e.defineComponentFromSchema("core::RealmInfo",RealmInfoSchema),TextShape=e=>e.defineComponentFromSchema("core::TextShape",TextShapeSchema),Tween$2=e=>e.defineComponentFromSchema("core::Tween",TweenSchema),TweenSequence$1=e=>e.defineComponentFromSchema("core::TweenSequence",TweenSequenceSchema),TweenState=e=>e.defineComponentFromSchema("core::TweenState",TweenStateSchema),UiBackground=e=>e.defineComponentFromSchema("core::UiBackground",UiBackgroundSchema),UiCanvasInformation=e=>e.defineComponentFromSchema("core::UiCanvasInformation",UiCanvasInformationSchema),UiDropdown=e=>e.defineComponentFromSchema("core::UiDropdown",UiDropdownSchema),UiDropdownResult=e=>e.defineComponentFromSchema("core::UiDropdownResult",UiDropdownResultSchema),UiInput=e=>e.defineComponentFromSchema("core::UiInput",UiInputSchema),UiInputResult=e=>e.defineComponentFromSchema("core::UiInputResult",UiInputResultSchema),UiText=e=>e.defineComponentFromSchema("core::UiText",UiTextSchema),UiTransform=e=>e.defineComponentFromSchema("core::UiTransform",UiTransformSchema),VideoEvent=e=>e.defineValueSetComponentFromSchema("core::VideoEvent",VideoEventSchema,{timestampFunction:e=>e.timestamp,maxElements:100}),VideoPlayer=e=>e.defineComponentFromSchema("core::VideoPlayer",VideoPlayerSchema),VirtualCamera=e=>e.defineComponentFromSchema("core::VirtualCamera",VirtualCameraSchema),VisibilityComponent=e=>e.defineComponentFromSchema("core::VisibilityComponent",VisibilityComponentSchema),componentDefinitionByName={"core::Animator":Animator,"core::AudioEvent":AudioEvent,"core::AudioSource":AudioSource,"core::AudioStream":AudioStream,"core::AvatarAttach":AvatarAttach,"core::AvatarBase":AvatarBase,"core::AvatarEmoteCommand":AvatarEmoteCommand,"core::AvatarEquippedData":AvatarEquippedData,"core::AvatarModifierArea":AvatarModifierArea,"core::AvatarShape":AvatarShape,"core::Billboard":Billboard,"core::CameraMode":CameraMode,"core::CameraModeArea":CameraModeArea,"core::EngineInfo":EngineInfo,"core::GltfContainer":GltfContainer,"core::GltfContainerLoadingState":GltfContainerLoadingState,"core::InputModifier":InputModifier,"core::MainCamera":MainCamera,"core::Material":Material$2,"core::MeshCollider":MeshCollider$1,"core::MeshRenderer":MeshRenderer$2,"core::NftShape":NftShape,"core::PlayerIdentityData":PlayerIdentityData,"core::PointerEvents":PointerEvents,"core::PointerEventsResult":PointerEventsResult,"core::PointerLock":PointerLock,"core::Raycast":Raycast,"core::RaycastResult":RaycastResult,"core::RealmInfo":RealmInfo,"core::TextShape":TextShape,"core::Tween":Tween$2,"core::TweenSequence":TweenSequence$1,"core::TweenState":TweenState,"core::UiBackground":UiBackground,"core::UiCanvasInformation":UiCanvasInformation,"core::UiDropdown":UiDropdown,"core::UiDropdownResult":UiDropdownResult,"core::UiInput":UiInput,"core::UiInputResult":UiInputResult,"core::UiText":UiText,"core::UiTransform":UiTransform,"core::VideoEvent":VideoEvent,"core::VideoPlayer":VideoPlayer,"core::VirtualCamera":VirtualCamera,"core::VisibilityComponent":VisibilityComponent},TextureHelper={Common:e=>({tex:{$case:"texture",texture:e}}),Avatar:e=>({tex:{$case:"avatarTexture",avatarTexture:e}}),Video:e=>({tex:{$case:"videoTexture",videoTexture:e}})};function defineMaterialComponent(e){const t=Material$2(e);return{...t,Texture:TextureHelper,setBasicMaterial(e,n){t.createOrReplace(e,{material:{$case:"unlit",unlit:n}})},setPbrMaterial(e,n){t.createOrReplace(e,{material:{$case:"pbr",pbr:n}})}}}function defineMeshColliderComponent(e){const t=MeshCollider$1(e);function n(e){return Array.isArray(e)?e.map((e=>e)).reduce(((e,t)=>e|t),0):e||void 0}return{...t,setBox(e,r){t.createOrReplace(e,{mesh:{$case:"box",box:{}},collisionMask:n(r)})},setPlane(e,r){t.createOrReplace(e,{mesh:{$case:"plane",plane:{}},collisionMask:n(r)})},setCylinder(e,r,i,o){t.createOrReplace(e,{mesh:{$case:"cylinder",cylinder:{radiusBottom:r,radiusTop:i}},collisionMask:n(o)})},setSphere(e,r){t.createOrReplace(e,{mesh:{$case:"sphere",sphere:{}},collisionMask:n(r)})}}}function defineMeshRendererComponent(e){const t=MeshRenderer$2(e);return{...t,setBox(e,n){t.createOrReplace(e,{mesh:{$case:"box",box:{uvs:n||[]}}})},setPlane(e,n){t.createOrReplace(e,{mesh:{$case:"plane",plane:{uvs:n||[]}}})},setCylinder(e,n,r){t.createOrReplace(e,{mesh:{$case:"cylinder",cylinder:{radiusBottom:n,radiusTop:r}}})},setSphere(e){t.createOrReplace(e,{mesh:{$case:"sphere",sphere:{}}})}}}const TweenHelper={Move:e=>({$case:"move",move:e}),Rotate:e=>({$case:"rotate",rotate:e}),Scale:e=>({$case:"scale",scale:e}),TextureMove:e=>({$case:"textureMove",textureMove:e})};function defineTweenComponent(e){return{...Tween$2(e),Mode:TweenHelper}}const IArray=e=>({serialize(t,n){n.writeUint32(t.length);for(const r of t)e.serialize(r,n)},deserialize(t){const n=[],r=t.readUint32();for(let i=0;i<r;i++)n.push(e.deserialize(t));return n},create:()=>[],jsonSchema:{type:"array",items:e.jsonSchema,serializationType:"array"}}),Bool={serialize(e,t){t.writeInt8(e?1:0)},deserialize:e=>1===e.readInt8(),create:()=>!1,jsonSchema:{type:"boolean",serializationType:"boolean"}},Int64={serialize(e,t){t.writeInt64(BigInt(e))},deserialize:e=>Number(e.readInt64()),create:()=>0,jsonSchema:{type:"integer",serializationType:"int64"}},Int32={serialize(e,t){t.writeInt32(e)},deserialize:e=>e.readInt32(),create:()=>0,jsonSchema:{type:"integer",serializationType:"int32"}},Int16={serialize(e,t){t.writeInt16(e)},deserialize:e=>e.readInt16(),create:()=>0,jsonSchema:{type:"integer",serializationType:"int16"}},Int8={serialize(e,t){t.writeInt8(e)},deserialize:e=>e.readInt8(),create:()=>0,jsonSchema:{type:"integer",serializationType:"int8"}},FlatString={serialize(e,t){t.writeUtf8String(e)},deserialize:e=>e.readUtf8String(),create:()=>"",jsonSchema:{type:"string",serializationType:"utf8-string"}},EcsString=FlatString;function validateMemberValuesAreNumbersAndInRangeInt32(e){const t=-(2**31),n=2**31-1;let r=0,i=0;for(const o in e){if("number"==typeof e[o]){if(e[o]>n||e[o]<t)throw new Error("Enum member values must be numbers within the range of -2147483648 to 2147483647.");r++}i++}if(i!==2*r)throw new Error("All enum member values must be of numeric type.")}function validateMemberValuesAreStrings(e){for(const t in e)if("string"!=typeof e[t])throw new Error("All enum member values must be of string type.")}const IntEnumReflectionType="enum-int",IntEnum=(e,t)=>(validateMemberValuesAreNumbersAndInRangeInt32(e),{serialize(e,t){Int32.serialize(e,t)},deserialize:e=>Int32.deserialize(e),create:()=>t,jsonSchema:{type:"integer",enum:Object.values(e).filter((e=>Number.isInteger(e))),default:t,serializationType:IntEnumReflectionType,enumObject:e}}),StringEnumReflectionType="enum-string",StringEnum=(e,t)=>(validateMemberValuesAreStrings(e),{serialize(e,t){FlatString.serialize(e,t)},deserialize:e=>FlatString.deserialize(e),create:()=>t,jsonSchema:{type:"string",enum:Object.values(e),default:t,serializationType:StringEnumReflectionType,enumObject:e}}),Float32={serialize(e,t){t.writeFloat32(e)},deserialize:e=>e.readFloat32(),create:()=>0,jsonSchema:{type:"number",serializationType:"float32"}},Float64={serialize(e,t){t.writeFloat64(e)},deserialize:e=>e.readFloat64(),create:()=>0,jsonSchema:{type:"number",serializationType:"float64"}},Color3Schema={serialize(e,t){t.writeFloat32(e.r),t.writeFloat32(e.g),t.writeFloat32(e.b)},deserialize:e=>({r:e.readFloat32(),g:e.readFloat32(),b:e.readFloat32()}),create:()=>({r:0,g:0,b:0}),jsonSchema:{type:"object",properties:{r:{type:"number"},g:{type:"number"},b:{type:"number"}},serializationType:"color3"}},Color4Schema={serialize(e,t){t.writeFloat32(e.r),t.writeFloat32(e.g),t.writeFloat32(e.b),t.writeFloat32(e.a)},deserialize:e=>({r:e.readFloat32(),g:e.readFloat32(),b:e.readFloat32(),a:e.readFloat32()}),create:()=>({r:0,g:0,b:0,a:0}),jsonSchema:{type:"object",properties:{r:{type:"number"},g:{type:"number"},b:{type:"number"},a:{type:"number"}},serializationType:"color4"}},EntitySchema={serialize(e,t){t.writeInt32(e)},deserialize:e=>e.readInt32(),create:()=>0,jsonSchema:{type:"integer",serializationType:"entity"}},QuaternionSchema={serialize(e,t){t.writeFloat32(e.x),t.writeFloat32(e.y),t.writeFloat32(e.z),t.writeFloat32(e.w)},deserialize:e=>({x:e.readFloat32(),y:e.readFloat32(),z:e.readFloat32(),w:e.readFloat32()}),create:()=>({x:0,y:0,z:0,w:0}),jsonSchema:{type:"object",properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"},w:{type:"number"}},serializationType:"quaternion"}},Vector3Schema={serialize(e,t){t.writeFloat32(e.x),t.writeFloat32(e.y),t.writeFloat32(e.z)},deserialize:e=>({x:e.readFloat32(),y:e.readFloat32(),z:e.readFloat32()}),create:()=>({x:0,y:0,z:0}),jsonSchema:{type:"object",properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"},w:{type:"number"}},serializationType:"vector3"}},IMap=(e,t)=>{const n=Object.keys(e).reduce(((t,n)=>(t[n]=e[n].jsonSchema,t)),{});return{serialize(t,n){for(const r in e)e[r].serialize(t[r],n)},deserialize(t){const n={};for(const r in e)n[r]=e[r].deserialize(t);return n},create(){const n={};for(const t in e)n[t]=e[t].create();return{...n,...t}},extend:n=>{const r={};for(const t in e)r[t]=e[t].create();return{...r,...t,...n}},jsonSchema:{type:"object",properties:n,serializationType:"map"}}},IOptional=e=>({serialize(t,n){t?(n.writeInt8(1),e.serialize(t,n)):n.writeInt8(0)},deserialize(t){if(t.readInt8())return e.deserialize(t)},create(){},jsonSchema:{type:e.jsonSchema.type,serializationType:"optional",optionalJsonSchema:e.jsonSchema}}),IOneOf=e=>{const t=Object.keys(e),n=t.reduce(((e,t,n)=>(e[t]=n,e)),{}),r=t.reduce(((t,n)=>(t[n]=e[n].jsonSchema,t)),{});return{serialize({$case:t,value:r},i){const o=n[t.toString()]+1;i.writeUint8(o),e[t].serialize(r,i)},deserialize(n){const r=t[n.readInt8()-1];return{$case:r,value:e[r].deserialize(n)}},create:()=>({}),jsonSchema:{type:"object",properties:r,serializationType:"one-of"}}},isSchemaType=(e,t)=>t.includes(e.serializationType),isOneOfJsonSchema=e=>isSchemaType(e,["one-of"]),getUnknownSchema=()=>({type:{type:"object",serializationType:"unknown"},value:void 0}),isCompoundType=e=>isSchemaType(e,["array","map"]),getTypeAndValue=(e,t,n)=>{const r=e[n],i=t[n];if(isOneOfJsonSchema(r)){const e=i;if(!e.$case)return getUnknownSchema();const o=r.properties[e.$case];return isCompoundType(o)&&(t[n]={[e.$case]:e.value}),{type:o,value:e.value}}return{type:r,value:i}},primitiveSchemas={[Bool.jsonSchema.serializationType]:Bool,[EcsString.jsonSchema.serializationType]:EcsString,[Float32.jsonSchema.serializationType]:Float32,[Float64.jsonSchema.serializationType]:Float64,[Int8.jsonSchema.serializationType]:Int8,[Int16.jsonSchema.serializationType]:Int16,[Int32.jsonSchema.serializationType]:Int32,[Int64.jsonSchema.serializationType]:Int64,[Vector3Schema.jsonSchema.serializationType]:Vector3Schema,[QuaternionSchema.jsonSchema.serializationType]:QuaternionSchema,[Color3Schema.jsonSchema.serializationType]:Color3Schema,[Color4Schema.jsonSchema.serializationType]:Color4Schema,[EntitySchema.jsonSchema.serializationType]:EntitySchema};function jsonSchemaToSchema(e){if(primitiveSchemas[e.serializationType])return primitiveSchemas[e.serializationType];if("map"===e.serializationType){const t=e,n={};for(const e in t.properties)n[e]=jsonSchemaToSchema(t.properties[e]);return IMap(n)}if("optional"===e.serializationType){return IOptional(jsonSchemaToSchema(e.optionalJsonSchema))}if("array"===e.serializationType){return IArray(jsonSchemaToSchema(e.items))}if("enum-int"===e.serializationType){const t=e;return IntEnum(t.enumObject,t.default)}if("enum-string"===e.serializationType){const t=e;return StringEnum(t.enumObject,t.default)}if("one-of"===e.serializationType){const t=e,n={};for(const e in t.properties)n[e]=jsonSchemaToSchema(t.properties[e]);return IOneOf(n)}throw new Error(`${e.serializationType} is not supported as reverse schema generation.`)}function mutateValues(e,t,n){if("map"===e.serializationType){const{properties:r}=e,i=t;for(const e in r){const{type:t,value:o}=getTypeAndValue(r,i,e);if("unknown"!==t.serializationType)if(isCompoundType(t))mutateValues(t,o,n);else{const r=n(o,t);r.changed&&(i[e]=r.value)}}}else if("array"===e.serializationType){const{items:r}=e,i=t;for(let e=0,t=i.length;e<t;e++){const{type:t,value:o}=getTypeAndValue({items:r},{items:i[e]},"items");if(isCompoundType(t))mutateValues(t,o,n);else{const r=n(o,t);r.changed&&(i[e]=r.value)}}}}var Schemas;function defineNameComponent(e){return e.defineComponent("core-schema::Name",{value:Schemas.String})}function defineNetworkEntityComponent(e){return e.defineComponent("core-schema::Network-Entity",{networkId:Schemas.Int64,entityId:Schemas.Entity})}function defineNetworkParentComponent(e){return e.defineComponent("core-schema::Network-Parent",{networkId:Schemas.Int64,entityId:Schemas.Entity})}!function(e){e.Boolean=Bool,e.String=EcsString,e.Float=Float32,e.Double=Float64,e.Byte=Int8,e.Short=Int16,e.Int=Int32,e.Int64=Int64,e.Number=Float32,e.Vector3=Vector3Schema,e.Quaternion=QuaternionSchema,e.Color3=Color3Schema,e.Color4=Color4Schema,e.Entity=EntitySchema,e.EnumNumber=IntEnum,e.EnumString=StringEnum,e.Array=IArray,e.Map=IMap,e.Optional=IOptional,e.OneOf=IOneOf,e.fromJson=jsonSchemaToSchema,e.mutateNestedValues=mutateValues}(Schemas||(Schemas={}));const TRANSFORM_LENGTH=44,TransformSchema={serialize(e,t){const n=t.incrementWriteOffset(TRANSFORM_LENGTH);t.setFloat32(n,e.position.x),t.setFloat32(n+4,e.position.y),t.setFloat32(n+8,e.position.z),t.setFloat32(n+12,e.rotation.x),t.setFloat32(n+16,e.rotation.y),t.setFloat32(n+20,e.rotation.z),t.setFloat32(n+24,e.rotation.w),t.setFloat32(n+28,e.scale.x),t.setFloat32(n+32,e.scale.y),t.setFloat32(n+36,e.scale.z),t.setUint32(n+40,e.parent||0)},deserialize(e){const t=e.incrementReadOffset(TRANSFORM_LENGTH);return{position:{x:e.getFloat32(t),y:e.getFloat32(t+4),z:e.getFloat32(t+8)},rotation:{x:e.getFloat32(t+12),y:e.getFloat32(t+16),z:e.getFloat32(t+20),w:e.getFloat32(t+24)},scale:{x:e.getFloat32(t+28),y:e.getFloat32(t+32),z:e.getFloat32(t+36)},parent:e.getUint32(t+40)}},create:()=>({position:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},rotation:{x:0,y:0,z:0,w:1},parent:0}),extend:e=>({position:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},rotation:{x:0,y:0,z:0,w:1},parent:0,...e}),jsonSchema:{type:"object",properties:{position:{type:"object",properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"}}},scale:{type:"object",properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"}}},rotation:{type:"object",properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"},w:{type:"number"}}},parent:{type:"integer"}},serializationType:"transform"}};function defineTransformComponent(e){const t=e.defineComponentFromSchema("core::Transform",TransformSchema);return{...t,create:(e,n)=>t.create(e,TransformSchema.extend(n)),createOrReplace:(e,n)=>t.createOrReplace(e,TransformSchema.extend(n))}}var MediaState;!function(e){e[e.MS_NONE=0]="MS_NONE",e[e.MS_ERROR=1]="MS_ERROR",e[e.MS_LOADING=2]="MS_LOADING",e[e.MS_READY=3]="MS_READY",e[e.MS_PLAYING=4]="MS_PLAYING",e[e.MS_BUFFERING=5]="MS_BUFFERING",e[e.MS_SEEKING=6]="MS_SEEKING",e[e.MS_PAUSED=7]="MS_PAUSED"}(MediaState||(MediaState={}));const Transform$1=e=>defineTransformComponent(e),Material$1=e=>defineMaterialComponent(e),MeshRenderer$1=e=>defineMeshRendererComponent(e),MeshCollider=e=>defineMeshColliderComponent(e),Tween$1=e=>defineTweenComponent(e),Name=e=>defineNameComponent(e),NetworkEntity=e=>defineNetworkEntityComponent(e),NetworkParent=e=>defineNetworkParentComponent(e),coreComponentMappings={"core::Transform":1,"core::Animator":1042,"core::AudioEvent":1105,"core::AudioSource":1020,"core::AudioStream":1021,"core::AvatarAttach":1073,"core::AvatarBase":1087,"core::AvatarEmoteCommand":1088,"core::AvatarEquippedData":1091,"core::AvatarModifierArea":1070,"core::AvatarShape":1080,"core::Billboard":1090,"core::CameraMode":1072,"core::CameraModeArea":1071,"core::EngineInfo":1048,"core::GltfContainer":1041,"core::GltfContainerLoadingState":1049,"core::InputModifier":1078,"core::MainCamera":1075,"core::MapPin":1097,"core::Material":1017,"core::MeshCollider":1019,"core::MeshRenderer":1018,"core::NftShape":1040,"core::PlayerIdentityData":1089,"core::PointerEvents":1062,"core::PointerEventsResult":1063,"core::PointerLock":1074,"core::Raycast":1067,"core::RaycastResult":1068,"core::RealmInfo":1106,"core::TextShape":1030,"core::Tween":1102,"core::TweenSequence":1104,"core::TweenState":1103,"core::UiBackground":1053,"core::UiCanvasInformation":1054,"core::UiDropdown":1094,"core::UiDropdownResult":1096,"core::UiInput":1093,"core::UiInputResult":1095,"core::UiText":1052,"core::UiTransform":1050,"core::VideoEvent":1044,"core::VideoPlayer":1043,"core::VirtualCamera":1076,"core::VisibilityComponent":1081},CRC_TABLE=new Int32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function _crc32(e,t){let n=~t;for(let t=0;t<e.length;t++)n=CRC_TABLE[255&(n^e[t])]^n>>>8;return~n}function unsignedCRC32(e,t=0){return _crc32(e,t)>>>0}const MAX_STATIC_COMPONENT=2048;function componentNumberFromName(e){if(coreComponentMappings[e])return coreComponentMappings[e];const t=new Uint8Array(128);return utf8$2.write(e,t,0),(unsignedCRC32(t)+MAX_STATIC_COMPONENT&4294967295)>>>0}const __DEV__="boolean"==typeof DEBUG&&DEBUG||"object"==typeof process&&("production"!==process.env?.NODE_ENV||"development"===process.env?.NODE_ENV)||!1;function checkNotThenable(e,t){if(__DEV__&&e&&"object"==typeof e&&"function"==typeof e.then)throw new Error(t);return e}function createVersionGSet(){const e=new Map;return{addTo(t,n){if(n<0)return!1;const r=e.get(t);return void 0!==r&&r>=n||e.set(t,n),!0},has(t,n){const r=e.get(t);return void 0!==r&&r>=n},getMap:()=>e}}const MAX_U16=65535,MASK_UPPER_16_ON_32=4294901760,MAX_ENTITY_NUMBER=MAX_U16,RESERVED_STATIC_ENTITIES=512;var EntityUtils,EntityState;function createEntityContainer(e){const t=e?.reservedStaticEntities??RESERVED_STATIC_ENTITIES;let n=t;const r=new Set;let i=[];const o=createVersionGSet();function a(){if(n>MAX_ENTITY_NUMBER-1)throw new Error(`It fails trying to generate an entity out of range ${MAX_ENTITY_NUMBER}.`);const e=n++,t=o.getMap().has(e)?o.getMap().get(e)+1:0,i=EntityUtils.toEntityId(e,t);return r.has(i)?a():(r.add(i),i)}function s(e){const[t,n]=EntityUtils.fromEntityId(e);o.addTo(t,n);for(let e=0;e<=n;e++)r.delete(EntityUtils.toEntityId(t,e));return!0}return{generateEntity:function(){if(r.size+t>=n)return a();for(const[e,t]of o.getMap())if(t<MAX_U16){const n=EntityUtils.toEntityId(e,t+1);if(!r.has(n)&&!i.includes(n))return r.add(n),n}return a()},removeEntity:function(e){return!(e<t)&&(r.has(e)?(r.delete(e),i.push(e)):s(e),!0)},getExistingEntities:()=>new Set(r),getEntityState:function(e){const[n,i]=EntityUtils.fromEntityId(e);if(n<t)return EntityState.Reserved;if(r.has(e))return EntityState.UsedEntity;const a=o.getMap().get(n);return void 0!==a&&a>=i?EntityState.Removed:EntityState.Unknown},releaseRemovedEntities:function(){const e=i;if(e.length){i=[];for(const t of e){const[e,n]=EntityUtils.fromEntityId(t);o.addTo(e,n)}}return e},updateRemovedEntity:s,updateUsedEntity:function(e){const[t,n]=EntityUtils.fromEntityId(e);if(o.has(t,n))return!1;if(n>0){for(let e=0;e<=n-1;e++)r.delete(EntityUtils.toEntityId(t,e));o.addTo(t,n-1)}return r.add(e),!0}}}!function(e){e.fromEntityId=function(e){return[(e&MAX_U16)>>>0,((e&MASK_UPPER_16_ON_32)>>16&MAX_U16)>>>0]},e.toEntityId=function(e,t){return(e&MAX_U16|(t&MAX_U16)<<16)>>>0}}(EntityUtils||(EntityUtils={})),function(e){e[e.Unknown=0]="Unknown",e[e.UsedEntity=1]="UsedEntity",e[e.Removed=2]="Removed",e[e.Reserved=3]="Reserved"}(EntityState||(EntityState={}));var __classPrivateFieldGet=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},_ReadWriteByteBuffer_instances,_ReadWriteByteBuffer_woAdd,_ReadWriteByteBuffer_roAdd;function getNextSize(e,t){const n=Math.max(e,t)+1024;return 1024*Math.ceil(n/1024)}const defaultInitialCapacity=10240;class ReadWriteByteBuffer{constructor(e,t,n){_ReadWriteByteBuffer_instances.add(this),this._buffer=e||new Uint8Array(defaultInitialCapacity),this.view=new DataView(this._buffer.buffer,this._buffer.byteOffset),this.woffset=n??(e?this._buffer.length:null)??0,this.roffset=t??0}buffer(){return this._buffer}bufferLength(){return this._buffer.length}resetBuffer(){this.roffset=0,this.woffset=0}currentReadOffset(){return this.roffset}currentWriteOffset(){return this.woffset}incrementReadOffset(e){return __classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,e)}remainingBytes(){return this.woffset-this.roffset}readFloat32(){return this.view.getFloat32(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,4),!0)}readFloat64(){return this.view.getFloat64(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,8),!0)}readInt8(){return this.view.getInt8(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,1))}readInt16(){return this.view.getInt16(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,2),!0)}readInt32(){return this.view.getInt32(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,4),!0)}readInt64(){return this.view.getBigInt64(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,8),!0)}readUint8(){return this.view.getUint8(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,1))}readUint16(){return this.view.getUint16(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,2),!0)}readUint32(){return this.view.getUint32(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,4),!0)}readUint64(){return this.view.getBigUint64(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,8),!0)}readBuffer(){const e=this.view.getUint32(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,4),!0);return this._buffer.subarray(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,e),__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,0))}readUtf8String(){const e=this.view.getUint32(__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,4),!0);return utf8$2.read(this._buffer,__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,e),__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_roAdd).call(this,0))}incrementWriteOffset(e){return __classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,e)}toBinary(){return this._buffer.subarray(0,this.woffset)}toCopiedBinary(){return new Uint8Array(this.toBinary())}writeBuffer(e,t=!0){t&&this.writeUint32(e.byteLength);const n=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,e.byteLength);this._buffer.set(e,n)}writeUtf8String(e,t=!0){const n=utf8$2.length(e);t&&this.writeUint32(n);const r=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,n);utf8$2.write(e,this._buffer,r)}writeFloat32(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,4);this.view.setFloat32(t,e,!0)}writeFloat64(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,8);this.view.setFloat64(t,e,!0)}writeInt8(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,1);this.view.setInt8(t,e)}writeInt16(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,2);this.view.setInt16(t,e,!0)}writeInt32(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,4);this.view.setInt32(t,e,!0)}writeInt64(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,8);this.view.setBigInt64(t,e,!0)}writeUint8(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,1);this.view.setUint8(t,e)}writeUint16(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,2);this.view.setUint16(t,e,!0)}writeUint32(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,4);this.view.setUint32(t,e,!0)}writeUint64(e){const t=__classPrivateFieldGet(this,_ReadWriteByteBuffer_instances,"m",_ReadWriteByteBuffer_woAdd).call(this,8);this.view.setBigUint64(t,e,!0)}getFloat32(e){return this.view.getFloat32(e,!0)}getFloat64(e){return this.view.getFloat64(e,!0)}getInt8(e){return this.view.getInt8(e)}getInt16(e){return this.view.getInt16(e,!0)}getInt32(e){return this.view.getInt32(e,!0)}getInt64(e){return this.view.getBigInt64(e,!0)}getUint8(e){return this.view.getUint8(e)}getUint16(e){return this.view.getUint16(e,!0)}getUint32(e){return this.view.getUint32(e,!0)}getUint64(e){return this.view.getBigUint64(e,!0)}setFloat32(e,t){this.view.setFloat32(e,t,!0)}setFloat64(e,t){this.view.setFloat64(e,t,!0)}setInt8(e,t){this.view.setInt8(e,t)}setInt16(e,t){this.view.setInt16(e,t,!0)}setInt32(e,t){this.view.setInt32(e,t,!0)}setInt64(e,t){this.view.setBigInt64(e,t,!0)}setUint8(e,t){this.view.setUint8(e,t)}setUint16(e,t){this.view.setUint16(e,t,!0)}setUint32(e,t){this.view.setUint32(e,t,!0)}setUint64(e,t){this.view.setBigUint64(e,t,!0)}}var CrdtMessageType;_ReadWriteByteBuffer_instances=new WeakSet,_ReadWriteByteBuffer_woAdd=function(e){if(this.woffset+e>this._buffer.byteLength){const t=getNextSize(this._buffer.byteLength,this.woffset+e),n=new Uint8Array(t);n.set(this._buffer);const r=this._buffer.byteOffset;this._buffer=n,this.view=new DataView(this._buffer.buffer,r)}return this.woffset+=e,this.woffset-e},_ReadWriteByteBuffer_roAdd=function(e){if(this.roffset+e>this.woffset)throw new Error("Outside of the bounds of writen data.");return this.roffset+=e,this.roffset-e},function(e){e[e.RESERVED=0]="RESERVED",e[e.PUT_COMPONENT=1]="PUT_COMPONENT",e[e.DELETE_COMPONENT=2]="DELETE_COMPONENT",e[e.DELETE_ENTITY=3]="DELETE_ENTITY",e[e.APPEND_VALUE=4]="APPEND_VALUE",e[e.PUT_COMPONENT_NETWORK=5]="PUT_COMPONENT_NETWORK",e[e.DELETE_COMPONENT_NETWORK=6]="DELETE_COMPONENT_NETWORK",e[e.DELETE_ENTITY_NETWORK=7]="DELETE_ENTITY_NETWORK",e[e.MAX_MESSAGE_TYPE=8]="MAX_MESSAGE_TYPE"}(CrdtMessageType||(CrdtMessageType={}));const CRDT_MESSAGE_HEADER_LENGTH=8;var ProcessMessageResultType,CrdtMessageProtocol,DeleteComponent,AppendValueOperation,DeleteEntity,PutComponentOperation,PutNetworkComponentOperation,DeleteComponentNetwork,DeleteEntityNetwork;function isNetworkMessage(e){return[CrdtMessageType.DELETE_COMPONENT_NETWORK,CrdtMessageType.DELETE_ENTITY_NETWORK,CrdtMessageType.PUT_COMPONENT_NETWORK].includes(e.type)}function networkMessageToLocal(e,t,n,r){const i=n.currentWriteOffset();e.type===CrdtMessageType.PUT_COMPONENT_NETWORK?PutComponentOperation.write(t,e.timestamp,e.componentId,e.data,n):e.type===CrdtMessageType.DELETE_COMPONENT_NETWORK?DeleteComponent.write(t,e.componentId,e.timestamp,n):e.type===CrdtMessageType.DELETE_ENTITY_NETWORK&&DeleteEntity.write(t,n),r.writeBuffer(n.buffer().subarray(i,n.currentWriteOffset()),!1)}function localMessageToNetwork(e,t,n,r){const i=n.currentWriteOffset();e.type===CrdtMessageType.PUT_COMPONENT?PutNetworkComponentOperation.write(t.entityId,e.timestamp,e.componentId,t.networkId,e.data,n):e.type===CrdtMessageType.DELETE_COMPONENT?DeleteComponentNetwork.write(t.entityId,e.componentId,e.timestamp,t.networkId,n):e.type===CrdtMessageType.DELETE_ENTITY&&DeleteEntityNetwork.write(t.entityId,t.networkId,n),r.writeBuffer(n.buffer().subarray(i,n.currentWriteOffset()),!1)}!function(e){e[e.StateUpdatedTimestamp=1]="StateUpdatedTimestamp",e[e.StateOutdatedTimestamp=2]="StateOutdatedTimestamp",e[e.NoChanges=3]="NoChanges",e[e.StateOutdatedData=4]="StateOutdatedData",e[e.StateUpdatedData=5]="StateUpdatedData",e[e.EntityWasDeleted=6]="EntityWasDeleted",e[e.EntityDeleted=7]="EntityDeleted"}(ProcessMessageResultType||(ProcessMessageResultType={})),function(e){function t(e){const t=e.remainingBytes();if(t<CRDT_MESSAGE_HEADER_LENGTH)return!1;return!(t<e.getUint32(e.currentReadOffset()))}function n(e){if(!t(e))return null;const n=e.currentReadOffset();return{length:e.getUint32(n),type:e.getUint32(n+4)}}e.validate=t,e.readHeader=function(e){return t(e)?{length:e.readUint32(),type:e.readUint32()}:null},e.getHeader=n,e.consumeMessage=function(e){const t=n(e);return!!t&&(e.incrementReadOffset(t.length),!0)}}(CrdtMessageProtocol||(CrdtMessageProtocol={})),function(e){e.MESSAGE_HEADER_LENGTH=12,e.write=function(t,n,r,i){const o=CRDT_MESSAGE_HEADER_LENGTH+e.MESSAGE_HEADER_LENGTH,a=i.incrementWriteOffset(o);i.setUint32(a,o),i.setUint32(a+4,CrdtMessageType.DELETE_COMPONENT),i.setUint32(a+8,t),i.setUint32(a+12,n),i.setUint32(a+16,r)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.DELETE_COMPONENT)throw new Error("DeleteComponentOperation tried to read another message type.");return{...t,entityId:e.readUint32(),componentId:e.readUint32(),timestamp:e.readUint32()}}}(DeleteComponent||(DeleteComponent={})),function(e){e.MESSAGE_HEADER_LENGTH=16,e.write=function(t,n,r,i,o){const a=o.incrementWriteOffset(CRDT_MESSAGE_HEADER_LENGTH+e.MESSAGE_HEADER_LENGTH);o.writeBuffer(i,!1);const s=o.currentWriteOffset()-a;o.setUint32(a,s),o.setUint32(a+4,CrdtMessageType.APPEND_VALUE),o.setUint32(a+8,t),o.setUint32(a+12,r),o.setUint32(a+16,n);const c=s-e.MESSAGE_HEADER_LENGTH-CRDT_MESSAGE_HEADER_LENGTH;o.setUint32(a+20,c)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.APPEND_VALUE)throw new Error("AppendValueOperation tried to read another message type.");return{...t,entityId:e.readUint32(),componentId:e.readUint32(),timestamp:e.readUint32(),data:e.readBuffer()}}}(AppendValueOperation||(AppendValueOperation={})),function(e){e.MESSAGE_HEADER_LENGTH=4,e.write=function(e,t){t.writeUint32(CRDT_MESSAGE_HEADER_LENGTH+4),t.writeUint32(CrdtMessageType.DELETE_ENTITY),t.writeUint32(e)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.DELETE_ENTITY)throw new Error("DeleteEntity tried to read another message type.");return{...t,entityId:e.readUint32()}}}(DeleteEntity||(DeleteEntity={})),function(e){e.MESSAGE_HEADER_LENGTH=16,e.write=function(t,n,r,i,o){const a=o.incrementWriteOffset(CRDT_MESSAGE_HEADER_LENGTH+e.MESSAGE_HEADER_LENGTH);o.writeBuffer(i,!1);const s=o.currentWriteOffset()-a;o.setUint32(a,s),o.setUint32(a+4,CrdtMessageType.PUT_COMPONENT),o.setUint32(a+8,t),o.setUint32(a+12,r),o.setUint32(a+16,n);const c=s-e.MESSAGE_HEADER_LENGTH-CRDT_MESSAGE_HEADER_LENGTH;o.setUint32(a+20,c)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.PUT_COMPONENT)throw new Error("PutComponentOperation tried to read another message type.");return{...t,entityId:e.readUint32(),componentId:e.readUint32(),timestamp:e.readUint32(),data:e.readBuffer()}}}(PutComponentOperation||(PutComponentOperation={})),function(e){e.MESSAGE_HEADER_LENGTH=20,e.write=function(t,n,r,i,o,a){const s=a.incrementWriteOffset(CRDT_MESSAGE_HEADER_LENGTH+e.MESSAGE_HEADER_LENGTH);a.writeBuffer(o,!1);const c=a.currentWriteOffset()-s;a.setUint32(s,c),a.setUint32(s+4,CrdtMessageType.PUT_COMPONENT_NETWORK),a.setUint32(s+8,t),a.setUint32(s+12,r),a.setUint32(s+16,n),a.setUint32(s+20,i);const u=c-e.MESSAGE_HEADER_LENGTH-CRDT_MESSAGE_HEADER_LENGTH;a.setUint32(s+24,u)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.PUT_COMPONENT_NETWORK)throw new Error("PutComponentNetworkOperation tried to read another message type.");return{...t,entityId:e.readUint32(),componentId:e.readUint32(),timestamp:e.readUint32(),networkId:e.readUint32(),data:e.readBuffer()}}}(PutNetworkComponentOperation||(PutNetworkComponentOperation={})),function(e){e.MESSAGE_HEADER_LENGTH=16,e.write=function(t,n,r,i,o){const a=CRDT_MESSAGE_HEADER_LENGTH+e.MESSAGE_HEADER_LENGTH,s=o.incrementWriteOffset(a);o.setUint32(s,a),o.setUint32(s+4,CrdtMessageType.DELETE_COMPONENT_NETWORK),o.setUint32(s+8,t),o.setUint32(s+12,n),o.setUint32(s+16,r),o.setUint32(s+20,i)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.DELETE_COMPONENT_NETWORK)throw new Error("DeleteComponentOperation tried to read another message type.");return{...t,entityId:e.readUint32(),componentId:e.readUint32(),timestamp:e.readUint32(),networkId:e.readUint32()}}}(DeleteComponentNetwork||(DeleteComponentNetwork={})),function(e){e.MESSAGE_HEADER_LENGTH=8,e.write=function(e,t,n){n.writeUint32(CRDT_MESSAGE_HEADER_LENGTH+4),n.writeUint32(CrdtMessageType.DELETE_ENTITY_NETWORK),n.writeUint32(e),n.writeUint32(t)},e.read=function(e){const t=CrdtMessageProtocol.readHeader(e);if(!t)return null;if(t.type!==CrdtMessageType.DELETE_ENTITY_NETWORK)throw new Error("DeleteEntityNetwork tried to read another message type.");return{...t,entityId:e.readUint32(),networkId:e.readUint32()}}}(DeleteEntityNetwork||(DeleteEntityNetwork={}));const buffer=new ReadWriteByteBuffer;function fixTransformParent(e,t,n){buffer.resetBuffer();let r=t;if(!r&&"data"in e&&(r=TransformSchema.deserialize(new ReadWriteByteBuffer(e.data))),!r)throw new Error("Invalid parent transform");const i={...r,parent:n};return TransformSchema.serialize(i,buffer),buffer.toBinary()}function crdtSceneSystem(e,t){const n=[],r=NetworkEntity(e),i=NetworkParent(e),o=Transform$1(e),a=[],s=[];function c(e){return e.splice(0,e.length)}function u(t){if("networkId"in t)for(const[n,i]of e.getEntitiesWith(r))if(i.networkId===t.networkId&&i.entityId===t.entityId)return{entityId:n,network:i};return{entityId:t.entityId}}return{sendMessages:async function(a){const l=c(s),f=new ReadWriteByteBuffer;for(const r of e.componentsIter())for(const e of r.getCrdtUpdates()){const i=f.currentWriteOffset();if(n.some((t=>t.filter(e)))&&(e.type===CrdtMessageType.PUT_COMPONENT?PutComponentOperation.write(e.entityId,e.timestamp,e.componentId,e.data,f):e.type===CrdtMessageType.DELETE_COMPONENT?DeleteComponent.write(e.entityId,r.componentId,e.timestamp,f):e.type===CrdtMessageType.APPEND_VALUE&&AppendValueOperation.write(e.entityId,e.timestamp,e.componentId,e.data,f),l.push({...e,messageBuffer:f.buffer().subarray(i,f.currentWriteOffset())})),t){const n=e.type===CrdtMessageType.PUT_COMPONENT||e.type===CrdtMessageType.APPEND_VALUE?r.get(e.entityId):void 0;t(e.entityId,e.type,r,n)}}for(const e of a){const n=f.currentWriteOffset();DeleteEntity.write(e,f),l.push({type:CrdtMessageType.DELETE_ENTITY,entityId:e,messageBuffer:f.buffer().subarray(n,f.currentWriteOffset())}),t&&t(e,CrdtMessageType.DELETE_ENTITY)}const d=new ReadWriteByteBuffer;for(const e in n){const t=13,a=[],s=Number(e),c=n[s],f="renderer"===c.type,h="network"===c.type;d.resetBuffer();const p=new ReadWriteByteBuffer;for(const e of l){if(h&&d.toBinary().byteLength/1024>t&&(a.push(d.toBinary()),d.resetBuffer()),e.transportId===s)continue;if(!c.filter(e))continue;const{entityId:n}=u(e),l="componentId"in e&&e.componentId===o.componentId&&o.has(n)&&i.has(n)&&r.has(n);if(f&&e.type===CrdtMessageType.PUT_COMPONENT&&l){const t=u(i.get(n)),r=fixTransformParent(e,o.get(n),t.entityId),a=p.currentWriteOffset();PutComponentOperation.write(n,e.timestamp,e.componentId,r,p),d.writeBuffer(p.buffer().subarray(a,p.currentWriteOffset()),!1)}else if(f&&isNetworkMessage(e)){let t="data"in e?e.data:new Uint8Array;if(l){const r=u(i.get(n));t=fixTransformParent(e,o.get(n),r.entityId)}networkMessageToLocal({...e,data:t},n,p,d)}else{if(h&&!isNetworkMessage(e)){const t=r.getOrNull(e.entityId);if(t){localMessageToNetwork(e,t,p,d);continue}}d.writeBuffer(e.messageBuffer,!1)}}h&&d.currentWriteOffset()&&a.push(d.toBinary());const m=h?a:d.toBinary();await c.send(m)}},receiveMessages:async function(){const n=c(a),l=[];for(const a of n){let{entityId:n,network:c}=u(a);if(isNetworkMessage(a)&&!c&&(n=e.addEntity(),c={entityId:a.entityId,networkId:a.networkId},r.createOrReplace(n,c)),a.type===CrdtMessageType.DELETE_ENTITY||a.type===CrdtMessageType.DELETE_ENTITY_NETWORK)l.push(n),s.push(a);else{const c=e.entityContainer.getEntityState(n);if(c===EntityState.Removed)continue;c===EntityState.Unknown&&e.entityContainer.updateUsedEntity(n);const u=e.getComponentOrNull(a.componentId);if(u){a.type===CrdtMessageType.PUT_COMPONENT&&u.componentId===o.componentId&&r.has(n)&&i.has(n)&&(a.data=fixTransformParent(a));const[e,c]=u.updateFromCrdt({...a,entityId:n});e||(s.push(a),t&&t(n,a.type,u,c))}else s.push(a)}}for(const n of l){for(const t of e.componentsIter())t.entityDeleted(n,!0);e.entityContainer.updateRemovedEntity(n),t&&t(n,CrdtMessageType.DELETE_ENTITY)}},addTransport:function(e){const t=n.push(e)-1;var r;e.onmessage=(r=t,function(e){const t=new ReadWriteByteBuffer(e);let n;for(;n=CrdtMessageProtocol.getHeader(t);){const e=t.currentReadOffset();let i;n.type===CrdtMessageType.DELETE_COMPONENT?i=DeleteComponent.read(t):n.type===CrdtMessageType.DELETE_COMPONENT_NETWORK?i=DeleteComponentNetwork.read(t):n.type===CrdtMessageType.PUT_COMPONENT?i=PutComponentOperation.read(t):n.type===CrdtMessageType.PUT_COMPONENT_NETWORK?i=PutNetworkComponentOperation.read(t):n.type===CrdtMessageType.DELETE_ENTITY?i=DeleteEntity.read(t):n.type===CrdtMessageType.DELETE_ENTITY_NETWORK?i=DeleteEntityNetwork.read(t):n.type===CrdtMessageType.APPEND_VALUE?i=AppendValueOperation.read(t):t.incrementReadOffset(n.length),i&&a.push({...i,transportId:r,messageBuffer:t.buffer().subarray(e,t.currentReadOffset())})}})}}}var CrdtUtils;function dataCompare(e,t){if(e===t)return 0;if(null===e&&null!==t)return-1;if(null!==e&&null===t)return 1;if(e instanceof Uint8Array&&t instanceof Uint8Array){const n=e.byteLength-t.byteLength;if(0!==n)return n>0?1:-1;let r;for(let n=0,i=e.byteLength;n<i;n++)if(r=e[n]-t[n],0!==r)return r>0?1:-1;return 0}if("string"==typeof e){const n=e.length-t.length;return 0!==n?n>0?1:-1:e.localeCompare(t)}return e>t?1:-1}function deepReadonly(e){return Object.freeze({...e})}function incrementTimestamp(e,t){const n=(t.get(e)||0)+1;return t.set(e,n),n}function createDumpLwwFunctionFromCrdt(e,t,n,r){return function(i,o){for(const[a,s]of t)if(!o||o(a))if(r.has(a)){const t=r.get(a),o=new ReadWriteByteBuffer;n.serialize(t,o),PutComponentOperation.write(a,s,e,o.toBinary(),i)}else DeleteComponent.write(a,e,s,i)}}function createUpdateLwwFromCrdt(e,t,n,r){return i=>{if(i.type!==CrdtMessageType.PUT_COMPONENT&&i.type!==CrdtMessageType.PUT_COMPONENT_NETWORK&&i.type!==CrdtMessageType.DELETE_COMPONENT&&i.type!==CrdtMessageType.DELETE_COMPONENT_NETWORK)return[null,r.get(i.entityId)];const o=function(e){const{entityId:i,timestamp:o}=e,a=t.get(i);if(void 0===a||a<o)return ProcessMessageResultType.StateUpdatedTimestamp;if(a>o)return ProcessMessageResultType.StateOutdatedTimestamp;if(e.type===CrdtMessageType.DELETE_COMPONENT&&!r.has(i))return ProcessMessageResultType.NoChanges;let s=0;if(r.has(i)){const t=new ReadWriteByteBuffer;n.serialize(r.get(i),t),s=dataCompare(t.toBinary(),e.data||null)}else s=dataCompare(null,e.data);return 0===s?ProcessMessageResultType.NoChanges:s>0?ProcessMessageResultType.StateOutdatedData:ProcessMessageResultType.StateUpdatedData}(i),a=i.entityId;switch(o){case ProcessMessageResultType.StateUpdatedData:case ProcessMessageResultType.StateUpdatedTimestamp:if(t.set(a,i.timestamp),i.type===CrdtMessageType.PUT_COMPONENT||i.type===CrdtMessageType.PUT_COMPONENT_NETWORK){const e=new ReadWriteByteBuffer(i.data);r.set(a,n.deserialize(e))}else r.delete(a);return[null,r.get(a)];case ProcessMessageResultType.StateOutdatedTimestamp:case ProcessMessageResultType.StateOutdatedData:if(r.has(a)){const i=new ReadWriteByteBuffer;return n.serialize(r.get(a),i),[{type:CrdtMessageType.PUT_COMPONENT,componentId:e,data:i.toBinary(),entityId:a,timestamp:t.get(a)},r.get(a)]}return[{type:CrdtMessageType.DELETE_COMPONENT,componentId:e,entityId:a,timestamp:t.get(a)},void 0]}return[null,r.get(a)]}}function createGetCrdtMessagesForLww(e,t,n,r,i){return function*(){for(const o of n){const n=incrementTimestamp(o,t);if(i.has(o)){const t=new ReadWriteByteBuffer;r.serialize(i.get(o),t);const a={type:CrdtMessageType.PUT_COMPONENT,componentId:e,entityId:o,data:t.toBinary(),timestamp:n};yield a}else{const t={type:CrdtMessageType.DELETE_COMPONENT,componentId:e,entityId:o,timestamp:n};yield t}}n.clear()}}function createComponentDefinitionFromSchema(e,t,n){const r=new Map,i=new Set,o=new Map,a=new Map;return{get componentId(){return t},get componentName(){return e},get componentType(){return 0},schema:n,has:e=>r.has(e),deleteFrom(e,t=!0){const n=r.get(e);return r.delete(e)&&t&&i.add(e),n||null},entityDeleted(e,t){r.delete(e)&&t&&i.add(e)},getOrNull(e){const t=r.get(e);return t?deepReadonly(t):null},get(t){const n=r.get(t);if(!n)throw new Error(`[getFrom] Component ${e} for entity #${t} not found`);return deepReadonly(n)},create(t,o){if(r.get(t))throw new Error(`[create] Component ${e} for ${t} already exists`);const a=void 0===o?n.create():n.extend?n.extend(o):o;return r.set(t,a),i.add(t),a},createOrReplace(e,t){const o=void 0===t?n.create():n.extend?n.extend(t):t;return r.set(e,o),i.add(e),o},getMutableOrNull(e){const t=r.get(e);return t?(i.add(e),t):null},getOrCreateMutable(e,t){const n=r.get(e);return n?(i.add(e),n):this.create(e,t)},getMutable(t){const n=this.getMutableOrNull(t);if(null===n)throw new Error(`[mutable] Component ${e} for ${t} not found`);return n},*iterator(){for(const[e,t]of r)yield[e,t]},*dirtyIterator(){for(const e of i)yield e},getCrdtUpdates:createGetCrdtMessagesForLww(t,o,i,n,r),updateFromCrdt:createUpdateLwwFromCrdt(t,o,n,r),dumpCrdtStateToBuffer:createDumpLwwFunctionFromCrdt(t,o,n,r),onChange(e,t){const n=a.get(e)??[];n.push(t),a.set(e,n)},__onChangeCallbacks(e,t){const n=a.get(e);if(n)for(const e of n)e(t)}}}!function(e){var t;(t=e.SynchronizedEntityType||(e.SynchronizedEntityType={}))[t.NETWORKED=0]="NETWORKED",t[t.RENDERER=1]="RENDERER"}(CrdtUtils||(CrdtUtils={}));const SYSTEMS_REGULAR_PRIORITY=1e5;function SystemContainer(){const e=[];function t(){e.sort(((e,t)=>t.priority-e.priority))}return{add:function(n,r,i){const o=i??n.name;if(e.find((e=>e.fn===n)))throw new Error(`System ${JSON.stringify(o)} already added to the engine`);e.push({fn:n,priority:r,name:o}),t()},remove:function(n){let r=-1;return r="string"==typeof n?e.findIndex((e=>e.name===n)):e.findIndex((e=>e.fn===n)),-1!==r&&(e.splice(r,1),t(),!0)},getSystems:()=>e}}const emptyReadonlySet=freezeSet(new Set);function frozenError(){throw new Error("The set is frozen")}function freezeSet(e){return e.add=frozenError,e.clear=frozenError,e}function sortByTimestamp(e,t){return e.timestamp>t.timestamp?1:-1}function createValueSetComponentDefinitionFromSchema(e,t,n,r){const i=new Map,o=new Set,a=[],s=new Map;function c(e){const t=i.get(e);if(t){for(function(e){const t=e.raw.length;return t>1&&e.raw[t-1].timestamp<=e.raw[t-2].timestamp}(t)&&t.raw.sort(sortByTimestamp);t.raw.length>r.maxElements;)t.raw.shift();const e=freezeSet(new Set(t?.raw.map((e=>e.value))));return t.frozenSet=e,e}return emptyReadonlySet}function u(e,t){let o=i.get(e);o||(o={raw:[],frozenSet:emptyReadonlySet},i.set(e,o));const a=n.extend?n.extend(t):t,s=r.timestampFunction(a);return __DEV__&&Object.freeze(a),o.raw.push({value:a,timestamp:s}),{set:c(e),value:a}}const l={get componentId(){return t},get componentName(){return e},get componentType(){return 1},schema:n,has:e=>i.has(e),entityDeleted(e){i.delete(e)},get(e){const t=i.get(e);return t?t.frozenSet:emptyReadonlySet},addValue(e,r){const{set:i,value:s}=u(e,r);o.add(e);const c=new ReadWriteByteBuffer;return n.serialize(s,c),a.push({componentId:t,data:c.toBinary(),entityId:e,timestamp:0,type:CrdtMessageType.APPEND_VALUE}),i},*iterator(){for(const[e,t]of i)yield[e,t.frozenSet]},*dirtyIterator(){for(const e of o)yield e},getCrdtUpdates:()=>(o.clear(),a.splice(0,a.length)),updateFromCrdt(e){if(e.type===CrdtMessageType.APPEND_VALUE){const t=new ReadWriteByteBuffer(e.data),{value:r}=u(e.entityId,n.deserialize(t));return[null,r]}return[null,void 0]},dumpCrdtStateToBuffer:function(e,r){for(const[o,{raw:a}]of i)if(!r||r(o))for(const r of a){const i=new ReadWriteByteBuffer;n.serialize(r.value,i),AppendValueOperation.write(o,0,t,i.toBinary(),e)}},onChange(e,t){const n=s.get(e)??[];n.push(t),s.set(e,n)},__onChangeCallbacks(e,t){const n=s.get(e);if(n)for(const e of n)e(t)}};return l}function*genEntityTree(e,t){if(t.has(e)){t.delete(e);for(const[n,r]of t)r.parent===e&&(yield*genEntityTree(n,t));yield e}}function getComponentEntityTree(e,t,n){return genEntityTree(t,new Map(e.getEntitiesWith(n)))}function removeNetworkEntityChildrens(e,t){const n=NetworkParent(e),r=NetworkEntity(e);e.removeEntity(t);const i=r.getOrNull(t);if(i)for(const[t,r]of e.getEntitiesWith(n))r.entityId===i.entityId&&r.networkId===i.networkId&&removeNetworkEntityChildrens(e,t)}function removeEntityWithChildren(e,t){const n=Transform$1(e);if(NetworkEntity(e).has(t))return removeNetworkEntityChildrens(e,t);for(const r of getComponentEntityTree(e,t,n))e.removeEntity(r)}var ComponentType;function preEngine(e){const t=e?.entityContainer??createEntityContainer(),n=new Map,r=SystemContainer();let i=!1;function o(e){for(const[,t]of n)"core-schema::Network-Entity"!==t.componentName&&t.entityDeleted(e,!0);return t.removeEntity(e)}function a(e,t){const r=componentNumberFromName(e),o=n.get(r);if(o)return o;if(i)throw new Error("Engine is already sealed. No components can be added at this stage");const a=createComponentDefinitionFromSchema(e,r,t);return n.set(r,a),a}function s(e,t,r){const o=componentNumberFromName(e),a=n.get(o);if(a)return a;if(i)throw new Error("Engine is already sealed. No components can be added at this stage");const s=createComponentDefinitionFromSchema(e,o,Schemas.Map(t,r)),c={...s,create:(e,t)=>s.create(e,t),createOrReplace:(e,t)=>s.createOrReplace(e,t)};return n.set(o,c),c}function*c(...e){for(const[t,...n]of function*(...e){const[t,...n]=e;for(const[r]of t.iterator()){let t=!0;for(const e of n)if(!e.has(r)){t=!1;break}t&&(yield[r,...e])}}(...e))yield[t,...n.map((e=>e.get(t)))]}return Transform$1({defineComponentFromSchema:a}),{addEntity:function(){return t.generateEntity()},removeEntity:o,removeEntityWithChildren:function(e){return removeEntityWithChildren({removeEntity:o,defineComponentFromSchema:a,getEntitiesWith:c,defineComponent:s},e)},addSystem:function(e,t=SYSTEMS_REGULAR_PRIORITY,n){r.add(e,t,n)},getSystems:function(){return r.getSystems()},removeSystem:function(e){return r.remove(e)},defineComponent:s,defineComponentFromSchema:a,defineValueSetComponentFromSchema:function(e,t,r){const o=componentNumberFromName(e),a=n.get(o);if(a)return a;if(i)throw new Error("Engine is already sealed. No components can be added at this stage");const s=createValueSetComponentDefinitionFromSchema(e,o,t,r);return n.set(o,s),s},getEntitiesWith:c,getComponent:function(e){const t="number"==typeof e?e:componentNumberFromName(e),r=n.get(t);if(!r)throw new Error(`Component ${e} not found. You need to declare the components at the beginnig of the engine declaration`);return r},getComponentOrNull:function(e){const t="number"==typeof e?e:componentNumberFromName(e);return n.get(t)??null},getEntityOrNullByName:function(e){const t=Name({defineComponent:s});for(const[n,r]of c(t))if(r.value===e)return n;return null},removeComponentDefinition:function(e){if(i)throw new Error("Engine is already sealed. No components can be removed at this stage");const t="number"==typeof e?e:componentNumberFromName(e);n.delete(t)},registerComponentDefinition:function(e,t){if(i)throw new Error("Engine is already sealed. No components can be added at this stage");const r=componentNumberFromName(e);if(n.get(r))throw new Error(`Component number ${r} was already registered.`);if(t.componentName!==e)throw new Error(`Component name doesn't match componentDefinition.componentName ${e} != ${t.componentName}`);if(t.componentId!==r)throw new Error(`Component number doesn't match componentDefinition.componentId ${r} != ${t.componentId}`);return n.set(r,t),t},entityContainer:t,componentsIter:function(){return n.values()},seal:function(){i||(i=!0)}}}function Engine(e){const t=preEngine(e),n=crdtSceneSystem(t,((n,r,i,o)=>{if(r===CrdtMessageType.DELETE_ENTITY)for(const e of t.componentsIter())e?.__onChangeCallbacks(n,void 0);else i?.__onChangeCallbacks(n,o);return e?.onChangeFunction(n,r,i,o)}));return{_id:Date.now(),addEntity:t.addEntity,removeEntity:t.removeEntity,removeEntityWithChildren:t.removeEntityWithChildren,addSystem:t.addSystem,removeSystem:t.removeSystem,defineComponent:t.defineComponent,defineComponentFromSchema:t.defineComponentFromSchema,defineValueSetComponentFromSchema:t.defineValueSetComponentFromSchema,registerComponentDefinition:t.registerComponentDefinition,getEntitiesWith:t.getEntitiesWith,getComponent:t.getComponent,getComponentOrNull:t.getComponentOrNull,removeComponentDefinition:t.removeComponentDefinition,componentsIter:t.componentsIter,seal:t.seal,getEntityOrNullByName:t.getEntityOrNullByName,update:async function(e){await n.receiveMessages();for(const n of t.getSystems()){checkNotThenable(n.fn(e),`A system (${n.name||"anonymous"}) returned a thenable. Systems cannot be async functions. Documentation: https://dcl.gg/sdk/sync-systems`)}const r=t.entityContainer.releaseRemovedEntities();await n.sendMessages(r)},RootEntity:0,PlayerEntity:1,CameraEntity:2,getEntityState:t.entityContainer.getEntityState,addTransport:n.addTransport,entityContainer:t.entityContainer}}!function(e){e[e.LastWriteWinElementSet=0]="LastWriteWinElementSet",e[e.GrowOnlyValueSet=1]="GrowOnlyValueSet"}(ComponentType||(ComponentType={}));const cacheTween=new Map;function createTweenSystem(e){if(cacheTween.has(e._id))return cacheTween.get(e._id);const t=Tween$1(e),n=TweenState(e),r=TweenSequence$1(e),i=new Map;function o(e){const r=n.getOrNull(e),o=t.getOrNull(e),s=i.get(e);return!(!r||!o)&&!(!a(e)&&1!==r.state||s?.completed||!((s?.frames??0)>2))}function a(e){const n=t.getOrNull(e),r=i.get(e)?.tween;if(n&&!r||!n&&r)return!0;const o=new ReadWriteByteBuffer;t.schema.serialize(n,o);return dataCompare(o.toBinary(),r)}const s=[];function c(e){if("move"===e.mode?.$case&&e.mode.move)return{...e,mode:{...e.mode,move:{start:e.mode.move.end,end:e.mode.move.start}}};if("rotate"===e.mode?.$case&&e.mode.rotate)return{...e,mode:{...e.mode,rotate:{start:e.mode.rotate.end,end:e.mode.rotate.start}}};if("scale"===e.mode?.$case&&e.mode.scale)return{...e,mode:{...e.mode,scale:{start:e.mode.scale.end,end:e.mode.scale.start}}};if("textureMove"===e.mode?.$case&&e.mode.textureMove)return{...e,mode:{...e.mode,textureMove:{start:e.mode.textureMove.end,end:e.mode.textureMove.start}}};throw new Error("Invalid tween")}e.addSystem((()=>{for(const e of s)e();s.length=0;for(const[n,u]of e.getEntitiesWith(t)){if(a(n)){const e=new ReadWriteByteBuffer;t.schema.serialize(u,e),i.set(n,{tween:e.toBinary(),frames:0,completed:!1,changed:!0});continue}const e=i.get(n);if(e.frames+=1,e.changed=!1,o(n)){e.frames=0,e.completed=!0;const o=r.getOrNull(n);if(!o)continue;const{sequence:a}=o;if(a&&a.length){const[e,...i]=a;t.createOrReplace(n,e);const s=r.getMutable(n);s.sequence=i,0===o.loop&&s.sequence.push(u)}else 1===o.loop?t.createOrReplace(n,c(u)):0===o.loop&&(t.deleteFrom(n),i.delete(n),s.push((()=>{t.createOrReplace(n,u)})))}}}),Number.NEGATIVE_INFINITY);const u={tweenCompleted:o};return cacheTween.set(e._id,u),u}function pointerEventColliderChecker(e){const t=PointerEvents(e),n=MeshCollider(e),r=GltfContainer(e),i=UiTransform(e),o=new Set;let a=0;function s(s){if(a+=s,!(a<=10)){a=0;for(const[a]of e.getEntitiesWith(t)){if(o.has(a))continue;if(r.has(a))continue;if(i.has(a))continue;const e=n.getOrNull(a);e&&(void 0===e.collisionMask||1&e.collisionMask)||(o.add(a),console.log(`⚠️ Missing MeshCollider component on entity ${a}. Add a MeshCollider to the entity so it can be clickeable by the player.\nSee https://docs.decentraland.org/creator/development-guide/sdk7/colliders/#pointer-blocking`))}}}e.removeSystem(s),e.addSystem(s)}const engine=Engine();createTweenSystem(engine),pointerEventColliderChecker(engine);const TweenSequence=TweenSequence$1(engine);var CameraType,InputAction,PointerEventType,LoadingState,TextAlignMode,Font;function getCompositeRootComponent(e){const t=e.getComponentOrNull("composite::root");return t||e.defineComponent("composite::root",{src:Schemas.String,entities:Schemas.Array(Schemas.Map({src:Schemas.Entity,dest:Schemas.Entity}))})}!function(e){e[e.CT_FIRST_PERSON=0]="CT_FIRST_PERSON",e[e.CT_THIRD_PERSON=1]="CT_THIRD_PERSON",e[e.CT_CINEMATIC=2]="CT_CINEMATIC"}(CameraType||(CameraType={})),function(e){e[e.IA_POINTER=0]="IA_POINTER",e[e.IA_PRIMARY=1]="IA_PRIMARY",e[e.IA_SECONDARY=2]="IA_SECONDARY",e[e.IA_ANY=3]="IA_ANY",e[e.IA_FORWARD=4]="IA_FORWARD",e[e.IA_BACKWARD=5]="IA_BACKWARD",e[e.IA_RIGHT=6]="IA_RIGHT",e[e.IA_LEFT=7]="IA_LEFT",e[e.IA_JUMP=8]="IA_JUMP",e[e.IA_WALK=9]="IA_WALK",e[e.IA_ACTION_3=10]="IA_ACTION_3",e[e.IA_ACTION_4=11]="IA_ACTION_4",e[e.IA_ACTION_5=12]="IA_ACTION_5",e[e.IA_ACTION_6=13]="IA_ACTION_6"}(InputAction||(InputAction={})),function(e){e[e.PET_UP=0]="PET_UP",e[e.PET_DOWN=1]="PET_DOWN",e[e.PET_HOVER_ENTER=2]="PET_HOVER_ENTER",e[e.PET_HOVER_LEAVE=3]="PET_HOVER_LEAVE"}(PointerEventType||(PointerEventType={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.LOADING=1]="LOADING",e[e.NOT_FOUND=2]="NOT_FOUND",e[e.FINISHED_WITH_ERROR=3]="FINISHED_WITH_ERROR",e[e.FINISHED=4]="FINISHED"}(LoadingState||(LoadingState={})),function(e){e[e.TAM_TOP_LEFT=0]="TAM_TOP_LEFT",e[e.TAM_TOP_CENTER=1]="TAM_TOP_CENTER",e[e.TAM_TOP_RIGHT=2]="TAM_TOP_RIGHT",e[e.TAM_MIDDLE_LEFT=3]="TAM_MIDDLE_LEFT",e[e.TAM_MIDDLE_CENTER=4]="TAM_MIDDLE_CENTER",e[e.TAM_MIDDLE_RIGHT=5]="TAM_MIDDLE_RIGHT",e[e.TAM_BOTTOM_LEFT=6]="TAM_BOTTOM_LEFT",e[e.TAM_BOTTOM_CENTER=7]="TAM_BOTTOM_CENTER",e[e.TAM_BOTTOM_RIGHT=8]="TAM_BOTTOM_RIGHT"}(TextAlignMode||(TextAlignMode={})),function(e){e[e.F_SANS_SERIF=0]="F_SANS_SERIF",e[e.F_SERIF=1]="F_SERIF",e[e.F_MONOSPACE=2]="F_MONOSPACE"}(Font||(Font={}));const currentWorkingDir="/";function normalizeStringPosix(e,t=!1){let n,r="",i=0,o=-1,a=0;for(let s=0;s<=e.length;++s){if(s<e.length)n=e.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(o===s-1||1===a);else if(o!==s-1&&2===a){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){const e=r.lastIndexOf("/");if(e!==r.length-1){-1===e?(r="",i=0):(r=r.slice(0,e),i=r.length-1-r.lastIndexOf("/")),o=s,a=0;continue}}else if(2===r.length||1===r.length){r="",i=0,o=s,a=0;continue}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/"+e.slice(o+1,s):r=e.slice(o+1,s),i=s-o-1;o=s,a=0}else 46===n&&-1!==a?++a:a=-1}return r}function resolve(...e){let t,n="",r=!1;for(let i=e.length-1;i>=-1&&!r;i--){let o;i>=0?o=e[i]:(void 0===t&&(t=currentWorkingDir),o=t),0!==o.length&&(n=o+"/"+n,r=47===o.charCodeAt(0))}return n=normalizeStringPosix(n,!r),r?n.length>0?"/"+n:"/":n.length>0?n:"."}function dirname(e){if(0===e.length)return".";let t=e.charCodeAt(0);const n=47===t;let r=-1,i=!0;for(let n=e.length-1;n>=1;--n)if(t=e.charCodeAt(n),47===t){if(!i){r=n;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"//":e.slice(0,r)}function resolveComposite(e,t){return(e.startsWith(".")?resolve(t,e):resolve(e)).substring(1)}var EntityMappingMode,NullValue,Struct,Struct_FieldsEntry,Value,ListValue;function getComponentValue(e,t){return"json"===t.data?.$case?t.data.json:e.schema.deserialize(new ReadWriteByteBuffer(t.data?.binary))}function getComponentDefinition(e,t){const n=e.getComponentOrNull(t.name);if(n)return n;if(t.name.startsWith("core::")){if(t.name in componentDefinitionByName)return componentDefinitionByName[t.name](e);throw new Error(`The core component ${t.name} was not found.`)}if(t.jsonSchema)return e.defineComponentFromSchema(t.name,Schemas.fromJson(t.jsonSchema));throw new Error(`${t.name} is not defined and there is no schema to define it.`)}function getEntityMapping(e,t,n,{entityMapping:r}){const i=n.get(t);if(i)return i;if(r?.type===EntityMappingMode.EMM_DIRECT_MAPPING){const e=r.getCompositeEntity(t);return n.set(t,e),e}const o=r?.type===EntityMappingMode.EMM_NEXT_AVAILABLE?r.getNextAvailableEntity():e.addEntity();if(null===o)throw new Error("There is no more entities to allocate");return n.set(t,o),o}function instanceComposite(e,t,n,r){const{rootEntity:i,alreadyRequestedSrc:o,entityMapping:a}=r,s=o||new Set,c=dirname(resolve(t.src)),u=componentNumberFromName("core::Transform"),l=getCompositeRootComponent(e),f=new Map,d=t=>getEntityMapping(e,t,f,r),h=i??d(0);i&&f.set(0,i);const p=t.composite.components.find((e=>e.name===l.componentName));if(p)for(const[r,i]of p.data){const o=resolveComposite(getComponentValue(l,i).src,c),u=n.getCompositeOrNull(o),f=d(r);if(u){if(s.has(u.src)||u.src===t.src)throw new Error(`Composite ${t.src} has a recursive instanciation while try to instance ${u.src}. Previous instances: ${s.toString()}`);instanceComposite(e,u,n,{rootEntity:f,alreadyRequestedSrc:new Set(s).add(u.src),entityMapping:a?.type===EntityMappingMode.EMM_NEXT_AVAILABLE?a:void 0})}}for(const n of t.composite.components){if(n.name===l.componentName)continue;const t=getComponentDefinition(e,n);for(const[e,r]of n.data){const n=getComponentValue(t,r),i=d(e),o=t.create(i,n);if(t.componentId===u){const e=o;e.parent?e.parent=d(e.parent):e.parent=d(0)}else Schemas.mutateNestedValues(t.schema.jsonSchema,o,((e,t)=>"entity"===t.serializationType?{changed:!0,value:d(e)}:{changed:!1}))}}const m=l.getMutableOrNull(h)||l.create(h);for(const[e,t]of f)m.entities.push({src:e,dest:t});return m.src=t.src,h}function nullValueFromJSON(e){switch(e){case 0:case"NULL_VALUE":return 0;default:throw new tsProtoGlobalThis$1.Error("Unrecognized enum value "+e+" for enum NullValue")}}function nullValueToJSON(e){if(0===e)return"NULL_VALUE";throw new tsProtoGlobalThis$1.Error("Unrecognized enum value "+e+" for enum NullValue")}function createBaseStruct(){return{fields:new Map}}function createBaseStruct_FieldsEntry(){return{key:"",value:void 0}}function createBaseValue(){return{kind:void 0}}function createBaseListValue(){return{values:[]}}!function(e){e[e.EMM_NONE=0]="EMM_NONE",e[e.EMM_NEXT_AVAILABLE=1]="EMM_NEXT_AVAILABLE",e[e.EMM_DIRECT_MAPPING=2]="EMM_DIRECT_MAPPING"}(EntityMappingMode||(EntityMappingMode={})),function(e){e[e.NULL_VALUE=0]="NULL_VALUE"}(NullValue||(NullValue={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return e.fields.forEach(((e,n)=>{void 0!==e&&Struct_FieldsEntry.encode({key:n,value:e},t.uint32(10).fork()).ldelim()})),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseStruct();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;const t=Struct_FieldsEntry.decode(n,n.uint32());void 0!==t.value&&i.fields.set(t.key,t.value);continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i},e.fromJSON=function(e){return{fields:isObject$b(e.fields)?Object.entries(e.fields).reduce(((e,[t,n])=>(e.set(t,n),e)),new Map):new Map}},e.toJSON=function(e){const t={fields:{}};return e.fields&&e.fields.forEach(((e,n)=>{t.fields[n]=e})),t},e.wrap=function(e){const t=createBaseStruct();return void 0!==e&&Object.keys(e).forEach((n=>{t.fields.set(n,e[n])})),t},e.unwrap=function(e){const t={};return[...e.fields.keys()].forEach((n=>{t[n]=e.fields.get(n)})),t}}(Struct||(Struct={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.key&&t.uint32(10).string(e.key),void 0!==e.value&&Value.encode(Value.wrap(e.value),t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseStruct_FieldsEntry();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.key=n.string();continue;case 2:if(18!==e)break;i.value=Value.unwrap(Value.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i},e.fromJSON=function(e){return{key:isSet$1(e.key)?String(e.key):"",value:isSet$1(e?.value)?e.value:void 0}},e.toJSON=function(e){const t={};return void 0!==e.key&&(t.key=e.key),void 0!==e.value&&(t.value=e.value),t}}(Struct_FieldsEntry||(Struct_FieldsEntry={})),function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.kind?.$case){case"nullValue":t.uint32(8).int32(e.kind.nullValue);break;case"numberValue":t.uint32(17).double(e.kind.numberValue);break;case"stringValue":t.uint32(26).string(e.kind.stringValue);break;case"boolValue":t.uint32(32).bool(e.kind.boolValue);break;case"structValue":Struct.encode(Struct.wrap(e.kind.structValue),t.uint32(42).fork()).ldelim();break;case"listValue":ListValue.encode(ListValue.wrap(e.kind.listValue),t.uint32(50).fork()).ldelim()}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseValue();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.kind={$case:"nullValue",nullValue:n.int32()};continue;case 2:if(17!==e)break;i.kind={$case:"numberValue",numberValue:n.double()};continue;case 3:if(26!==e)break;i.kind={$case:"stringValue",stringValue:n.string()};continue;case 4:if(32!==e)break;i.kind={$case:"boolValue",boolValue:n.bool()};continue;case 5:if(42!==e)break;i.kind={$case:"structValue",structValue:Struct.unwrap(Struct.decode(n,n.uint32()))};continue;case 6:if(50!==e)break;i.kind={$case:"listValue",listValue:ListValue.unwrap(ListValue.decode(n,n.uint32()))};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i},e.fromJSON=function(e){return{kind:isSet$1(e.nullValue)?{$case:"nullValue",nullValue:nullValueFromJSON(e.nullValue)}:isSet$1(e.numberValue)?{$case:"numberValue",numberValue:Number(e.numberValue)}:isSet$1(e.stringValue)?{$case:"stringValue",stringValue:String(e.stringValue)}:isSet$1(e.boolValue)?{$case:"boolValue",boolValue:Boolean(e.boolValue)}:isSet$1(e.structValue)?{$case:"structValue",structValue:e.structValue}:isSet$1(e.listValue)?{$case:"listValue",listValue:[...e.listValue]}:void 0}},e.toJSON=function(e){const t={};return"nullValue"===e.kind?.$case&&(t.nullValue=void 0!==e.kind?.nullValue?nullValueToJSON(e.kind?.nullValue):void 0),"numberValue"===e.kind?.$case&&(t.numberValue=e.kind?.numberValue),"stringValue"===e.kind?.$case&&(t.stringValue=e.kind?.stringValue),"boolValue"===e.kind?.$case&&(t.boolValue=e.kind?.boolValue),"structValue"===e.kind?.$case&&(t.structValue=e.kind?.structValue),"listValue"===e.kind?.$case&&(t.listValue=e.kind?.listValue),t},e.wrap=function(e){const t=createBaseValue();if(null===e)t.kind={$case:"nullValue",nullValue:0};else if("boolean"==typeof e)t.kind={$case:"boolValue",boolValue:e};else if("number"==typeof e)t.kind={$case:"numberValue",numberValue:e};else if("string"==typeof e)t.kind={$case:"stringValue",stringValue:e};else if(Array.isArray(e))t.kind={$case:"listValue",listValue:e};else if("object"==typeof e)t.kind={$case:"structValue",structValue:e};else if(void 0!==e)throw new Error("Unsupported any value type: "+typeof e);return t},e.unwrap=function(e){return"nullValue"===e.kind?.$case?null:"numberValue"===e.kind?.$case?e.kind?.numberValue:"stringValue"===e.kind?.$case?e.kind?.stringValue:"boolValue"===e.kind?.$case?e.kind?.boolValue:"structValue"===e.kind?.$case?e.kind?.structValue:"listValue"===e.kind?.$case?e.kind?.listValue:void 0}}(Value||(Value={})),function(e){e.encode=function(e,t=minimal.Writer.create()){for(const n of e.values)Value.encode(Value.wrap(n),t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseListValue();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.values.push(Value.unwrap(Value.decode(n,n.uint32())));continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i},e.fromJSON=function(e){return{values:Array.isArray(e?.values)?[...e.values]:[]}},e.toJSON=function(e){const t={};return e.values?t.values=e.values.map((e=>e)):t.values=[],t},e.wrap=function(e){const t=createBaseListValue();return t.values=e??[],t},e.unwrap=function(e){return e?.hasOwnProperty("values")&&Array.isArray(e.values)?e.values:e}}(ListValue||(ListValue={}));const tsProtoGlobalThis$1=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw"Unable to locate global object"})();function isObject$b(e){return"object"==typeof e&&null!==e}function isSet$1(e){return null!=e}function createBaseComponentData(){return{data:void 0}}var ComponentData,CompositeComponent,CompositeComponent_DataEntry,CompositeDefinition;function createBaseCompositeComponent(){return{name:"",jsonSchema:void 0,data:new Map}}function createBaseCompositeComponent_DataEntry(){return{key:0,value:void 0}}function createBaseCompositeDefinition(){return{version:0,components:[]}}!function(e){e.encode=function(e,t=minimal.Writer.create()){switch(e.data?.$case){case"json":Value.encode(Value.wrap(e.data.json),t.uint32(10).fork()).ldelim();break;case"binary":t.uint32(18).bytes(e.data.binary)}return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseComponentData();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.data={$case:"json",json:Value.unwrap(Value.decode(n,n.uint32()))};continue;case 2:if(18!==e)break;i.data={$case:"binary",binary:n.bytes()};continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i},e.fromJSON=function(e){return{data:isSet(e.json)?{$case:"json",json:e.json}:isSet(e.binary)?{$case:"binary",binary:bytesFromBase64(e.binary)}:void 0}},e.toJSON=function(e){const t={};return"json"===e.data?.$case&&(t.json=e.data?.json),"binary"===e.data?.$case&&(t.binary=void 0!==e.data?.binary?base64FromBytes(e.data?.binary):void 0),t}}(ComponentData||(ComponentData={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return""!==e.name&&t.uint32(10).string(e.name),void 0!==e.jsonSchema&&Value.encode(Value.wrap(e.jsonSchema),t.uint32(18).fork()).ldelim(),e.data.forEach(((e,n)=>{CompositeComponent_DataEntry.encode({key:n,value:e},t.uint32(26).fork()).ldelim()})),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseCompositeComponent();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;i.name=n.string();continue;case 2:if(18!==e)break;i.jsonSchema=Value.unwrap(Value.decode(n,n.uint32()));continue;case 3:if(26!==e)break;const t=CompositeComponent_DataEntry.decode(n,n.uint32());void 0!==t.value&&i.data.set(t.key,t.value);continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i},e.fromJSON=function(e){return{name:isSet(e.name)?String(e.name):"",jsonSchema:isSet(e?.jsonSchema)?e.jsonSchema:void 0,data:isObject$a(e.data)?Object.entries(e.data).reduce(((e,[t,n])=>(e.set(Number(t),ComponentData.fromJSON(n)),e)),new Map):new Map}},e.toJSON=function(e){const t={};return void 0!==e.name&&(t.name=e.name),void 0!==e.jsonSchema&&(t.jsonSchema=e.jsonSchema),t.data={},e.data&&e.data.forEach(((e,n)=>{t.data[n]=ComponentData.toJSON(e)})),t}}(CompositeComponent||(CompositeComponent={})),function(e){e.encode=function(e,t=minimal.Writer.create()){return 0!==e.key&&t.uint32(8).int32(e.key),void 0!==e.value&&ComponentData.encode(e.value,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseCompositeComponent_DataEntry();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.key=n.int32();continue;case 2:if(18!==e)break;i.value=ComponentData.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i},e.fromJSON=function(e){return{key:isSet(e.key)?Number(e.key):0,value:isSet(e.value)?ComponentData.fromJSON(e.value):void 0}},e.toJSON=function(e){const t={};return void 0!==e.key&&(t.key=Math.round(e.key)),void 0!==e.value&&(t.value=e.value?ComponentData.toJSON(e.value):void 0),t}}(CompositeComponent_DataEntry||(CompositeComponent_DataEntry={})),function(e){e.encode=function(e,t=minimal.Writer.create()){0!==e.version&&t.uint32(8).int32(e.version);for(const n of e.components)CompositeComponent.encode(n,t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){const n=e instanceof minimal.Reader?e:minimal.Reader.create(e);let r=void 0===t?n.len:n.pos+t;const i=createBaseCompositeDefinition();for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;i.version=n.int32();continue;case 2:if(18!==e)break;i.components.push(CompositeComponent.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skipType(7&e)}return i},e.fromJSON=function(e){return{version:isSet(e.version)?Number(e.version):0,components:Array.isArray(e?.components)?e.components.map((e=>CompositeComponent.fromJSON(e))):[]}},e.toJSON=function(e){const t={};return void 0!==e.version&&(t.version=Math.round(e.version)),e.components?t.components=e.components.map((e=>e?CompositeComponent.toJSON(e):void 0)):t.components=[],t}}(CompositeDefinition||(CompositeDefinition={}));const tsProtoGlobalThis=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw"Unable to locate global object"})();function bytesFromBase64(e){if(tsProtoGlobalThis.Buffer)return Uint8Array.from(tsProtoGlobalThis.Buffer.from(e,"base64"));{const t=tsProtoGlobalThis.atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n[e]=t.charCodeAt(e);return n}}function base64FromBytes(e){if(tsProtoGlobalThis.Buffer)return tsProtoGlobalThis.Buffer.from(e).toString("base64");{const t=[];return e.forEach((e=>{t.push(String.fromCharCode(e))})),tsProtoGlobalThis.btoa(t.join(""))}}function isObject$a(e){return"object"==typeof e&&null!==e}function isSet(e){return null!=e}var Composite;!function(e){e.fromJson=function(e){return CompositeDefinition.fromJSON(e)},e.fromBinary=function(e){return CompositeDefinition.decode(e)},e.toJson=function(e){return CompositeDefinition.toJSON(e)},e.toBinary=function(e){return CompositeDefinition.encode(e).finish()},e.instance=function(e,t,n,r={}){instanceComposite(e,t,n,r)},e.resolveAndNormalizePath=function(e,t="/"){return resolveComposite(e,t)}}(Composite||(Composite={}));const Transform=Transform$1(engine),Material=Material$1(engine),MeshRenderer=MeshRenderer$1(engine);Name(engine);const Tween=Tween$1(engine);function definePlayerHelper(e){const t=Transform$1(e),n=PlayerIdentityData(e),r=AvatarEquippedData(e),i=AvatarBase(e),o=new Map,a=[],s=[];return e.addSystem((()=>{const t=Array.from(e.getEntitiesWith(n,i));if(t.length!==o.size)for(const[e,n]of t)o.has(e)||(o.set(e,n.address),a.length&&a.forEach((e=>e(getPlayer({userId:n.address})))),i.onChange(e,(t=>{!t&&s.length&&o.get(e)&&(s.forEach((t=>t(o.get(e)))),o.delete(e))})))})),{onEnterScene(e){a.push(e)},onLeaveScene(e){s.push(e)},getPlayer(o){const a=function(){if(!o?.userId)return e.PlayerEntity;for(const[t,r]of e.getEntitiesWith(n))if(r.address===o.userId)return t}();if(!a)return null;const s=n.getOrNull(a),c=i.getOrNull(a),u=r.getOrNull(a);return s||c||u?{entity:a,name:c?.name??"",isGuest:!!s?.isGuest,userId:s?.address??"",avatar:c??void 0,wearables:u?.wearableUrns??[],emotes:u?.emoteUrns??[],position:t.getOrNull(a)?.position}:null}}}const players=definePlayerHelper(engine),{getPlayer:getPlayer,onEnterScene:onEnterScene,onLeaveScene:onLeaveScene}=players;var fails$e=function(e){try{return!!e()}catch(e){return!0}},fails$d=fails$e,functionBindNative=!fails$d((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),NATIVE_BIND$2=functionBindNative,FunctionPrototype$1=Function.prototype,call$b=FunctionPrototype$1.call,uncurryThisWithBind=NATIVE_BIND$2&&FunctionPrototype$1.bind.bind(call$b,call$b),functionUncurryThis=NATIVE_BIND$2?uncurryThisWithBind:function(e){return function(){return call$b.apply(e,arguments)}},uncurryThis$m=functionUncurryThis,toString$8=uncurryThis$m({}.toString),stringSlice$4=uncurryThis$m("".slice),classofRaw$2=function(e){return stringSlice$4(toString$8(e),8,-1)},uncurryThis$l=functionUncurryThis,fails$c=fails$e,classof$5=classofRaw$2,$Object$4=Object,split$3=uncurryThis$l("".split),indexedObject=fails$c((function(){return!$Object$4("z").propertyIsEnumerable(0)}))?function(e){return"String"===classof$5(e)?split$3(e,""):$Object$4(e)}:$Object$4,isNullOrUndefined$3=function(e){return null==e},isNullOrUndefined$2=isNullOrUndefined$3,$TypeError$9=TypeError,requireObjectCoercible$4=function(e){if(isNullOrUndefined$2(e))throw new $TypeError$9("Can't call method on "+e);return e},IndexedObject$1=indexedObject,requireObjectCoercible$3=requireObjectCoercible$4,toIndexedObject$5=function(e){return IndexedObject$1(requireObjectCoercible$3(e))},check=function(e){return e&&e.Math===Math&&e},globalThis_1=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof commonjsGlobal&&commonjsGlobal)||check("object"==typeof commonjsGlobal&&commonjsGlobal)||function(){return this}()||Function("return this")(),sharedStore={exports:{}},isPure=!1,globalThis$f=globalThis_1,defineProperty$6=Object.defineProperty,defineGlobalProperty$3=function(e,t){try{defineProperty$6(globalThis$f,e,{value:t,configurable:!0,writable:!0})}catch(n){globalThis$f[e]=t}return t},globalThis$e=globalThis_1,defineGlobalProperty$2=defineGlobalProperty$3,SHARED="__core-js_shared__",store$3=sharedStore.exports=globalThis$e[SHARED]||defineGlobalProperty$2(SHARED,{});(store$3.versions||(store$3.versions=[])).push({version:"3.41.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"});var store$2=sharedStore.exports,shared$3=function(e,t){return store$2[e]||(store$2[e]=t||{})},requireObjectCoercible$2=requireObjectCoercible$4,$Object$3=Object,toObject$4=function(e){return $Object$3(requireObjectCoercible$2(e))},uncurryThis$k=functionUncurryThis,toObject$3=toObject$4,hasOwnProperty=uncurryThis$k({}.hasOwnProperty),hasOwnProperty_1=Object.hasOwn||function(e,t){return hasOwnProperty(toObject$3(e),t)},uncurryThis$j=functionUncurryThis,id=0,postfix=Math.random(),toString$7=uncurryThis$j(1..toString),uid$2=function(e){return"Symbol("+(void 0===e?"":e)+")_"+toString$7(++id+postfix,36)},globalThis$d=globalThis_1,navigator=globalThis$d.navigator,userAgent$1=navigator&&navigator.userAgent,environmentUserAgent=userAgent$1?String(userAgent$1):"",globalThis$c=globalThis_1,userAgent=environmentUserAgent,process$1=globalThis$c.process,Deno=globalThis$c.Deno,versions=process$1&&process$1.versions||Deno&&Deno.version,v8=versions&&versions.v8,match,version;v8&&(match=v8.split("."),version=match[0]>0&&match[0]<4?1:+(match[0]+match[1])),!version&&userAgent&&(match=userAgent.match(/Edge\/(\d+)/),(!match||match[1]>=74)&&(match=userAgent.match(/Chrome\/(\d+)/),match&&(version=+match[1])));var environmentV8Version=version,V8_VERSION=environmentV8Version,fails$b=fails$e,globalThis$b=globalThis_1,$String$5=globalThis$b.String,symbolConstructorDetection=!!Object.getOwnPropertySymbols&&!fails$b((function(){var e=Symbol("symbol detection");return!$String$5(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&V8_VERSION&&V8_VERSION<41})),NATIVE_SYMBOL$1=symbolConstructorDetection,useSymbolAsUid=NATIVE_SYMBOL$1&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,globalThis$a=globalThis_1,shared$2=shared$3,hasOwn$a=hasOwnProperty_1,uid$1=uid$2,NATIVE_SYMBOL=symbolConstructorDetection,USE_SYMBOL_AS_UID$1=useSymbolAsUid,Symbol$1=globalThis$a.Symbol,WellKnownSymbolsStore=shared$2("wks"),createWellKnownSymbol=USE_SYMBOL_AS_UID$1?Symbol$1.for||Symbol$1:Symbol$1&&Symbol$1.withoutSetter||uid$1,wellKnownSymbol$b=function(e){return hasOwn$a(WellKnownSymbolsStore,e)||(WellKnownSymbolsStore[e]=NATIVE_SYMBOL&&hasOwn$a(Symbol$1,e)?Symbol$1[e]:createWellKnownSymbol("Symbol."+e)),WellKnownSymbolsStore[e]},documentAll="object"==typeof document&&document.all,isCallable$g=void 0===documentAll&&void 0!==documentAll?function(e){return"function"==typeof e||e===documentAll}:function(e){return"function"==typeof e},isCallable$f=isCallable$g,isObject$9=function(e){return"object"==typeof e?null!==e:isCallable$f(e)},isObject$8=isObject$9,$String$4=String,$TypeError$8=TypeError,anObject$8=function(e){if(isObject$8(e))return e;throw new $TypeError$8($String$4(e)+" is not an object")},objectDefineProperties={},fails$a=fails$e,descriptors=!fails$a((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),DESCRIPTORS$f=descriptors,fails$9=fails$e,v8PrototypeDefineBug=DESCRIPTORS$f&&fails$9((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),objectDefineProperty={},globalThis$9=globalThis_1,isObject$7=isObject$9,document$1=globalThis$9.document,EXISTS$1=isObject$7(document$1)&&isObject$7(document$1.createElement),documentCreateElement$1=function(e){return EXISTS$1?document$1.createElement(e):{}},DESCRIPTORS$e=descriptors,fails$8=fails$e,createElement=documentCreateElement$1,ie8DomDefine=!DESCRIPTORS$e&&!fails$8((function(){return 7!==Object.defineProperty(createElement("div"),"a",{get:function(){return 7}}).a})),NATIVE_BIND$1=functionBindNative,call$a=Function.prototype.call,functionCall=NATIVE_BIND$1?call$a.bind(call$a):function(){return call$a.apply(call$a,arguments)},globalThis$8=globalThis_1,isCallable$e=isCallable$g,aFunction=function(e){return isCallable$e(e)?e:void 0},getBuiltIn$7=function(e,t){return arguments.length<2?aFunction(globalThis$8[e]):globalThis$8[e]&&globalThis$8[e][t]},uncurryThis$i=functionUncurryThis,objectIsPrototypeOf=uncurryThis$i({}.isPrototypeOf),getBuiltIn$6=getBuiltIn$7,isCallable$d=isCallable$g,isPrototypeOf$1=objectIsPrototypeOf,USE_SYMBOL_AS_UID=useSymbolAsUid,$Object$2=Object,isSymbol$2=USE_SYMBOL_AS_UID?function(e){return"symbol"==typeof e}:function(e){var t=getBuiltIn$6("Symbol");return isCallable$d(t)&&isPrototypeOf$1(t.prototype,$Object$2(e))},$String$3=String,tryToString$2=function(e){try{return $String$3(e)}catch(e){return"Object"}},isCallable$c=isCallable$g,tryToString$1=tryToString$2,$TypeError$7=TypeError,aCallable$4=function(e){if(isCallable$c(e))return e;throw new $TypeError$7(tryToString$1(e)+" is not a function")},aCallable$3=aCallable$4,isNullOrUndefined$1=isNullOrUndefined$3,getMethod$3=function(e,t){var n=e[t];return isNullOrUndefined$1(n)?void 0:aCallable$3(n)},call$9=functionCall,isCallable$b=isCallable$g,isObject$6=isObject$9,$TypeError$6=TypeError,ordinaryToPrimitive$1=function(e,t){var n,r;if("string"===t&&isCallable$b(n=e.toString)&&!isObject$6(r=call$9(n,e)))return r;if(isCallable$b(n=e.valueOf)&&!isObject$6(r=call$9(n,e)))return r;if("string"!==t&&isCallable$b(n=e.toString)&&!isObject$6(r=call$9(n,e)))return r;throw new $TypeError$6("Can't convert object to primitive value")},call$8=functionCall,isObject$5=isObject$9,isSymbol$1=isSymbol$2,getMethod$2=getMethod$3,ordinaryToPrimitive=ordinaryToPrimitive$1,wellKnownSymbol$a=wellKnownSymbol$b,$TypeError$5=TypeError,TO_PRIMITIVE=wellKnownSymbol$a("toPrimitive"),toPrimitive$1=function(e,t){if(!isObject$5(e)||isSymbol$1(e))return e;var n,r=getMethod$2(e,TO_PRIMITIVE);if(r){if(void 0===t&&(t="default"),n=call$8(r,e,t),!isObject$5(n)||isSymbol$1(n))return n;throw new $TypeError$5("Can't convert object to primitive value")}return void 0===t&&(t="number"),ordinaryToPrimitive(e,t)},toPrimitive=toPrimitive$1,isSymbol=isSymbol$2,toPropertyKey$2=function(e){var t=toPrimitive(e,"string");return isSymbol(t)?t:t+""},DESCRIPTORS$d=descriptors,IE8_DOM_DEFINE$1=ie8DomDefine,V8_PROTOTYPE_DEFINE_BUG$1=v8PrototypeDefineBug,anObject$7=anObject$8,toPropertyKey$1=toPropertyKey$2,$TypeError$4=TypeError,$defineProperty=Object.defineProperty,$getOwnPropertyDescriptor$1=Object.getOwnPropertyDescriptor,ENUMERABLE="enumerable",CONFIGURABLE$1="configurable",WRITABLE="writable";objectDefineProperty.f=DESCRIPTORS$d?V8_PROTOTYPE_DEFINE_BUG$1?function(e,t,n){if(anObject$7(e),t=toPropertyKey$1(t),anObject$7(n),"function"==typeof e&&"prototype"===t&&"value"in n&&WRITABLE in n&&!n[WRITABLE]){var r=$getOwnPropertyDescriptor$1(e,t);r&&r[WRITABLE]&&(e[t]=n.value,n={configurable:CONFIGURABLE$1 in n?n[CONFIGURABLE$1]:r[CONFIGURABLE$1],enumerable:ENUMERABLE in n?n[ENUMERABLE]:r[ENUMERABLE],writable:!1})}return $defineProperty(e,t,n)}:$defineProperty:function(e,t,n){if(anObject$7(e),t=toPropertyKey$1(t),anObject$7(n),IE8_DOM_DEFINE$1)try{return $defineProperty(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new $TypeError$4("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var ceil=Math.ceil,floor$3=Math.floor,mathTrunc=Math.trunc||function(e){var t=+e;return(t>0?floor$3:ceil)(t)},trunc=mathTrunc,toIntegerOrInfinity$3=function(e){var t=+e;return t!=t||0===t?0:trunc(t)},toIntegerOrInfinity$2=toIntegerOrInfinity$3,max=Math.max,min$1=Math.min,toAbsoluteIndex$2=function(e,t){var n=toIntegerOrInfinity$2(e);return n<0?max(n+t,0):min$1(n,t)},toIntegerOrInfinity$1=toIntegerOrInfinity$3,min=Math.min,toLength$1=function(e){var t=toIntegerOrInfinity$1(e);return t>0?min(t,9007199254740991):0},toLength=toLength$1,lengthOfArrayLike$2=function(e){return toLength(e.length)},toIndexedObject$4=toIndexedObject$5,toAbsoluteIndex$1=toAbsoluteIndex$2,lengthOfArrayLike$1=lengthOfArrayLike$2,createMethod$1=function(e){return function(t,n,r){var i=toIndexedObject$4(t),o=lengthOfArrayLike$1(i);if(0===o)return!e&&-1;var a,s=toAbsoluteIndex$1(r,o);if(e&&n!=n){for(;o>s;)if((a=i[s++])!=a)return!0}else for(;o>s;s++)if((e||s in i)&&i[s]===n)return e||s||0;return!e&&-1}},arrayIncludes={includes:createMethod$1(!0),indexOf:createMethod$1(!1)},hiddenKeys$4={},uncurryThis$h=functionUncurryThis,hasOwn$9=hasOwnProperty_1,toIndexedObject$3=toIndexedObject$5,indexOf=arrayIncludes.indexOf,hiddenKeys$3=hiddenKeys$4,push$4=uncurryThis$h([].push),objectKeysInternal=function(e,t){var n,r=toIndexedObject$3(e),i=0,o=[];for(n in r)!hasOwn$9(hiddenKeys$3,n)&&hasOwn$9(r,n)&&push$4(o,n);for(;t.length>i;)hasOwn$9(r,n=t[i++])&&(~indexOf(o,n)||push$4(o,n));return o},enumBugKeys$3=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],internalObjectKeys$1=objectKeysInternal,enumBugKeys$2=enumBugKeys$3,objectKeys$2=Object.keys||function(e){return internalObjectKeys$1(e,enumBugKeys$2)},DESCRIPTORS$c=descriptors,V8_PROTOTYPE_DEFINE_BUG=v8PrototypeDefineBug,definePropertyModule$4=objectDefineProperty,anObject$6=anObject$8,toIndexedObject$2=toIndexedObject$5,objectKeys$1=objectKeys$2;objectDefineProperties.f=DESCRIPTORS$c&&!V8_PROTOTYPE_DEFINE_BUG?Object.defineProperties:function(e,t){anObject$6(e);for(var n,r=toIndexedObject$2(t),i=objectKeys$1(t),o=i.length,a=0;o>a;)definePropertyModule$4.f(e,n=i[a++],r[n]);return e};var getBuiltIn$5=getBuiltIn$7,html$1=getBuiltIn$5("document","documentElement"),shared$1=shared$3,uid=uid$2,keys=shared$1("keys"),sharedKey$3=function(e){return keys[e]||(keys[e]=uid(e))},anObject$5=anObject$8,definePropertiesModule=objectDefineProperties,enumBugKeys$1=enumBugKeys$3,hiddenKeys$2=hiddenKeys$4,html=html$1,documentCreateElement=documentCreateElement$1,sharedKey$2=sharedKey$3,GT=">",LT="<",PROTOTYPE="prototype",SCRIPT="script",IE_PROTO$1=sharedKey$2("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(e){return LT+SCRIPT+GT+e+LT+"/"+SCRIPT+GT},NullProtoObjectViaActiveX=function(e){e.write(scriptTag("")),e.close();var t=e.parentWindow.Object;return e=null,t},NullProtoObjectViaIFrame=function(){var e,t=documentCreateElement("iframe"),n="java"+SCRIPT+":";return t.style.display="none",html.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(scriptTag("document.F=Object")),e.close(),e.F},activeXDocument,NullProtoObject=function(){try{activeXDocument=new ActiveXObject("htmlfile")}catch(e){}NullProtoObject="undefined"!=typeof document?document.domain&&activeXDocument?NullProtoObjectViaActiveX(activeXDocument):NullProtoObjectViaIFrame():NullProtoObjectViaActiveX(activeXDocument);for(var e=enumBugKeys$1.length;e--;)delete NullProtoObject[PROTOTYPE][enumBugKeys$1[e]];return NullProtoObject()};hiddenKeys$2[IE_PROTO$1]=!0;var objectCreate=Object.create||function(e,t){var n;return null!==e?(EmptyConstructor[PROTOTYPE]=anObject$5(e),n=new EmptyConstructor,EmptyConstructor[PROTOTYPE]=null,n[IE_PROTO$1]=e):n=NullProtoObject(),void 0===t?n:definePropertiesModule.f(n,t)},wellKnownSymbol$9=wellKnownSymbol$b,create$2=objectCreate,defineProperty$5=objectDefineProperty.f,UNSCOPABLES=wellKnownSymbol$9("unscopables"),ArrayPrototype$1=Array.prototype;void 0===ArrayPrototype$1[UNSCOPABLES]&&defineProperty$5(ArrayPrototype$1,UNSCOPABLES,{configurable:!0,value:create$2(null)});var addToUnscopables$1=function(e){ArrayPrototype$1[UNSCOPABLES][e]=!0},iterators={},globalThis$7=globalThis_1,isCallable$a=isCallable$g,WeakMap$2=globalThis$7.WeakMap,weakMapBasicDetection=isCallable$a(WeakMap$2)&&/native code/.test(String(WeakMap$2)),createPropertyDescriptor$5=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},DESCRIPTORS$b=descriptors,definePropertyModule$3=objectDefineProperty,createPropertyDescriptor$4=createPropertyDescriptor$5,createNonEnumerableProperty$3=DESCRIPTORS$b?function(e,t,n){return definePropertyModule$3.f(e,t,createPropertyDescriptor$4(1,n))}:function(e,t,n){return e[t]=n,e},NATIVE_WEAK_MAP=weakMapBasicDetection,globalThis$6=globalThis_1,isObject$4=isObject$9,createNonEnumerableProperty$2=createNonEnumerableProperty$3,hasOwn$8=hasOwnProperty_1,shared=sharedStore.exports,sharedKey$1=sharedKey$3,hiddenKeys$1=hiddenKeys$4,OBJECT_ALREADY_INITIALIZED="Object already initialized",TypeError$3=globalThis$6.TypeError,WeakMap$1=globalThis$6.WeakMap,set,get,has,enforce=function(e){return has(e)?get(e):set(e,{})},getterFor=function(e){return function(t){var n;if(!isObject$4(t)||(n=get(t)).type!==e)throw new TypeError$3("Incompatible receiver, "+e+" required");return n}};if(NATIVE_WEAK_MAP||shared.state){var store$1=shared.state||(shared.state=new WeakMap$1);store$1.get=store$1.get,store$1.has=store$1.has,store$1.set=store$1.set,set=function(e,t){if(store$1.has(e))throw new TypeError$3(OBJECT_ALREADY_INITIALIZED);return t.facade=e,store$1.set(e,t),t},get=function(e){return store$1.get(e)||{}},has=function(e){return store$1.has(e)}}else{var STATE=sharedKey$1("state");hiddenKeys$1[STATE]=!0,set=function(e,t){if(hasOwn$8(e,STATE))throw new TypeError$3(OBJECT_ALREADY_INITIALIZED);return t.facade=e,createNonEnumerableProperty$2(e,STATE,t),t},get=function(e){return hasOwn$8(e,STATE)?e[STATE]:{}},has=function(e){return hasOwn$8(e,STATE)}}var internalState={set:set,get:get,has:has,enforce:enforce,getterFor:getterFor},objectGetOwnPropertyDescriptor={},objectPropertyIsEnumerable={},$propertyIsEnumerable={}.propertyIsEnumerable,getOwnPropertyDescriptor$2=Object.getOwnPropertyDescriptor,NASHORN_BUG=getOwnPropertyDescriptor$2&&!$propertyIsEnumerable.call({1:2},1);objectPropertyIsEnumerable.f=NASHORN_BUG?function(e){var t=getOwnPropertyDescriptor$2(this,e);return!!t&&t.enumerable}:$propertyIsEnumerable;var DESCRIPTORS$a=descriptors,call$7=functionCall,propertyIsEnumerableModule$1=objectPropertyIsEnumerable,createPropertyDescriptor$3=createPropertyDescriptor$5,toIndexedObject$1=toIndexedObject$5,toPropertyKey=toPropertyKey$2,hasOwn$7=hasOwnProperty_1,IE8_DOM_DEFINE=ie8DomDefine,$getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;objectGetOwnPropertyDescriptor.f=DESCRIPTORS$a?$getOwnPropertyDescriptor:function(e,t){if(e=toIndexedObject$1(e),t=toPropertyKey(t),IE8_DOM_DEFINE)try{return $getOwnPropertyDescriptor(e,t)}catch(e){}if(hasOwn$7(e,t))return createPropertyDescriptor$3(!call$7(propertyIsEnumerableModule$1.f,e,t),e[t])};var makeBuiltIn$3={exports:{}},DESCRIPTORS$9=descriptors,hasOwn$6=hasOwnProperty_1,FunctionPrototype=Function.prototype,getDescriptor=DESCRIPTORS$9&&Object.getOwnPropertyDescriptor,EXISTS=hasOwn$6(FunctionPrototype,"name"),PROPER=EXISTS&&"something"===function(){}.name,CONFIGURABLE=EXISTS&&(!DESCRIPTORS$9||DESCRIPTORS$9&&getDescriptor(FunctionPrototype,"name").configurable),functionName={EXISTS:EXISTS,PROPER:PROPER,CONFIGURABLE:CONFIGURABLE},uncurryThis$g=functionUncurryThis,isCallable$9=isCallable$g,store=sharedStore.exports,functionToString=uncurryThis$g(Function.toString);isCallable$9(store.inspectSource)||(store.inspectSource=function(e){return functionToString(e)});var inspectSource$2=store.inspectSource,uncurryThis$f=functionUncurryThis,fails$7=fails$e,isCallable$8=isCallable$g,hasOwn$5=hasOwnProperty_1,DESCRIPTORS$8=descriptors,CONFIGURABLE_FUNCTION_NAME$1=functionName.CONFIGURABLE,inspectSource$1=inspectSource$2,InternalStateModule$4=internalState,enforceInternalState=InternalStateModule$4.enforce,getInternalState$2=InternalStateModule$4.get,$String$2=String,defineProperty$4=Object.defineProperty,stringSlice$3=uncurryThis$f("".slice),replace$3=uncurryThis$f("".replace),join$4=uncurryThis$f([].join),CONFIGURABLE_LENGTH=DESCRIPTORS$8&&!fails$7((function(){return 8!==defineProperty$4((function(){}),"length",{value:8}).length})),TEMPLATE=String(String).split("String"),makeBuiltIn$2=makeBuiltIn$3.exports=function(e,t,n){"Symbol("===stringSlice$3($String$2(t),0,7)&&(t="["+replace$3($String$2(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!hasOwn$5(e,"name")||CONFIGURABLE_FUNCTION_NAME$1&&e.name!==t)&&(DESCRIPTORS$8?defineProperty$4(e,"name",{value:t,configurable:!0}):e.name=t),CONFIGURABLE_LENGTH&&n&&hasOwn$5(n,"arity")&&e.length!==n.arity&&defineProperty$4(e,"length",{value:n.arity});try{n&&hasOwn$5(n,"constructor")&&n.constructor?DESCRIPTORS$8&&defineProperty$4(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=enforceInternalState(e);return hasOwn$5(r,"source")||(r.source=join$4(TEMPLATE,"string"==typeof t?t:"")),e};Function.prototype.toString=makeBuiltIn$2((function(){return isCallable$8(this)&&getInternalState$2(this).source||inspectSource$1(this)}),"toString");var isCallable$7=isCallable$g,definePropertyModule$2=objectDefineProperty,makeBuiltIn$1=makeBuiltIn$3.exports,defineGlobalProperty$1=defineGlobalProperty$3,defineBuiltIn$8=function(e,t,n,r){r||(r={});var i=r.enumerable,o=void 0!==r.name?r.name:t;if(isCallable$7(n)&&makeBuiltIn$1(n,o,r),r.global)i?e[t]=n:defineGlobalProperty$1(t,n);else{try{r.unsafe?e[t]&&(i=!0):delete e[t]}catch(e){}i?e[t]=n:definePropertyModule$2.f(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e},objectGetOwnPropertyNames={},internalObjectKeys=objectKeysInternal,enumBugKeys=enumBugKeys$3,hiddenKeys=enumBugKeys.concat("length","prototype");objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(e){return internalObjectKeys(e,hiddenKeys)};var objectGetOwnPropertySymbols={};objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols;var getBuiltIn$4=getBuiltIn$7,uncurryThis$e=functionUncurryThis,getOwnPropertyNamesModule=objectGetOwnPropertyNames,getOwnPropertySymbolsModule$1=objectGetOwnPropertySymbols,anObject$4=anObject$8,concat$1=uncurryThis$e([].concat),ownKeys$1=getBuiltIn$4("Reflect","ownKeys")||function(e){var t=getOwnPropertyNamesModule.f(anObject$4(e)),n=getOwnPropertySymbolsModule$1.f;return n?concat$1(t,n(e)):t},hasOwn$4=hasOwnProperty_1,ownKeys=ownKeys$1,getOwnPropertyDescriptorModule=objectGetOwnPropertyDescriptor,definePropertyModule$1=objectDefineProperty,copyConstructorProperties$1=function(e,t,n){for(var r=ownKeys(t),i=definePropertyModule$1.f,o=getOwnPropertyDescriptorModule.f,a=0;a<r.length;a++){var s=r[a];hasOwn$4(e,s)||n&&hasOwn$4(n,s)||i(e,s,o(t,s))}},fails$6=fails$e,isCallable$6=isCallable$g,replacement=/#|\.prototype\./,isForced$1=function(e,t){var n=data[normalize(e)];return n===POLYFILL||n!==NATIVE&&(isCallable$6(t)?fails$6(t):!!t)},normalize=isForced$1.normalize=function(e){return String(e).replace(replacement,".").toLowerCase()},data=isForced$1.data={},NATIVE=isForced$1.NATIVE="N",POLYFILL=isForced$1.POLYFILL="P",isForced_1=isForced$1,globalThis$5=globalThis_1,getOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f,createNonEnumerableProperty$1=createNonEnumerableProperty$3,defineBuiltIn$7=defineBuiltIn$8,defineGlobalProperty=defineGlobalProperty$3,copyConstructorProperties=copyConstructorProperties$1,isForced=isForced_1,_export=function(e,t){var n,r,i,o,a,s=e.target,c=e.global,u=e.stat;if(n=c?globalThis$5:u?globalThis$5[s]||defineGlobalProperty(s,{}):globalThis$5[s]&&globalThis$5[s].prototype)for(r in t){if(o=t[r],i=e.dontCallGetSet?(a=getOwnPropertyDescriptor$1(n,r))&&a.value:n[r],!isForced(c?r:s+(u?".":"#")+r,e.forced)&&void 0!==i){if(typeof o==typeof i)continue;copyConstructorProperties(o,i)}(e.sham||i&&i.sham)&&createNonEnumerableProperty$1(o,"sham",!0),defineBuiltIn$7(n,r,o,e)}},fails$5=fails$e,correctPrototypeGetter=!fails$5((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),hasOwn$3=hasOwnProperty_1,isCallable$5=isCallable$g,toObject$2=toObject$4,sharedKey=sharedKey$3,CORRECT_PROTOTYPE_GETTER=correctPrototypeGetter,IE_PROTO=sharedKey("IE_PROTO"),$Object$1=Object,ObjectPrototype=$Object$1.prototype,objectGetPrototypeOf=CORRECT_PROTOTYPE_GETTER?$Object$1.getPrototypeOf:function(e){var t=toObject$2(e);if(hasOwn$3(t,IE_PROTO))return t[IE_PROTO];var n=t.constructor;return isCallable$5(n)&&t instanceof n?n.prototype:t instanceof $Object$1?ObjectPrototype:null},fails$4=fails$e,isCallable$4=isCallable$g,isObject$3=isObject$9,getPrototypeOf$1=objectGetPrototypeOf,defineBuiltIn$6=defineBuiltIn$8,wellKnownSymbol$8=wellKnownSymbol$b,ITERATOR$5=wellKnownSymbol$8("iterator"),BUGGY_SAFARI_ITERATORS$1=!1,IteratorPrototype$2,PrototypeOfArrayIteratorPrototype,arrayIterator;[].keys&&(arrayIterator=[].keys(),"next"in arrayIterator?(PrototypeOfArrayIteratorPrototype=getPrototypeOf$1(getPrototypeOf$1(arrayIterator)),PrototypeOfArrayIteratorPrototype!==Object.prototype&&(IteratorPrototype$2=PrototypeOfArrayIteratorPrototype)):BUGGY_SAFARI_ITERATORS$1=!0);var NEW_ITERATOR_PROTOTYPE=!isObject$3(IteratorPrototype$2)||fails$4((function(){var e={};return IteratorPrototype$2[ITERATOR$5].call(e)!==e}));NEW_ITERATOR_PROTOTYPE&&(IteratorPrototype$2={}),isCallable$4(IteratorPrototype$2[ITERATOR$5])||defineBuiltIn$6(IteratorPrototype$2,ITERATOR$5,(function(){return this}));var iteratorsCore={IteratorPrototype:IteratorPrototype$2,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS$1},defineProperty$3=objectDefineProperty.f,hasOwn$2=hasOwnProperty_1,wellKnownSymbol$7=wellKnownSymbol$b,TO_STRING_TAG$2=wellKnownSymbol$7("toStringTag"),setToStringTag$4=function(e,t,n){e&&!n&&(e=e.prototype),e&&!hasOwn$2(e,TO_STRING_TAG$2)&&defineProperty$3(e,TO_STRING_TAG$2,{configurable:!0,value:t})},IteratorPrototype$1=iteratorsCore.IteratorPrototype,create$1=objectCreate,createPropertyDescriptor$2=createPropertyDescriptor$5,setToStringTag$3=setToStringTag$4,Iterators$4=iterators,returnThis$1=function(){return this},iteratorCreateConstructor=function(e,t,n,r){var i=t+" Iterator";return e.prototype=create$1(IteratorPrototype$1,{next:createPropertyDescriptor$2(+!r,n)}),setToStringTag$3(e,i,!1),Iterators$4[i]=returnThis$1,e},uncurryThis$d=functionUncurryThis,aCallable$2=aCallable$4,functionUncurryThisAccessor=function(e,t,n){try{return uncurryThis$d(aCallable$2(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}},isObject$2=isObject$9,isPossiblePrototype$1=function(e){return isObject$2(e)||null===e},isPossiblePrototype=isPossiblePrototype$1,$String$1=String,$TypeError$3=TypeError,aPossiblePrototype$1=function(e){if(isPossiblePrototype(e))return e;throw new $TypeError$3("Can't set "+$String$1(e)+" as a prototype")},uncurryThisAccessor=functionUncurryThisAccessor,isObject$1=isObject$9,requireObjectCoercible$1=requireObjectCoercible$4,aPossiblePrototype=aPossiblePrototype$1,objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=uncurryThisAccessor(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return requireObjectCoercible$1(n),aPossiblePrototype(r),isObject$1(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0),$$6=_export,call$6=functionCall,FunctionName=functionName,isCallable$3=isCallable$g,createIteratorConstructor$1=iteratorCreateConstructor,getPrototypeOf=objectGetPrototypeOf,setPrototypeOf=objectSetPrototypeOf,setToStringTag$2=setToStringTag$4,createNonEnumerableProperty=createNonEnumerableProperty$3,defineBuiltIn$5=defineBuiltIn$8,wellKnownSymbol$6=wellKnownSymbol$b,Iterators$3=iterators,IteratorsCore=iteratorsCore,PROPER_FUNCTION_NAME=FunctionName.PROPER,CONFIGURABLE_FUNCTION_NAME=FunctionName.CONFIGURABLE,IteratorPrototype=IteratorsCore.IteratorPrototype,BUGGY_SAFARI_ITERATORS=IteratorsCore.BUGGY_SAFARI_ITERATORS,ITERATOR$4=wellKnownSymbol$6("iterator"),KEYS="keys",VALUES="values",ENTRIES="entries",returnThis=function(){return this},iteratorDefine=function(e,t,n,r,i,o,a){createIteratorConstructor$1(n,t,r);var s,c,u,l=function(e){if(e===i&&m)return m;if(!BUGGY_SAFARI_ITERATORS&&e&&e in h)return h[e];switch(e){case KEYS:case VALUES:case ENTRIES:return function(){return new n(this,e)}}return function(){return new n(this)}},f=t+" Iterator",d=!1,h=e.prototype,p=h[ITERATOR$4]||h["@@iterator"]||i&&h[i],m=!BUGGY_SAFARI_ITERATORS&&p||l(i),y="Array"===t&&h.entries||p;if(y&&(s=getPrototypeOf(y.call(new e)))!==Object.prototype&&s.next&&(getPrototypeOf(s)!==IteratorPrototype&&(setPrototypeOf?setPrototypeOf(s,IteratorPrototype):isCallable$3(s[ITERATOR$4])||defineBuiltIn$5(s,ITERATOR$4,returnThis)),setToStringTag$2(s,f,!0)),PROPER_FUNCTION_NAME&&i===VALUES&&p&&p.name!==VALUES&&(CONFIGURABLE_FUNCTION_NAME?createNonEnumerableProperty(h,"name",VALUES):(d=!0,m=function(){return call$6(p,this)})),i)if(c={values:l(VALUES),keys:o?m:l(KEYS),entries:l(ENTRIES)},a)for(u in c)(BUGGY_SAFARI_ITERATORS||d||!(u in h))&&defineBuiltIn$5(h,u,c[u]);else $$6({target:t,proto:!0,forced:BUGGY_SAFARI_ITERATORS||d},c);return h[ITERATOR$4]!==m&&defineBuiltIn$5(h,ITERATOR$4,m,{name:i}),Iterators$3[t]=m,c},createIterResultObject$3=function(e,t){return{value:e,done:t}},toIndexedObject=toIndexedObject$5,addToUnscopables=addToUnscopables$1,Iterators$2=iterators,InternalStateModule$3=internalState,defineProperty$2=objectDefineProperty.f,defineIterator$1=iteratorDefine,createIterResultObject$2=createIterResultObject$3,DESCRIPTORS$7=descriptors,ARRAY_ITERATOR="Array Iterator",setInternalState$3=InternalStateModule$3.set,getInternalState$1=InternalStateModule$3.getterFor(ARRAY_ITERATOR);defineIterator$1(Array,"Array",(function(e,t){setInternalState$3(this,{type:ARRAY_ITERATOR,target:toIndexedObject(e),index:0,kind:t})}),(function(){var e=getInternalState$1(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=null,createIterResultObject$2(void 0,!0);switch(e.kind){case"keys":return createIterResultObject$2(n,!1);case"values":return createIterResultObject$2(t[n],!1)}return createIterResultObject$2([n,t[n]],!1)}),"values");var values=Iterators$2.Arguments=Iterators$2.Array;if(addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries"),DESCRIPTORS$7&&"values"!==values.name)try{defineProperty$2(values,"name",{value:"values"})}catch(e){}var $$5=_export,uncurryThis$c=functionUncurryThis,toAbsoluteIndex=toAbsoluteIndex$2,$RangeError$1=RangeError,fromCharCode$2=String.fromCharCode,$fromCodePoint=String.fromCodePoint,join$3=uncurryThis$c([].join),INCORRECT_LENGTH=!!$fromCodePoint&&1!==$fromCodePoint.length;$$5({target:"String",stat:!0,arity:1,forced:INCORRECT_LENGTH},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,i=0;r>i;){if(t=+arguments[i++],toAbsoluteIndex(t,1114111)!==t)throw new $RangeError$1(t+" is not a valid code point");n[i]=t<65536?fromCharCode$2(t):fromCharCode$2(55296+((t-=65536)>>10),t%1024+56320)}return join$3(n,"")}});var globalThis$4=globalThis_1,DESCRIPTORS$6=descriptors,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,safeGetBuiltIn$1=function(e){if(!DESCRIPTORS$6)return globalThis$4[e];var t=getOwnPropertyDescriptor(globalThis$4,e);return t&&t.value},fails$3=fails$e,wellKnownSymbol$5=wellKnownSymbol$b,DESCRIPTORS$5=descriptors,IS_PURE=isPure,ITERATOR$3=wellKnownSymbol$5("iterator"),urlConstructorDetection=!fails$3((function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,n=new URLSearchParams("a=1&a=2&b=3"),r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),n.delete("a",2),n.delete("b",void 0),IS_PURE&&(!e.toJSON||!n.has("a",1)||n.has("a",2)||!n.has("a",void 0)||n.has("b"))||!t.size&&(IS_PURE||!DESCRIPTORS$5)||!t.sort||"https://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[ITERATOR$3]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://тест").host||"#%D0%B1"!==new URL("https://a#б").hash||"a1c3"!==r||"x"!==new URL("https://x",void 0).host})),makeBuiltIn=makeBuiltIn$3.exports,defineProperty$1=objectDefineProperty,defineBuiltInAccessor$3=function(e,t,n){return n.get&&makeBuiltIn(n.get,t,{getter:!0}),n.set&&makeBuiltIn(n.set,t,{setter:!0}),defineProperty$1.f(e,t,n)},defineBuiltIn$4=defineBuiltIn$8,defineBuiltIns$1=function(e,t,n){for(var r in t)defineBuiltIn$4(e,r,t[r],n);return e},isPrototypeOf=objectIsPrototypeOf,$TypeError$2=TypeError,anInstance$2=function(e,t){if(isPrototypeOf(t,e))return e;throw new $TypeError$2("Incorrect invocation")},classofRaw$1=classofRaw$2,uncurryThis$b=functionUncurryThis,functionUncurryThisClause=function(e){if("Function"===classofRaw$1(e))return uncurryThis$b(e)},uncurryThis$a=functionUncurryThisClause,aCallable$1=aCallable$4,NATIVE_BIND=functionBindNative,bind$3=uncurryThis$a(uncurryThis$a.bind),functionBindContext=function(e,t){return aCallable$1(e),void 0===t?e:NATIVE_BIND?bind$3(e,t):function(){return e.apply(t,arguments)}},wellKnownSymbol$4=wellKnownSymbol$b,TO_STRING_TAG$1=wellKnownSymbol$4("toStringTag"),test={};test[TO_STRING_TAG$1]="z";var toStringTagSupport="[object z]"===String(test),TO_STRING_TAG_SUPPORT=toStringTagSupport,isCallable$2=isCallable$g,classofRaw=classofRaw$2,wellKnownSymbol$3=wellKnownSymbol$b,TO_STRING_TAG=wellKnownSymbol$3("toStringTag"),$Object=Object,CORRECT_ARGUMENTS="Arguments"===classofRaw(function(){return arguments}()),tryGet=function(e,t){try{return e[t]}catch(e){}},classof$4=TO_STRING_TAG_SUPPORT?classofRaw:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=tryGet(t=$Object(e),TO_STRING_TAG))?n:CORRECT_ARGUMENTS?classofRaw(t):"Object"===(r=classofRaw(t))&&isCallable$2(t.callee)?"Arguments":r},classof$3=classof$4,$String=String,toString$6=function(e){if("Symbol"===classof$3(e))throw new TypeError("Cannot convert a Symbol value to a string");return $String(e)},classof$2=classof$4,getMethod$1=getMethod$3,isNullOrUndefined=isNullOrUndefined$3,Iterators$1=iterators,wellKnownSymbol$2=wellKnownSymbol$b,ITERATOR$2=wellKnownSymbol$2("iterator"),getIteratorMethod$3=function(e){if(!isNullOrUndefined(e))return getMethod$1(e,ITERATOR$2)||getMethod$1(e,"@@iterator")||Iterators$1[classof$2(e)]},call$5=functionCall,aCallable=aCallable$4,anObject$3=anObject$8,tryToString=tryToString$2,getIteratorMethod$2=getIteratorMethod$3,$TypeError$1=TypeError,getIterator$2=function(e,t){var n=arguments.length<2?getIteratorMethod$2(e):t;if(aCallable(n))return anObject$3(call$5(n,e));throw new $TypeError$1(tryToString(e)+" is not iterable")},$TypeError=TypeError,validateArgumentsLength$6=function(e,t){if(e<t)throw new $TypeError("Not enough arguments");return e},uncurryThis$9=functionUncurryThis,arraySlice$2=uncurryThis$9([].slice),arraySlice$1=arraySlice$2,floor$2=Math.floor,sort=function(e,t){var n=e.length;if(n<8)for(var r,i,o=1;o<n;){for(i=o,r=e[o];i&&t(e[i-1],r)>0;)e[i]=e[--i];i!==o++&&(e[i]=r)}else for(var a=floor$2(n/2),s=sort(arraySlice$1(e,0,a),t),c=sort(arraySlice$1(e,a),t),u=s.length,l=c.length,f=0,d=0;f<u||d<l;)e[f+d]=f<u&&d<l?t(s[f],c[d])<=0?s[f++]:c[d++]:f<u?s[f++]:c[d++];return e},arraySort$1=sort,$$4=_export,globalThis$3=globalThis_1,safeGetBuiltIn=safeGetBuiltIn$1,getBuiltIn$3=getBuiltIn$7,call$4=functionCall,uncurryThis$8=functionUncurryThis,DESCRIPTORS$4=descriptors,USE_NATIVE_URL$3=urlConstructorDetection,defineBuiltIn$3=defineBuiltIn$8,defineBuiltInAccessor$2=defineBuiltInAccessor$3,defineBuiltIns=defineBuiltIns$1,setToStringTag$1=setToStringTag$4,createIteratorConstructor=iteratorCreateConstructor,InternalStateModule$2=internalState,anInstance$1=anInstance$2,isCallable$1=isCallable$g,hasOwn$1=hasOwnProperty_1,bind$2=functionBindContext,classof$1=classof$4,anObject$2=anObject$8,isObject=isObject$9,$toString$1=toString$6,create=objectCreate,createPropertyDescriptor$1=createPropertyDescriptor$5,getIterator$1=getIterator$2,getIteratorMethod$1=getIteratorMethod$3,createIterResultObject$1=createIterResultObject$3,validateArgumentsLength$5=validateArgumentsLength$6,wellKnownSymbol$1=wellKnownSymbol$b,arraySort=arraySort$1,ITERATOR$1=wellKnownSymbol$1("iterator"),URL_SEARCH_PARAMS="URLSearchParams",URL_SEARCH_PARAMS_ITERATOR=URL_SEARCH_PARAMS+"Iterator",setInternalState$2=InternalStateModule$2.set,getInternalParamsState=InternalStateModule$2.getterFor(URL_SEARCH_PARAMS),getInternalIteratorState=InternalStateModule$2.getterFor(URL_SEARCH_PARAMS_ITERATOR),nativeFetch=safeGetBuiltIn("fetch"),NativeRequest=safeGetBuiltIn("Request"),Headers=safeGetBuiltIn("Headers"),RequestPrototype=NativeRequest&&NativeRequest.prototype,HeadersPrototype=Headers&&Headers.prototype,TypeError$2=globalThis$3.TypeError,encodeURIComponent$1=globalThis$3.encodeURIComponent,fromCharCode$1=String.fromCharCode,fromCodePoint=getBuiltIn$3("String","fromCodePoint"),$parseInt=parseInt,charAt$3=uncurryThis$8("".charAt),join$2=uncurryThis$8([].join),push$3=uncurryThis$8([].push),replace$2=uncurryThis$8("".replace),shift$1=uncurryThis$8([].shift),splice=uncurryThis$8([].splice),split$2=uncurryThis$8("".split),stringSlice$2=uncurryThis$8("".slice),exec$3=uncurryThis$8(/./.exec),plus=/\+/g,FALLBACK_REPLACER="�",VALID_HEX=/^[0-9a-f]+$/i,parseHexOctet=function(e,t){var n=stringSlice$2(e,t,t+2);return exec$3(VALID_HEX,n)?$parseInt(n,16):NaN},getLeadingOnes=function(e){for(var t=0,n=128;n>0&&e&n;n>>=1)t++;return t},utf8Decode=function(e){var t=null;switch(e.length){case 1:t=e[0];break;case 2:t=(31&e[0])<<6|63&e[1];break;case 3:t=(15&e[0])<<12|(63&e[1])<<6|63&e[2];break;case 4:t=(7&e[0])<<18|(63&e[1])<<12|(63&e[2])<<6|63&e[3]}return t>1114111?null:t},decode=function(e){for(var t=(e=replace$2(e,plus," ")).length,n="",r=0;r<t;){var i=charAt$3(e,r);if("%"===i){if("%"===charAt$3(e,r+1)||r+3>t){n+="%",r++;continue}var o=parseHexOctet(e,r+1);if(o!=o){n+=i,r++;continue}r+=2;var a=getLeadingOnes(o);if(0===a)i=fromCharCode$1(o);else{if(1===a||a>4){n+=FALLBACK_REPLACER,r++;continue}for(var s=[o],c=1;c<a&&!(++r+3>t||"%"!==charAt$3(e,r));){var u=parseHexOctet(e,r+1);if(u!=u){r+=3;break}if(u>191||u<128)break;push$3(s,u),r+=2,c++}if(s.length!==a){n+=FALLBACK_REPLACER;continue}var l=utf8Decode(s);null===l?n+=FALLBACK_REPLACER:i=fromCodePoint(l)}}n+=i,r++}return n},find=/[!'()~]|%20/g,replacements={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},replacer=function(e){return replacements[e]},serialize=function(e){return replace$2(encodeURIComponent$1(e),find,replacer)},URLSearchParamsIterator=createIteratorConstructor((function(e,t){setInternalState$2(this,{type:URL_SEARCH_PARAMS_ITERATOR,target:getInternalParamsState(e).entries,index:0,kind:t})}),URL_SEARCH_PARAMS,(function(){var e=getInternalIteratorState(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=null,createIterResultObject$1(void 0,!0);var r=t[n];switch(e.kind){case"keys":return createIterResultObject$1(r.key,!1);case"values":return createIterResultObject$1(r.value,!1)}return createIterResultObject$1([r.key,r.value],!1)}),!0),URLSearchParamsState=function(e){this.entries=[],this.url=null,void 0!==e&&(isObject(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===charAt$3(e,0)?stringSlice$2(e,1):e:$toString$1(e)))};URLSearchParamsState.prototype={type:URL_SEARCH_PARAMS,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,i,o,a,s,c=this.entries,u=getIteratorMethod$1(e);if(u)for(n=(t=getIterator$1(e,u)).next;!(r=call$4(n,t)).done;){if(o=(i=getIterator$1(anObject$2(r.value))).next,(a=call$4(o,i)).done||(s=call$4(o,i)).done||!call$4(o,i).done)throw new TypeError$2("Expected sequence with length 2");push$3(c,{key:$toString$1(a.value),value:$toString$1(s.value)})}else for(var l in e)hasOwn$1(e,l)&&push$3(c,{key:l,value:$toString$1(e[l])})},parseQuery:function(e){if(e)for(var t,n,r=this.entries,i=split$2(e,"&"),o=0;o<i.length;)(t=i[o++]).length&&(n=split$2(t,"="),push$3(r,{key:decode(shift$1(n)),value:decode(join$2(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],push$3(n,serialize(e.key)+"="+serialize(e.value));return join$2(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var URLSearchParamsConstructor=function(){anInstance$1(this,URLSearchParamsPrototype$3);var e=setInternalState$2(this,new URLSearchParamsState(arguments.length>0?arguments[0]:void 0));DESCRIPTORS$4||(this.size=e.entries.length)},URLSearchParamsPrototype$3=URLSearchParamsConstructor.prototype;if(defineBuiltIns(URLSearchParamsPrototype$3,{append:function(e,t){var n=getInternalParamsState(this);validateArgumentsLength$5(arguments.length,2),push$3(n.entries,{key:$toString$1(e),value:$toString$1(t)}),DESCRIPTORS$4||this.length++,n.updateURL()},delete:function(e){for(var t=getInternalParamsState(this),n=validateArgumentsLength$5(arguments.length,1),r=t.entries,i=$toString$1(e),o=n<2?void 0:arguments[1],a=void 0===o?o:$toString$1(o),s=0;s<r.length;){var c=r[s];if(c.key!==i||void 0!==a&&c.value!==a)s++;else if(splice(r,s,1),void 0!==a)break}DESCRIPTORS$4||(this.size=r.length),t.updateURL()},get:function(e){var t=getInternalParamsState(this).entries;validateArgumentsLength$5(arguments.length,1);for(var n=$toString$1(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){var t=getInternalParamsState(this).entries;validateArgumentsLength$5(arguments.length,1);for(var n=$toString$1(e),r=[],i=0;i<t.length;i++)t[i].key===n&&push$3(r,t[i].value);return r},has:function(e){for(var t=getInternalParamsState(this).entries,n=validateArgumentsLength$5(arguments.length,1),r=$toString$1(e),i=n<2?void 0:arguments[1],o=void 0===i?i:$toString$1(i),a=0;a<t.length;){var s=t[a++];if(s.key===r&&(void 0===o||s.value===o))return!0}return!1},set:function(e,t){var n=getInternalParamsState(this);validateArgumentsLength$5(arguments.length,1);for(var r,i=n.entries,o=!1,a=$toString$1(e),s=$toString$1(t),c=0;c<i.length;c++)(r=i[c]).key===a&&(o?splice(i,c--,1):(o=!0,r.value=s));o||push$3(i,{key:a,value:s}),DESCRIPTORS$4||(this.size=i.length),n.updateURL()},sort:function(){var e=getInternalParamsState(this);arraySort(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=getInternalParamsState(this).entries,r=bind$2(e,arguments.length>1?arguments[1]:void 0),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new URLSearchParamsIterator(this,"keys")},values:function(){return new URLSearchParamsIterator(this,"values")},entries:function(){return new URLSearchParamsIterator(this,"entries")}},{enumerable:!0}),defineBuiltIn$3(URLSearchParamsPrototype$3,ITERATOR$1,URLSearchParamsPrototype$3.entries,{name:"entries"}),defineBuiltIn$3(URLSearchParamsPrototype$3,"toString",(function(){return getInternalParamsState(this).serialize()}),{enumerable:!0}),DESCRIPTORS$4&&defineBuiltInAccessor$2(URLSearchParamsPrototype$3,"size",{get:function(){return getInternalParamsState(this).entries.length},configurable:!0,enumerable:!0}),setToStringTag$1(URLSearchParamsConstructor,URL_SEARCH_PARAMS),$$4({global:!0,constructor:!0,forced:!USE_NATIVE_URL$3},{URLSearchParams:URLSearchParamsConstructor}),!USE_NATIVE_URL$3&&isCallable$1(Headers)){var headersHas=uncurryThis$8(HeadersPrototype.has),headersSet=uncurryThis$8(HeadersPrototype.set),wrapRequestOptions=function(e){if(isObject(e)){var t,n=e.body;if(classof$1(n)===URL_SEARCH_PARAMS)return t=e.headers?new Headers(e.headers):new Headers,headersHas(t,"content-type")||headersSet(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),create(e,{body:createPropertyDescriptor$1(0,$toString$1(n)),headers:createPropertyDescriptor$1(0,t)})}return e};if(isCallable$1(nativeFetch)&&$$4({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return nativeFetch(e,arguments.length>1?wrapRequestOptions(arguments[1]):{})}}),isCallable$1(NativeRequest)){var RequestConstructor=function(e){return anInstance$1(this,RequestPrototype),new NativeRequest(e,arguments.length>1?wrapRequestOptions(arguments[1]):{})};RequestPrototype.constructor=RequestConstructor,RequestConstructor.prototype=RequestPrototype,$$4({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:RequestConstructor})}}var web_urlSearchParams_constructor={URLSearchParams:URLSearchParamsConstructor,getState:getInternalParamsState},defineBuiltIn$2=defineBuiltIn$8,uncurryThis$7=functionUncurryThis,toString$5=toString$6,validateArgumentsLength$4=validateArgumentsLength$6,$URLSearchParams$1=URLSearchParams,URLSearchParamsPrototype$2=$URLSearchParams$1.prototype,append=uncurryThis$7(URLSearchParamsPrototype$2.append),$delete=uncurryThis$7(URLSearchParamsPrototype$2.delete),forEach$1=uncurryThis$7(URLSearchParamsPrototype$2.forEach),push$2=uncurryThis$7([].push),params$1=new $URLSearchParams$1("a=1&a=2&b=3");params$1.delete("a",1),params$1.delete("b",void 0),params$1+""!="a=2"&&defineBuiltIn$2(URLSearchParamsPrototype$2,"delete",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return $delete(this,e);var r=[];forEach$1(this,(function(e,t){push$2(r,{key:t,value:e})})),validateArgumentsLength$4(t,1);for(var i,o=toString$5(e),a=toString$5(n),s=0,c=0,u=!1,l=r.length;s<l;)i=r[s++],u||i.key===o?(u=!0,$delete(this,i.key)):c++;for(;c<l;)(i=r[c++]).key===o&&i.value===a||append(this,i.key,i.value)}),{enumerable:!0,unsafe:!0});var defineBuiltIn$1=defineBuiltIn$8,uncurryThis$6=functionUncurryThis,toString$4=toString$6,validateArgumentsLength$3=validateArgumentsLength$6,$URLSearchParams=URLSearchParams,URLSearchParamsPrototype$1=$URLSearchParams.prototype,getAll=uncurryThis$6(URLSearchParamsPrototype$1.getAll),$has=uncurryThis$6(URLSearchParamsPrototype$1.has),params=new $URLSearchParams("a=1");!params.has("a",2)&&params.has("a",void 0)||defineBuiltIn$1(URLSearchParamsPrototype$1,"has",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return $has(this,e);var r=getAll(this,e);validateArgumentsLength$3(t,1);for(var i=toString$4(n),o=0;o<r.length;)if(r[o++]===i)return!0;return!1}),{enumerable:!0,unsafe:!0});var DESCRIPTORS$3=descriptors,uncurryThis$5=functionUncurryThis,defineBuiltInAccessor$1=defineBuiltInAccessor$3,URLSearchParamsPrototype=URLSearchParams.prototype,forEach=uncurryThis$5(URLSearchParamsPrototype.forEach);DESCRIPTORS$3&&!("size"in URLSearchParamsPrototype)&&defineBuiltInAccessor$1(URLSearchParamsPrototype,"size",{get:function(){var e=0;return forEach(this,(function(){e++})),e},configurable:!0,enumerable:!0});var globalThis$2=globalThis_1,path$2=globalThis$2,path$1=path$2;path$1.URLSearchParams;var uncurryThis$4=functionUncurryThis,toIntegerOrInfinity=toIntegerOrInfinity$3,toString$3=toString$6,requireObjectCoercible=requireObjectCoercible$4,charAt$2=uncurryThis$4("".charAt),charCodeAt$1=uncurryThis$4("".charCodeAt),stringSlice$1=uncurryThis$4("".slice),createMethod=function(e){return function(t,n){var r,i,o=toString$3(requireObjectCoercible(t)),a=toIntegerOrInfinity(n),s=o.length;return a<0||a>=s?e?"":void 0:(r=charCodeAt$1(o,a))<55296||r>56319||a+1===s||(i=charCodeAt$1(o,a+1))<56320||i>57343?e?charAt$2(o,a):r:e?stringSlice$1(o,a,a+2):i-56320+(r-55296<<10)+65536}},stringMultibyte={codeAt:createMethod(!1),charAt:createMethod(!0)},charAt$1=stringMultibyte.charAt,toString$2=toString$6,InternalStateModule$1=internalState,defineIterator=iteratorDefine,createIterResultObject=createIterResultObject$3,STRING_ITERATOR="String Iterator",setInternalState$1=InternalStateModule$1.set,getInternalState=InternalStateModule$1.getterFor(STRING_ITERATOR);defineIterator(String,"String",(function(e){setInternalState$1(this,{type:STRING_ITERATOR,string:toString$2(e),index:0})}),(function(){var e,t=getInternalState(this),n=t.string,r=t.index;return r>=n.length?createIterResultObject(void 0,!0):(e=charAt$1(n,r),t.index+=e.length,createIterResultObject(e,!1))}));var DESCRIPTORS$2=descriptors,uncurryThis$3=functionUncurryThis,call$3=functionCall,fails$2=fails$e,objectKeys=objectKeys$2,getOwnPropertySymbolsModule=objectGetOwnPropertySymbols,propertyIsEnumerableModule=objectPropertyIsEnumerable,toObject$1=toObject$4,IndexedObject=indexedObject,$assign=Object.assign,defineProperty=Object.defineProperty,concat=uncurryThis$3([].concat),objectAssign=!$assign||fails$2((function(){if(DESCRIPTORS$2&&1!==$assign({b:1},$assign(defineProperty({},"a",{enumerable:!0,get:function(){defineProperty(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol("assign detection"),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!==$assign({},e)[n]||objectKeys($assign({},t)).join("")!==r}))?function(e,t){for(var n=toObject$1(e),r=arguments.length,i=1,o=getOwnPropertySymbolsModule.f,a=propertyIsEnumerableModule.f;r>i;)for(var s,c=IndexedObject(arguments[i++]),u=o?concat(objectKeys(c),o(c)):objectKeys(c),l=u.length,f=0;l>f;)s=u[f++],DESCRIPTORS$2&&!call$3(a,c,s)||(n[s]=c[s]);return n}:$assign,call$2=functionCall,anObject$1=anObject$8,getMethod=getMethod$3,iteratorClose$1=function(e,t,n){var r,i;anObject$1(e);try{if(!(r=getMethod(e,"return"))){if("throw"===t)throw n;return n}r=call$2(r,e)}catch(e){i=!0,r=e}if("throw"===t)throw n;if(i)throw r;return anObject$1(r),n},anObject=anObject$8,iteratorClose=iteratorClose$1,callWithSafeIterationClosing$1=function(e,t,n,r){try{return r?t(anObject(n)[0],n[1]):t(n)}catch(t){iteratorClose(e,"throw",t)}},wellKnownSymbol=wellKnownSymbol$b,Iterators=iterators,ITERATOR=wellKnownSymbol("iterator"),ArrayPrototype=Array.prototype,isArrayIteratorMethod$1=function(e){return void 0!==e&&(Iterators.Array===e||ArrayPrototype[ITERATOR]===e)},uncurryThis$2=functionUncurryThis,fails$1=fails$e,isCallable=isCallable$g,classof=classof$4,getBuiltIn$2=getBuiltIn$7,inspectSource=inspectSource$2,noop=function(){},construct=getBuiltIn$2("Reflect","construct"),constructorRegExp=/^\s*(?:class|function)\b/,exec$2=uncurryThis$2(constructorRegExp.exec),INCORRECT_TO_STRING=!constructorRegExp.test(noop),isConstructorModern=function(e){if(!isCallable(e))return!1;try{return construct(noop,[],e),!0}catch(e){return!1}},isConstructorLegacy=function(e){if(!isCallable(e))return!1;switch(classof(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return INCORRECT_TO_STRING||!!exec$2(constructorRegExp,inspectSource(e))}catch(e){return!0}};isConstructorLegacy.sham=!0;var isConstructor$1=!construct||fails$1((function(){var e;return isConstructorModern(isConstructorModern.call)||!isConstructorModern(Object)||!isConstructorModern((function(){e=!0}))||e}))?isConstructorLegacy:isConstructorModern,DESCRIPTORS$1=descriptors,definePropertyModule=objectDefineProperty,createPropertyDescriptor=createPropertyDescriptor$5,createProperty$1=function(e,t,n){DESCRIPTORS$1?definePropertyModule.f(e,t,createPropertyDescriptor(0,n)):e[t]=n},bind$1=functionBindContext,call$1=functionCall,toObject=toObject$4,callWithSafeIterationClosing=callWithSafeIterationClosing$1,isArrayIteratorMethod=isArrayIteratorMethod$1,isConstructor=isConstructor$1,lengthOfArrayLike=lengthOfArrayLike$2,createProperty=createProperty$1,getIterator=getIterator$2,getIteratorMethod=getIteratorMethod$3,$Array=Array,arrayFrom$1=function(e){var t=toObject(e),n=isConstructor(this),r=arguments.length,i=r>1?arguments[1]:void 0,o=void 0!==i;o&&(i=bind$1(i,r>2?arguments[2]:void 0));var a,s,c,u,l,f,d=getIteratorMethod(t),h=0;if(!d||this===$Array&&isArrayIteratorMethod(d))for(a=lengthOfArrayLike(t),s=n?new this(a):$Array(a);a>h;h++)f=o?i(t[h],h):t[h],createProperty(s,h,f);else for(s=n?new this:[],l=(u=getIterator(t,d)).next;!(c=call$1(l,u)).done;h++)f=o?callWithSafeIterationClosing(u,i,[c.value,h],!0):c.value,createProperty(s,h,f);return s.length=h,s},uncurryThis$1=functionUncurryThis,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexNonASCII=/[^\0-\u007E]/,regexSeparators=/[.\u3002\uFF0E\uFF61]/g,OVERFLOW_ERROR="Overflow: input needs wider integers to process",baseMinusTMin=base-tMin,$RangeError=RangeError,exec$1=uncurryThis$1(regexSeparators.exec),floor$1=Math.floor,fromCharCode=String.fromCharCode,charCodeAt=uncurryThis$1("".charCodeAt),join$1=uncurryThis$1([].join),push$1=uncurryThis$1([].push),replace$1=uncurryThis$1("".replace),split$1=uncurryThis$1("".split),toLowerCase$1=uncurryThis$1("".toLowerCase),ucs2decode=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=charCodeAt(e,n++);if(i>=55296&&i<=56319&&n<r){var o=charCodeAt(e,n++);56320==(64512&o)?push$1(t,((1023&i)<<10)+(1023&o)+65536):(push$1(t,i),n--)}else push$1(t,i)}return t},digitToBasic=function(e){return e+22+75*(e<26)},adapt=function(e,t,n){var r=0;for(e=n?floor$1(e/damp):e>>1,e+=floor$1(e/t);e>baseMinusTMin*tMax>>1;)e=floor$1(e/baseMinusTMin),r+=base;return floor$1(r+(baseMinusTMin+1)*e/(e+skew))},encode=function(e){var t,n,r=[],i=(e=ucs2decode(e)).length,o=initialN,a=0,s=initialBias;for(t=0;t<e.length;t++)(n=e[t])<128&&push$1(r,fromCharCode(n));var c=r.length,u=c;for(c&&push$1(r,delimiter);u<i;){var l=maxInt;for(t=0;t<e.length;t++)(n=e[t])>=o&&n<l&&(l=n);var f=u+1;if(l-o>floor$1((maxInt-a)/f))throw new $RangeError(OVERFLOW_ERROR);for(a+=(l-o)*f,o=l,t=0;t<e.length;t++){if((n=e[t])<o&&++a>maxInt)throw new $RangeError(OVERFLOW_ERROR);if(n===o){for(var d=a,h=base;;){var p=h<=s?tMin:h>=s+tMax?tMax:h-s;if(d<p)break;var m=d-p,y=base-p;push$1(r,fromCharCode(digitToBasic(p+m%y))),d=floor$1(m/y),h+=base}push$1(r,fromCharCode(digitToBasic(d))),s=adapt(a,f,u===c),a=0,u++}}a++,o++}return join$1(r,"")},stringPunycodeToAscii=function(e){var t,n,r=[],i=split$1(replace$1(toLowerCase$1(e),regexSeparators,"."),".");for(t=0;t<i.length;t++)n=i[t],push$1(r,exec$1(regexNonASCII,n)?"xn--"+encode(n):n);return join$1(r,".")},$$3=_export,DESCRIPTORS=descriptors,USE_NATIVE_URL$2=urlConstructorDetection,globalThis$1=globalThis_1,bind=functionBindContext,uncurryThis=functionUncurryThis,defineBuiltIn=defineBuiltIn$8,defineBuiltInAccessor=defineBuiltInAccessor$3,anInstance=anInstance$2,hasOwn=hasOwnProperty_1,assign=objectAssign,arrayFrom=arrayFrom$1,arraySlice=arraySlice$2,codeAt=stringMultibyte.codeAt,toASCII=stringPunycodeToAscii,$toString=toString$6,setToStringTag=setToStringTag$4,validateArgumentsLength$2=validateArgumentsLength$6,URLSearchParamsModule=web_urlSearchParams_constructor,InternalStateModule=internalState,setInternalState=InternalStateModule.set,getInternalURLState=InternalStateModule.getterFor("URL"),URLSearchParams$1=URLSearchParamsModule.URLSearchParams,getInternalSearchParamsState=URLSearchParamsModule.getState,NativeURL=globalThis$1.URL,TypeError$1=globalThis$1.TypeError,parseInt$1=globalThis$1.parseInt,floor=Math.floor,pow=Math.pow,charAt=uncurryThis("".charAt),exec=uncurryThis(/./.exec),join=uncurryThis([].join),numberToString=uncurryThis(1..toString),pop=uncurryThis([].pop),push=uncurryThis([].push),replace=uncurryThis("".replace),shift=uncurryThis([].shift),split=uncurryThis("".split),stringSlice=uncurryThis("".slice),toLowerCase=uncurryThis("".toLowerCase),unshift=uncurryThis([].unshift),INVALID_AUTHORITY="Invalid authority",INVALID_SCHEME="Invalid scheme",INVALID_HOST="Invalid host",INVALID_PORT="Invalid port",ALPHA=/[a-z]/i,ALPHANUMERIC=/[\d+-.a-z]/i,DIGIT=/\d/,HEX_START=/^0x/i,OCT=/^[0-7]+$/,DEC=/^\d+$/,HEX=/^[\da-f]+$/i,FORBIDDEN_HOST_CODE_POINT=/[\0\t\n\r #%/:<>?@[\\\]^|]/,FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT=/[\0\t\n\r #/:<>?@[\\\]^|]/,LEADING_C0_CONTROL_OR_SPACE=/^[\u0000-\u0020]+/,TRAILING_C0_CONTROL_OR_SPACE=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,TAB_AND_NEW_LINE=/[\t\n\r]/g,EOF,parseIPv4=function(e){var t,n,r,i,o,a,s,c=split(e,".");if(c.length&&""===c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""===(i=c[r]))return e;if(o=10,i.length>1&&"0"===charAt(i,0)&&(o=exec(HEX_START,i)?16:8,i=stringSlice(i,8===o?1:2)),""===i)a=0;else{if(!exec(10===o?DEC:8===o?OCT:HEX,i))return e;a=parseInt$1(i,o)}push(n,a)}for(r=0;r<t;r++)if(a=n[r],r===t-1){if(a>=pow(256,5-t))return null}else if(a>255)return null;for(s=pop(n),r=0;r<n.length;r++)s+=n[r]*pow(256,3-r);return s},parseIPv6=function(e){var t,n,r,i,o,a,s,c=[0,0,0,0,0,0,0,0],u=0,l=null,f=0,d=function(){return charAt(e,f)};if(":"===d()){if(":"!==charAt(e,1))return;f+=2,l=++u}for(;d();){if(8===u)return;if(":"!==d()){for(t=n=0;n<4&&exec(HEX,d());)t=16*t+parseInt$1(d(),16),f++,n++;if("."===d()){if(0===n)return;if(f-=n,u>6)return;for(r=0;d();){if(i=null,r>0){if(!("."===d()&&r<4))return;f++}if(!exec(DIGIT,d()))return;for(;exec(DIGIT,d());){if(o=parseInt$1(d(),10),null===i)i=o;else{if(0===i)return;i=10*i+o}if(i>255)return;f++}c[u]=256*c[u]+i,2!==++r&&4!==r||u++}if(4!==r)return;break}if(":"===d()){if(f++,!d())return}else if(d())return;c[u++]=t}else{if(null!==l)return;f++,l=++u}}if(null!==l)for(a=u-l,u=7;0!==u&&a>0;)s=c[u],c[u--]=c[l+a-1],c[l+--a]=s;else if(8!==u)return;return c},findLongestZeroSequence=function(e){for(var t=null,n=1,r=null,i=0,o=0;o<8;o++)0!==e[o]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=o),++i);return i>n?r:t},serializeHost=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)unshift(t,e%256),e=floor(e/256);return join(t,".")}if("object"==typeof e){for(t="",r=findLongestZeroSequence(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=numberToString(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},C0ControlPercentEncodeSet={},fragmentPercentEncodeSet=assign({},C0ControlPercentEncodeSet,{" ":1,'"':1,"<":1,">":1,"`":1}),pathPercentEncodeSet=assign({},fragmentPercentEncodeSet,{"#":1,"?":1,"{":1,"}":1}),userinfoPercentEncodeSet=assign({},pathPercentEncodeSet,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),percentEncode=function(e,t){var n=codeAt(e,0);return n>32&&n<127&&!hasOwn(t,e)?e:encodeURIComponent(e)},specialSchemes={ftp:21,file:null,http:80,https:443,ws:80,wss:443},isWindowsDriveLetter=function(e,t){var n;return 2===e.length&&exec(ALPHA,charAt(e,0))&&(":"===(n=charAt(e,1))||!t&&"|"===n)},startsWithWindowsDriveLetter=function(e){var t;return e.length>1&&isWindowsDriveLetter(stringSlice(e,0,2))&&(2===e.length||"/"===(t=charAt(e,2))||"\\"===t||"?"===t||"#"===t)},isSingleDot=function(e){return"."===e||"%2e"===toLowerCase(e)},isDoubleDot=function(e){return".."===(e=toLowerCase(e))||"%2e."===e||".%2e"===e||"%2e%2e"===e},SCHEME_START={},SCHEME={},NO_SCHEME={},SPECIAL_RELATIVE_OR_AUTHORITY={},PATH_OR_AUTHORITY={},RELATIVE={},RELATIVE_SLASH={},SPECIAL_AUTHORITY_SLASHES={},SPECIAL_AUTHORITY_IGNORE_SLASHES={},AUTHORITY={},HOST={},HOSTNAME={},PORT={},FILE={},FILE_SLASH={},FILE_HOST={},PATH_START={},PATH={},CANNOT_BE_A_BASE_URL_PATH={},QUERY={},FRAGMENT={},URLState=function(e,t,n){var r,i,o,a=$toString(e);if(t){if(i=this.parse(a))throw new TypeError$1(i);this.searchParams=null}else{if(void 0!==n&&(r=new URLState(n,!0)),i=this.parse(a,null,r))throw new TypeError$1(i);(o=getInternalSearchParamsState(new URLSearchParams$1)).bindURL(this),this.searchParams=o}};URLState.prototype={type:"URL",parse:function(e,t,n){var r,i,o,a,s=this,c=t||SCHEME_START,u=0,l="",f=!1,d=!1,h=!1;for(e=$toString(e),t||(s.scheme="",s.username="",s.password="",s.host=null,s.port=null,s.path=[],s.query=null,s.fragment=null,s.cannotBeABaseURL=!1,e=replace(e,LEADING_C0_CONTROL_OR_SPACE,""),e=replace(e,TRAILING_C0_CONTROL_OR_SPACE,"$1")),e=replace(e,TAB_AND_NEW_LINE,""),r=arrayFrom(e);u<=r.length;){switch(i=r[u],c){case SCHEME_START:if(!i||!exec(ALPHA,i)){if(t)return INVALID_SCHEME;c=NO_SCHEME;continue}l+=toLowerCase(i),c=SCHEME;break;case SCHEME:if(i&&(exec(ALPHANUMERIC,i)||"+"===i||"-"===i||"."===i))l+=toLowerCase(i);else{if(":"!==i){if(t)return INVALID_SCHEME;l="",c=NO_SCHEME,u=0;continue}if(t&&(s.isSpecial()!==hasOwn(specialSchemes,l)||"file"===l&&(s.includesCredentials()||null!==s.port)||"file"===s.scheme&&!s.host))return;if(s.scheme=l,t)return void(s.isSpecial()&&specialSchemes[s.scheme]===s.port&&(s.port=null));l="","file"===s.scheme?c=FILE:s.isSpecial()&&n&&n.scheme===s.scheme?c=SPECIAL_RELATIVE_OR_AUTHORITY:s.isSpecial()?c=SPECIAL_AUTHORITY_SLASHES:"/"===r[u+1]?(c=PATH_OR_AUTHORITY,u++):(s.cannotBeABaseURL=!0,push(s.path,""),c=CANNOT_BE_A_BASE_URL_PATH)}break;case NO_SCHEME:if(!n||n.cannotBeABaseURL&&"#"!==i)return INVALID_SCHEME;if(n.cannotBeABaseURL&&"#"===i){s.scheme=n.scheme,s.path=arraySlice(n.path),s.query=n.query,s.fragment="",s.cannotBeABaseURL=!0,c=FRAGMENT;break}c="file"===n.scheme?FILE:RELATIVE;continue;case SPECIAL_RELATIVE_OR_AUTHORITY:if("/"!==i||"/"!==r[u+1]){c=RELATIVE;continue}c=SPECIAL_AUTHORITY_IGNORE_SLASHES,u++;break;case PATH_OR_AUTHORITY:if("/"===i){c=AUTHORITY;break}c=PATH;continue;case RELATIVE:if(s.scheme=n.scheme,i===EOF)s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=arraySlice(n.path),s.query=n.query;else if("/"===i||"\\"===i&&s.isSpecial())c=RELATIVE_SLASH;else if("?"===i)s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=arraySlice(n.path),s.query="",c=QUERY;else{if("#"!==i){s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=arraySlice(n.path),s.path.length--,c=PATH;continue}s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=arraySlice(n.path),s.query=n.query,s.fragment="",c=FRAGMENT}break;case RELATIVE_SLASH:if(!s.isSpecial()||"/"!==i&&"\\"!==i){if("/"!==i){s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,c=PATH;continue}c=AUTHORITY}else c=SPECIAL_AUTHORITY_IGNORE_SLASHES;break;case SPECIAL_AUTHORITY_SLASHES:if(c=SPECIAL_AUTHORITY_IGNORE_SLASHES,"/"!==i||"/"!==charAt(l,u+1))continue;u++;break;case SPECIAL_AUTHORITY_IGNORE_SLASHES:if("/"!==i&&"\\"!==i){c=AUTHORITY;continue}break;case AUTHORITY:if("@"===i){f&&(l="%40"+l),f=!0,o=arrayFrom(l);for(var p=0;p<o.length;p++){var m=o[p];if(":"!==m||h){var y=percentEncode(m,userinfoPercentEncodeSet);h?s.password+=y:s.username+=y}else h=!0}l=""}else if(i===EOF||"/"===i||"?"===i||"#"===i||"\\"===i&&s.isSpecial()){if(f&&""===l)return INVALID_AUTHORITY;u-=arrayFrom(l).length+1,l="",c=HOST}else l+=i;break;case HOST:case HOSTNAME:if(t&&"file"===s.scheme){c=FILE_HOST;continue}if(":"!==i||d){if(i===EOF||"/"===i||"?"===i||"#"===i||"\\"===i&&s.isSpecial()){if(s.isSpecial()&&""===l)return INVALID_HOST;if(t&&""===l&&(s.includesCredentials()||null!==s.port))return;if(a=s.parseHost(l))return a;if(l="",c=PATH_START,t)return;continue}"["===i?d=!0:"]"===i&&(d=!1),l+=i}else{if(""===l)return INVALID_HOST;if(a=s.parseHost(l))return a;if(l="",c=PORT,t===HOSTNAME)return}break;case PORT:if(!exec(DIGIT,i)){if(i===EOF||"/"===i||"?"===i||"#"===i||"\\"===i&&s.isSpecial()||t){if(""!==l){var g=parseInt$1(l,10);if(g>65535)return INVALID_PORT;s.port=s.isSpecial()&&g===specialSchemes[s.scheme]?null:g,l=""}if(t)return;c=PATH_START;continue}return INVALID_PORT}l+=i;break;case FILE:if(s.scheme="file","/"===i||"\\"===i)c=FILE_SLASH;else{if(!n||"file"!==n.scheme){c=PATH;continue}switch(i){case EOF:s.host=n.host,s.path=arraySlice(n.path),s.query=n.query;break;case"?":s.host=n.host,s.path=arraySlice(n.path),s.query="",c=QUERY;break;case"#":s.host=n.host,s.path=arraySlice(n.path),s.query=n.query,s.fragment="",c=FRAGMENT;break;default:startsWithWindowsDriveLetter(join(arraySlice(r,u),""))||(s.host=n.host,s.path=arraySlice(n.path),s.shortenPath()),c=PATH;continue}}break;case FILE_SLASH:if("/"===i||"\\"===i){c=FILE_HOST;break}n&&"file"===n.scheme&&!startsWithWindowsDriveLetter(join(arraySlice(r,u),""))&&(isWindowsDriveLetter(n.path[0],!0)?push(s.path,n.path[0]):s.host=n.host),c=PATH;continue;case FILE_HOST:if(i===EOF||"/"===i||"\\"===i||"?"===i||"#"===i){if(!t&&isWindowsDriveLetter(l))c=PATH;else if(""===l){if(s.host="",t)return;c=PATH_START}else{if(a=s.parseHost(l))return a;if("localhost"===s.host&&(s.host=""),t)return;l="",c=PATH_START}continue}l+=i;break;case PATH_START:if(s.isSpecial()){if(c=PATH,"/"!==i&&"\\"!==i)continue}else if(t||"?"!==i)if(t||"#"!==i){if(i!==EOF&&(c=PATH,"/"!==i))continue}else s.fragment="",c=FRAGMENT;else s.query="",c=QUERY;break;case PATH:if(i===EOF||"/"===i||"\\"===i&&s.isSpecial()||!t&&("?"===i||"#"===i)){if(isDoubleDot(l)?(s.shortenPath(),"/"===i||"\\"===i&&s.isSpecial()||push(s.path,"")):isSingleDot(l)?"/"===i||"\\"===i&&s.isSpecial()||push(s.path,""):("file"===s.scheme&&!s.path.length&&isWindowsDriveLetter(l)&&(s.host&&(s.host=""),l=charAt(l,0)+":"),push(s.path,l)),l="","file"===s.scheme&&(i===EOF||"?"===i||"#"===i))for(;s.path.length>1&&""===s.path[0];)shift(s.path);"?"===i?(s.query="",c=QUERY):"#"===i&&(s.fragment="",c=FRAGMENT)}else l+=percentEncode(i,pathPercentEncodeSet);break;case CANNOT_BE_A_BASE_URL_PATH:"?"===i?(s.query="",c=QUERY):"#"===i?(s.fragment="",c=FRAGMENT):i!==EOF&&(s.path[0]+=percentEncode(i,C0ControlPercentEncodeSet));break;case QUERY:t||"#"!==i?i!==EOF&&("'"===i&&s.isSpecial()?s.query+="%27":s.query+="#"===i?"%23":percentEncode(i,C0ControlPercentEncodeSet)):(s.fragment="",c=FRAGMENT);break;case FRAGMENT:i!==EOF&&(s.fragment+=percentEncode(i,fragmentPercentEncodeSet))}u++}},parseHost:function(e){var t,n,r;if("["===charAt(e,0)){if("]"!==charAt(e,e.length-1))return INVALID_HOST;if(!(t=parseIPv6(stringSlice(e,1,-1))))return INVALID_HOST;this.host=t}else if(this.isSpecial()){if(e=toASCII(e),exec(FORBIDDEN_HOST_CODE_POINT,e))return INVALID_HOST;if(null===(t=parseIPv4(e)))return INVALID_HOST;this.host=t}else{if(exec(FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT,e))return INVALID_HOST;for(t="",n=arrayFrom(e),r=0;r<n.length;r++)t+=percentEncode(n[r],C0ControlPercentEncodeSet);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return hasOwn(specialSchemes,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&isWindowsDriveLetter(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,i=e.host,o=e.port,a=e.path,s=e.query,c=e.fragment,u=t+":";return null!==i?(u+="//",e.includesCredentials()&&(u+=n+(r?":"+r:"")+"@"),u+=serializeHost(i),null!==o&&(u+=":"+o)):"file"===t&&(u+="//"),u+=e.cannotBeABaseURL?a[0]:a.length?"/"+join(a,"/"):"",null!==s&&(u+="?"+s),null!==c&&(u+="#"+c),u},setHref:function(e){var t=this.parse(e);if(t)throw new TypeError$1(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"===e)try{return new URLConstructor(e.path[0]).origin}catch(e){return"null"}return"file"!==e&&this.isSpecial()?e+"://"+serializeHost(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse($toString(e)+":",SCHEME_START)},getUsername:function(){return this.username},setUsername:function(e){var t=arrayFrom($toString(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=percentEncode(t[n],userinfoPercentEncodeSet)}},getPassword:function(){return this.password},setPassword:function(e){var t=arrayFrom($toString(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=percentEncode(t[n],userinfoPercentEncodeSet)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?serializeHost(e):serializeHost(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,HOST)},getHostname:function(){var e=this.host;return null===e?"":serializeHost(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,HOSTNAME)},getPort:function(){var e=this.port;return null===e?"":$toString(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""===(e=$toString(e))?this.port=null:this.parse(e,PORT))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+join(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,PATH_START))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""===(e=$toString(e))?this.query=null:("?"===charAt(e,0)&&(e=stringSlice(e,1)),this.query="",this.parse(e,QUERY)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!==(e=$toString(e))?("#"===charAt(e,0)&&(e=stringSlice(e,1)),this.fragment="",this.parse(e,FRAGMENT)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var URLConstructor=function(e){var t=anInstance(this,URLPrototype),n=validateArgumentsLength$2(arguments.length,1)>1?arguments[1]:void 0,r=setInternalState(t,new URLState(e,!1,n));DESCRIPTORS||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},URLPrototype=URLConstructor.prototype,accessorDescriptor=function(e,t){return{get:function(){return getInternalURLState(this)[e]()},set:t&&function(e){return getInternalURLState(this)[t](e)},configurable:!0,enumerable:!0}};if(DESCRIPTORS&&(defineBuiltInAccessor(URLPrototype,"href",accessorDescriptor("serialize","setHref")),defineBuiltInAccessor(URLPrototype,"origin",accessorDescriptor("getOrigin")),defineBuiltInAccessor(URLPrototype,"protocol",accessorDescriptor("getProtocol","setProtocol")),defineBuiltInAccessor(URLPrototype,"username",accessorDescriptor("getUsername","setUsername")),defineBuiltInAccessor(URLPrototype,"password",accessorDescriptor("getPassword","setPassword")),defineBuiltInAccessor(URLPrototype,"host",accessorDescriptor("getHost","setHost")),defineBuiltInAccessor(URLPrototype,"hostname",accessorDescriptor("getHostname","setHostname")),defineBuiltInAccessor(URLPrototype,"port",accessorDescriptor("getPort","setPort")),defineBuiltInAccessor(URLPrototype,"pathname",accessorDescriptor("getPathname","setPathname")),defineBuiltInAccessor(URLPrototype,"search",accessorDescriptor("getSearch","setSearch")),defineBuiltInAccessor(URLPrototype,"searchParams",accessorDescriptor("getSearchParams")),defineBuiltInAccessor(URLPrototype,"hash",accessorDescriptor("getHash","setHash"))),defineBuiltIn(URLPrototype,"toJSON",(function(){return getInternalURLState(this).serialize()}),{enumerable:!0}),defineBuiltIn(URLPrototype,"toString",(function(){return getInternalURLState(this).serialize()}),{enumerable:!0}),NativeURL){var nativeCreateObjectURL=NativeURL.createObjectURL,nativeRevokeObjectURL=NativeURL.revokeObjectURL;nativeCreateObjectURL&&defineBuiltIn(URLConstructor,"createObjectURL",bind(nativeCreateObjectURL,NativeURL)),nativeRevokeObjectURL&&defineBuiltIn(URLConstructor,"revokeObjectURL",bind(nativeRevokeObjectURL,NativeURL))}setToStringTag(URLConstructor,"URL"),$$3({global:!0,constructor:!0,forced:!USE_NATIVE_URL$2,sham:!DESCRIPTORS},{URL:URLConstructor});var $$2=_export,getBuiltIn$1=getBuiltIn$7,fails=fails$e,validateArgumentsLength$1=validateArgumentsLength$6,toString$1=toString$6,USE_NATIVE_URL$1=urlConstructorDetection,URL$2=getBuiltIn$1("URL"),THROWS_WITHOUT_ARGUMENTS=USE_NATIVE_URL$1&&fails((function(){URL$2.canParse()})),WRONG_ARITY=fails((function(){return 1!==URL$2.canParse.length}));$$2({target:"URL",stat:!0,forced:!THROWS_WITHOUT_ARGUMENTS||WRONG_ARITY},{canParse:function(e){var t=validateArgumentsLength$1(arguments.length,1),n=toString$1(e),r=t<2||void 0===arguments[1]?void 0:toString$1(arguments[1]);try{return!!new URL$2(n,r)}catch(e){return!1}}});var $$1=_export,getBuiltIn=getBuiltIn$7,validateArgumentsLength=validateArgumentsLength$6,toString=toString$6,USE_NATIVE_URL=urlConstructorDetection,URL$1=getBuiltIn("URL");$$1({target:"URL",stat:!0,forced:!USE_NATIVE_URL},{parse:function(e){var t=validateArgumentsLength(arguments.length,1),n=toString(e),r=t<2||void 0===arguments[1]?void 0:toString(arguments[1]);try{return new URL$1(n,r)}catch(e){return null}}});var $=_export,call=functionCall;$({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return call(URL.prototype.toString,this)}});var path=path$2;path.URL;const ToGammaSpace=1/2.2,ToLinearSpace=2.2,Epsilon=1e-6,DEG2RAD=Math.PI/180,RAD2DEG=360/(2*Math.PI);var Scalar,Vector3,Plane,Matrix,Quaternion,Vector2,Color4,Color3,InterpolationType;function getWorldPosition(e){let t=Transform.getOrNull(e);if(!t)return Vector3.Zero();let n=t.parent;return n?(Transform.get(n).rotation,Vector3.add(getWorldPosition(n),Vector3.rotate(t.position,getWorldRotation(n)))):t.position}function getWorldRotation(e){let t=Transform.getOrNull(e);if(!t)return Quaternion.Identity();let n=t.parent;return n?Quaternion.multiply(t.rotation,getWorldRotation(n)):t.rotation}function createCatmullRomSpline(e,t,n){const r=new Array,i=1/t;let o=0;if(n){const n=e.length;for(let a=0;a<n;a++){o=0;for(let s=0;s<t;s++)r.push(Vector3.catmullRom(e[a%n],e[(a+1)%n],e[(a+2)%n],e[(a+3)%n],o)),o+=i}r.push(r[0])}else{const n=new Array;n.push(Vector3.clone(e[0])),Array.prototype.push.apply(n,e),n.push(Vector3.clone(e[e.length-1]));let a=0;for(;a<n.length-3;a++){o=0;for(let e=0;e<t;e++)r.push(Vector3.catmullRom(n[a],n[a+1],n[a+2],n[a+3],o)),o+=i}a--,r.push(Vector3.catmullRom(n[a],n[a+1],n[a+2],n[a+3],o))}return r}function areAABBIntersecting(e,t,n,r){return e.x<=r.x&&t.x>=n.x&&e.y<=r.y&&t.y>=n.y&&e.z<=r.z&&t.z>=n.z}function areSpheresIntersecting(e,t,n,r){const i=t+r;return Vector3.distanceSquared(e,n)<i*i}function areAABBSphereIntersecting(e,t,n,r){let i=0;return n.x<e.x&&(i+=(e.x-n.x)*(e.x-n.x)),n.x>t.x&&(i+=(n.x-t.x)*(n.x-t.x)),n.y<e.y&&(i+=(e.y-n.y)*(e.y-n.y)),n.y>t.y&&(i+=(n.y-t.y)*(n.y-t.y)),n.z<e.z&&(i+=(e.z-n.z)*(e.z-n.z)),n.z>t.z&&(i+=(n.z-t.z)*(n.z-t.z)),i<r*r}!function(e){function t(e){const t=+e;return 0===t||isNaN(t)?t:t>0?1:-1}function n(e,t=0,n=1){return Math.min(n,Math.max(t,e))}function r(e,t){return e-Math.floor(e/t)*t}function i(e,t){let n=r(t-e,360);return n>180&&(n-=360),n}function o(e,n,r){let i=0;return i=Math.abs(n-e)<=r?n:e+t(n-e)*r,i}e.TwoPi=2*Math.PI,e.withinEpsilon=function(e,t,n=1401298e-51){const r=e-t;return-n<=r&&r<=n},e.toHex=function(e){const t=e.toString(16);return e<=15?("0"+t).toUpperCase():t.toUpperCase()},e.sign=t,e.clamp=n,e.log2=function(e){return Math.log(e)*Math.LOG2E},e.repeat=r,e.normalize=function(e,t,n){return(e-t)/(n-t)},e.denormalize=function(e,t,n){return e*(n-t)+t},e.deltaAngle=i,e.pingPong=function(e,t){const n=r(e,2*t);return t-Math.abs(n-t)},e.smoothStep=function(e,t,r){let i=n(r);return i=-2*i*i*i+3*i*i,t*i+e*(1-i)},e.moveTowards=o,e.moveTowardsAngle=function(e,t,n){const r=i(e,t);let a=0;return a=-n<r&&r<n?t:o(e,e+r,n),a},e.lerp=function(e,t,n){return e+(t-e)*n},e.lerpAngle=function(e,t,i){let o=r(t-e,360);return o>180&&(o-=360),e+o*n(i)},e.inverseLerp=function(e,t,r){let i=0;return i=e!==t?n((r-e)/(t-e)):0,i},e.hermite=function(e,t,n,r,i){const o=i*i,a=i*o;return e*(2*a-3*o+1)+n*(-2*a+3*o)+t*(a-2*o+i)+r*(a-o)},e.randomRange=function(e,t){return e===t?e:Math.random()*(t-e)+e},e.rangeToPercent=function(e,t,n){return(e-t)/(n-t)},e.percentToRange=function(e,t,n){return(n-t)*e+t},e.normalizeRadians=function(t){return t-e.TwoPi*Math.floor((t+Math.PI)/e.TwoPi)}}(Scalar||(Scalar={})),function(e){function t(e=0,t=0,n=0){return{x:e,y:t,z:n}}function n(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}}function r(e,t){t.x=e.x,t.y=e.y,t.z=e.z}function i(e,t,n,r){r.x=e,r.y=t,r.z=n}function o(e){return t(e.x,e.y,e.z)}function a(e,n=0){return t(e[n],e[n+1],e[n+2])}function s(e,t,n){n.x=e[t],n.y=e[t+1],n.z=e[t+2]}function c(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}function u(e,t,n){n.x=e.x*t,n.y=e.y*t,n.z=e.z*t}function l(e,n){const r=t(0,0,0);return f(e,n,r),r}function f(e,t,n){0!==t&&1!==t?u(e,1/t,n):r(e,n)}function d(e){return l(e,c(e))}function h(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}function p(e,t,n){const{x:r,y:i,z:o}=e,a=t._m,s=1/(a[3]*r+a[7]*i+a[11]*o+a[15]);n.x=(a[0]*r+a[4]*i+a[8]*o+a[12])*s,n.y=(a[1]*r+a[5]*i+a[9]*o+a[13])*s,n.z=(a[2]*r+a[6]*i+a[10]*o+a[14])*s}function m(e,t,n){const{x:r,y:i,z:o}=e,{x:a,y:s,z:c,w:u}=t,l=u*r+s*o-c*i,f=u*i+c*r-a*o,d=u*o+a*i-s*r,h=-a*r-s*i-c*o;n.x=l*u+h*-a+f*-c-d*-s,n.y=f*u+h*-s+d*-a-l*-c,n.z=d*u+h*-c+l*-s-f*-a}function y(e,t,n,r){r.x=e.x+(t.x-e.x)*n,r.y=e.y+(t.y-e.y)*n,r.z=e.z+(t.z-e.z)*n}function g(e,t,n){n.x=e.y*t.z-e.z*t.y,n.y=e.z*t.x-e.x*t.z,n.z=e.x*t.y-e.y*t.x}function E(e,t,n){return T(e.x,e.y,e.z,t,n)}function T(e,t,n,r,i){const o=r._m,a=e*o[0]+t*o[4]+n*o[8]+o[12],s=e*o[1]+t*o[5]+n*o[9]+o[13],c=e*o[2]+t*o[6]+n*o[10]+o[14],u=1/(e*o[3]+t*o[7]+n*o[11]+o[15]);i.x=a*u,i.y=s*u,i.z=c*u}function _(e,t,n){S(e.x,e.y,e.z,t,n)}function S(e,t,n,r,i){const o=r._m;i.x=e*o[0]+t*o[4]+n*o[8],i.y=e*o[1]+t*o[5]+n*o[9],i.z=e*o[2]+t*o[6]+n*o[10]}function b(e,t,n,r){let o=e.x;o=o>n.x?n.x:o,o=o<t.x?t.x:o;let a=e.y;a=a>n.y?n.y:a,a=a<t.y?t.y:a;let s=e.z;s=s>n.z?n.z:s,s=s<t.z?t.z:s,i(o,a,s,r)}function $(e,t){const n=e.x-t.x,r=e.y-t.y,i=e.z-t.z;return n*n+r*r+i*i}function v(e,t,n,i){const o=Quaternion.create();Quaternion.fromAxisToRotationQuaternionToRef(e,t,n,o),r(Quaternion.toEulerAngles(o),i)}function A(e,t,n){n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z}function R(e,t,n,r,i){i.x=e.x*t,i.y=e.y*n,i.z=e.z*r}function P(e,t,n,r,i){t>e.x?i.x=t:i.x=e.x,n>e.y?i.y=n:i.y=e.y,r>e.z?i.z=r:i.z=e.z}function I(e,t,n,r,i){t<e.x?i.x=t:i.x=e.x,n<e.y?i.y=n:i.y=e.y,r<e.z?i.z=r:i.z=e.z}function w(){return t(0,0,0)}e.isNonUniform=function(e){const t=Math.abs(e.x);return t!==Math.abs(e.y)||t!==Math.abs(e.z)},e.create=t,e.add=n,e.addToRef=function(e,t,n){n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z},e.subtract=function(e,t){return{x:e.x-t.x,y:e.y-t.y,z:e.z-t.z}},e.subtractToRef=function(e,t,n){n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z},e.subtractFromFloatsToRef=function(e,t,n,r,i){i.x=e.x-t,i.y=e.y-n,i.z=e.z-r},e.negate=function(e){return{x:-e.x,y:-e.y,z:-e.z}},e.copyFrom=r,e.copyFromFloats=i,e.clone=o,e.getClipFactor=function(e,t,n,r){const i=h(e,n)-r;return i/(i-(h(t,n)-r))},e.getAngleBetweenVectors=function(e,n,r){const i=d(e),o=d(n),a=h(i,o),s=t();return g(i,o,s),h(s,r)>0?Math.acos(a):-Math.acos(a)},e.fromArray=a,e.fromFloatArray=function(e,t){return a(e,t)},e.fromArrayToRef=s,e.fromFloatArrayToRef=function(e,t,n){return s(e,t,n)},e.length=c,e.lengthSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z},e.scaleToRef=u,e.scale=function(e,n){return t(e.x*n,e.y*n,e.z*n)},e.normalizeFromLength=l,e.normalizeFromLengthToRef=f,e.normalize=d,e.normalizeToRef=function(e,t){f(e,c(e),t)},e.dot=h,e.applyMatrix4=function(e,t){const n=o(e);return p(e,t,n),n},e.applyMatrix4ToRef=p,e.rotate=function(e,n){const r=t();return m(e,n,r),r},e.rotateToRef=m,e.lerp=function(e,n,r){const i=t(0,0,0);return y(e,n,r,i),i},e.lerpToRef=y,e.cross=function(e,t){const n=w();return g(e,t,n),n},e.crossToRef=g,e.transformCoordinates=function(e,t){const n=w();return E(e,t,n),n},e.transformCoordinatesToRef=E,e.transformCoordinatesFromFloatsToRef=T,e.transformNormal=function(e,t){const n=w();return _(e,t,n),n},e.transformNormalToRef=_,e.transformNormalFromFloatsToRef=S,e.catmullRom=function(e,n,r,i,o){const a=o*o,s=o*a;return t(.5*(2*n.x+(-e.x+r.x)*o+(2*e.x-5*n.x+4*r.x-i.x)*a+(-e.x+3*n.x-3*r.x+i.x)*s),.5*(2*n.y+(-e.y+r.y)*o+(2*e.y-5*n.y+4*r.y-i.y)*a+(-e.y+3*n.y-3*r.y+i.y)*s),.5*(2*n.z+(-e.z+r.z)*o+(2*e.z-5*n.z+4*r.z-i.z)*a+(-e.z+3*n.z-3*r.z+i.z)*s))},e.clamp=function(e,n,r){const i=t();return b(e,n,r,i),i},e.clampToRef=b,e.hermite=function(e,n,r,i,o){const a=o*o,s=o*a,c=2*s-3*a+1,u=-2*s+3*a,l=s-2*a+o,f=s-a;return t(e.x*c+r.x*u+n.x*l+i.x*f,e.y*c+r.y*u+n.y*l+i.y*f,e.z*c+r.z*u+n.z*l+i.z*f)},e.minimize=function(e,n){const r=t();return I(n,e.x,e.y,e.z,r),r},e.maximize=function(e,n){const r=t();return P(e,n.x,n.y,n.z,r),r},e.distance=function(e,t){return Math.sqrt($(e,t))},e.distanceSquared=$,e.center=function(e,t){const r=n(e,t);return u(r,.5,r),r},e.rotationFromAxis=function(e,t,n){const r=w();return v(e,t,n,r),r},e.rotationFromAxisToRef=v,e.toString=function(e){return`(${e.x}, ${e.y}, ${e.z})`},e.getHashCode=function(e){let t=e.x||0;return t=397*t^(e.y||0),t=397*t^(e.z||0),t},e.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z},e.equalsWithEpsilon=function(e,t,n=Epsilon){return Scalar.withinEpsilon(e.x,t.x,n)&&Scalar.withinEpsilon(e.y,t.y,n)&&Scalar.withinEpsilon(e.z,t.z,n)},e.equalsToFloats=function(e,t,n,r){return e.x===t&&e.y===n&&e.z===r},e.multiply=function(e,n){const r=t();return A(e,n,r),r},e.multiplyToRef=A,e.multiplyByFloatsToRef=R,e.multiplyByFloats=function(e,n,r,i){const o=t();return R(e,n,r,i,o),o},e.divide=function(e,t){return{x:e.x/t.x,y:e.y/t.y,z:e.z/t.z}},e.divideToRef=function(e,t,n){n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z},e.maximizeInPlaceFromFloatsToRef=P,e.minimizeInPlaceFromFloatsToRef=I,e.floor=function(e){return t(Math.floor(e.x),Math.floor(e.y),Math.floor(e.z))},e.fract=function(e){return t(e.x-Math.floor(e.x),e.y-Math.floor(e.y),e.z-Math.floor(e.z))},e.Zero=w,e.One=function(){return t(1,1,1)},e.Up=function(){return t(0,1,0)},e.Down=function(){return t(0,-1,0)},e.Forward=function(){return t(0,0,1)},e.Backward=function(){return t(0,0,-1)},e.Right=function(){return t(1,0,0)},e.Left=function(){return t(-1,0,0)},e.Random=function(){return t(Math.random(),Math.random(),Math.random())}}(Vector3||(Vector3={})),function(e){function t(e,t,n,r){return{normal:Vector3.create(e,t,n),d:r}}e.create=t,e.fromArray=function(e){return t(e[0],e[1],e[2],e[3])},e.fromPoints=function(e,n,r){return t(0,0,0,0)},e.romPositionAndNormal=function(e,n){const r=t(0,0,0,0);return r.normal=Vector3.normalize(n),r.d=-(n.x*e.x+n.y*e.y+n.z*e.z),r},e.signedDistanceToPlaneFromPositionAndNormal=function(e,t,n){const r=-(t.x*e.x+t.y*e.y+t.z*e.z);return Vector3.dot(n,t)+r},e.asArray=function(e){return[e.normal.x,e.normal.y,e.normal.z,e.d]},e.clone=function(e){return t(e.normal.x,e.normal.y,e.normal.z,e.d)},e.getHashCode=function(e){return 0},e.normalize=function(e){const n=t(0,0,0,0),r=Math.sqrt(e.normal.x*e.normal.x+e.normal.y*e.normal.y+e.normal.z*e.normal.z);let i=0;return 0!==r&&(i=1/r),n.normal.x=e.normal.x*i,n.normal.y=e.normal.y*i,n.normal.z=e.normal.z*i,n.d*=i,e},e.transform=function(e,n){const r=Matrix.create();Matrix.transposeToRef(n,r);const i=r._m,o=e.normal.x,a=e.normal.y,s=e.normal.z,c=e.d;return t(o*i[0]+a*i[1]+s*i[2]+c*i[3],o*i[4]+a*i[5]+s*i[6]+c*i[7],o*i[8]+a*i[9]+s*i[10]+c*i[11],o*i[12]+a*i[13]+s*i[14]+c*i[15])},e.dotCoordinate=function(e,t){return e.normal.x*t.x+e.normal.y*t.y+e.normal.z*t.z+e.d},e.copyFromPoints=function(e,t,n){const r=t.x-e.x,i=t.y-e.y,o=t.z-e.z,a=n.x-e.x,s=n.y-e.y,c=n.z-e.z,u=i*c-o*s,l=o*a-r*c,f=r*s-i*a,d=Math.sqrt(u*u+l*l+f*f);let h;h=0!==d?1/d:0;const p=Vector3.create(u*h,l*h,f*h);return{normal:p,d:-(p.x*e.x+p.y*e.y+p.z*e.z)}},e.isFrontFacingTo=function(e,t,n){return Vector3.dot(e.normal,t)<=n},e.signedDistanceTo=function(e,t){return Vector3.dot(t,e.normal)+e.d}}(Plane||(Plane={})),function(e){e.m=function(e){return e._m};let t=0;const n={};function r(){const e={updateFlag:0,isIdentity:!1,isIdentity3x2:!0,_isIdentityDirty:!0,_isIdentity3x2Dirty:!0,_m:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};return z(e,!1),e}function i(e,t,n){for(let r=0;r<16;r++)n._m[r]=e[r+t];I(n)}function o(e,t,n,r,i,o,a,s,c,u,l,f,d,h,p,m,y){const g=y._m;g[0]=e,g[1]=t,g[2]=n,g[3]=r,g[4]=i,g[5]=o,g[6]=a,g[7]=s,g[8]=c,g[9]=u,g[10]=l,g[11]=f,g[12]=d,g[13]=h,g[14]=p,g[15]=m,I(y)}function a(e,t,n,i,o,a,s,c,u,l,f,d,h,p,m,y){const g=r(),E=g._m;return E[0]=e,E[1]=t,E[2]=n,E[3]=i,E[4]=o,E[5]=a,E[6]=s,E[7]=c,E[8]=u,E[9]=l,E[10]=f,E[11]=d,E[12]=h,E[13]=p,E[14]=m,E[15]=y,I(g),g}function s(e,t,n,i){const o=[r(),r(),r()];p(e.x,e.y,e.z,o[1]),P(t,o[0]),L(o[1],o[0],i),k(i,n)}function c(){const e=a(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return z(e,!0),e}function u(e,t){const n=Math.sin(e),r=Math.cos(e);o(1,0,0,0,0,r,n,0,0,-n,r,0,0,0,0,1,t),z(t,1===r&&0===n)}function l(e,t){const n=Math.sin(e),r=Math.cos(e);o(r,0,-n,0,0,1,0,0,n,0,r,0,0,0,0,1,t),z(t,1===r&&0===n)}function f(e,t){const n=Math.sin(e),r=Math.cos(e);o(r,n,0,0,-n,r,0,0,0,0,1,0,0,0,0,1,t),z(t,1===r&&0===n)}function d(e,t,n){const r=Math.sin(-t),i=Math.cos(-t),o=1-i,a=Vector3.normalize(e),s=n._m;s[0]=a.x*a.x*o+i,s[1]=a.x*a.y*o-a.z*r,s[2]=a.x*a.z*o+a.y*r,s[3]=0,s[4]=a.y*a.x*o+a.z*r,s[5]=a.y*a.y*o+i,s[6]=a.y*a.z*o-a.x*r,s[7]=0,s[8]=a.z*a.x*o-a.y*r,s[9]=a.z*a.y*o+a.x*r,s[10]=a.z*a.z*o+i,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,I(n)}function h(e,t,n,r){const i=Quaternion.Zero();Quaternion.fromRotationYawPitchRollToRef(e,t,n,i),P(i,r)}function p(e,t,n,r){o(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1,r),z(r,1===e&&1===t&&1===n)}function m(e,t,n,r){o(1,0,0,0,0,1,0,0,0,0,1,0,e,t,n,1,r),z(r,0===e&&0===t&&0===n)}function y(e,t,n,r){for(let i=0;i<16;i++)r._m[i]=e._m[i]*(1-n)+t._m[i]*n;I(r)}function g(e,t,n,r){const i=Vector3.Zero(),o=Quaternion.Zero(),a=Vector3.Zero();x(e,i,o,a);const c=Vector3.Zero(),u=Quaternion.Zero(),l=Vector3.Zero();x(t,c,u,l);const f=Vector3.Zero();Vector3.lerpToRef(i,c,n,f);const d=Quaternion.Zero();Quaternion.slerpToRef(o,u,n,d);const h=Vector3.Zero();Vector3.lerpToRef(a,l,n,h),s(f,d,h,r)}function E(e,t,n,r){const i=Vector3.Zero(),a=Vector3.Zero(),s=Vector3.Zero();Vector3.subtractToRef(t,e,s),Vector3.normalizeToRef(s,s),Vector3.crossToRef(n,s,i);const c=Vector3.lengthSquared(i);0===c?i.x=1:Vector3.normalizeFromLengthToRef(i,Math.sqrt(c),i),Vector3.crossToRef(s,i,a),Vector3.normalizeToRef(a,a);const u=-Vector3.dot(i,e),l=-Vector3.dot(a,e),f=-Vector3.dot(s,e);o(i.x,a.x,s.x,0,i.y,a.y,s.y,0,i.z,a.z,s.z,0,u,l,f,1,r)}function T(e,t,n,r){const i=Vector3.Zero(),a=Vector3.Zero(),s=Vector3.Zero();Vector3.subtractToRef(e,t,s),Vector3.normalizeToRef(s,s),Vector3.crossToRef(n,s,i);const c=Vector3.lengthSquared(i);0===c?i.x=1:Vector3.normalizeFromLengthToRef(i,Math.sqrt(c),i),Vector3.crossToRef(s,i,a),Vector3.normalizeToRef(a,a);const u=-Vector3.dot(i,e),l=-Vector3.dot(a,e),f=-Vector3.dot(s,e);o(i.x,a.x,s.x,0,i.y,a.y,s.y,0,i.z,a.z,s.z,0,u,l,f,1,r)}function _(e,t,n,r,i){const a=2/e,s=2/t,c=2/(r-n),u=-(r+n)/(r-n);o(a,0,0,0,0,s,0,0,0,0,c,0,0,0,u,1,i),z(i,1===a&&1===s&&1===c&&0===u)}function S(e,t,n,r,i,a,s){o(2/(t-e),0,0,0,0,2/(r-n),0,0,0,0,2/(a-i),0,(e+t)/(e-t),(r+n)/(n-r),-(a+i)/(a-i),1,s),I(s)}function b(e,t,n,r,i,o,a){S(e,t,n,r,i,o,a),a._m[10]*=-1}function $(e,t,n,r,i,a=!0){const s=n,c=r,u=1/Math.tan(.5*e);o(a?u/t:u,0,0,0,0,a?u:u*t,0,0,0,0,(c+s)/(c-s),1,0,0,-2*c*s/(c-s),0,i),z(i,!1)}function v(e,t,n,r,i,a=!0){const s=n,c=r,u=1/Math.tan(.5*e);o(a?u/t:u,0,0,0,0,a?u:u*t,0,0,0,0,-(c+s)/(c-s),-1,0,0,-2*c*s/(c-s),0,i),z(i,!1)}function A(e,t){const n=t._m,r=e._m;n[0]=r[0],n[1]=r[4],n[2]=r[8],n[3]=r[12],n[4]=r[1],n[5]=r[5],n[6]=r[9],n[7]=r[13],n[8]=r[2],n[9]=r[6],n[10]=r[10],n[11]=r[14],n[12]=r[3],n[13]=r[7],n[14]=r[11],n[15]=r[15],z(t,e.isIdentity,e._isIdentityDirty)}function R(e,t){const n=Plane.normalize(e),r=n.normal.x,i=n.normal.y,a=n.normal.z,s=-2*r,c=-2*i,u=-2*a;o(s*r+1,c*r,u*r,0,s*i,c*i+1,u*i,0,s*a,c*a,u*a+1,0,s*n.d,c*n.d,u*n.d,1,t)}function P(e,t){const n=e.x*e.x,r=e.y*e.y,i=e.z*e.z,o=e.x*e.y,a=e.z*e.w,s=e.z*e.x,c=e.y*e.w,u=e.y*e.z,l=e.x*e.w;t._m[0]=1-2*(r+i),t._m[1]=2*(o+a),t._m[2]=2*(s-c),t._m[3]=0,t._m[4]=2*(o-a),t._m[5]=1-2*(i+n),t._m[6]=2*(u+l),t._m[7]=0,t._m[8]=2*(s+c),t._m[9]=2*(u-l),t._m[10]=1-2*(r+n),t._m[11]=0,t._m[12]=0,t._m[13]=0,t._m[14]=0,t._m[15]=1,I(t)}function I(e){e.updateFlag=t++,e.isIdentity=!1,e.isIdentity3x2=!1,e._isIdentityDirty=!0,e._isIdentity3x2Dirty=!0}function w(e){if(!0===e.isIdentity)return 1;const t=e._m,n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],u=t[7],l=t[8],f=t[9],d=t[10],h=t[11],p=t[12],m=t[13],y=t[14],g=t[15],E=d*g-y*h,T=f*g-m*h,_=f*y-m*d,S=l*g-p*h,b=l*y-d*p,$=l*m-p*f;return n*+(s*E-c*T+u*_)+r*-(a*E-c*S+u*b)+i*+(a*T-s*S+u*$)+o*-(a*_-s*b+c*$)}function O(e,t,n){for(let r=0;r<16;r++)n._m[r]=e._m[r]+t._m[r];I(n)}function C(e,t){if(!0===e.isIdentity)return void N(e,t);const n=e._m,r=n[0],i=n[1],a=n[2],s=n[3],c=n[4],u=n[5],l=n[6],f=n[7],d=n[8],h=n[9],p=n[10],m=n[11],y=n[12],g=n[13],E=n[14],T=n[15],_=p*T-E*m,S=h*T-g*m,b=h*E-g*p,$=d*T-y*m,v=d*E-p*y,A=d*g-y*h,R=+(u*_-l*S+f*b),P=-(c*_-l*$+f*v),I=+(c*S-u*$+f*A),w=-(c*b-u*v+l*A),O=r*R+i*P+a*I+s*w;if(0===O)return void N(e,t);const C=1/O,B=l*T-E*f,k=u*T-g*f,M=u*E-g*l,L=c*T-y*f,U=c*E-y*l,x=c*g-y*u,D=l*m-p*f,F=u*m-h*f,z=u*p-h*l,V=c*m-d*f,W=c*p-d*l,j=c*h-d*u;o(R*C,-(i*_-a*S+s*b)*C,+(i*B-a*k+s*M)*C,-(i*D-a*F+s*z)*C,P*C,+(r*_-a*$+s*v)*C,-(r*B-a*L+s*U)*C,+(r*D-a*V+s*W)*C,I*C,-(r*S-i*$+s*A)*C,+(r*k-i*L+s*x)*C,-(r*F-i*V+s*j)*C,w*C,+(r*b-i*v+a*A)*C,-(r*M-i*U+a*x)*C,+(r*z-i*W+a*j)*C,t)}function B(e,t,n,r){e._m[12]=t,e._m[13]=n,e._m[14]=r,I(e)}function k(e,t){B(e,t.x,t.y,t.z)}function N(e,t){M(e,t._m),z(t,e.isIdentity,e._isIdentityDirty,e.isIdentity3x2,e._isIdentity3x2Dirty)}function M(e,t,n=0){for(let r=0;r<16;r++)t[n+r]=e._m[r]}function L(e,t,n){e.isIdentity?N(t,n):t.isIdentity?N(e,n):(U(e,t,n._m,0),I(n))}function U(e,t,n,r){const i=e._m,o=t._m,a=i[0],s=i[1],c=i[2],u=i[3],l=i[4],f=i[5],d=i[6],h=i[7],p=i[8],m=i[9],y=i[10],g=i[11],E=i[12],T=i[13],_=i[14],S=i[15],b=o[0],$=o[1],v=o[2],A=o[3],R=o[4],P=o[5],I=o[6],w=o[7],O=o[8],C=o[9],B=o[10],k=o[11],N=o[12],M=o[13],L=o[14],U=o[15];n[r]=a*b+s*R+c*O+u*N,n[r+1]=a*$+s*P+c*C+u*M,n[r+2]=a*v+s*I+c*B+u*L,n[r+3]=a*A+s*w+c*k+u*U,n[r+4]=l*b+f*R+d*O+h*N,n[r+5]=l*$+f*P+d*C+h*M,n[r+6]=l*v+f*I+d*B+h*L,n[r+7]=l*A+f*w+d*k+h*U,n[r+8]=p*b+m*R+y*O+g*N,n[r+9]=p*$+m*P+y*C+g*M,n[r+10]=p*v+m*I+y*B+g*L,n[r+11]=p*A+m*w+y*k+g*U,n[r+12]=E*b+T*R+_*O+S*N,n[r+13]=E*$+T*P+_*C+S*M,n[r+14]=E*v+T*I+_*B+S*L,n[r+15]=E*A+T*w+_*k+S*U}function x(e,t,n,i){if(e.isIdentity)return i&&(i.x=0,i.y=0,i.z=0),t&&(t.x=1,t.y=1,t.z=1),n&&(n.w=1,n.x=0,n.y=0,n.z=0),!0;const a=e._m;i&&(i.x=a[12],i.y=a[13],i.z=a[14]);const s=t||Vector3.Zero();if(s.x=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]),s.y=Math.sqrt(a[4]*a[4]+a[5]*a[5]+a[6]*a[6]),s.z=Math.sqrt(a[8]*a[8]+a[9]*a[9]+a[10]*a[10]),w(e)<=0&&(s.y*=-1),0===s.x||0===s.y||0===s.z)return n&&(n.w=1,n.x=0,n.y=0,n.z=0),!1;if(n){const e=1/s.x,t=1/s.y,i=1/s.z,c=r();o(a[0]*e,a[1]*e,a[2]*e,0,a[4]*t,a[5]*t,a[6]*t,0,a[8]*i,a[9]*i,a[10]*i,0,0,0,0,1,c),Quaternion.fromRotationMatrixToRef(c,n)}return!0}function D(e,t,n){for(let r=0;r<16;r++)n._m[r]=e._m[r]*t;I(n)}function F(e,t){const n=Vector3.Zero();if(!x(e,n))return void(t=c());const r=e._m,i=1/n.x,a=1/n.y,s=1/n.z;o(r[0]*i,r[1]*i,r[2]*i,0,r[4]*a,r[5]*a,r[6]*a,0,r[8]*s,r[9]*s,r[10]*s,0,0,0,0,1,t)}function z(e,n,r=!1,i=!1,o=!0){e.updateFlag=t++,e.isIdentity=n,e.isIdentity3x2=n||i,e._isIdentityDirty=!e.isIdentity&&r,e._isIdentity3x2Dirty=!e.isIdentity3x2&&o}e.IdentityReadonly=function(){return n},e.create=r,e.fromArray=function(e,t=0){const n=r();return i(e,t,n),n},e.fromArrayToRef=i,e.fromFloatArrayToRefScaled=function(e,t,n,r){for(let i=0;i<16;i++)r._m[i]=e[i+t]*n;I(r)},e.fromValuesToRef=o,e.fromValues=a,e.compose=function(e,t,n){const i=r();return s(e,t,n,i),i},e.composeToRef=s,e.Identity=c,e.IdentityToRef=function(e){o(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,e),z(e,!0)},e.Zero=function(){const e=a(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return z(e,!1),e},e.RotationX=function(e){const t=r();return u(e,t),t},e.rotationXToRef=u,e.rotationY=function(e){const t=r();return l(e,t),t},e.rotationYToRef=l,e.rotationZ=function(e){const t=r();return f(e,t),t},e.rotationZToRef=f,e.rotationAxis=function(e,t){const n=r();return d(e,t,n),n},e.rotationAxisToRef=d,e.rotationYawPitchRoll=function(e,t,n){const i=r();return h(e,t,n,i),i},e.rotationYawPitchRollToRef=h,e.scaling=function(e,t,n){const i=r();return p(e,t,n,i),i},e.scalingToRef=p,e.translation=function(e,t,n){const i=r();return m(e,t,n,i),i},e.translationToRef=m,e.lerp=function(e,t,n){const i=r();return y(e,t,n,i),i},e.lerpToRef=y,e.decomposeLerp=function(e,t,n){const i=r();return g(e,t,n,i),i},e.decomposeLerpToRef=g,e.LookAtLH=function(e,t,n){const i=r();return E(e,t,n,i),i},e.lookAtLHToRef=E,e.lookAtRH=function(e,t,n){const i=r();return T(e,t,n,i),i},e.lookAtRHToRef=T,e.orthoLH=function(e,t,n,i){const o=r();return _(e,t,n,i,o),o},e.orthoLHToRef=_,e.OrthoOffCenterLH=function(e,t,n,i,o,a){const s=r();return S(e,t,n,i,o,a,s),s},e.orthoOffCenterLHToRef=S,e.orthoOffCenterRH=function(e,t,n,i,o,a){const s=r();return b(e,t,n,i,o,a,s),s},e.orthoOffCenterRHToRef=b,e.perspectiveLH=function(e,t,n,i){const a=r();return o(2*n/e,0,0,0,0,2*n/t,0,0,0,0,(i+n)/(i-n),1,0,0,-2*i*n/(i-n),0,a),z(a,!1),a},e.perspectiveFovLH=function(e,t,n,i){const o=r();return $(e,t,n,i,o),o},e.perspectiveFovLHToRef=$,e.PerspectiveFovRH=function(e,t,n,i){const o=r();return v(e,t,n,i,o),o},e.perspectiveFovRHToRef=v,e.perspectiveFovWebVRToRef=function(e,t,n,r,i=!1){const o=i?-1:1,a=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),c=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),l=2/(c+u),f=2/(a+s),d=r._m;d[0]=l,d[1]=d[2]=d[3]=d[4]=0,d[5]=f,d[6]=d[7]=0,d[8]=(c-u)*l*.5,d[9]=-(a-s)*f*.5,d[10]=-n/(t-n),d[11]=1*o,d[12]=d[13]=d[15]=0,d[14]=-2*n*t/(n-t),I(r)},e.GetAsMatrix2x2=function(e){return[e._m[0],e._m[1],e._m[4],e._m[5]]},e.GetAsMatrix3x3=function(e){return[e._m[0],e._m[1],e._m[2],e._m[4],e._m[5],e._m[6],e._m[8],e._m[9],e._m[10]]},e.transpose=function(e){const t=r();return A(e,t),t},e.transposeToRef=A,e.reflection=function(e){const t=r();return R(e,t),t},e.reflectionToRef=R,e.fromXYZAxesToRef=function(e,t,n,r){o(e.x,e.y,e.z,0,t.x,t.y,t.z,0,n.x,n.y,n.z,0,0,0,0,1,r)},e.fromQuaternionToRef=P,e.isIdentityUpdate=function(e){if(e._isIdentityDirty){e._isIdentityDirty=!1;const t=e._m;e.isIdentity=1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}return e.isIdentity},e.isIdentityAs3x2Update=function(e){return e._isIdentity3x2Dirty&&(e._isIdentity3x2Dirty=!1,1!==e._m[0]||1!==e._m[5]||1!==e._m[15]||0!==e._m[1]||0!==e._m[2]||0!==e._m[3]||0!==e._m[4]||0!==e._m[6]||0!==e._m[7]||0!==e._m[8]||0!==e._m[9]||0!==e._m[10]||0!==e._m[11]||0!==e._m[12]||0!==e._m[13]||0!==e._m[14]?e.isIdentity3x2=!1:e.isIdentity3x2=!0),e.isIdentity3x2},e.determinant=w,e.toArray=function(e){return e._m},e.asArray=function(e){return e._m},e.reset=function(e){o(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,e),z(e,!1)},e.add=function(e,t){const n=r();return O(e,t,n),n},e.addToRef=O,e.addToSelf=function(e,t){for(let n=0;n<16;n++)e._m[n]+=t._m[n];I(e)},e.invert=function(e){const t=r();return C(e,t),t},e.invertToRef=C,e.addAtIndex=function(e,t,n){e._m[t]+=n,I(e)},e.multiplyAtIndex=function(e,t,n){return e._m[t]*=n,I(e),e},e.setTranslationFromFloats=B,e.setTranslation=k,e.getTranslation=function(e){return Vector3.create(e._m[12],e._m[13],e._m[14])},e.getTranslationToRef=function(e,t){t.x=e._m[12],t.y=e._m[13],t.z=e._m[14]},e.removeRotationAndScaling=function(e){const t=e._m;return o(1,0,0,0,0,1,0,0,0,0,1,0,t[12],t[13],t[14],t[15],e),z(e,0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]),e},e.multiply=function(e,t){const n=r();return L(e,t,n),n},e.copy=N,e.copyToArray=M,e.multiplyToRef=L,e.multiplyToArray=U,e.equals=function(e,t){const n=t;if(!n)return!1;if((e.isIdentity||n.isIdentity)&&!e._isIdentityDirty&&!n._isIdentityDirty)return e.isIdentity&&n.isIdentity;const r=e._m,i=n._m;return r[0]===i[0]&&r[1]===i[1]&&r[2]===i[2]&&r[3]===i[3]&&r[4]===i[4]&&r[5]===i[5]&&r[6]===i[6]&&r[7]===i[7]&&r[8]===i[8]&&r[9]===i[9]&&r[10]===i[10]&&r[11]===i[11]&&r[12]===i[12]&&r[13]===i[13]&&r[14]===i[14]&&r[15]===i[15]},e.clone=function(e){const t=r();return N(e,t),t},e.getHashCode=function(e){let t=e._m[0]||0;for(let n=1;n<16;n++)t=397*t^(e._m[n]||0);return t},e.decompose=x,e.setRowFromFloats=function(e,t,n,r,i,o){if(t<0||t>3)return;const a=4*t;e._m[a+0]=n,e._m[a+1]=r,e._m[a+2]=i,e._m[a+3]=o,I(e)},e.scale=function(e,t){const n=r();return D(e,t,n),n},e.scaleToRef=D,e.scaleAndAddToRef=function(e,t,n){for(let r=0;r<16;r++)n._m[r]+=e._m[r]*t;I(n)},e.normalMatrixToRef=function(e,t){const n=r();C(e,n),A(n,t);const i=t._m;o(i[0],i[1],i[2],0,i[4],i[5],i[6],0,i[8],i[9],i[10],0,0,0,0,1,t)},e.getRotationMatrix=function(e){const t=r();return F(e,t),t},e.getRotationMatrixToRef=F,e.toggleModelMatrixHandInPlace=function(e){e._m[2]*=-1,e._m[6]*=-1,e._m[8]*=-1,e._m[9]*=-1,e._m[14]*=-1,I(e)},e.toggleProjectionMatrixHandInPlace=function(e){e._m[8]*=-1,e._m[9]*=-1,e._m[10]*=-1,e._m[11]*=-1,I(e)}}(Matrix||(Matrix={})),function(e){function t(e=0,t=0,n=0,r=1){return{x:e,y:t,z:n,w:r}}function n(e,n,r){const i=.5*n,o=.5*e,a=.5*r,s=Math.cos(i),c=Math.cos(o),u=Math.cos(a),l=Math.sin(i),f=Math.sin(o),d=Math.sin(a);return t(c*l*u+f*s*d,f*s*u-c*l*d,c*s*d-f*l*u,c*s*u+f*l*d)}function r(e){return Math.sqrt(i(e))}function i(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w}function o(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w}function a(e,t){const n=o(e,t);return 2*Math.acos(Math.min(Math.abs(n),1))*RAD2DEG}function s(e){const n=1/r(e);return t(e.x*n,e.y*n,e.z*n,e.w*n)}function c(){return t(0,0,0,1)}function u(t,n,r){const i=e.Identity();return e.slerpToRef(t,n,r,i),i}function l(e,t,n){n.x=e.x*t.w+e.y*t.z-e.z*t.y+e.w*t.x,n.y=-e.x*t.z+e.y*t.w+e.z*t.x+e.w*t.y,n.z=e.x*t.y-e.y*t.x+e.z*t.w+e.w*t.z,n.w=-e.x*t.x-e.y*t.y-e.z*t.z+e.w*t.w}function f(t,n,r,i){const o=Matrix.create();Matrix.fromXYZAxesToRef(Vector3.normalize(t),Vector3.normalize(n),Vector3.normalize(r),o),e.fromRotationMatrixToRef(o,i)}function d(t,n,r=Vector3.Up(),i){const o=Matrix.Identity();Matrix.lookAtLHToRef(t,n,r,o),Matrix.invertToRef(o,o),e.fromRotationMatrixToRef(o,i)}e.create=t,e.add=function(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z,w:e.w+t.w}},e.fromRotationYawPitchRoll=n,e.fromEulerDegrees=function(e,t,r){return n(t*DEG2RAD,e*DEG2RAD,r*DEG2RAD)},e.length=r,e.lengthSquared=i,e.dot=o,e.angle=a,e.rotateTowards=function(e,t,n){const r=a(e,t);return 0===r?t:u(e,t,Math.min(1,n/r))},e.lookRotation=function(e,n={x:0,y:1,z:0}){const r=Vector3.normalize(e),i=Vector3.normalize(Vector3.cross(n,r)),o=Vector3.cross(r,i),a=i.x,s=i.y,c=i.z,u=o.x,l=o.y,f=o.z,d=r.x,h=r.y,p=r.z,m=a+l+p,y=t();if(m>0){let e=Math.sqrt(m+1);return y.w=.5*e,e=.5/e,y.x=(f-h)*e,y.y=(d-c)*e,y.z=(s-u)*e,y}if(a>=l&&a>=p){const e=Math.sqrt(1+a-l-p),t=.5/e;return y.x=.5*e,y.y=(s+u)*t,y.z=(c+d)*t,y.w=(f-h)*t,y}if(l>p){const e=Math.sqrt(1+l-a-p),t=.5/e;return y.x=(u+s)*t,y.y=.5*e,y.z=(h+f)*t,y.w=(d-c)*t,y}const g=Math.sqrt(1+p-a-l),E=.5/g;return y.x=(d+c)*E,y.y=(h+f)*E,y.z=.5*g,y.w=(s-u)*E,y},e.normalize=s,e.fromToRotation=function(e,n,r=Vector3.Up()){const i=Vector3.normalize(e),o=Vector3.normalize(n),a=Vector3.cross(i,o),u=Math.sqrt(Vector3.lengthSquared(i)*Vector3.lengthSquared(o))+Vector3.dot(i,o);return Vector3.lengthSquared(a)<1e-4?Math.abs(u)<1e-4?s(t(r.x,r.y,r.z,0)):c():s(t(a.x,a.y,a.z,u))},e.Identity=c,e.toEulerAngles=function(e){const t=Vector3.create(),n=e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w,r=e.x*e.w-e.y*e.z;return r>.4995*n?(t.x=Math.PI/2,t.y=2*Math.atan2(e.y,e.x),t.z=0):r<-.4995*n?(t.x=-Math.PI/2,t.y=-2*Math.atan2(e.y,e.x),t.z=0):(t.x=Math.asin(2*(e.w*e.x-e.y*e.z)),t.y=Math.atan2(2*e.w*e.y+2*e.z*e.x,1-2*(e.x*e.x+e.y*e.y)),t.z=Math.atan2(2*e.w*e.z+2*e.x*e.y,1-2*(e.z*e.z+e.x*e.x))),t.x*=RAD2DEG,t.y*=RAD2DEG,t.z*=RAD2DEG,t.x=Scalar.repeat(t.x,360),t.y=Scalar.repeat(t.y,360),t.z=Scalar.repeat(t.z,360),t},e.fromRotationYawPitchRollToRef=function(e,t,n,r){const i=.5*t,o=.5*e,a=.5*n,s=Math.cos(i),c=Math.cos(o),u=Math.cos(a),l=Math.sin(i),f=Math.sin(o),d=Math.sin(a);r.x=c*l*u+f*s*d,r.y=f*s*u-c*l*d,r.z=c*s*d-f*l*u,r.w=c*s*u+f*l*d},e.fromRotationMatrixToRef=function(e,t){const n=e._m,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],c=n[9],u=n[2],l=n[6],f=n[10],d=r+s+f;let h;d>0?(h=.5/Math.sqrt(d+1),t.w=.25/h,t.x=(l-c)*h,t.y=(o-u)*h,t.z=(a-i)*h):r>s&&r>f?(h=2*Math.sqrt(1+r-s-f),t.w=(l-c)/h,t.x=.25*h,t.y=(i+a)/h,t.z=(o+u)/h):s>f?(h=2*Math.sqrt(1+s-r-f),t.w=(o-u)/h,t.x=(i+a)/h,t.y=.25*h,t.z=(c+l)/h):(h=2*Math.sqrt(1+f-r-s),t.w=(a-i)/h,t.x=(o+u)/h,t.y=(c+l)/h,t.z=.25*h)},e.slerp=u,e.slerpToRef=function(e,t,n,r){let i,o,a=e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w,s=!1;if(a<0&&(s=!0,a=-a),a>.999999)o=1-n,i=s?-n:n;else{const e=Math.acos(a),t=1/Math.sin(e);o=Math.sin((1-n)*e)*t,i=s?-Math.sin(n*e)*t:Math.sin(n*e)*t}r.x=o*e.x+i*t.x,r.y=o*e.y+i*t.y,r.z=o*e.z+i*t.z,r.w=o*e.w+i*t.w},e.multiply=function(e,n){const r=t(0,0,0,1);return l(e,n,r),r},e.multiplyToRef=l,e.fromAngleAxis=function(t,n){if(0===Vector3.lengthSquared(n))return e.Identity();const r=c();let i=t*DEG2RAD;i*=.5;const o=Vector3.normalize(n);return Vector3.scaleToRef(o,Math.sin(i),o),r.x=o.x,r.y=o.y,r.z=o.z,r.w=Math.cos(i),s(r)},e.fromAxisToRotationQuaternion=function(t,n,r){const i=e.create(0,0,0,0);return f(t,n,r,i),i},e.fromAxisToRotationQuaternionToRef=f,e.Zero=function(){return t(0,0,0,0)},e.fromLookAt=function(t,n,r=Vector3.Up()){const i=e.Identity();return d(t,n,r,i),i},e.fromLookAtToRef=d}(Quaternion||(Quaternion={})),function(e){function t(e=0,t=0){return{x:e,y:t}}e.create=t,e.Zero=function(){return t(0,0)},e.One=function(){return t(1,1)}}(Vector2||(Vector2={})),function(e){function t(e=0,t=0,n=0,r=1){return{r:e,g:t,b:n,a:r}}function n(){return t(0,0,0,0)}function r(e,t,n){n.r=e.r+t.r,n.g=e.g+t.g,n.b=e.b+t.b,n.a=e.a+t.a}function i(e,t,n){n.r=e.r-t.r,n.g=e.g-t.g,n.b=e.b-t.b,n.a=e.a-t.a}function o(e,t){t.r=Math.pow(e.r,ToLinearSpace),t.g=Math.pow(e.g,ToLinearSpace),t.b=Math.pow(e.b,ToLinearSpace),t.a=e.a}function a(e,t){t.r=Math.pow(e.r,ToGammaSpace),t.g=Math.pow(e.g,ToGammaSpace),t.b=Math.pow(e.b,ToGammaSpace),t.a=e.a}e.create=t,e.fromHexString=function(n){if("#"!==n.substring(0,1)||7!==n.length&&9!==n.length)return t(0,0,0,1);const r=parseInt(n.substring(1,3),16),i=parseInt(n.substring(3,5),16),o=parseInt(n.substring(5,7),16),a=n.substring(7,9),s=a?parseInt(a,16):255;return e.fromInts(r,i,o,s)},e.lerp=function(n,r,i){const o=t(0,0,0,0);return e.lerpToRef(n,r,i,o),o},e.lerpToRef=function(e,t,n,r){r.r=e.r+(t.r-e.r)*n,r.g=e.g+(t.g-e.g)*n,r.b=e.b+(t.b-e.b)*n,r.a=e.a+(t.a-e.a)*n},e.Red=function(){return t(1,0,0,1)},e.Green=function(){return t(0,1,0,1)},e.Blue=function(){return t(0,0,1,1)},e.Black=function(){return t(0,0,0,1)},e.White=function(){return t(1,1,1,1)},e.Purple=function(){return t(.5,0,.5,1)},e.Magenta=function(){return t(1,0,1,1)},e.Yellow=function(){return t(1,1,0,1)},e.Gray=function(){return t(.5,.5,.5,1)},e.Teal=function(){return t(0,1,1,1)},e.Clear=n,e.fromColor3=function(e,n=1){return t(e.r,e.g,e.b,n)},e.fromArray=function(e,n=0){return t(e[n],e[n+1],e[n+2],e[n+3])},e.fromInts=function(e,n,r,i){return t(e/255,n/255,r/255,i/255)},e.checkColors4=function(e,t){if(e.length===3*t){const t=[];for(let n=0;n<e.length;n+=3){const r=n/3*4;t[r]=e[n],t[r+1]=e[n+1],t[r+2]=e[n+2],t[r+3]=1}return t}return e},e.addToRef=r,e.toArray=function(e,t,n=0){t[n]=e.r,t[n+1]=e.g,t[n+2]=e.b,t[n+3]=e.a},e.add=function(e,t){const i=n();return r(e,t,i),i},e.subtract=function(e,t){const r=n();return i(e,t,r),r},e.subtractToRef=i,e.scale=function(e,n){return t(e.r*n,e.g*n,e.b*n,e.a*n)},e.scaleToRef=function(e,t,n){n.r=e.r*t,n.g=e.g*t,n.b=e.b*t,n.a=e.a*t},e.scaleAndAddToRef=function(e,t,n){n.r+=e.r*t,n.g+=e.g*t,n.b+=e.b*t,n.a+=e.a*t},e.clampToRef=function(e,t=0,n=1,r){r.r=Scalar.clamp(e.r,t,n),r.g=Scalar.clamp(e.g,t,n),r.b=Scalar.clamp(e.b,t,n),r.a=Scalar.clamp(e.a,t,n)},e.multiply=function(e,n){return t(e.r*n.r,e.g*n.g,e.b*n.b,e.a*n.a)},e.multiplyToRef=function(e,t,n){n.r=e.r*t.r,n.g=e.g*t.g,n.b=e.b*t.b,n.a=e.a*t.a},e.toString=function(e){return"{R: "+e.r+" G:"+e.g+" B:"+e.b+" A:"+e.a+"}"},e.getHashCode=function(e){let t=e.r||0;return t=397*t^(e.g||0),t=397*t^(e.b||0),t=397*t^(e.a||0),t},e.clone=function(e){return t(e.r,e.g,e.b,e.a)},e.copyFrom=function(e,t){t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a},e.copyFromFloats=function(e,t,n,r,i){i.r=e,i.g=t,i.b=n,i.a=r},e.set=function(e,t,n,r,i){i.r=e,i.g=t,i.b=n,i.a=r},e.toHexString=function(e){const t=255*e.r|0,n=255*e.g|0,r=255*e.b|0,i=255*e.a|0;return"#"+Scalar.toHex(t)+Scalar.toHex(n)+Scalar.toHex(r)+Scalar.toHex(i)},e.toLinearSpace=function(e){const n=t();return o(e,n),n},e.toLinearSpaceToRef=o,e.toGammaSpace=function(e){const n=t();return a(e,n),n},e.toGammaSpaceToRef=a}(Color4||(Color4={})),function(e){function t(e=0,t=0,n=0){return{r:e,g:t,b:n}}function n(e,n,r){return t(e/255,n/255,r/255)}function r(e,t,n=0){t[n]=e.r,t[n+1]=e.g,t[n+2]=e.b}function i(e,t=0,n=1,r){r.r=Scalar.clamp(e.r,t,n),r.g=Scalar.clamp(e.g,t,n),r.b=Scalar.clamp(e.b,t,n)}function o(e,t){t.r=Math.pow(e.r,ToLinearSpace),t.g=Math.pow(e.g,ToLinearSpace),t.b=Math.pow(e.b,ToLinearSpace)}function a(e,t){t.r=Math.pow(e.r,ToGammaSpace),t.g=Math.pow(e.g,ToGammaSpace),t.b=Math.pow(e.b,ToGammaSpace)}e.create=t,e.fromHexString=function(e){return"#"!==e.substring(0,1)||7!==e.length?t(0,0,0):n(parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16))},e.fromArray=function(e,n=0){return t(e[n],e[n+1],e[n+2])},e.fromInts=n,e.lerp=function(n,r,i){const o=t(0,0,0);return e.lerpToRef(n,r,i,o),o},e.lerpToRef=function(e,t,n,r){r.r=e.r+(t.r-e.r)*n,r.g=e.g+(t.g-e.g)*n,r.b=e.b+(t.b-e.b)*n},e.Red=function(){return t(1,0,0)},e.Green=function(){return t(0,1,0)},e.Blue=function(){return t(0,0,1)},e.Black=function(){return t(0,0,0)},e.White=function(){return t(1,1,1)},e.Purple=function(){return t(.5,0,.5)},e.Magenta=function(){return t(1,0,1)},e.Yellow=function(){return t(1,1,0)},e.Gray=function(){return t(.5,.5,.5)},e.Teal=function(){return t(0,1,1)},e.Random=function(){return t(Math.random(),Math.random(),Math.random())},e.toString=function(e){return"{R: "+e.r+" G:"+e.g+" B:"+e.b+"}"},e.getHashCode=function(e){let t=e.r||0;return t=397*t^(e.g||0),t=397*t^(e.b||0),t},e.toArray=r,e.toColor4=function(e,t=1){return Color4.create(e.r,e.g,e.b,t)},e.asArray=function(e){const t=new Array;return r(e,t,0),t},e.toLuminance=function(e){return.3*e.r+.59*e.g+.11*e.b},e.multiply=function(e,n){return t(e.r*n.r,e.g*n.g,e.b*n.b)},e.multiplyToRef=function(e,t,n){n.r=e.r*t.r,n.g=e.g*t.g,n.b=e.b*t.b},e.equals=function(e,t){return t&&e.r===t.r&&e.g===t.g&&e.b===t.b},e.equalsFloats=function(e,t,n,r){return e.r===t&&e.g===n&&e.b===r},e.scale=function(e,n){return t(e.r*n,e.g*n,e.b*n)},e.scaleToRef=function(e,t,n){n.r=e.r*t,n.g=e.g*t,n.b=e.b*t},e.scaleAndAddToRef=function(e,t,n){n.r+=e.r*t,n.g+=e.g*t,n.b+=e.b*t},e.clampToRef=i,e.clamp=function(t,n=0,r=1){const o=e.Black();return i(t,n,r,o),o},e.add=function(e,n){return t(e.r+n.r,e.g+n.g,e.b+n.b)},e.addToRef=function(e,t,n){n.r=e.r+t.r,n.g=e.g+t.g,n.b=e.b+t.b},e.subtract=function(e,n){return t(e.r-n.r,e.g-n.g,e.b-n.b)},e.subtractToRef=function(e,t,n){n.r=e.r-t.r,n.g=e.g-t.g,n.b=e.b-t.b},e.clone=function(e){return t(e.r,e.g,e.b)},e.copyFrom=function(e,t){t.r=e.r,t.g=e.g,t.b=e.b},e.set=function(e,t,n,r){e.r=t,e.g=n,e.b=r},e.toHexString=function(e){const t=255*e.r|0,n=255*e.g|0,r=255*e.b|0;return"#"+Scalar.toHex(t)+Scalar.toHex(n)+Scalar.toHex(r)},e.toLinearSpace=function(e){const n=t();return o(e,n),n},e.toLinearSpaceToRef=o,e.toGammaSpace=function(e){const n=t();return a(e,n),n},e.toGammaSpaceToRef=a}(Color3||(Color3={})),function(e){e.LINEAR="linear",e.EASEINQUAD="easeinquad",e.EASEOUTQUAD="easeoutquad",e.EASEQUAD="easequad",e.EASEINSINE="easeinsine",e.EASEOUTSINE="easeoutsine",e.EASESINE="easeinoutsine",e.EASEINEXPO="easeinexpo",e.EASEOUTEXPO="easeoutexpo",e.EASEEXPO="easeinoutexpo",e.EASEINELASTIC="easeinelastic",e.EASEOUTELASTIC="easeoutelastic",e.EASEELASTIC="easeinoutelastic",e.EASEINBOUNCE="easeinbounce",e.EASEOUTEBOUNCE="easeoutbounce",e.EASEBOUNCE="easeinoutbounce"}(InterpolationType||(InterpolationType={}));const REGULAR_PRIORITY=1e5;var priority;function createTimers(e){const t=new Map;let n=0;return e.addSystem((function(e){let n=[],r=[];for(let[i,o]of t)o.accumulatedTime+=1e3*e,o.accumulatedTime<o.interval||(r.push(o.callback),o.recurrent?o.accumulatedTime-=Math.floor(o.accumulatedTime/o.interval)*o.interval:n.push(i));for(let e of n)t.delete(e);for(let e of r)e()}),priority.TimerSystemPriority),{setTimeout(e,r){let i=n++;return t.set(i,{callback:e,interval:r,recurrent:!1,accumulatedTime:0}),i},clearTimeout(e){t.delete(e)},setInterval(e,r){let i=n++;return t.set(i,{callback:e,interval:r,recurrent:!0,accumulatedTime:0}),i},clearInterval(e){t.delete(e)}}}!function(e){e.TimerSystemPriority=REGULAR_PRIORITY+256,e.TweenSystemPriority=REGULAR_PRIORITY+192,e.PerpetualMotionSystemPriority=REGULAR_PRIORITY+192,e.PathSystemPriority=REGULAR_PRIORITY+192,e.TriggerSystemPriority=REGULAR_PRIORITY+128,e.ActionSystemPriority=REGULAR_PRIORITY+64}(priority||(priority={}));const timers=createTimers(engine);var ToggleState,AXIS;function createToggles(e,t){const n=e.defineComponent("dcl.utils.Toggle",{state:Schemas.EnumNumber(ToggleState,ToggleState.Off)});let r=new Map;return t.setInterval((function(){for(const t of r.keys())e.getEntityState(t)!=EntityState.Removed&&n.has(t)||r.delete(t)}),5e3),{addToggle(e,t,i){r.set(e,i),n.createOrReplace(e,{state:t})},removeToggle(e){r.delete(e),n.deleteFrom(e)},setCallback(e,t){r.set(e,t)},set(e,t){if(n.get(e).state!=t){n.getMutable(e).state=t;const i=r.get(e);i&&i(t)}},flip(e){this.set(e,1-n.get(e).state)},isOn:e=>n.get(e).state==ToggleState.On}}function getEasingFunctionFromInterpolation(e){switch(e){case InterpolationType.LINEAR:return 0;case InterpolationType.EASEINQUAD:return 1;case InterpolationType.EASEOUTQUAD:return 2;case InterpolationType.EASEQUAD:return 3;case InterpolationType.EASEINSINE:return 4;case InterpolationType.EASEOUTSINE:return 5;case InterpolationType.EASESINE:return 6;case InterpolationType.EASEINEXPO:return 7;case InterpolationType.EASEOUTEXPO:return 8;case InterpolationType.EASEEXPO:return 9;case InterpolationType.EASEINELASTIC:return 10;case InterpolationType.EASEOUTELASTIC:return 11;case InterpolationType.EASEELASTIC:return 12;case InterpolationType.EASEINBOUNCE:return 13;case InterpolationType.EASEOUTEBOUNCE:return 14;case InterpolationType.EASEBOUNCE:return 15;default:return 0}}function createTweens(e){const t=new Map;function n(e){Tween.deleteFrom(e),t.delete(e)}function r(e){return function(n,r,i,o,a=InterpolationType.LINEAR,s){const c=0===o?1:0;t.set(n,{normalizedTime:c,callback:s}),Tween.createOrReplace(n,{duration:1e3*o,easingFunction:getEasingFunctionFromInterpolation(a),currentTime:c,mode:Tween.Mode[e]({start:r,end:i})})}}function i(e){if(!t.has(e))throw new Error(`Entity ${e} is not registered with tweens system`);return t.get(e)}return e.addSystem((function(n){const r=[];for(const[i,o]of t.entries()){if(e.getEntityState(i)==EntityState.Removed||!Tween.has(i)){t.delete(i);continue}const a=Tween.get(i);o.normalizedTime+=1e3*n,o.normalizedTime>=a.duration&&r.push(i)}for(const e of r){const n=t.get(e)?.callback;Tween.deleteFrom(e),t.delete(e),n&&n()}}),priority.TweenSystemPriority),{startTranslation:r("Move"),stopTranslation:n,startRotation:r("Rotate"),stopRotation:n,startScaling:r("Scale"),stopScaling:n,getTranslationOnFinishCallback:i,getRotationOnFinishCallback:i,getScalingOnFinishCallback:i}}function createPerpetualMotions(e){const t=e.defineComponent("dcl.utils.PerpetualRotation",{velocity:Schemas.Quaternion});return e.addSystem((function(n){for(const[r,i]of e.getEntitiesWith(t,Transform)){const e=Quaternion.slerp(Quaternion.Identity(),i.velocity,n),t=Transform.getMutable(r);t.rotation=Quaternion.normalize(Quaternion.multiply(t.rotation,e))}}),priority.PerpetualMotionSystemPriority),{startRotation(e,n){t.createOrReplace(e,{velocity:n})},stopRotation(e){Tween.has(e)&&Tween.deleteFrom(e),TweenSequence.has(e)&&TweenSequence.deleteFrom(e),t.has(e)&&t.deleteFrom(e)},smoothRotation(e,t,n){let r=Quaternion.fromEulerDegrees(0,180,0),i=Quaternion.fromEulerDegrees(0,360,0);switch(n){case AXIS.X:r=Quaternion.fromEulerDegrees(180,0,0),i=Quaternion.fromEulerDegrees(360,0,0);break;case AXIS.Y:r=Quaternion.fromEulerDegrees(0,180,0),i=Quaternion.fromEulerDegrees(0,360,0);break;case AXIS.Z:r=Quaternion.fromEulerDegrees(0,0,180),i=Quaternion.fromEulerDegrees(0,0,360)}Tween.createOrReplace(e,{mode:Tween.Mode.Rotate({start:Quaternion.fromEulerDegrees(0,0,0),end:r}),duration:t/2,easingFunction:0}),TweenSequence.create(e,{loop:0,sequence:[{mode:Tween.Mode.Rotate({start:r,end:i}),duration:t/2,easingFunction:0}]})}}}function createPaths(e){const t=e.defineComponent("dcl.utils.FollowPath",{points:Schemas.Array(Schemas.Vector3),faceDirection:Schemas.Boolean,speed:Schemas.Number,normalizedTime:Schemas.Number,currentIndex:Schemas.Number,segmentTimes:Schemas.Array(Schemas.Number),curveSegmentCount:Schemas.Number}),n=new Map,r=new Map;function i(e){n.delete(e),r.delete(e),t.deleteFrom(e)}function o(e,i,o,a,s,c,u){if(i.length<2)throw new Error("At least 2 points are required to form a path.");if(0==o)throw new Error("Path duration must not be zero");if(s){const e=Vector3.equals(i[0],i[i.length-1]);e&&(i.pop(),i.unshift(i.pop())),i=createCatmullRomSpline(i,s,e)}else s=1;n.set(e,c),r.set(e,u);let l=0;const f=[];for(let e=0;e<i.length-1;e++){let t=Vector3.distance(i[e],i[e+1]);l+=t,f.push(t)}const d=[0];for(let e=0;e<f.length;e++)d.push(f[e]/l+d[e]);t.createOrReplace(e,{points:i,segmentTimes:d,curveSegmentCount:s,speed:1/o,normalizedTime:0,currentIndex:0,faceDirection:a})}return e.addSystem((function(o){const a=[],s=[];for(const r of n.keys()){if(e.getEntityState(r)==EntityState.Removed||!t.has(r)){i(r);continue}const n=Transform.getMutable(r),c=t.getMutable(r);for(c.normalizedTime=Scalar.clamp(c.normalizedTime+o*c.speed,0,1),c.normalizedTime>=1&&a.push(r);c.normalizedTime>=c.segmentTimes[c.currentIndex]&&c.currentIndex<c.points.length-1;){if(c.faceDirection){const e=Vector3.subtract(c.points[c.currentIndex+1],c.points[c.currentIndex]);n.rotation=Quaternion.lookRotation(e)}if(c.currentIndex>0&&c.currentIndex%c.curveSegmentCount==0){const e=c.currentIndex/c.curveSegmentCount,t=c.points[c.currentIndex],n=c.points[c.currentIndex+c.curveSegmentCount];s.push({entity:r,index:e,coords:t,nextCoords:n})}c.currentIndex+=1}const u=c.segmentTimes[c.currentIndex]-c.segmentTimes[c.currentIndex-1],l=(c.segmentTimes[c.currentIndex]-c.normalizedTime)/u;n.position=Vector3.lerp(c.points[c.currentIndex],c.points[c.currentIndex-1],l)}for(const e of s){const t=r.get(e.entity);t&&t(e.index,e.coords,e.nextCoords)}for(const e of a){const t=n.get(e);i(e),t&&t()}}),priority.PathSystemPriority),{startStraightPath:(e,t,n,r,i,a)=>o(e,t,n,r,0,i,a),startSmoothPath(e,t,n,r,i,a,s){if(r<2||!Number.isInteger(r))throw new Error(`segmentCount must be an integer that is greater than 2, got: ${r}`);return o(e,t,n,i,r,a,s)},stopPath(e){i(e)},getOnFinishCallback(e){if(!n.has(e))throw new Error(`Entity ${e} is not registered in triggers system`);return n.get(e)}}}!function(e){e[e.Off=0]="Off",e[e.On=1]="On"}(ToggleState||(ToggleState={})),createToggles(engine,timers),createTweens(engine),function(e){e.X="x",e.Y="y",e.Z="z"}(AXIS||(AXIS={})),createPerpetualMotions(engine),createPaths(engine);const LAYER_1=1,ALL_LAYERS=255,NO_LAYERS=0;let PLAYER_LAYER_ID=LAYER_1;function createTriggers(e){const t=engine.defineComponent("dcl.utils.Trigger",{active:Schemas.Boolean,layerMask:Schemas.Int,triggeredByMask:Schemas.Int,areas:Schemas.Array(Schemas.OneOf({box:Schemas.Map({position:Schemas.Vector3,scale:Schemas.Vector3}),sphere:Schemas.Map({position:Schemas.Vector3,radius:Schemas.Number})})),debugColor:Schemas.Color3}),n=new Map,r=new Map;let i=!1;const o=new Map,a=new Map;function s(e,t,n,r){for(let i=0;i<t.areas.length;++i){const o=e[i],a=t.areas[i];if("box"==a.$case){const e=a.value,t=Vector3.subtract(o,Vector3.scale(e.scale,.5)),i=Vector3.add(t,e.scale);for(let e=0;e<r.areas.length;++e){const o=n[e],a=r.areas[e];if("box"==a.$case){const e=a.value,n=Vector3.subtract(o,Vector3.scale(e.scale,.5));if(areAABBIntersecting(t,i,n,Vector3.add(n,e.scale)))return!0}else if(areAABBSphereIntersecting(t,i,o,a.value.radius))return!0}}else{const e=a.value.radius;for(let t=0;t<r.areas.length;++t){const i=n[t],a=r.areas[t];if("box"==a.$case){const t=a.value,n=Vector3.subtract(i,Vector3.scale(t.scale,.5));if(areAABBSphereIntersecting(n,Vector3.add(n,t.scale),o,e))return!0}else if(areSpheresIntersecting(o,e,i,a.value.radius))return!0}}}return!1}function c(n,r){let i=EMPTY_IMMUTABLE_SET;const o=t.get(n);if(!o.active)return i;if(o.triggeredByMask==PLAYER_LAYER_ID){const a=e.PlayerEntity,c=t.get(e.PlayerEntity);if(a==n)return i;if(!c.active)return i;if(!(o.triggeredByMask&c.layerMask))return i;s(r.get(n),o,r.get(a),c)&&(i===EMPTY_IMMUTABLE_SET&&(i=new Set),i.add(a))}else for(const[a,c]of e.getEntitiesWith(t,Transform)){if(a==n)continue;if(!c.active)continue;if(!(o.triggeredByMask&c.layerMask))continue;s(r.get(n),o,r.get(a),c)&&(i===EMPTY_IMMUTABLE_SET&&(i=new Set),i.add(a))}return i}function u(e){e||(e=[{type:"box"}]);const t=[];for(const n of e)"box"==n.type?t.push({$case:"box",value:{position:n.position?n.position:Vector3.Zero(),scale:n.scale?n.scale:Vector3.One()}}):t.push({$case:"sphere",value:{position:n.position?n.position:Vector3.Zero(),radius:n.radius?n.radius:1}});return t}e.addSystem((function(s){!function(){const i=[],s=[],u=new Map;for(const i of o.keys()){if(e.getEntityState(i)==EntityState.Removed||!t.has(i)){for(const t of a.get(i))e.removeEntity(t);for(const e of o.values())e.has(i)&&e.delete(i);a.delete(i),o.delete(i),n.delete(i),r.delete(i);continue}const s=[],c=getWorldPosition(i),l=getWorldRotation(i),f=t.get(i);for(const e of f.areas)s.push(Vector3.add(c,Vector3.rotate(e.value.position,l)));u.set(i,s)}for(const e of o.keys()){const t=c(e,u),n=o.get(e);for(const r of n)t.has(r)||s.push([e,r]);for(const r of t)n.has(r)||i.push([e,r]);o.set(e,t)}for(const[e,t]of i){const r=n.get(e);r&&r(t)}for(const[e,t]of s){const n=r.get(e);n&&n(t)}}(),function(n){if(n)for(const[n,r]of e.getEntitiesWith(t,Transform)){let t=a.get(n);const i=r.areas.length;for(;t.length>i;)e.removeEntity(t.pop());for(;t.length<i;)t.push(e.addEntity());const o=getWorldPosition(n),s=getWorldRotation(n);for(let e=0;e<i;++e){const n=r.areas[e],i=t[e];let a;if("box"==n.$case)a=n.value.scale,MeshRenderer.setBox(i);else{const e=n.value.radius;a={x:e,y:e,z:e},MeshRenderer.setSphere(i)}Transform.createOrReplace(i,{position:Vector3.add(o,Vector3.rotate(n.value.position,s)),scale:a});const c=r.active?r.debugColor:Color3.Black();Material.setPbrMaterial(i,{albedoColor:Color4.fromInts(255*c.r,255*c.g,255*c.b,75)})}}}(i)}),priority.TriggerSystemPriority);const l={addTrigger(e,i=NO_LAYERS,s=NO_LAYERS,c,l,f,d){if(i<0||i>ALL_LAYERS||!Number.isInteger(i))throw new Error(`Bad layerMask: ${i}. Expected a non-negative integer no greater than ${ALL_LAYERS}`);if(s<0||s>ALL_LAYERS||!Number.isInteger(s))throw new Error(`Bad triggeredByMask: ${s}. Expected a non-negative integer no greater than ${ALL_LAYERS}`);a.set(e,[]),o.set(e,new Set),n.set(e,l),r.set(e,f),t.createOrReplace(e,{active:!0,layerMask:i,triggeredByMask:s,areas:u(c),debugColor:d||Color3.Red()})},removeTrigger(i){const s=o.get(i),c=r.get(i);for(const t of a.get(i))e.removeEntity(t);a.delete(i),o.delete(i),n.delete(i),r.delete(i),t.deleteFrom(i);const u=[];for(const[e,t]of o)t.has(i)&&(t.delete(i),u.push(e));if(c)for(const e of s)c(e);for(const e of u){const t=r.get(e);t&&t(i)}},oneTimeTrigger(e,t=NO_LAYERS,n=NO_LAYERS,r,i,o){this.addTrigger(e,t,n,r,(function(t){triggers.removeTrigger(e),i&&i(t)}),void 0,o)},enableTrigger(e,n){t.getMutable(e).active=n},isTriggerEnabled:e=>t.get(e).active,getLayerMask:e=>t.get(e).layerMask,setLayerMask(e,n){if(n<0||n>ALL_LAYERS||!Number.isInteger(n))throw new Error(`Bad layerMask: ${n}. Expected a non-negative integer no greater than ${ALL_LAYERS}`);t.getMutable(e).layerMask=n},getTriggeredByMask:e=>t.get(e).triggeredByMask,setTriggeredByMask(e,n){if(n<0||n>ALL_LAYERS||!Number.isInteger(n))throw new Error(`Bad layerMask: ${n}. Expected a non-negative integer no greater than ${ALL_LAYERS}`);t.getMutable(e).triggeredByMask=n},getAreas:e=>t.get(e).areas,setAreas(e,n){t.getMutable(e).areas=u(n)},setOnEnterCallback(e,t){n.set(e,t)},setOnExitCallback(e,t){r.set(e,t)},enableDebugDraw(t){if(i=t,!t)for(const t of a.values()){for(const n of t)e.removeEntity(n);t.length=0}},isDebugDrawEnabled:()=>i};return l.addTrigger(e.PlayerEntity,PLAYER_LAYER_ID,NO_LAYERS,[{type:"box",scale:{x:.65,y:1.92,z:.65},position:{x:0,y:.96,z:0}}],void 0,void 0,Color3.Green()),l}const triggers=createTriggers(engine),EMPTY_IMMUTABLE_SET=new Set;var actions;EMPTY_IMMUTABLE_SET.add=e=>{throw new Error("EMPTY_SET is read only")},EMPTY_IMMUTABLE_SET.delete=e=>{throw new Error("EMPTY_SET is read only")},EMPTY_IMMUTABLE_SET.has=e=>!1,function(e){e.SequenceRunner=class{constructor(e,t,n){this.beginSequenceNode=null,this.currentSequenceNode=null,this.running=!1,this.started=!1,this.engine=e,this.systemFn=e=>{this.update(e)},this.engine.addSystem(this.systemFn,priority.ActionSystemPriority),t&&this.startSequence(t),n&&this.setOnFinishCallback(n)}startSequence(e){this.beginSequenceNode=e.beginSequenceNode,this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1}destroy(){this.engine.removeSystem(this.systemFn)}setOnFinishCallback(e){this.onFinishCallback=e}isRunning(){return this.running}stop(){this.running=!1}resume(){null!=this.beginSequenceNode&&(this.running=!0)}reset(){this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1}getRunningAction(){let e=this.currentSequenceNode;if(this.currentSequenceNode instanceof n)do{e=e.currentInnerSequence}while(e instanceof n);return e.action}update(e){if(this.running)return this.started?void(this.currentSequenceNode.hasFinish()?(this.currentSequenceNode.onFinish(),this.currentSequenceNode=this.currentSequenceNode.next,this.currentSequenceNode?this.currentSequenceNode.onStart():(this.running=!1,this.onFinishCallback&&this.onFinishCallback())):this.currentSequenceNode.update(e)):(this.currentSequenceNode.onStart(),void(this.started=!0))}};e.SequenceBuilder=class{constructor(){this.currentSequenceNode=null,this.beginSequenceNode=null,this.whileNodeStack=[]}then(e){if(null==this.currentSequenceNode)this.currentSequenceNode=new t,this.currentSequenceNode.action=e,this.beginSequenceNode=this.currentSequenceNode;else{let n=new t;n.action=e,this.currentSequenceNode=this.currentSequenceNode.then(n)}return this}if(e){let t=new r(e);return null==this.currentSequenceNode?(this.currentSequenceNode=t,this.beginSequenceNode=t):this.currentSequenceNode=this.currentSequenceNode.then(t),this}else(){let e=this.currentSequenceNode.getSequence();if(!(e instanceof r))throw new Error("IF statement is needed to be called before ELSE statement.");{e.closed=!0;let t=new i(e);this.currentSequenceNode=this.currentSequenceNode.then(t)}return this}endIf(){let e=this.currentSequenceNode.getSequence();if(!(e instanceof r||e instanceof i))throw new Error("IF statement is needed to be called before ENDIF statement.");return e.closed=!0,this}while(e){let t=new o(e);return null==this.currentSequenceNode?(this.currentSequenceNode=t,this.beginSequenceNode=t):this.currentSequenceNode=this.currentSequenceNode.then(t),this.whileNodeStack.push(t),this}endWhile(){let e=this.currentSequenceNode.getSequence();if(!(e instanceof o))throw new Error("WHILE statement is needed to be called before ENDWHILE statement.");return e.closed=!0,this.whileNodeStack.length>0&&this.whileNodeStack.splice(this.whileNodeStack.length-1,1),this}breakWhile(){if(!(this.whileNodeStack.length>0))throw new Error("WHILE statement is needed to be called before BREAKWHILE statement.");return this.currentSequenceNode=this.currentSequenceNode.then(new a(this.whileNodeStack[this.whileNodeStack.length-1])),this}};class t{constructor(){this.action=null,this.next=null}then(e){return this.next=e,e}onStart(){this.action&&this.action.onStart()}update(e){this.action&&this.action.update(e)}onFinish(){this.action&&this.action.onFinish()}hasFinish(){return!this.action||this.action.hasFinished}getSequence(){return this}}e.SequenceNode=t;class n extends t{constructor(){super(...arguments),this.currentInnerSequence=null,this.startingInnerSequence=null,this.closed=!1}then(e){if(null==this.currentInnerSequence)this.currentInnerSequence=e,this.startingInnerSequence=e;else{if(this.closed)return this.next=e,e;this.currentInnerSequence=this.currentInnerSequence.then(e)}return this}onStart(){this.currentInnerSequence=this.startingInnerSequence,this.currentInnerSequence&&this.currentInnerSequence.onStart()}update(e){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(e))}onFinish(){this.currentInnerSequence&&this.currentInnerSequence.onFinish()}hasFinish(){return null==this.currentInnerSequence}getSequence(){if(this.currentInnerSequence){let e=this.currentInnerSequence.getSequence();if(e instanceof n&&!e.closed)return e}return this}}class r extends n{constructor(e){super(),this.result=!1,this.condition=e}onStart(){this.result=this.condition(),this.result?super.onStart():this.currentInnerSequence=null}}class i extends n{constructor(e){super(),this.ifSequence=null,this.ifSequence=e}onStart(){this.ifSequence&&!this.ifSequence.result?super.onStart():this.currentInnerSequence=null}}class o extends n{constructor(e){super(),this.breakWhile=!1,this.condition=e}onStart(){this.breakWhile=!1,this.condition()?super.onStart():this.currentInnerSequence=null}update(e){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,null==this.currentInnerSequence&&(this.currentInnerSequence=this.startingInnerSequence),this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(e))}hasFinish(){return this.breakWhile||!this.condition()}}class a extends t{constructor(e){super(),this.whileNode=e}onStart(){this.whileNode.breakWhile=!0}}}(actions||(actions={}));const CLASSNAME="XMLHttpRequest";class XMLHttpRequest{constructor(){this.requestHeaders={};console.log(CLASSNAME,"constructor","ENTRY")}getAllResponseHeaders(){return this.responseHeadersRaw}setRequestHeader(e,t){console.log(CLASSNAME,"setRequestHeader","ENTRY",e,t),this.requestHeaders[e]=t}open(e,t){console.log(CLASSNAME,"open","ENTRY",e,t),this.method=e,this.url=t}send(e){const t="send";if(console.log(CLASSNAME,t,"ENTRY",e),!this.url)throw new Error("url is required");if(!this.method)throw new Error("method is required");fetch(this.url,{method:this.method,headers:this.requestHeaders,body:e,timeout:this.timeout}).then((async e=>{console.log(CLASSNAME,t,"PROMISE.ENTRY",e),this.status=e.status,this.statusText=e.statusText,this.response=await e.text(),this.responseHeadersRaw="",e.headers.forEach(((e,t)=>{this.responseHeadersRaw+=t+": "+e+"\r\n"})),console.log(CLASSNAME,t,"PROMISE.RESULT","this.status",this.status,"this.responseHeadersRaw",this.responseHeadersRaw),this.onload&&this.onload()})).catch((e=>{console.log("catching reason",e),!e.code||20!=e.code&&23!=e.code||(e.type="timeout"),this.onerror&&(this.onerror(e),console.log("on error reason",e))}))}}let player;Object.assign(globalThis,{FormData:class{},clearTimeout:timers.clearTimeout,setTimeout:timers.setTimeout,XMLHttpRequest:XMLHttpRequest}),null==console||console.warn||(console.warn=(...e)=>console.log("WARNING",...e));let pendingQuestConnections=[];const lscQuestEvent=mitt();var LSCQUEST_EVENTS;!function(e){e.QUEST_ERROR="QUEST_ERROR",e.QUEST_DATA="QUEST_DATA",e.QUEST_STARTED="QUEST_STARTED",e.QUEST_COMPLETE="QUEST_COMPLETE",e.QUEST_END="QUEST_END",e.QUEST_UPDATE="QUEST_UPDATE",e.QUEST_DISCONNECT="QUEST_DISCONNECT",e.QUEST_ACTION="QUEST_ACTION",e.QUEST_START="QUEST_START",e.QUEST_STEP_COMPLETE="STEP_COMPLETE",e.QUEST_TASK_COMPLETE="TASK_COMPLETE"}(LSCQUEST_EVENTS||(LSCQUEST_EVENTS={}));const lscQuestConnections=new Map,lscQuestUserData=new Map;async function LSCQuestConnect(e){engine.addSystem(CheckPlayerSystem),engine.addSystem(ConnectQuestSystem),lscQuestConnections.has(e)||pendingQuestConnections.push(e)}function LSCQuestStart(e){let t=lscQuestConnections.get(e);if(t)try{t.send(LSCQUEST_EVENTS.QUEST_START,{questId:e})}catch(e){console.log("error sending quest action",e)}}function LSCQuestAction(e,t,n){let r=lscQuestConnections.get(e);if(r)try{r.send(LSCQUEST_EVENTS.QUEST_ACTION,{questId:e,stepId:t,taskId:n,metaverse:"DECENTRALAND"})}catch(e){console.log("error sending quest action",e)}}function setLSCQuestListeners(e,t){e.onMessage(LSCQUEST_EVENTS.QUEST_ERROR,(e=>{console.log("quest error ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_ERROR,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_DATA,(e=>{console.log("user quest data ",e),lscQuestUserData.set(t,e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_DATA,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_STARTED,(e=>{console.log("started quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_STARTED,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_COMPLETE,(e=>{console.log("complete quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_COMPLETE,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_END,(e=>{console.log("ended quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_END,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_UPDATE,(e=>{console.log("update quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_UPDATE,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_STEP_COMPLETE,(e=>{console.log("step complete quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_UPDATE,e)})),e.onMessage(LSCQUEST_EVENTS.QUEST_TASK_COMPLETE,(e=>{console.log("task complete quest ",e),lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_UPDATE,e)}))}let time=0;function CheckPlayerSystem(e){time>0?time-=e:(player=getPlayer(),player?engine.removeSystem(CheckPlayerSystem):time=1)}function ConnectQuestSystem(){if(player&&pendingQuestConnections.length>0){makeQuestConnection(""+pendingQuestConnections.shift())}}async function makeQuestConnection(e){const t=await getRealm({}),n={userId:player.userId,name:player.name,realm:t.realmInfo?.baseUrl,questId:e};let r=new Client("http://localhost:5335");try{const t=await r.joinOrCreate("angzaar_questing",n);return lscQuestConnections.set(e,t),setLSCQuestListeners(t,player.userId),t.onLeave(((t,n)=>{lscQuestEvent.emit(LSCQUEST_EVENTS.QUEST_DISCONNECT,e)})),t}catch(e){throw console.error("Error connecting to LSC Quest System",e),e}}export{LSCQUEST_EVENTS,LSCQuestAction,LSCQuestConnect,LSCQuestStart,lscQuestConnections,lscQuestEvent,lscQuestUserData};
//# sourceMappingURL=index.js.map
