import { UiCanvasInformation, engine } from "@dcl/sdk/ecs";
import { Color4 } from "@dcl/sdk/math";
export let dimensions = {
    width: 0,
    height: 0
};
let timer = 0;
export function uiSizer(dt) {
    if (timer > 0) {
        timer -= dt;
    }
    else {
        timer = 3;
        let canvas = UiCanvasInformation.get(engine.RootEntity);
        dimensions.aspect = canvas.devicePixelRatio;
        dimensions.width = canvas.width;
        dimensions.height = canvas.height;
    }
}
export function calculateImageDimensions(width, aspectRatio) {
    const desiredWidth = width / 100 * dimensions.width;
    const desiredHeight = desiredWidth / aspectRatio;
    return { width: desiredWidth, height: desiredHeight };
}
export function calculateSquareImageDimensions(percentage) {
    const minDimension = Math.min(dimensions.width, dimensions.height);
    const squareSize = (minDimension * percentage) / 100;
    return { width: squareSize, height: squareSize };
}
export function addLineBreak(text, bubble, lineCount, large) {
    return lineBreak(text, lineCount);
}
function lineBreak(text, maxLineLength) {
    const words = text.split(' ');
    let currentLine = '';
    const lines = [];
    for (const word of words) {
        if (currentLine.length + word.length + 1 <= maxLineLength) {
            currentLine += `${word} `;
        }
        else {
            lines.push(currentLine.trim());
            currentLine = `${word} `;
        }
    }
    lines.push(currentLine.trim());
    return lines.join('\n');
}
export function sizeFont(large, small) {
    return dimensions.width > 2000 ? large : small;
}
export function getImageAtlasMapping(data) {
    if (!data)
        return [];
    const { atlasWidth, atlasHeight, sourceWidth, sourceHeight, sourceTop, sourceLeft, } = data;
    return [
        sourceLeft / atlasWidth, (atlasHeight - sourceTop - sourceHeight) / atlasHeight,
        sourceLeft / atlasWidth, (atlasHeight - sourceTop) / atlasHeight,
        (sourceLeft + sourceWidth) / atlasWidth, (atlasHeight - sourceTop) / atlasHeight,
        (sourceLeft + sourceWidth) / atlasWidth, (atlasHeight - sourceTop - sourceHeight) / atlasHeight,
    ];
}
export function getAspect(panel) {
    return panel.sourceWidth / panel.sourceHeight;
}
export function getUITransform(component, entiy, height = 100, width = 100, unit = 2) {
    let uiTransformComponent = component.getMutableOrNull(entiy);
    if (!uiTransformComponent) {
        uiTransformComponent = component.create(entiy);
        uiTransformComponent.heightUnit = unit;
        uiTransformComponent.widthUnit = unit;
        uiTransformComponent.height = height;
        uiTransformComponent.width = width;
        uiTransformComponent.maxHeightUnit = unit;
        uiTransformComponent.maxWidthUnit = unit;
        uiTransformComponent.maxHeight = height;
        uiTransformComponent.maxWidth = width;
    }
    if (entiy === 0) {
        uiTransformComponent.positionType = 1;
    }
    return uiTransformComponent;
}
export function getRandomColor4(alpha) {
    return Color4.create(Math.random(), Math.random(), Math.random(), alpha ? alpha : Math.random());
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9oZWxwZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBVSxtQkFBbUIsRUFBMEIsTUFBTSxFQUFFLE1BQU0sY0FBYyxDQUFBO0FBRTFGLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUE7QUFFdEMsTUFBTSxDQUFDLElBQUksVUFBVSxHQUFPO0lBQ3hCLEtBQUssRUFBQyxDQUFDO0lBQ1AsTUFBTSxFQUFDLENBQUM7Q0FDVCxDQUFBO0FBRUgsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFBO0FBQ2IsTUFBTSxVQUFVLE9BQU8sQ0FBQyxFQUFTO0lBQy9CLElBQUcsS0FBSyxHQUFHLENBQUMsRUFBQyxDQUFDO1FBQ1osS0FBSyxJQUFJLEVBQUUsQ0FBQTtJQUNiLENBQUM7U0FDRyxDQUFDO1FBQ0gsS0FBSyxHQUFHLENBQUMsQ0FBQTtRQUNULElBQUksTUFBTSxHQUFHLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUE7UUFHdkQsVUFBVSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsZ0JBQWdCLENBQUE7UUFDM0MsVUFBVSxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFBO1FBQy9CLFVBQVUsQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQTtJQUNuQyxDQUFDO0FBQ0gsQ0FBQztBQUVELE1BQU0sVUFBVSx3QkFBd0IsQ0FBQyxLQUFZLEVBQUUsV0FBbUI7SUFDeEUsTUFBTSxZQUFZLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDO0lBQ3BELE1BQU0sYUFBYSxHQUFHLFlBQVksR0FBRyxXQUFXLENBQUM7SUFDakQsT0FBTyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLGFBQWEsRUFBRSxDQUFDO0FBQ3hELENBQUM7QUFFRCxNQUFNLFVBQVUsOEJBQThCLENBQUMsVUFBa0I7SUFDL0QsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNuRSxNQUFNLFVBQVUsR0FBRyxDQUFDLFlBQVksR0FBRyxVQUFVLENBQUMsR0FBRyxHQUFHLENBQUM7SUFDckQsT0FBTyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxDQUFDO0FBQ25ELENBQUM7QUFFRCxNQUFNLFVBQVUsWUFBWSxDQUFDLElBQVcsRUFBRSxNQUEwQixFQUFFLFNBQWdCLEVBQUUsS0FBYTtJQUNuRyxPQUFPLFNBQVMsQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUE7QUFDbkMsQ0FBQztBQUVELFNBQVMsU0FBUyxDQUFDLElBQVksRUFBRSxhQUFxQjtJQUNwRCxNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzlCLElBQUksV0FBVyxHQUFHLEVBQUUsQ0FBQztJQUNyQixNQUFNLEtBQUssR0FBRyxFQUFFLENBQUM7SUFFakIsS0FBSyxNQUFNLElBQUksSUFBSSxLQUFLLEVBQUUsQ0FBQztRQUN6QixJQUFJLFdBQVcsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLElBQUksYUFBYSxFQUFFLENBQUM7WUFDMUQsV0FBVyxJQUFJLEdBQUcsSUFBSSxHQUFHLENBQUM7UUFDNUIsQ0FBQzthQUFNLENBQUM7WUFDTixLQUFLLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQy9CLFdBQVcsR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDO1FBQzNCLENBQUM7SUFDSCxDQUFDO0lBQ0QsS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUMvQixPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDMUIsQ0FBQztBQUVELE1BQU0sVUFBVSxRQUFRLENBQUMsS0FBWSxFQUFFLEtBQVk7SUFDakQsT0FBTyxVQUFVLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUE7QUFDaEQsQ0FBQztBQUVELE1BQU0sVUFBVSxvQkFBb0IsQ0FBQyxJQUFxQjtJQUN0RCxJQUFJLENBQUMsSUFBSTtRQUFFLE9BQU8sRUFBRSxDQUFBO0lBRXBCLE1BQU0sRUFDSixVQUFVLEVBQ1YsV0FBVyxFQUNYLFdBQVcsRUFDWCxZQUFZLEVBQ1osU0FBUyxFQUNULFVBQVUsR0FDWCxHQUFHLElBQUksQ0FBQTtJQUVSLE9BQU87UUFDTCxVQUFVLEdBQUcsVUFBVSxFQUFFLENBQUMsV0FBVyxHQUFHLFNBQVMsR0FBRyxZQUFZLENBQUMsR0FBRyxXQUFXO1FBQy9FLFVBQVUsR0FBRyxVQUFVLEVBQUUsQ0FBQyxXQUFXLEdBQUcsU0FBUyxDQUFDLEdBQUcsV0FBVztRQUNoRSxDQUFDLFVBQVUsR0FBRyxXQUFXLENBQUMsR0FBRyxVQUFVLEVBQUUsQ0FBQyxXQUFXLEdBQUcsU0FBUyxDQUFDLEdBQUcsV0FBVztRQUNoRixDQUFDLFVBQVUsR0FBRyxXQUFXLENBQUMsR0FBRyxVQUFVLEVBQUUsQ0FBQyxXQUFXLEdBQUcsU0FBUyxHQUFHLFlBQVksQ0FBQyxHQUFHLFdBQVc7S0FDaEcsQ0FBQTtBQUNILENBQUM7QUFXRCxNQUFNLFVBQVUsU0FBUyxDQUFDLEtBQVM7SUFDL0IsT0FBTyxLQUFLLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQyxZQUFZLENBQUE7QUFDakQsQ0FBQztBQUVELE1BQU0sVUFBVSxjQUFjLENBQzVCLFNBQWMsRUFDZCxLQUFhLEVBQ2IsTUFBTSxHQUFHLEdBQUcsRUFDWixLQUFLLEdBQUcsR0FBRyxFQUNYLFFBQWlDO0lBRWpDLElBQUksb0JBQW9CLEdBQUcsU0FBUyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFBO0lBRTVELElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1FBQzFCLG9CQUFvQixHQUFHLFNBQVMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDOUMsb0JBQW9CLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQTtRQUN0QyxvQkFBb0IsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFBO1FBQ3JDLG9CQUFvQixDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUE7UUFDcEMsb0JBQW9CLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQTtRQUNsQyxvQkFBb0IsQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFBO1FBQ3pDLG9CQUFvQixDQUFDLFlBQVksR0FBRyxJQUFJLENBQUE7UUFDeEMsb0JBQW9CLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQTtRQUN2QyxvQkFBb0IsQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFBO0lBQ3ZDLENBQUM7SUFFRCxJQUFJLEtBQUssS0FBSyxDQUFDLEVBQUUsQ0FBQztRQUNoQixvQkFBb0IsQ0FBQyxZQUFZLElBQStCLENBQUE7SUFDbEUsQ0FBQztJQUVELE9BQU8sb0JBQW9CLENBQUE7QUFDN0IsQ0FBQztBQUVELE1BQU0sVUFBVSxlQUFlLENBQUMsS0FBYTtJQUMzQyxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFBO0FBQ2xHLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFbnRpdHksIFVpQ2FudmFzSW5mb3JtYXRpb24sIFlHUG9zaXRpb25UeXBlLCBZR1VuaXQsIGVuZ2luZSB9IGZyb20gXCJAZGNsL3Nkay9lY3NcIlxuaW1wb3J0IHsgdWlTaXplcyB9IGZyb20gXCIuL3VpQ29uZmlnXCJcbmltcG9ydCB7IENvbG9yNCB9IGZyb20gXCJAZGNsL3Nkay9tYXRoXCJcblxuZXhwb3J0IGxldCBkaW1lbnNpb25zOmFueSA9IHtcbiAgICB3aWR0aDowLFxuICAgIGhlaWdodDowXG4gIH1cblxubGV0IHRpbWVyID0gMCAgIFxuZXhwb3J0IGZ1bmN0aW9uIHVpU2l6ZXIoZHQ6bnVtYmVyKXtcbiAgaWYodGltZXIgPiAwKXtcbiAgICB0aW1lciAtPSBkdFxuICB9XG4gIGVsc2V7XG4gICAgdGltZXIgPSAzXG4gICAgbGV0IGNhbnZhcyA9IFVpQ2FudmFzSW5mb3JtYXRpb24uZ2V0KGVuZ2luZS5Sb290RW50aXR5KVxuICAgIC8vIGNvbnNvbGUubG9nKGNhbnZhcy5pbnRlcmFjdGFibGVBcmVhKVxuICAgIC8vIGNvbnNvbGUubG9nKFwiQ0FOVkFTIERJTUVOU0lPTlM6IFwiLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpXG4gICAgZGltZW5zaW9ucy5hc3BlY3QgPSBjYW52YXMuZGV2aWNlUGl4ZWxSYXRpb1xuICAgIGRpbWVuc2lvbnMud2lkdGggPSBjYW52YXMud2lkdGhcbiAgICBkaW1lbnNpb25zLmhlaWdodCA9IGNhbnZhcy5oZWlnaHRcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlSW1hZ2VEaW1lbnNpb25zKHdpZHRoOm51bWJlciwgYXNwZWN0UmF0aW86IG51bWJlcik6IGFueSB7XG4gIGNvbnN0IGRlc2lyZWRXaWR0aCA9IHdpZHRoIC8gMTAwICogZGltZW5zaW9ucy53aWR0aDsgLy8gNDAlIG9mIHRoZSBzY3JlZW4gd2lkdGhcbiAgY29uc3QgZGVzaXJlZEhlaWdodCA9IGRlc2lyZWRXaWR0aCAvIGFzcGVjdFJhdGlvO1xuICByZXR1cm4geyB3aWR0aDogZGVzaXJlZFdpZHRoLCBoZWlnaHQ6IGRlc2lyZWRIZWlnaHQgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZVNxdWFyZUltYWdlRGltZW5zaW9ucyhwZXJjZW50YWdlOiBudW1iZXIpOiBhbnkge1xuICBjb25zdCBtaW5EaW1lbnNpb24gPSBNYXRoLm1pbihkaW1lbnNpb25zLndpZHRoLCBkaW1lbnNpb25zLmhlaWdodCk7XG4gIGNvbnN0IHNxdWFyZVNpemUgPSAobWluRGltZW5zaW9uICogcGVyY2VudGFnZSkgLyAxMDA7XG4gIHJldHVybiB7IHdpZHRoOiBzcXVhcmVTaXplLCBoZWlnaHQ6IHNxdWFyZVNpemUgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZExpbmVCcmVhayh0ZXh0OnN0cmluZywgYnViYmxlOmJvb2xlYW4gfCB1bmRlZmluZWQsIGxpbmVDb3VudDpudW1iZXIsIGxhcmdlPzpudW1iZXIpe1xuICByZXR1cm4gbGluZUJyZWFrKHRleHQsIGxpbmVDb3VudClcbn1cblxuZnVuY3Rpb24gbGluZUJyZWFrKHRleHQ6IHN0cmluZywgbWF4TGluZUxlbmd0aDogbnVtYmVyKTogc3RyaW5nIHtcbiAgY29uc3Qgd29yZHMgPSB0ZXh0LnNwbGl0KCcgJyk7XG4gIGxldCBjdXJyZW50TGluZSA9ICcnO1xuICBjb25zdCBsaW5lcyA9IFtdO1xuXG4gIGZvciAoY29uc3Qgd29yZCBvZiB3b3Jkcykge1xuICAgIGlmIChjdXJyZW50TGluZS5sZW5ndGggKyB3b3JkLmxlbmd0aCArIDEgPD0gbWF4TGluZUxlbmd0aCkge1xuICAgICAgY3VycmVudExpbmUgKz0gYCR7d29yZH0gYDtcbiAgICB9IGVsc2Uge1xuICAgICAgbGluZXMucHVzaChjdXJyZW50TGluZS50cmltKCkpO1xuICAgICAgY3VycmVudExpbmUgPSBgJHt3b3JkfSBgO1xuICAgIH1cbiAgfVxuICBsaW5lcy5wdXNoKGN1cnJlbnRMaW5lLnRyaW0oKSk7XG4gIHJldHVybiBsaW5lcy5qb2luKCdcXG4nKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNpemVGb250KGxhcmdlOm51bWJlciwgc21hbGw6bnVtYmVyKXtcbiAgcmV0dXJuIGRpbWVuc2lvbnMud2lkdGggPiAyMDAwID8gbGFyZ2UgOiBzbWFsbFxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0SW1hZ2VBdGxhc01hcHBpbmcoZGF0YT86IEltYWdlQXRsYXNEYXRhKTogbnVtYmVyW10ge1xuICAgIGlmICghZGF0YSkgcmV0dXJuIFtdXG4gIFxuICAgIGNvbnN0IHtcbiAgICAgIGF0bGFzV2lkdGgsXG4gICAgICBhdGxhc0hlaWdodCxcbiAgICAgIHNvdXJjZVdpZHRoLFxuICAgICAgc291cmNlSGVpZ2h0LFxuICAgICAgc291cmNlVG9wLFxuICAgICAgc291cmNlTGVmdCxcbiAgICB9ID0gZGF0YVxuICBcbiAgICByZXR1cm4gW1xuICAgICAgc291cmNlTGVmdCAvIGF0bGFzV2lkdGgsIChhdGxhc0hlaWdodCAtIHNvdXJjZVRvcCAtIHNvdXJjZUhlaWdodCkgLyBhdGxhc0hlaWdodCxcbiAgICAgIHNvdXJjZUxlZnQgLyBhdGxhc1dpZHRoLCAoYXRsYXNIZWlnaHQgLSBzb3VyY2VUb3ApIC8gYXRsYXNIZWlnaHQsXG4gICAgICAoc291cmNlTGVmdCArIHNvdXJjZVdpZHRoKSAvIGF0bGFzV2lkdGgsIChhdGxhc0hlaWdodCAtIHNvdXJjZVRvcCkgLyBhdGxhc0hlaWdodCxcbiAgICAgIChzb3VyY2VMZWZ0ICsgc291cmNlV2lkdGgpIC8gYXRsYXNXaWR0aCwgKGF0bGFzSGVpZ2h0IC0gc291cmNlVG9wIC0gc291cmNlSGVpZ2h0KSAvIGF0bGFzSGVpZ2h0LFxuICAgIF1cbiAgfVxuICBcbiAgZXhwb3J0IHR5cGUgSW1hZ2VBdGxhc0RhdGEgPSB7XG4gICAgYXRsYXNXaWR0aDogbnVtYmVyO1xuICAgIGF0bGFzSGVpZ2h0OiBudW1iZXI7XG4gICAgc291cmNlV2lkdGg6IG51bWJlcjtcbiAgICBzb3VyY2VIZWlnaHQ6IG51bWJlcjtcbiAgICBzb3VyY2VMZWZ0OiBudW1iZXI7XG4gICAgc291cmNlVG9wOiBudW1iZXI7XG4gIH07XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIGdldEFzcGVjdChwYW5lbDphbnkpe1xuICAgICAgcmV0dXJuIHBhbmVsLnNvdXJjZVdpZHRoIC8gcGFuZWwuc291cmNlSGVpZ2h0XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gZ2V0VUlUcmFuc2Zvcm0oXG4gICAgY29tcG9uZW50OiBhbnksXG4gICAgZW50aXk6IEVudGl0eSxcbiAgICBoZWlnaHQgPSAxMDAsXG4gICAgd2lkdGggPSAxMDAsXG4gICAgdW5pdDogWUdVbml0ID0gWUdVbml0LllHVV9QRVJDRU5ULFxuICApIHtcbiAgICBsZXQgdWlUcmFuc2Zvcm1Db21wb25lbnQgPSBjb21wb25lbnQuZ2V0TXV0YWJsZU9yTnVsbChlbnRpeSlcbiAgXG4gICAgaWYgKCF1aVRyYW5zZm9ybUNvbXBvbmVudCkge1xuICAgICAgdWlUcmFuc2Zvcm1Db21wb25lbnQgPSBjb21wb25lbnQuY3JlYXRlKGVudGl5KVxuICAgICAgdWlUcmFuc2Zvcm1Db21wb25lbnQuaGVpZ2h0VW5pdCA9IHVuaXRcbiAgICAgIHVpVHJhbnNmb3JtQ29tcG9uZW50LndpZHRoVW5pdCA9IHVuaXRcbiAgICAgIHVpVHJhbnNmb3JtQ29tcG9uZW50LmhlaWdodCA9IGhlaWdodFxuICAgICAgdWlUcmFuc2Zvcm1Db21wb25lbnQud2lkdGggPSB3aWR0aFxuICAgICAgdWlUcmFuc2Zvcm1Db21wb25lbnQubWF4SGVpZ2h0VW5pdCA9IHVuaXRcbiAgICAgIHVpVHJhbnNmb3JtQ29tcG9uZW50Lm1heFdpZHRoVW5pdCA9IHVuaXRcbiAgICAgIHVpVHJhbnNmb3JtQ29tcG9uZW50Lm1heEhlaWdodCA9IGhlaWdodFxuICAgICAgdWlUcmFuc2Zvcm1Db21wb25lbnQubWF4V2lkdGggPSB3aWR0aFxuICAgIH1cbiAgXG4gICAgaWYgKGVudGl5ID09PSAwKSB7XG4gICAgICB1aVRyYW5zZm9ybUNvbXBvbmVudC5wb3NpdGlvblR5cGUgPSBZR1Bvc2l0aW9uVHlwZS5ZR1BUX0FCU09MVVRFXG4gICAgfVxuICBcbiAgICByZXR1cm4gdWlUcmFuc2Zvcm1Db21wb25lbnRcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBnZXRSYW5kb21Db2xvcjQoYWxwaGE/Om51bWJlcil7XG4gICAgcmV0dXJuIENvbG9yNC5jcmVhdGUoTWF0aC5yYW5kb20oKSwgTWF0aC5yYW5kb20oKSwgTWF0aC5yYW5kb20oKSwgYWxwaGEgPyBhbHBoYSA6IE1hdGgucmFuZG9tKCkpXG4gIH0iXX0=